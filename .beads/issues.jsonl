{"id":"kura-training-0a0","title":"MCP: Session-aware Context Gate (stdio + HTTP)","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T12:01:15.947692+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T12:12:02.995854+01:00","closed_at":"2026-02-17T12:12:02.995854+01:00","close_reason":"Session-aware context gate implemented with static session store, TTL cleanup, token/stdio session IDs, and 6 behavioral tests. 27/27 mcp-runtime tests pass.","dependencies":[{"issue_id":"kura-training-0a0","depends_on_id":"kura-training-9rd","type":"blocks","created_at":"2026-02-17T12:01:20.387531+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-0hf","title":"Write Path: POST /v1/events + POST /v1/events/batch mit Idempotency","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:05.490369+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T07:26:40.287064+01:00","closed_at":"2026-02-08T07:26:40.287064+01:00","close_reason":"Closed"}
{"id":"kura-training-0hg","title":"Add causal inference telemetry + API parity","description":"Support causal_inference in inference_runs telemetry (schema + writer paths) and expose the projection consistently in API projection metadata/routing summaries where inference projections are enumerated.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T13:54:58.309524+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T14:26:25.543557+01:00","closed_at":"2026-02-11T14:26:25.543557+01:00","close_reason":"Closed","labels":["agent-first","causal","observability"]}
{"id":"kura-training-0tgs","title":"[jkoo.3] Error Translation: technische Fehler in klare User-Aktionen mappen","description":"Warum:\nTechnische Fehlertexte wie \"exec denied: approval timed out\" sind fuer Endnutzer schwer verwertbar und fuehren zu Fehlinterpretation (Agent \"verwirrt\" statt klar blockiert).\n\nWie:\nFehlercode-\u003eUX-Mapping etablieren: stabile interne Codes bleiben erhalten, aber Agent/Runtime liefert kurze, handlungsorientierte Meldungen mit 1-2 konkreten Optionen.","design":"Artefakte:\n- mcp-runtime/src/lib.rs (error mapping)\n- ggf. cli/src/commands/mcp.rs (output formatting)\n- tests fuer message mapping\n\nUmsetzung:\n1) Mapping-Tabelle fuer relevante Codes (approval timeout, legacy route, policy violation).\n2) User-facing text ohne internen Stack-Jargon.\n3) Kontextfelder optional personalisiert (node), aber systemweit generisch nutzbar.","acceptance_criteria":"1) Mindestens die 3 Hauptfehlerpfade sind gemappt und getestet.\n2) Meldungen enthalten klare Next Action.\n3) Keine Aenderung an underlying policy/safety semantics.","notes":"implemented:\n- Added structured write API error classifier in MCP runtime (`classify_write_api_error`).\n- Added user-actionable mapped codes for key failure classes: `write_preflight_blocked`, `plan_write_requires_write_with_proof`, `approval_timeout`.\n- Embedded mapped error surface into tool error payload for better agent UX and downstream handling.\n\nartifacts:\n- mcp-runtime/src/lib.rs\n- tests/architecture/test_150_plan_write_contract.py\n\nverify:\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test -p kura-mcp-runtime tests::write_api_error_classification_maps_preflight_blockers -- --exact\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test -p kura-mcp-runtime tests::write_api_error_classification_maps_approval_timeout -- --exact\n\nresidual risk:\n- Localization is not yet implemented; messages are English baseline.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:39:48.034121+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T18:56:25.538716+01:00","closed_at":"2026-02-20T18:56:25.538716+01:00","close_reason":"Implemented and verified","dependencies":[{"issue_id":"kura-training-0tgs","depends_on_id":"kura-training-jkoo","type":"blocks","created_at":"2026-02-20T18:40:00.147616+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-0tgs","depends_on_id":"kura-training-60ek","type":"blocks","created_at":"2026-02-20T18:40:07.803566+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-0tgs","depends_on_id":"kura-training-adxg","type":"blocks","created_at":"2026-02-20T18:40:07.930029+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-0yc","title":"API: Admin invite management endpoints","description":"## Was\nAdmin-Endpoints für Invite-Verwaltung und Access-Request-Review.\n\n## Endpoints\n\n### GET /v1/admin/access-requests?status=pending\n- Listet Access Requests, filterbar nach status\n- Response: { \"requests\": [{ id, email, name, context, status, created_at }] }\n\n### POST /v1/admin/access-requests/{id}/approve\n- Setzt status=approved, reviewed_at=now(), reviewed_by=admin\n- Generiert invite_token (kura_inv_ + 32 hex, 7 Tage gültig, an Request-Email gebunden)\n- Verlinkt invite_token_id am access_request\n- Response: { \"status\": \"approved\", \"invite_token\": \"kura_inv_...\", \"invite_url\": \"https://...?invite=TOKEN\" }\n\n### POST /v1/admin/access-requests/{id}/reject\n- Setzt status=rejected\n- Response: { \"status\": \"rejected\" }\n\n### POST /v1/admin/invites\n- Erstellt manuellen Invite (ohne Access Request)\n- Body: { \"email\": \"...\" (optional), \"expires_in_days\": 7 (optional, default 7) }\n- Response: { \"token\": \"kura_inv_...\", \"invite_url\": \"...\", \"expires_at\": \"...\" }\n\n### GET /v1/admin/invites?status=unused|used|expired\n- Listet Invites mit Status\n\n## Auth\n- Alle Endpoints: Admin-only (bestehende Admin-Auth-Middleware)\n\n## Hinweise\n- Token-Generierung: kura_inv_ + 32 random hex (wie kura_sk_ Pattern)\n- invite_url: {FRONTEND_URL}/signup?invite={token}\n- FRONTEND_URL aus Config/Env","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:44:54.108201+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:03:38.296159+01:00","closed_at":"2026-02-13T13:03:38.296159+01:00","close_reason":"Admin invite endpoints implemented + Resend email","dependencies":[{"issue_id":"kura-training-0yc","depends_on_id":"kura-training-33v","type":"blocks","created_at":"2026-02-13T12:46:50.341411+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-0yc","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:31.9047+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-14e","title":"[spec] Executable Specs fuer Policy Kernel v1 (Invarianten + Drift-Schutz)","description":"Warum:\n- AGENTS.md verlangt neue Architekturentscheidungen als executable specs.\n- Ohne explizite Kernel-Invarianten entsteht schleichender Drift zwischen Contract und Runtime.\n\nWie:\n- Neue Tests in tests/architecture/ definieren den Kernel-Contract (Input-Snapshot -\u003e Output + Reason Codes).\n- Abdeckung fuer: response_mode A/B/C, advisory-only sidecar, no-forced-personalization, uncertainty transparency, threshold behavior.\n- Contract-Matrix erweitern, damit Kernel-spezifische Runtime-Checks verpflichtend sind.\n\nCompaction-Recovery:\n- Start mit tests/architecture/test_60_agent_contract_coverage_matrix.py und bestehenden tests 105/106/107 als Vorlage.\n- Erst wenn diese Spezifikation stabil ist, Implementierung starten.\n\nAkzeptanz:\n- Specs schlagen ohne Kernel-Implementierung erwartbar fehl oder pinnen bestehendes Verhalten explizit.\n- Testnamen und Invarianten sind selbsterklaerend und deterministic.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T17:14:41.832212+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T17:30:40.703729+01:00","closed_at":"2026-02-15T17:30:40.703729+01:00","close_reason":"Executable Specs ergänzt: neue tests/architecture/test_118_policy_kernel_contract.py, Matrix-Update in tests/architecture/test_60_agent_contract_coverage_matrix.py, Runtime-Hooks via neue Rust-Tests policy_kernel_contract_*; Architektur- und Runtime-Specs verifiziert."}
{"id":"kura-training-15g","title":"Decision 13: Explicit autonomy confirmation templates by SLO status","description":"Translate integrity SLO/autonomy-throttle signals into explicit agent prompt policy with fixed confirmation templates for healthy/monitor/degraded states, exposed via system_config and claim_guard guidance.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:28:52.469907+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T18:33:38.77841+01:00","closed_at":"2026-02-11T18:33:38.77841+01:00","close_reason":"Closed"}
{"id":"kura-training-1ac","title":"Add population priors support for causal_inference","description":"Extend population prior resolution to support causal_inference in workers/src/kura_workers/population_priors.py (currently limited to strength_inference/readiness_inference). Define prior payload schema for causal estimands, privacy gates, and blend policy; wire into causal handler and add tests for opt-in/privacy constraints and fallback behavior.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T14:42:50.116024+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T15:28:58.37727+01:00","closed_at":"2026-02-11T15:28:58.37727+01:00","close_reason":"Closed","labels":["bayesian","causal","privacy"]}
{"id":"kura-training-1e8","title":"Causal Inference Layer: Intervention-Effekte statt nur Korrelationen","description":"Build a dedicated causal inference layer that estimates intervention effects (program changes, nutrition shifts, sleep interventions) using observational data with explicit assumptions. Include propensity-style adjustment, uncertainty intervals, and machine-readable caveats for agents.","notes":"Out-of-scope for current Semantic/Bayesian delivery; follow-up innovation track.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T08:36:55.196912+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T13:55:25.247826+01:00","closed_at":"2026-02-11T13:55:25.247826+01:00","close_reason":"Closed","labels":["agent-first","causal","statistics"]}
{"id":"kura-training-1eo","title":"[spec] Architecture tests für operational_model Invarianten","description":"## Kontext\n\nArchitektur-Entscheidung (AGENTS.md Workflow Schritt 3): Tests VOR Implementierung. Tests in tests/architecture/ erzwingen die Invarianten dauerhaft per CI.\n\n## Was zu tun ist\n\nNeue Test-Datei: tests/architecture/test_NNN_operational_model_contract.py\n\nInvarianten die erzwungen werden müssen:\n\n1. **Jede event_convention hat category** — Alle Einträge in get_event_conventions() haben ein 'category' Feld. Erlaubte Werte: 'tracking', 'correction', 'planning', 'meta', 'system'. Kein neuer Event-Type ohne Kategorie.\n\n2. **build_system_config() enthält operational_model** — Output von build_system_config() hat key 'operational_model' mit mindestens: mutations, corrections, state_access, event_types.\n\n3. **operational_model ist abgeleitet, nicht hardcoded** — Der operational_model-Text für corrections muss aus event_conventions abgeleitet sein (z.B. usage-Text von category=correction Events referenziert).\n\n4. **agent_brief struct hat operational_model Feld** — In api/src/routes/agent.rs: AgentBrief struct enthält pub operational_model.\n\n5. **Rust-Test: agent_brief enthält operational_model aus system_config** — Existing pattern: routes::agent::tests::agent_context_brief_contract_exposes_required_fields erweitern oder neuen Test.\n\n## Wie\n\n- Python arch tests: tests/architecture/test_NNN_operational_model_contract.py\n  - Importiere get_event_conventions, build_system_config aus workers\n  - assert_kura_api_test_passes() für Rust-seitige Tests\n- Rust unit tests: in api/src/routes/agent.rs mod tests\n- Bestehende Patterns anschauen: tests/architecture/test_129_context_brief_overflow_contract.py als Vorlage\n\n## Dateien\n\n- tests/architecture/test_129_context_brief_overflow_contract.py (Vorlage)\n- workers/src/kura_workers/event_conventions.py (wird geprüft)\n- workers/src/kura_workers/system_config.py (wird geprüft)\n- api/src/routes/agent.rs (AgentBrief struct + test)","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-18T22:50:37.173752+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-18T22:55:23.409448+01:00","closed_at":"2026-02-18T22:55:23.409448+01:00","close_reason":"Closed"}
{"id":"kura-training-1ls","title":"Decision 13 F6: Integrity SLOs + autonomy throttling","description":"Measure integrity SLOs from quality_health (unresolved set ratio, save-claim mismatch rate, repair latency), define healthy/monitor/degraded thresholds, and expose policy-gated autonomy throttling (max scope + confirmation strictness) so agent behavior is automatically constrained on regressions.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:19:32.704343+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T18:25:02.076658+01:00","closed_at":"2026-02-11T18:25:02.076658+01:00","close_reason":"Closed"}
{"id":"kura-training-21cw","title":"Deterministic Retrieval Platform V1 (MCP/API/CLI)","description":"Why:\nPayload-Truncation und große Kontextantworten erzeugen nicht-deterministisches Agent-Verhalten (fehlende kritische Sektionen, Halluzinationen, inkonsistente Onboarding/Non-Onboarding-Flows). Ein punktueller Fix reicht nicht; wir brauchen einen systemweiten Retrieval-Vertrag.\n\nHow:\nWir trennen Control Plane (klein, kritisch, deterministisch) von Data Plane (chunked/paginiert/on-demand), erzwingen fail-closed Gates vor jeder Antwortgenerierung und definieren stabile Fetch-Invarianten mit ausführbaren Architektur-Tests.\n\nWhat success means:\nDer Agent kann in jedem Flow (Onboarding und Advanced Use) die benötigten Informationen reproduzierbar laden oder explizit blockiert/fallbacken, ohne spekulative Antworten. Truncation darf niemals stillschweigend kritische Fakten verwerfen.\n\nScope:\nMCP Runtime, API Contracts, MCP Tool-Surface, CLI-Diagnostik, Observability und Rollout-Guardrails.\n\nOut of scope:\nUI-only Workarounds, Prompt-only Fixes ohne Runtime-Invarianten, und domain-spezifisches Hardcoding nur für Onboarding.","design":"System invariants first: response generation is allowed only when all critical sections are present. APIs must expose section index + paginated section fetch. MCP/CLI surfaces must reflect the same startup contract and reason codes.","acceptance_criteria":"1) Alle Child-Tasks sind umgesetzt und verifiziert.\n2) Architektur-Tests in tests/architecture erzwingen die Retrieval-Invarianten dauerhaft.\n3) Es existiert ein messbarer Rückgang von overflow/critical-missing/speculative-answer Ereignissen.","status":"open","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-21T08:49:06.053905+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T08:49:06.053905+01:00","labels":["api","architecture","cli","mcp","payload","runtime"]}
{"id":"kura-training-21cw.1","title":"Canary targeting via user/email allowlists + rollout for first 4 users","notes":"Implement user/email canary allowlists in mcp-runtime, wire compose envs, deploy canary for 4 initial users, verify diagnostics/guard behavior.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T12:14:03.349432+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T12:21:10.047001+01:00","closed_at":"2026-02-21T12:21:10.047001+01:00","close_reason":"Implemented and deployed canary targeting by session/user/email allowlists; activated first cohort of 4 users and verified runtime env + service health.","labels":["determinism","mcp","rollout"],"dependencies":[{"issue_id":"kura-training-21cw.1","depends_on_id":"kura-training-21cw","type":"parent-child","created_at":"2026-02-21T12:14:03.350744+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-21cw.2","title":"Deterministic Retrieval DX Hardening (CLI + MCP, compact-resilient)","description":"Why:\nCLI und MCP bieten den Retrieval-Vertrag zwar funktional, aber der Bedienpfad ist noch zu indirekt (CLI via generischem request) und nicht maximal kompakt-resilient bei Kontextverlust.\n\nHow:\nWir bauen einen expliziten DX-Layer über den bestehenden API-Vertrag:\n- First-class CLI-Kommandos für section-index/section-fetch + token-budgeting.\n- MCP-Antworten mit deterministischem Fetch-Plan und paginierbaren Next-Call-Hinweisen.\n- Spec-first Absicherung über tests/architecture und Runtime-Unit-Tests.\n\nCompact-survival note:\nJede Teilarbeit enthält Why/How im Issue selbst, plus maschinenlesbare Test-Invarianten. Dadurch bleibt die Implementierung nach Chat-Compaction reproduzierbar.\n\nDesign:\nKeine neue Retrieval-Logik erfinden. Nur bestehende API-Contracts explizit und robust nutzbar machen.\n\nAcceptance criteria:\n1) CLI kann section-index/fetch ohne agent request Escape-Hatch aufrufen.\n2) MCP liefert in section-index/fetch explizite next-safe fetch Hinweise.\n3) Architekturtests erzwingen den Vertrag dauerhaft.\n","status":"open","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-21T14:06:49.734535+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T14:06:49.734535+01:00","labels":["architecture","cli","mcp","retrieval"],"dependencies":[{"issue_id":"kura-training-21cw.2","depends_on_id":"kura-training-21cw","type":"parent-child","created_at":"2026-02-21T14:06:49.736987+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-21cw.2.1","title":"Spec-first: CLI+MCP retrieval ergonomics contract","description":"Why:\nOhne expliziten Contract droht Drift zwischen CLI, MCP und API; nach Compaction gehen implizite Annahmen verloren.\n\nHow:\n- Ergänze tests/architecture um einen Vertrag für:\n  - CLI surface für section-index/section-fetch + budget_tokens.\n  - MCP section tools mit deterministic recovery metadata.\n- Ergänze passende Rust-Unit-Tests in cli/mcp-runtime.\n\nCompact-survival note:\nDiese Specs sind die dauerhafte Quelle für \"was muss gelten\" und ersetzen flüchtigen Chat-Kontext.\n\nAcceptance criteria:\n1) Neue Architekturtests schlagen bei Surface-Drift fehl.\n2) Runtime-Tests verifizieren konkrete Felder der Tool/CLI-Ausgaben.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T14:06:49.871557+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T14:13:53.354601+01:00","closed_at":"2026-02-21T14:13:53.354601+01:00","close_reason":"Implemented and verified","labels":["architecture","cli","mcp","tests"],"dependencies":[{"issue_id":"kura-training-21cw.2.1","depends_on_id":"kura-training-21cw.2","type":"parent-child","created_at":"2026-02-21T14:06:49.873713+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-21cw.2.1","depends_on_id":"kura-training-21cw","type":"blocks","created_at":"2026-02-21T14:06:49.878927+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-21cw.2.2","title":"CLI: first-class section-index/section-fetch + context budget ergonomics","description":"Why:\nAktuell braucht man für section-basierte Reads den Umweg über kura agent request; das ist fehleranfällig und verlangsamt Incident- und Agent-Arbeit.\n\nHow:\n- Neue Subcommands:\n  - kura agent section-index\n  - kura agent section-fetch\n- Erweiterung von kura agent context um --budget-tokens.\n- Konsistente Query-Parameter/Fehlermeldungen entlang bestehender API-Contracts.\n\nCompact-survival note:\nDie CLI wird zum stabilen, reproduzierbaren Entry-Point für Retrieval ohne versteckte API-Pfade.\n\nAcceptance criteria:\n1) Alle drei Flows sind per CLI direkt nutzbar.\n2) CLI-Hilfe und Tests decken die Parameter ab.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T14:06:50.00523+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T14:13:53.3612+01:00","closed_at":"2026-02-21T14:13:53.3612+01:00","close_reason":"Implemented and verified","labels":["cli","dx","retrieval"],"dependencies":[{"issue_id":"kura-training-21cw.2.2","depends_on_id":"kura-training-21cw.2","type":"parent-child","created_at":"2026-02-21T14:06:50.00687+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-21cw.2.2","depends_on_id":"kura-training-21cw","type":"blocks","created_at":"2026-02-21T14:06:50.011963+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-21cw.2.2","depends_on_id":"kura-training-21cw.2.1","type":"blocks","created_at":"2026-02-21T14:06:50.017593+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-21cw.2.3","title":"MCP: deterministic recovery metadata for section tools","description":"Why:\nDie section tools liefern heute primär raw request/response. Bei Kontextverlust fehlen explizite nächste Schritte (Fetch-Reihenfolge, Pagination-Continuation).\n\nHow:\n- kura_agent_section_index ergänzt:\n  - critical_fetch_order\n  - critical_fetch_calls (tool + args)\n- kura_agent_section_fetch ergänzt:\n  - pagination metadata inklusive next_call bei has_more\n  - section_contract summary (critical/reason_code/next_action)\n\nCompact-survival note:\nDie Antwort selbst enthält den Fortsetzungsplan; dadurch bleibt der Ablauf ohne Chat-Historie deterministisch.\n\nAcceptance criteria:\n1) section-index enthält expliziten Recovery-Plan.\n2) section-fetch enthält explizite Pagination-Fortsetzung.\n3) Tests pinnen die neuen Felder.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T14:06:50.145196+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T14:13:53.366464+01:00","closed_at":"2026-02-21T14:13:53.366464+01:00","close_reason":"Implemented and verified","labels":["contract","mcp","retrieval"],"dependencies":[{"issue_id":"kura-training-21cw.2.3","depends_on_id":"kura-training-21cw.2","type":"parent-child","created_at":"2026-02-21T14:06:50.147528+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-21cw.2.3","depends_on_id":"kura-training-21cw","type":"blocks","created_at":"2026-02-21T14:06:50.152787+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-21cw.2.3","depends_on_id":"kura-training-21cw.2.1","type":"blocks","created_at":"2026-02-21T14:06:50.156614+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-21cw.2.4","title":"E2E gates + closure for retrieval DX hardening","description":"Why:\nEinzeländerungen ohne gemeinsamen Gate-Lauf erhöhen das Risiko für regressives Verhalten im Retrieval-Stack.\n\nHow:\n- Vollständige Quality Gates laut AGENTS.md.\n- Issue-Status synchronisieren, bd sync, git pull --rebase, git push.\n- Kurze Hand-off-Zusammenfassung mit Risiken/Restarbeiten.\n\nCompact-survival note:\nDer Abschluss ist reproduzierbar dokumentiert (Tests + Beads + Push), nicht nur im Chat beschrieben.\n\nAcceptance criteria:\n1) Alle relevanten Gates grün oder sauber begründet.\n2) Beads konsistent geschlossen/aktualisiert.\n3) Branch ist gepusht und remote aktuell.\n","status":"in_progress","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T14:06:50.288256+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T14:07:02.692344+01:00","labels":["integration","quality","tests"],"dependencies":[{"issue_id":"kura-training-21cw.2.4","depends_on_id":"kura-training-21cw.2","type":"parent-child","created_at":"2026-02-21T14:06:50.290245+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-21cw.2.4","depends_on_id":"kura-training-21cw.2.2","type":"blocks","created_at":"2026-02-21T14:06:50.295608+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-21cw.2.4","depends_on_id":"kura-training-21cw.2.3","type":"blocks","created_at":"2026-02-21T14:06:50.300135+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2iz","title":"Auth UX: consent-first social signup flow","description":"Implement dedicated social signup path that captures Art. 9 consent before account creation/linking, instead of requiring email/password pre-registration.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T18:49:47.326125+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T19:14:20.117899+01:00","closed_at":"2026-02-16T19:14:20.117899+01:00","close_reason":"Closed"}
{"id":"kura-training-2jl","title":"Agent persistence UX hardening (simulate-first, strict contracts, no dead ends)","description":"Why: Agent-side backend operations still allow ambiguous write modes, fragmented gates, and weakly formalized event types. This can produce user-visible dead ends, inconsistent persistence behavior, and hidden data quality drift. How: harden write policy contracts and route behavior so the agent always knows whether a write is simulated, blocked, draft-only, or durably committed. Scope: points 1-7 from the backend UX review (mode defaults, legacy fallback removal, preflight clarity, context gate behavior, persist-intent lifecycle, temporal/high-impact handshake clarity, strict event-type formality).","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-18T13:28:19.500567+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-18T13:56:09.59696+01:00","closed_at":"2026-02-18T13:56:09.59696+01:00","close_reason":"Closed"}
{"id":"kura-training-2jl.1","title":"[1] Simulate-first default for kura_events_write","description":"Why: Defaulting to commit conflicts with safety-first agent flow and increases accidental write risk. How: switch runtime defaults to simulate where mode is unspecified, keep explicit commit path unchanged, add architecture contract pinning and runtime tests. Acceptance: unspecified mode resolves to simulate across MCP/runtime surfaces; tests cover default and explicit override.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-18T13:28:19.637654+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-18T13:56:08.716786+01:00","closed_at":"2026-02-18T13:56:08.716786+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2jl.1","depends_on_id":"kura-training-2jl","type":"parent-child","created_at":"2026-02-18T13:28:19.639387+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2jl.2","title":"[2] Remove/guard legacy commit fallback in write_with_proof","description":"Why: Silent fallback from proof path to legacy commit breaks determinism and surprises the agent. How: make fallback explicit-blocked with machine-readable reason code and remediation hint; allow only via explicit compatibility flag if required. Acceptance: fallback cannot happen silently; error/response includes stable reason code; tests cover blocked fallback and opt-in compatibility behavior.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-18T13:28:19.776932+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-18T13:56:08.850838+01:00","closed_at":"2026-02-18T13:56:08.850838+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2jl.2","depends_on_id":"kura-training-2jl","type":"parent-child","created_at":"2026-02-18T13:28:19.780993+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2jl.2","depends_on_id":"kura-training-2jl.1","type":"blocks","created_at":"2026-02-18T13:28:20.587008+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2jl.3","title":"[3+6] Unified preflight blockers for onboarding/timezone/consent/handshake/high-impact","description":"Why: Preconditions are currently distributed and can cause retry loops because the agent sees partial blockers. How: add one preflight evaluation contract that returns complete blocker list, severity, and next action hints before write attempt. Acceptance: single payload exposes all active blockers with stable codes; no hidden hard blocker discovered later in write path.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-18T13:28:19.919188+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-18T13:56:08.982429+01:00","closed_at":"2026-02-18T13:56:08.982429+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2jl.3","depends_on_id":"kura-training-2jl","type":"parent-child","created_at":"2026-02-18T13:28:19.924205+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2jl.3","depends_on_id":"kura-training-2jl.1","type":"blocks","created_at":"2026-02-18T13:28:20.691461+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2jl.3","depends_on_id":"kura-training-2jl.2","type":"blocks","created_at":"2026-02-18T13:28:20.80408+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2jl.4","title":"[4] Context gate hardening (overflow + missing critical sections)","description":"Why: warning-only context gating plus overflow truncation can hide mandatory data and degrade decisions. How: keep advisory behavior for non-critical sections, but require explicit degraded-state markers and section reload hints; block only when critical invariant sections are missing. Acceptance: response includes structured overflow metadata, critical-missing marker, and deterministic behavior under token pressure.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-18T13:28:20.062711+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-18T13:56:09.107212+01:00","closed_at":"2026-02-18T13:56:09.107212+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2jl.4","depends_on_id":"kura-training-2jl","type":"parent-child","created_at":"2026-02-18T13:28:20.064366+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2jl.4","depends_on_id":"kura-training-2jl.3","type":"blocks","created_at":"2026-02-18T13:28:20.912304+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2jl.5","title":"[5] Persist-intent draft lifecycle closure","description":"Why: Drafts can become sinks (created but not progressed), degrading agent/user trust. How: enforce lifecycle states with age/review signals, dedupe prompts, and clear promote/dismiss/resolve affordances in backend contract. Acceptance: drafts expose actionable state and anti-loop guards; architecture tests pin lifecycle fields and transitions.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-18T13:28:20.192212+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-18T13:56:09.230101+01:00","closed_at":"2026-02-18T13:56:09.230101+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2jl.5","depends_on_id":"kura-training-2jl","type":"parent-child","created_at":"2026-02-18T13:28:20.194707+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2jl.5","depends_on_id":"kura-training-2jl.3","type":"blocks","created_at":"2026-02-18T13:28:21.028072+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2jl.6","title":"[7] Formal event-type contract at write boundaries","description":"Why: Free-form event_type allows events that persist but are weakly projected/handled, causing hidden backend UX failures. How: add canonical event-type validation/normalization policy for agent write paths; unknown types handled explicitly (reject or observation fallback with reason). Acceptance: write_with_proof and related draft promotion paths enforce formal type policy with stable machine-readable outcomes.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-18T13:28:20.331261+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-18T13:56:09.355112+01:00","closed_at":"2026-02-18T13:56:09.355112+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2jl.6","depends_on_id":"kura-training-2jl","type":"parent-child","created_at":"2026-02-18T13:28:20.333788+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2jl.6","depends_on_id":"kura-training-2jl.3","type":"blocks","created_at":"2026-02-18T13:28:21.138694+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2jl.7","title":"Architecture spec coverage + implementation + regression suite","description":"Why: These are architectural invariants and must survive future refactors and context compaction. How: encode 'what must hold' in tests/architecture and route-level tests before/with code updates, then run full quality gates. Acceptance: architecture tests reference new runtime test names, code/tests pass local gates, and task docs include rationale for future sessions.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-18T13:28:20.477535+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-18T13:56:09.476318+01:00","closed_at":"2026-02-18T13:56:09.476318+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2jl.7","depends_on_id":"kura-training-2jl","type":"parent-child","created_at":"2026-02-18T13:28:20.479867+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2jl.7","depends_on_id":"kura-training-2jl.4","type":"blocks","created_at":"2026-02-18T13:28:21.240467+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2jl.7","depends_on_id":"kura-training-2jl.5","type":"blocks","created_at":"2026-02-18T13:28:21.336012+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2jl.7","depends_on_id":"kura-training-2jl.6","type":"blocks","created_at":"2026-02-18T13:28:21.433262+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2kb","title":"Agent-Verhaltens-Conventions in system_config","description":"Neue Sektion in system_config für Agent-Verhalten (nicht Daten-Conventions): Bei Mehrdeutigkeit nachfragen statt annehmen, nicht mehr erstellen als explizit gewünscht, Follow-up-Fragen bei fehlenden Daten. System-Defaults in system_config, User-Overrides in user_profile. Quasi eine soul.md als Datenstruktur. Entdeckt im Kura-Playtest 2026-02-09 (über-eifriger Agent hat 3-Tage-Plan statt nur Tag A erstellt).","notes":"Grundgerüst implementiert: vision (Bach-Prinzipien) + operational (scope levels, rules). Follow-up: konkrete Szenarien, Beispiele, User-Override-Mechanismus in user_profile.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:50.376579+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:25:44.812262+01:00","closed_at":"2026-02-10T07:25:44.812262+01:00","close_reason":"Grundgerüst implementiert. Detailausbau als Follow-up."}
{"id":"kura-training-2of5","title":"Stabilize first-contact onboarding + brief-first context orchestration","description":"Problem: New users still receive non-deterministic startup behavior (discover-heavy replies, missing onboarding interview offer, and noisy capability menus like device connect/import). Root cause is architectural: onboarding and brief are contracts, but runtime behavior remains mostly advisory.\\n\\nWhy now: This directly harms first-session trust and causes contradictory agent outputs even when backend contracts are correct. We need deterministic startup without degrading later autonomy.\\n\\nHow (target architecture):\\n1) Risk-gated startup, not full-context hardcoding: require a minimal brief/intent context before normal tool freedom.\\n2) Deterministic first-contact policy when onboarding is open: explain Kura shortly, offer interview, allow skip/log-now path.\\n3) Discovery hygiene: hide non-production or non-ready capability suggestions in first-contact flows.\\n4) Backfill/recalculate for existing users and deep post-change audit.\\n\\nDefinition of done:\\n- Architecture spec tests in tests/architecture guard the invariants.\\n- Runtime + API + worker behavior are aligned end-to-end.\\n- Deploy completed, migration/drift checks clean, recompute/backfill executed, and production audit report confirms expected behavior.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-21T00:28:46.173214+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T01:09:36.620226+01:00","closed_at":"2026-02-21T01:09:36.620226+01:00","close_reason":"Closed","comments":[{"id":52,"issue_id":"kura-training-2of5","author":"jonzim-cmd","text":"Rollout complete. Why: first-contact onboarding was nondeterministic because startup behavior was advisory and discovery payloads were too large/noisy. How: introduced startup brief gate (kura_agent_brief required first), truncation-safe brief payload, deterministic onboarding action_required contract, and hidden import/provider tools by default. Verification: local gates all green (ruff; workers unit+integration; cargo test --workspace; tests/architecture). Production: deployed main@b3fcdc9, migration drift check passed, objective backfill source=manual.onboarding_brief_rollout_20260221 completed, and live MCP probe for jonzim@t-online.de confirms gate/error before brief, onboarding action in brief, discover unlocked after brief, import/provider/device tools hidden.","created_at":"2026-02-21T00:09:30Z"}]}
{"id":"kura-training-2of5.1","title":"Spec contracts: brief-first startup, onboarding determinism, and discovery hygiene","description":"Why: Compacting-safe implementation requires invariant tests before/with code. Existing tests cover pieces but do not fully enforce deterministic startup path and feature-hygiene behavior.\\n\\nHow:\\n- Add/extend tests in tests/architecture for: (a) mandatory minimal brief surface before normal tool flow, (b) onboarding-first response intents while workflow onboarding is open, (c) discover does not market connect/import in first-contact mode, (d) overflow contract keeps required onboarding/action signals.\\n- Pin contract version bumps where needed to make drift explicit in CI.\\n\\nDone when: CI fails if startup or onboarding determinism regresses, even after future compaction/refactors.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T00:28:57.075837+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T01:09:36.401953+01:00","closed_at":"2026-02-21T01:09:36.401953+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2of5.1","depends_on_id":"kura-training-2of5","type":"parent-child","created_at":"2026-02-21T00:28:57.077054+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2of5.2","title":"Implement minimal agent brief endpoint/path with non-truncatable onboarding signals","description":"Why: agent_brief exists but is buried inside large context payloads and optional behavior. We need a guaranteed small control-plane response that survives truncation and context loss.\\n\\nHow:\\n- Add dedicated runtime/API path/tool for minimal brief retrieval (or equivalent enforced minimal mode) containing action_required, must_cover_intents, workflow_state, and compact user/profile readiness markers.\\n- Ensure payload limit logic cannot drop required onboarding/action fields in this mode.\\n- Keep full context available as optional follow-up reads to preserve autonomy.\\n\\nDone when: first-contact logic can reliably run from minimal brief only, with deterministic fields and overflow-safe semantics.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T00:29:05.401952+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T01:09:36.431426+01:00","closed_at":"2026-02-21T01:09:36.431426+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2of5.2","depends_on_id":"kura-training-2of5","type":"parent-child","created_at":"2026-02-21T00:29:05.403281+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.2","depends_on_id":"kura-training-2of5.1","type":"blocks","created_at":"2026-02-21T00:29:05.405593+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2of5.3","title":"Runtime risk gate: enforce brief-first before unrestricted tool orchestration","description":"Why: Advisory warnings are insufficient; models can still skip context/brief and hallucinate startup behavior.\\n\\nHow:\\n- Introduce session state requiring successful minimal brief load before broad discover/read flows.\\n- Keep gate scope narrow: low-risk status tools can remain available; high-risk or user-state-dependent tools require brief_loaded=true.\\n- Preserve autonomy after gate unlock: no forced full-context reload for every turn.\\n\\nDone when: startup behavior is deterministic without forcing monolithic context fetches, and later-session flexibility remains intact.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T00:29:12.814794+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T01:09:36.466446+01:00","closed_at":"2026-02-21T01:09:36.466446+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2of5.3","depends_on_id":"kura-training-2of5","type":"parent-child","created_at":"2026-02-21T00:29:12.815961+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.3","depends_on_id":"kura-training-2of5.2","type":"blocks","created_at":"2026-02-21T00:29:12.818402+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2of5.4","title":"Deterministic first-contact onboarding behavior (intro + interview offer + skip path)","description":"Why: Onboarding currently exists in contracts but is not guaranteed in response behavior.\\n\\nHow:\\n- Enforce first-contact response intent policy when onboarding is open: explain Kura briefly, offer short onboarding interview, allow skip/log-now branch.\\n- Prevent feature-menu dumps before interview offer.\\n- Ensure workflow markers (onboarding closed/override) transition behavior cleanly into planning mode.\\n\\nDone when: transcripts for new accounts consistently produce onboarding-first behavior and no false claim that onboarding does not exist.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T00:29:21.766517+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T01:09:36.495993+01:00","closed_at":"2026-02-21T01:09:36.495993+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2of5.4","depends_on_id":"kura-training-2of5","type":"parent-child","created_at":"2026-02-21T00:29:21.767817+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.4","depends_on_id":"kura-training-2of5.2","type":"blocks","created_at":"2026-02-21T00:29:21.769645+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.4","depends_on_id":"kura-training-2of5.3","type":"blocks","created_at":"2026-02-21T00:29:21.77174+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2of5.5","title":"Discovery hygiene: suppress non-ready connect/import recommendations in first-contact flows","description":"Why: Agents currently suggest device-connect/import paths that are not fully user-ready, creating trust break and noise during onboarding.\\n\\nHow:\\n- Add readiness-aware capability surfacing in discover/brief metadata.\\n- In first-contact/onboarding-open mode, hide or downgrade connect/import suggestions unless explicitly asked by user and capability is ready.\\n- Keep explicit power-user access for debug/admin pathways unchanged.\\n\\nDone when: onboarding/start conversations no longer proactively advertise incomplete connect/import features.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T00:29:29.613703+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T01:09:36.522401+01:00","closed_at":"2026-02-21T01:09:36.522401+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2of5.5","depends_on_id":"kura-training-2of5","type":"parent-child","created_at":"2026-02-21T00:29:29.614362+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.5","depends_on_id":"kura-training-2of5.3","type":"blocks","created_at":"2026-02-21T00:29:29.615843+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2of5.6","title":"Migration/recalculation for existing users + safe rollout scripts","description":"Why: Existing users/projections can retain stale startup state; rollout without recompute risks mixed behavior.\\n\\nHow:\\n- Add/adjust migration if schema/state fields change.\\n- Execute deterministic recalculation/backfill for affected projections (especially user_profile/agenda and startup control surfaces).\\n- Provide idempotent rollout script + verification queries for before/after counts.\\n\\nDone when: existing users converge to new startup contracts without data loss and rerun is safe (idempotent).","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T00:29:35.639053+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T01:09:36.548951+01:00","closed_at":"2026-02-21T01:09:36.548951+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2of5.6","depends_on_id":"kura-training-2of5","type":"parent-child","created_at":"2026-02-21T00:29:35.640223+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.6","depends_on_id":"kura-training-2of5.4","type":"blocks","created_at":"2026-02-21T00:29:35.642753+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.6","depends_on_id":"kura-training-2of5.5","type":"blocks","created_at":"2026-02-21T00:29:35.645026+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2of5.7","title":"Deep audit + full quality gates + transcript regression verification","description":"Why: This change spans runtime, API, worker, and production behavior; partial checks miss cross-layer regressions.\\n\\nHow:\\n- Run mandatory gates from AGENTS.md: ruff, python unit, python integration, cargo test workspace.\\n- Run architecture spec tests relevant to startup/onboarding/discovery invariants.\\n- Execute transcript-style regression checks for: new user start, explicit onboarding hint, post-onboarding normal usage.\\n- Produce audit summary with findings and residual risks.\\n\\nDone when: no blocking findings remain and evidence shows deterministic behavior end-to-end.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T00:29:42.808708+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T01:09:36.573282+01:00","closed_at":"2026-02-21T01:09:36.573282+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2of5.7","depends_on_id":"kura-training-2of5","type":"parent-child","created_at":"2026-02-21T00:29:42.809971+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.7","depends_on_id":"kura-training-2of5.1","type":"blocks","created_at":"2026-02-21T00:29:42.813443+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.7","depends_on_id":"kura-training-2of5.2","type":"blocks","created_at":"2026-02-21T00:29:42.81564+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.7","depends_on_id":"kura-training-2of5.3","type":"blocks","created_at":"2026-02-21T00:29:42.818206+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.7","depends_on_id":"kura-training-2of5.4","type":"blocks","created_at":"2026-02-21T00:29:42.820857+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.7","depends_on_id":"kura-training-2of5.5","type":"blocks","created_at":"2026-02-21T00:29:42.823774+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.7","depends_on_id":"kura-training-2of5.6","type":"blocks","created_at":"2026-02-21T00:29:42.826174+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2of5.8","title":"Production deploy + post-deploy recompute and verification","description":"Why: Behavioral fix must be verified on real routing/auth/runtime, not only local tests.\\n\\nHow:\\n- Deploy branch build to VPS using project deploy workflow with migration drift checks.\\n- Trigger post-deploy recompute/backfill where required.\\n- Verify with real account traces (including jonzim@t-online.de) that startup now yields onboarding-first behavior and no noisy connect/import suggestions.\\n- Capture rollback signal criteria if unexpected behavior appears.\\n\\nDone when: production checks pass and rollout evidence is documented in bead comments.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T00:29:49.560777+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T01:09:36.59691+01:00","closed_at":"2026-02-21T01:09:36.59691+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2of5.8","depends_on_id":"kura-training-2of5","type":"parent-child","created_at":"2026-02-21T00:29:49.562467+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2of5.8","depends_on_id":"kura-training-2of5.7","type":"blocks","created_at":"2026-02-21T00:29:49.565055+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2rx","title":"[hardening] Session-Feedback Legacy-Text Heuristik gegen Randfälle absichern","description":"Warum:\n- Die Legacy-Freitext-Inferenz fuer session.completed basiert auf einfachen Substring-Matches und ist damit anfaellig fuer Fehlklassifikationen.\n- Aktuelle Rest-Risiken: Negationsphrasen (\"nicht schlecht\"), Umlaut-Varianten (\"muede\"), gemischte Signale, und Teilwort-Treffer (z.B. \"bad\" in \"badminton\").\n\nWie:\n- Heuristik auf tokenbasierte Matches mit Wortgrenzen und normalisierter Textform umstellen.\n- Negierte Negativphrasen explizit neutral behandeln.\n- Regression-Tests fuer die vier genannten Randfaelle in workers/tests/test_session_feedback.py ergaenzen.\n\nAkzeptanz:\n- Neue Regression-Tests sind gruen.\n- Bestehende session_feedback Unit- und Integration-Tests bleiben gruen.\n","notes":"Abschlussprotokoll (2026-02-15):\n- Legacy-Text-Heuristik von Substring-Matching auf tokenbasierte Wortgrenzen umgestellt.\n- Textnormalisierung ergänzt (ä/ö/ü/ß -\u003e ae/oe/ue/ss), damit Umlaut-Varianten wie \"muede\" zuverlässig erkannt werden.\n- Negationsphrasen \"nicht schlecht\"/\"not bad\" werden vor dem Token-Scoring neutralisiert.\n- Positive Hint-Liste präzisiert (\"spa\" -\u003e \"spass\"), um Teilwort-Fehltreffer zu reduzieren.\n- Neue Regression-Tests ergänzt:\n  1) negated negative phrase stays neutral\n  2) negative inference without umlaut variant (muede)\n  3) mixed signals remain unresolved\n  4) partial word tokens do not match (badminton)\n- Quality Gates:\n  - ruff check workers/src/ workers/tests/ -\u003e PASS\n  - PYTHONPATH=workers/src workers/.venv/bin/python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py -\u003e PASS (729 passed, 135 skipped)\n  - PYTHONPATH=workers/src workers/.venv/bin/python -m pytest workers/tests/test_integration.py -q -\u003e PASS (85 passed)\n  - cargo test --workspace -\u003e PASS\n- Akzeptanz erfüllt: neue Randfall-Regressionen grün, bestehende Unit/Integration-Suites unverändert grün.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T18:03:50.783025+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T18:07:06.830708+01:00","closed_at":"2026-02-15T18:07:06.830708+01:00","close_reason":"Legacy-Text-Heuristik gehärtet; neue Randfall-Regressionen und alle Gates grün."}
{"id":"kura-training-2ut","title":"Temporal Grounding v1 fuer Agent-Turns (compaction-resilient)","description":"Problem: Agent-Antworten verlieren im Chat schnell den korrekten Zeithorizont (\"heute\", \"gestern\", \"letzten Freitag\") und behandeln alte Kontexte als aktuell.\nWarum: Das Modell darf Zeitlogik nicht \"erraten\"; Kura muss pro Turn einen deterministischen Zeitanker liefern und bei zeitkritischen Flows überprüfbar machen.\nZiel: Ein end-to-end Temporal-Grounding-Contract, der auch bei Compaction/Kontextverlust tragfähig bleibt, weil er in API-Contracts, Tests, Telemetrie und Integrations-Runbook verankert ist.","design":"Phasen:\n1) Executable Spec: temporal_grounding.v1 als Architekturvertrag + Coverage-Matrix.\n2) API-Layer: /v1/agent/context liefert temporal_context (now/today/timezone + abgeleitete Deltas).\n3) Projection-Parität: readiness_inference auf timezone-first Tagessemantik angleichen.\n4) Runtime-Enforcement: zeitkritische write-with-proof Flows müssen frische temporal_basis nachweisen.\n5) Observability + Regression: Anomalien, natürliche Sprachszenarien, und Integrations-Playbook für Fred.\nClock-API Haltung: externe Clock ist optional; primäre Quelle ist serverseitige Zeit mit sauberer TZ-Normalisierung und Drift-Monitoring.","acceptance_criteria":"1) Alle Child-Tasks mit Dependencies angelegt. 2) Jeder Task enthaelt Why/How + konkrete Artefakte (Dateien/Tests/Endpoints). 3) Abschlusskriterium ist ein reproduzierbarer Turn-Zeitvertrag statt Prompt-Hoffnung.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:04:27.39842+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:29:53.842861+01:00","closed_at":"2026-02-15T11:29:53.842861+01:00","close_reason":"Closed"}
{"id":"kura-training-2ut.1","title":"Executable Spec: temporal_grounding_v1 als Architekturvertrag","description":"Warum: Ohne expliziten Architekturvertrag wird Zeitkontext bei Refactors wieder implizit und geht nach Compaction verloren.\nWie: temporal_grounding_v1 als public contract in system_config + neue Architecture-Tests, die Felder, Regeln und Runtime-Testnamen pinnen.","design":"- Neue Spec-Datei in tests/architecture (naechste freie Nummer) mit Invarianten fuer Temporal Grounding.\n- test_60_agent_contract_coverage_matrix.py um Contract-Key temporal_grounding erweitern.\n- Rust Runtime-Tests (routes::agent::tests::...) als referenzierte Positiv/Negativ-Cases pinnen.\n- Keine prose-only Entscheidung; Quelle der Wahrheit sind Tests + Contract-Felder.","acceptance_criteria":"1) Architecture-Test failt, wenn temporal_grounding_v1 fehlt/abweicht. 2) Coverage-Matrix enthaelt temporal_grounding mit schema_pin/positive_case/negative_case. 3) Referenzierte Rust-Tests laufen gruen.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:04:27.531718+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:29:52.790485+01:00","closed_at":"2026-02-15T11:29:52.790485+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2ut.1","depends_on_id":"kura-training-2ut","type":"parent-child","created_at":"2026-02-15T11:04:27.533563+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2ut.2","title":"API: /v1/agent/context liefert deterministic temporal_context","description":"Warum: Agenten brauchen pro Turn einen deterministischen Zeitanker; generated_at alleine reicht nicht fuer alltagsnahe Aussagen (heute/seit X Tagen).\nWie: /v1/agent/context bekommt ein explizites temporal_context-Objekt mit serverseitig berechneten absoluten Werten inkl. TZ-Herkunft und Trainingsdeltas.","design":"- AgentContextMeta erweitern um temporal_context:\n  - now_utc, now_local, today_local_date, weekday_local\n  - timezone, timezone_source(preference|assumed_default), timezone_assumed, assumption_disclosure\n  - optional anchors: last_training_date_local, days_since_last_training\n- Zeitberechnung ausschliesslich serverseitig (chrono/ZoneInfo), niemals aus LLM-Text.\n- AGENT_CONTEXT_CONTRACT_VERSION bump + passende Unit-Tests (Mitternacht/TZ-Grenzen).\n- Felder als stabile API-Schnittstelle dokumentieren.","acceptance_criteria":"1) /v1/agent/context Response enthaelt temporal_context mit oben genannten Pflichtfeldern. 2) days_since_last_training wird deterministisch berechnet (wenn last_training vorhanden). 3) Contract-Version und Tests sind aktualisiert.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:04:27.663647+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:29:52.942015+01:00","closed_at":"2026-02-15T11:29:52.942015+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2ut.2","depends_on_id":"kura-training-2ut","type":"parent-child","created_at":"2026-02-15T11:04:27.665943+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2ut.2","depends_on_id":"kura-training-2ut.1","type":"blocks","created_at":"2026-02-15T11:04:28.577595+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2ut.3","title":"Worker: readiness_inference auf timezone-first Day-Semantik harmonisieren","description":"Warum: readiness_inference gruppiert aktuell ueber timestamp.date() und kann dadurch von timezone-first Projektionen abweichen.\nWie: Tageszuordnung auf dieselbe timezone-first Normalisierung umstellen wie training_timeline/recovery, damit Cross-Dimension-Interpretationen konsistent sind.","design":"- In workers/src/kura_workers/handlers/readiness_inference.py:\n  - timezone_preference laden\n  - resolve_timezone_context nutzen\n  - local day ueber normalize_temporal_point/local_date bestimmen\n  - timezone_context in Projection ausgeben\n- Integrationstests fuer Day-Boundary und TZ-Unterschiede (z.B. America/Los_Angeles vs UTC).","acceptance_criteria":"1) readiness_inference nutzt keine rohe timestamp.date()-Gruppierung mehr. 2) Projection enthält timezone_context inkl. assumption disclosure. 3) Neue Tests decken TZ-Grenzfall ab.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:04:27.801877+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:29:53.07927+01:00","closed_at":"2026-02-15T11:29:53.07927+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2ut.3","depends_on_id":"kura-training-2ut","type":"parent-child","created_at":"2026-02-15T11:04:27.803475+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2ut.3","depends_on_id":"kura-training-2ut.1","type":"blocks","created_at":"2026-02-15T11:04:28.679246+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2ut.4","title":"Integration: CLI/MCP/Fred-Flow fuer frischen Turn-Context absichern","description":"Warum: Wenn Integrationen den Context nicht pro Turn abrufen oder wichtige Query-Parameter nicht durchreichen, ignoriert der Agent faktisch den Zeitanker.\nWie: CLI/MCP-Schnittstellen auf Agent-Context-Paritaet bringen und Integrationspfad fuer Fred so definieren, dass jeder Turn frischen Context nutzt.","design":"- CLI: context command parity zu API herstellen (mindestens strength_limit + task_intent; optional weitere relevante Parameter).\n- MCP runtime: kura_agent_context Tool-Input und Doku auf Temporal-Grounding-Flow abstimmen.\n- Integrationsregel dokumentieren: vor jeder zeitkritischen Antwort frischen /v1/agent/context Read nutzen.\n- Negative Tests fuer fehlende/alte Context-Nutzung im Adapter-Pfad.","acceptance_criteria":"1) CLI/MCP transportieren benoetigte Context-Parameter konsistent. 2) Integrationsdoku definiert 'context read per turn' als Pflicht. 3) Adapter-Tests schlagen bei veralteter Context-Nutzung fehl.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:04:27.932985+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:29:53.209568+01:00","closed_at":"2026-02-15T11:29:53.209568+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2ut.4","depends_on_id":"kura-training-2ut","type":"parent-child","created_at":"2026-02-15T11:04:27.935517+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2ut.4","depends_on_id":"kura-training-2ut.2","type":"blocks","created_at":"2026-02-15T11:04:28.783121+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2ut.5","title":"Policy: write-with-proof validiert frische temporal_basis bei zeitkritischen Writes","description":"Warum: Modelle koennen Zeitinfos ignorieren. Bei zeitkritischen writes braucht es deshalb einen serverseitig pruefbaren Nachweis der benutzten Zeitbasis.\nWie: write-with-proof/intent_handshake um temporal_basis erweitern und fuer definierte Eventklassen auf Frische + Konsistenz validieren.","design":"- AgentIntentHandshake um strukturierte temporal_basis erweitern (schema_version, context_generated_at, timezone, today_local_date, optional anchors).\n- Policy-Regeln: fuer zeitkritische plan/coaching writes temporal_basis erforderlich; stale/mismatch -\u003e policy_violation.\n- Fehlercodes + docs_hint analog bestehender Invariant-Fehler.\n- Runtime-Tests: akzeptiert frisch/passend, verwirft fehlend/stale/mismatch.","acceptance_criteria":"1) Zeitkritische Writes ohne temporal_basis werden klar abgelehnt. 2) stale/mismatch wird mit eigenem policy code + docs_hint signalisiert. 3) Runtime-Tests decken success + failure paths ab.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:04:28.064955+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:29:53.334006+01:00","closed_at":"2026-02-15T11:29:53.334006+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2ut.5","depends_on_id":"kura-training-2ut","type":"parent-child","created_at":"2026-02-15T11:04:28.067304+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2ut.5","depends_on_id":"kura-training-2ut.2","type":"blocks","created_at":"2026-02-15T11:04:28.883174+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2ut.5","depends_on_id":"kura-training-2ut.4","type":"blocks","created_at":"2026-02-15T11:04:28.989482+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2ut.6","title":"Observability: Temporal-Grounding-Adherence in Agent-Telemetrie","description":"Warum: Ohne Sichtbarkeit merkt man erst spaet, dass Agenten den Zeitvertrag nicht einhalten.\nWie: Agent-Telemetrie um Temporal-Grounding-Signale erweitern (z.B. stale context before write, assumed timezone usage), inkl. Anomalie-Schwellen.","design":"- Erweiterung in api/src/routes/agent_telemetry.rs:\n  - neue Metriken fuer temporal grounding adherence\n  - neue anomaly codes + recommendations\n- SQL Aggregationen und Response-Schema anpassen.\n- Test-Fixtures fuer anomaly detection und false-positive Kontrolle.","acceptance_criteria":"1) Overview/Anomalies enthalten Temporal-Grounding-Metriken. 2) Mindestens eine neue Temporal-Anomalie ist testabgedeckt. 3) Empfehlungen sind handlungsorientiert (kein generischer Text).","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:04:28.207216+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:29:53.457248+01:00","closed_at":"2026-02-15T11:29:53.457248+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2ut.6","depends_on_id":"kura-training-2ut","type":"parent-child","created_at":"2026-02-15T11:04:28.209396+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2ut.6","depends_on_id":"kura-training-2ut.5","type":"blocks","created_at":"2026-02-15T11:04:29.098692+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2ut.7","title":"Regression-Suite: natuerliche Zeitphrasen und Day-Delta-Korrektheit","description":"Warum: Reale Nutzer sprechen in natuerlicher Zeit-Sprache (heute, gestern, letzten Freitag) und genau dort treten Fehler auf.\nWie: Transcript-nahe Regressionen als reproduzierbarer Korpus in Tests aufnehmen, damit das Problem nach Refactors nicht zurueckkommt.","design":"- Goldens/Fixtures mit relativen Zeitphrasen + erwarteten absoluten Ableitungen.\n- Faelle: gleicher Tag, +5h Pause, Tageswechsel, Wochewechsel, Reise/TZ-Wechsel.\n- Assertions fokussieren auf deterministische Zeitbasis und korrekte day-delta Berechnung.","acceptance_criteria":"1) Korpus deckt mindestens 5 reale Zeitszenarien ab. 2) Tests validieren absolute Ableitung + Delta-Tage. 3) Ein transcript-naher Fall aus Fred-Dialog ist als Regression enthalten.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:04:28.340984+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:29:53.597599+01:00","closed_at":"2026-02-15T11:29:53.597599+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2ut.7","depends_on_id":"kura-training-2ut","type":"parent-child","created_at":"2026-02-15T11:04:28.343484+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2ut.7","depends_on_id":"kura-training-2ut.2","type":"blocks","created_at":"2026-02-15T11:04:29.205438+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2ut.7","depends_on_id":"kura-training-2ut.3","type":"blocks","created_at":"2026-02-15T11:04:29.310492+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2ut.7","depends_on_id":"kura-training-2ut.5","type":"blocks","created_at":"2026-02-15T11:04:29.414916+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2ut.8","title":"Runbook: Temporal-Grounding Integrations- und Betriebsleitfaden","description":"Warum: Nach Compaction gehen Chat-Hintergruende verloren; ein kompaktes Runbook sichert, dass neue Umsetzer das 'Warum' und die Betriebsregeln sofort verstehen.\nWie: Ein Integrations-Playbook beschreibt Entscheidungsgruende, Reihenfolge, Guardrails, Failure-Handling und Rollback fuer Temporal Grounding.","design":"- Runbook in Repo (z.B. docs/ oder ops/):\n  - Problem statement + failure modes\n  - Pflichtfluss pro Turn\n  - Metriken/Alerts + Eskalationspfad\n  - Rollout/Revert Schritte\n- Verlinkung auf alle relevanten Tests/Issues/Endpoints.","acceptance_criteria":"1) Runbook enthaelt Problem, Why, How, Failure modes, Rollback. 2) Verweist auf konkrete Tests/Endpoints/Beads. 3) Fuer neuen Umsetzer ohne Chat-Historie verstaendlich.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:04:28.476727+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:29:53.719332+01:00","closed_at":"2026-02-15T11:29:53.719332+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2ut.8","depends_on_id":"kura-training-2ut","type":"parent-child","created_at":"2026-02-15T11:04:28.478245+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2ut.8","depends_on_id":"kura-training-2ut.6","type":"blocks","created_at":"2026-02-15T11:04:29.52028+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2ut.8","depends_on_id":"kura-training-2ut.7","type":"blocks","created_at":"2026-02-15T11:04:29.623086+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2zc","title":"Continuous Learning Loop: Learn from all users without explicit reports","description":"Build a production learning loop so Kura learns from implicit user behavior and agent failures, not only from manual feedback. Problem: most users never report issues, and many failure modes are invisible unless instrumented. Goal: turn repeated runtime friction into prioritized engineering work automatically.","design":"Context: Decision 13 enables self-healing operations, but platform evolution still needs cross-user pattern learning. Implement privacy-aware telemetry -\u003e issue clustering -\u003e prioritized backlog generation -\u003e regression promotion. This closes the gap between observed field behavior and roadmap execution even when users do not actively contribute to product development.","acceptance_criteria":"1) Define telemetry taxonomy for quality/friction/outcome events. 2) Aggregate and cluster recurring issue signatures across users (pseudonymized). 3) Compute priority score from frequency x severity x outcome impact x reproducibility. 4) Produce a machine-readable weekly learning report and candidate issue list. 5) Define promotion path from recurring cluster -\u003e invariant/policy/test. 6) Document privacy boundaries and retention policy.","notes":"Session handoff 2026-02-13: Learning-loop foundation is complete (taxonomy, clustering, calibration, backlog bridge, unknown mining, shadow eval). Next-phase consumer is kura-training-wvp (model-aware runtime policy), which turns these signals into deterministic runtime autonomy gates.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:01:42.463218+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:55:29.605466+01:00","closed_at":"2026-02-13T09:55:29.605466+01:00","close_reason":"Foundation complete; handed off to model-aware runtime phase"}
{"id":"kura-training-2zc.1","title":"Learning Telemetry Taxonomy + Event Emission","description":"Implement a canonical telemetry schema for implicit learning signals. Problem: failures and friction are currently under-observed and hard to compare across users/sessions/agents. Build structured events for quality defects, user corrections, retries, retractions, and conversational friction.","design":"Create explicit event categories (quality_signal, friction_signal, outcome_signal, correction_signal). Include stable signature fields for clustering (issue_type, invariant_id, agent_version, workflow_phase, modality, confidence_band). Emit telemetry from relevant API/worker/agent touchpoints with pseudonymized user identifiers.","acceptance_criteria":"1) Telemetry schema versioned and documented. 2) At least 10 core signal types emitted with stable payload contracts. 3) Events include clustering keys and timestamps. 4) Pseudonymization enforced for cross-user aggregation. 5) Unit/integration tests verify emission and schema validity.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:02:20.077097+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:05:14.961708+01:00","closed_at":"2026-02-11T19:05:14.961708+01:00","close_reason":"Added canonical learning telemetry schema (v1), pseudonymized signal emission in quality health + save handshake, docs, and validation tests.","dependencies":[{"issue_id":"kura-training-2zc.1","depends_on_id":"kura-training-2zc","type":"parent-child","created_at":"2026-02-11T17:02:20.079603+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2zc.2","title":"Cross-user Issue Clustering + Priority Scoring","description":"Cluster recurring failures from telemetry and rank them automatically. Problem: teams miss systemic issues because incidents appear as isolated anecdotes. Build a clustering and scoring pipeline that produces actionable recurring-problem groups.","design":"Use stable issue signatures from telemetry. Cluster by invariant/failure type plus context facets (workflow phase, modality, agent model/version). Compute priority = frequency x severity x outcome-impact x reproducibility. Keep explainable scoring outputs for auditability.","acceptance_criteria":"1) Daily/weekly batch produces clustered issue groups with human-readable summaries. 2) Each cluster has score and factor breakdown. 3) Cluster output includes representative examples and affected workflow phases. 4) False-positive controls documented (minimum support, confidence thresholds). 5) Tests cover clustering determinism and score calculation.","notes":"Implemented artifacts\n- docs/design/033-cross-user-issue-clustering-and-priority-scoring.md (deterministic clustering/scoring model + controls)\n- migrations/20260226000001_learning_issue_clusters.sql\n  - new cross-user tables: learning_issue_clusters, learning_issue_cluster_runs\n  - indexes + grants for app_worker/app_writer\n- workers/src/kura_workers/issue_clustering.py\n  - deterministic clustering from learning.signal.logged by cluster_signature\n  - dual period outputs (day/week)\n  - explainable score factors: frequency * severity * impact * reproducibility\n  - false-positive controls (min support, min unique users, low-confidence filter)\n  - run telemetry persistence\n- workers/src/kura_workers/handlers/inference_nightly.py\n  - integrated issue-cluster refresh into nightly batch\n- workers/src/kura_workers/system_config.py\n  - added learning_clustering_v1 convention contract\n- workers/tests/test_issue_clustering.py (new deterministic + scoring unit coverage)\n- workers/tests/test_integration.py (nightly batch integration test for cluster refresh)\n- workers/tests/test_system_config.py (learning_clustering_v1 convention assertions)\n\nTests and exact commands\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- DB migration applied locally for integration gate:\n  - set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python - \u003c\u003c'PY' ... execute migrations/20260226000001_learning_issue_clusters.sql ... PY\n\nResidual risks / non-goals\n- V1 clustering is signature-based deterministic grouping only (no semantic merge across different signatures).\n- Score weights are heuristic defaults; calibration/threshold tuning is deferred to 2zc.5.\n- No automatic backlog ticket creation in this issue (handled by 2zc.3).\n\nFollow-up issues\n- kura-training-2zc.5 (confidence calibration + drift over clustering outputs)\n- kura-training-2zc.3 (cluster-to-backlog promotion bridge)\n- kura-training-2zc.6 (unknown-dimension mining integration)\n- kura-training-2zc.4 (shadow-eval gate using cluster deltas)\n\nRollback / disable path\n- Remove/disable refresh_issue_clusters(...) call in inference_nightly handler.\n- Keep tables inert (no writer path dependency) or revert migration if full rollback is required.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:02:38.073892+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T15:24:53.330128+01:00","closed_at":"2026-02-12T15:24:53.330128+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2zc.2","depends_on_id":"kura-training-2zc","type":"parent-child","created_at":"2026-02-11T17:02:38.07516+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.2","depends_on_id":"kura-training-2zc.1","type":"blocks","created_at":"2026-02-11T17:05:05.747185+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2zc.3","title":"Learning-to-Backlog Bridge + Regression Promotion","description":"Automatically convert recurring high-impact clusters into engineering artifacts. Problem: even detected patterns are lost if they are not operationalized into backlog items, invariants, and tests. Build a controlled bridge from clustered learnings to bd issues and regression assets.","design":"Define policy thresholds for auto-suggested issue creation. Generate candidate bd payloads with context, reproduction, and expected mitigation. Add promotion workflow: cluster -\u003e issue -\u003e invariant/policy/test update -\u003e shadow re-evaluation. Keep human approval gate for creation in initial rollout.","acceptance_criteria":"1) Pipeline outputs candidate bd issues in machine-readable form. 2) Candidates include root-cause hypothesis, impacted metrics, and suggested invariant/policy updates. 3) Promotion checklist documented and automated where possible. 4) At least one end-to-end demo from synthetic cluster to generated issue payload. 5) Guardrails prevent noisy/duplicate suggestions.","notes":"compact-safe:\n- artifacts: migrations/20260226000003_learning_backlog_bridge.sql; workers/src/kura_workers/learning_backlog_bridge.py; workers/src/kura_workers/handlers/inference_nightly.py; workers/src/kura_workers/system_config.py; workers/tests/test_learning_backlog_bridge.py; workers/tests/test_integration.py; workers/tests/test_system_config.py; docs/design/035-learning-to-backlog-bridge-and-regression-promotion-v1.md\n- tests:\n  1) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n  2) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n  3) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n  4) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- residual-risks/non-goals: v1 remains approval-gated and does not auto-create bd issues; candidate payload quality depends on upstream cluster/calibration signal quality and may still need human triage\n- follow-up-issues: kura-training-2zc.6 (use unknown-dimension mining signals as additional bridge source), kura-training-2zc.4 (consume promotion checklist + candidate priors in shadow eval gating)\n- rollback/disable: remove refresh_learning_backlog_candidates() from inference.nightly_refit and ignore learning_backlog_candidates outputs downstream","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:02:55.639134+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T15:48:59.804206+01:00","closed_at":"2026-02-12T15:48:59.804206+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2zc.3","depends_on_id":"kura-training-2zc","type":"parent-child","created_at":"2026-02-11T17:02:55.64011+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.3","depends_on_id":"kura-training-2zc.2","type":"blocks","created_at":"2026-02-11T17:05:16.031982+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2zc.4","title":"Shadow Evaluation for Policy/Agent Changes","description":"Run replay/shadow evaluations on historical sessions before broad rollout of new policies or agent behavior. Problem: fixes can regress unseen scenarios if not evaluated against diverse conversation histories. Build repeatable shadow runs with before/after metrics.","design":"Define representative replay corpus from pseudonymized traces and synthetic stress cases. Compare baseline vs candidate on quality and friction metrics. Gate rollouts on explicit pass criteria.","acceptance_criteria":"1) Shadow harness can run baseline and candidate configs side-by-side. 2) Report includes deltas for key quality metrics and failure classes. 3) Release gate criteria defined and enforced for selected changes. 4) One sample evaluation report committed/documented.","notes":"compact-safe completion notes\n\nimplemented artifacts\n- workers/src/kura_workers/eval_harness.py: added baseline-vs-candidate shadow execution, metric/source aggregation, delta evaluation, and release-gate report builder (`run_shadow_evaluation`, `build_shadow_evaluation_report`, deterministic pseudonymization helper)\n- workers/src/kura_workers/eval_cli.py: added `--shadow` mode + candidate override flags and dispatch to shadow harness\n- workers/src/kura_workers/system_config.py: added `shadow_evaluation_gate_v1` conventions (rules, entrypoint, inputs, delta thresholds, report sections)\n- workers/tests/test_eval_harness.py: added shadow delta/gate tests and combined-source reporting assertions\n- workers/tests/test_integration.py: added end-to-end shadow comparison integration test\n- workers/tests/test_system_config.py: validated new shadow-evaluation convention contract\n- docs/design/037-shadow-evaluation-release-gate-v1.md: design contract + rollout policy\n- docs/reports/shadow-eval-sample-report.json: committed sample output for downstream consumers\n\nvalidation commands (exact)\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nresidual risks / non-goals\n- non-goal: auto-promoting candidate configs from report output; this remains a separate release decision\n- residual risk: metric quality depends on representativeness of replay corpus and pseudonymized source labels\n- residual risk: defaults focus on evaluator metrics; teams may still tune thresholds for domain-specific rollout gates\n\nfollow-up issues\n- none required for AC scope; optional future work is corpus expansion + richer evaluator metrics\n\nrollback / disable path\n- CLI runtime rollback: stop using `--shadow` and continue with baseline single-run harness path\n- config rollback: remove/disable `shadow_evaluation_gate_v1` usage in policy rollout process\n- code rollback: revert eval-harness shadow functions and CLI flags in a single commit if needed","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:03:12.797507+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T16:07:50.606131+01:00","closed_at":"2026-02-12T16:07:50.606131+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2zc.4","depends_on_id":"kura-training-2zc","type":"parent-child","created_at":"2026-02-11T17:03:12.798457+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.4","depends_on_id":"kura-training-2zc.2","type":"blocks","created_at":"2026-02-11T17:05:26.316853+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2zc.5","title":"Extraction Calibration Pipeline: confidence scoring and drift monitoring","description":"Measure and continuously calibrate extraction quality for free-text-derived claims across users. Problem: confidence values are currently not closed-loop against observed correctness, so auto-repair risk can drift silently. Outcome: calibrated confidence and drift alarms for extraction/audit modules.","design":"Build evaluation dataset generation from resolved clarifications and correction outcomes. Compute calibration metrics (Brier score, reliability curves), precision/recall per dimension, and drift by model/parser version. Feed quality health with calibration status to gate auto-repair aggressiveness.","acceptance_criteria":"1) Calibration metrics computed per claim class/dimension. 2) Drift detection alerts when calibration degrades beyond threshold. 3) Quality-health policy can throttle/enable auto-repair based on calibration status. 4) Weekly report includes top underperforming extraction classes. 5) Tests validate metric computations deterministically.","notes":"compact-safe:\n- artifacts: migrations/20260226000002_extraction_calibration_metrics.sql; workers/src/kura_workers/extraction_calibration.py; workers/src/kura_workers/handlers/inference_nightly.py; workers/src/kura_workers/handlers/quality_health.py; workers/src/kura_workers/system_config.py; workers/tests/test_extraction_calibration.py; workers/tests/test_quality_health.py; workers/tests/test_system_config.py; workers/tests/test_integration.py; docs/design/034-extraction-calibration-and-drift-pipeline-v1.md; api/src/routes/agent.rs\n- tests:\n  1) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n  2) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n  3) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n  4) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- residual-risks/non-goals: v1 calibration labels are derived deterministically from correction/retraction signals only; no probabilistic relabeling and no per-user adaptive thresholds yet\n- follow-up-issues: kura-training-2zc.3 (backlog bridge consumes underperforming classes), kura-training-2zc.6 (unknown-dimension loop can reuse calibration confidence bands), kura-training-2zc.4 (shadow-eval should monitor calibration deltas pre/post policy changes)\n- rollback/disable: remove refresh_extraction_calibration() call from nightly inference handler and ignore calibration_status in autonomy policy gate to restore previous behavior","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T13:37:39.122993+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T15:40:17.692259+01:00","closed_at":"2026-02-12T15:40:17.692259+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2zc.5","depends_on_id":"kura-training-2zc.2","type":"blocks","created_at":"2026-02-12T13:37:39.126657+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.5","depends_on_id":"kura-training-pdc.19","type":"blocks","created_at":"2026-02-12T13:37:39.127506+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.5","depends_on_id":"kura-training-pdc.20","type":"blocks","created_at":"2026-02-12T13:37:39.12836+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.5","depends_on_id":"kura-training-2zc","type":"parent-child","created_at":"2026-02-12T13:40:11.427353+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2zc.6","title":"Unknown-Dimension Mining + Suggestion Loop","description":"Mine recurring high-value unknown observations from transcripts and propose new dimensions/contracts. Problem: we cannot predefine all user inputs; unknowns must become a managed discovery stream. Outcome: ranked suggestions for new dimensions with evidence and estimated product impact.","design":"Aggregate unresolved/unknown observation patterns, cluster by semantic similarity + workflow context, and generate candidate dimension proposals (name, type, expected unit/scale, sample utterances, risk notes). Route accepted proposals into backlog generation bridge with duplicate controls.","acceptance_criteria":"1) Pipeline surfaces ranked unknown-dimension candidates with evidence bundles. 2) Candidate proposals include suggested schema and confidence. 3) Integration with learning-to-backlog bridge prevents duplicate noisy tickets. 4) Human approval workflow documented. 5) At least one end-to-end demo from unknown cluster to accepted dimension.","notes":"compact-safe:\n- artifacts: migrations/20260226000004_unknown_dimension_mining.sql; workers/src/kura_workers/unknown_dimension_mining.py; workers/src/kura_workers/learning_backlog_bridge.py; workers/src/kura_workers/handlers/inference_nightly.py; workers/src/kura_workers/system_config.py; workers/tests/test_unknown_dimension_mining.py; workers/tests/test_learning_backlog_bridge.py; workers/tests/test_integration.py; workers/tests/test_system_config.py; docs/design/036-unknown-dimension-mining-and-suggestion-loop-v1.md\n- tests:\n  1) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n  2) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n  3) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n  4) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- residual-risks/non-goals: clustering is deterministic lexical+scope mining (no embedding model in v1); accepted-proposal promotion still requires explicit human status transition and no automatic schema mutation is performed\n- follow-up-issues: kura-training-2zc.4 (shadow-eval should compare unknown-dimension promotion effects before rollout)\n- rollback/disable: remove refresh_unknown_dimension_proposals() from nightly handler and stop routing accepted unknown proposals into learning_backlog_candidates (source_type=unknown_dimension)","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T13:37:44.353866+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T15:58:17.815522+01:00","closed_at":"2026-02-12T15:58:17.815522+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2zc.6","depends_on_id":"kura-training-2zc.2","type":"blocks","created_at":"2026-02-12T13:37:44.357032+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.6","depends_on_id":"kura-training-2zc.3","type":"blocks","created_at":"2026-02-12T13:37:44.357829+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.6","depends_on_id":"kura-training-pdc.21","type":"blocks","created_at":"2026-02-12T13:37:44.358645+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.6","depends_on_id":"kura-training-2zc","type":"parent-child","created_at":"2026-02-12T13:40:16.628972+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316","title":"Unified Training Core Model v1 (Kraft + Ausdauer + Sprint + Plyo)","description":"Warum:\nDas aktuelle Modell ist fuer Kraft stark, aber fuer hybride Athleten (Kraft + Ausdauer + Sprint + Plyo) noch nicht semantisch einheitlich genug. Ohne gemeinsames Kernmodell entstehen Sonderfaelle, unklare Analysen und falsche Rueckfragen (z. B. HR-Zwang bei Kraft).\n\nWie:\nWir bauen ein sportartenuebergreifendes Session/Block-Modell mit block-spezifischen Pflichtfeldern, gestufter Vollstaendigkeit und klarer Provenance. Umsetzung erfolgt als issue chain: Spezifikation -\u003e executable specs -\u003e Implementierung -\u003e Migration -\u003e Rollout.\n\nErfolgskriterien:\nEine gemischte Session (z. B. Kraft + Intervalle + Plyo) kann in einem Modell gespeichert und analysiert werden. Fehlende Daten werden als not_measured/not_applicable behandelt, nicht als harter Validierungsfehler.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:23.648871+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T16:07:40.984452+01:00","closed_at":"2026-02-15T16:07:40.984452+01:00","close_reason":"All sub-tasks complete, epic formally closed","labels":["architecture","domain-model","training"],"comments":[{"id":7,"issue_id":"kura-training-316","author":"jonzim-cmd","text":"Kontextanker fuer Session-Recovery:\n- Ziel ist EIN Kernmodell fuer Kraft, Ausdauer, Sprint, Plyo und Hybrid-Sessions (kein Nebenmodell fuer Ausdauer).\n- Modellprinzip: block-spezifische Pflichtfelder statt globaler Pflichtfelder.\n- Harte Regel: Keine globale HR-Pflicht. Fehlende Sensorik -\u003e measurement_state = not_measured/not_applicable.\n- Vollstaendigkeitsstufen: log_valid, analysis_basic, analysis_advanced.\n- Intensitaet: mindestens ein Anchor pro leistungsrelevantem Block (z. B. pace, power, HR, Borg/RPE, %Referenz).\n- Bot-Rueckfragen: nur fehlende Pflichtdaten des erkannten Blocktyps.\n- Analyse: modality-spezifisch + vereinheitlichte Gesamtlast mit Confidence.\n\nRecovery-Start fuer neue Session:\n1) scripts/bd-safe.sh prime\n2) scripts/bd-safe.sh show kura-training-316\n3) scripts/bd-safe.sh show kura-training-316.1\n4) Danach Umsetzung strikt entlang Dependency-Chain.","created_at":"2026-02-14T09:24:03Z"}]}
{"id":"kura-training-316.1","title":"Spec: session.logged v1 + Block-Taxonomie + Pflichtlogik","description":"Warum:\nVor Code braucht es eine eindeutige Domain-Spezifikation, sonst entstehen inkonsistente Feldnutzung und fragile Sonderregeln.\n\nWie:\nDefiniere `session.logged v1` mit `blocks[]` und den Kernbausteinen: session_meta, block_type, dose(work/recovery/repeats), intensity_anchors, metrics, capability_target, subjective_response, measurement_state, provenance. Lege block families fest (strength, sprint, interval, continuous, plyo, circuit, technique, recovery) inkl. Minimalanforderungen je Blocktyp.\n\nDeliverables:\n1) Kanonische Feldliste + Typen\n2) Pflicht/optional je Blocktyp\n3) Beispiele fuer Kraft, Intervall, Sprint, Plyo, Hybrid-Session\n4) Regel: keine globale HR-Pflicht","acceptance_criteria":"Kernschema, Blocktypen, Pflicht/Optional-Regeln und Beispiele sind eindeutig dokumentiert.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:23.794372+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:23:30.733311+01:00","closed_at":"2026-02-14T11:23:30.733311+01:00","close_reason":"Closed","labels":["architecture","spec"],"dependencies":[{"issue_id":"kura-training-316.1","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:23.796209+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":8,"issue_id":"kura-training-316.1","author":"jonzim-cmd","text":"Spec-Zusammenfassung (session.logged v1): Das Kernmodell ist block-basiert und modality-neutral mit session_meta + blocks[] als Pflicht. Jeder Block hat dose (work/recovery/repeats), intensity_anchors, optionale metrics/subjective_response und provenance. Fuer Performance-Bloecke gilt: mindestens ein Intensitaetsanker oder explizit intensity_anchors_status=not_applicable. Es gibt keine globale HR-Pflicht; fehlende Sensorik wird ueber measurement_state (not_measured/not_applicable) explizit modelliert.","created_at":"2026-02-14T10:23:30Z"}]}
{"id":"kura-training-316.10","title":"Structured Error Taxonomy v1 fuer session.logged Completeness","description":"Warum:\nDie Missing-Anchor-Erkennung darf nicht von Fehlermeldungstexten abhängen, sonst brechen Monitoring und QA bei harmlosen Textänderungen.\n\nWie:\nDefiniere eine strukturierte Fehler-Taxonomie v1 für session.logged Completeness mit stabilen error_code-Werten, block_scope und field_path.\n\nImplementierungsplan (deterministisch):\n1) Error-Code-Katalog und Return-Contract in training_session_completeness festlegen.\n2) Mapping von ValidationError -\u003e strukturierte Fehlerobjekte ohne String-Parsing.\n3) Architecture-Test + Unit-Tests für stabile Codes bei Missing-Anchor/Measurement-State-Verletzungen.\n4) System-Convention ergänzen (öffentliches Contract-Surface für Agent/Monitoring).\n\nAkzeptanz:\n- evaluate_session_completeness liefert strukturierte Fehler mit stabilem error_code.\n- Missing-Anchor ist über error_code eindeutig identifizierbar.\n- Keine produktive Abhängigkeit mehr von frei formulierten Fehltexten.\n","acceptance_criteria":"Completeness-Fehler sind code-basiert, stabil und block-spezifisch auswertbar.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:57.427769+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:51:50.449941+01:00","closed_at":"2026-02-14T12:51:50.449941+01:00","close_reason":"Closed","labels":["contract","validation"],"dependencies":[{"issue_id":"kura-training-316.10","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:57.429635+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.11","title":"Quality Health auf strukturierte Completeness-Codes umstellen","description":"Warum:\nQuality Health muss robuste Signale liefern; textbasierte Klassifikation erzeugt False-Negatives bei Refactors.\n\nWie:\nStelle quality_health vollständig auf strukturierte Completeness-Codes um und härte Missing-Anchor-/Parse-Metriken.\n\nImplementierungsplan (deterministisch):\n1) INV-010 auf error_code-basierte Auswertung umstellen.\n2) Metriken harmonisieren: session_missing_anchor_total/rate, parse_fail_rate, confidence_distribution.\n3) Regressionstests für alte und neue Fehlerpfade (inkl. sparse user).\n4) Shadow-Monitoring-Contract in Architekturtests absichern.\n\nAkzeptanz:\n- quality_health nutzt keine Fehltextsuche mehr für Missing-Anchor.\n- Monitoring-Metriken bleiben bei Text-/Lokalisierungsänderungen stabil.\n- Architekturtest erzwingt code-basierten Pfad.\n","acceptance_criteria":"Missing-Anchor-/Parse-Monitoring laeuft robust ueber error_codes statt Fehltexte.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:57.567331+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:51:50.583734+01:00","closed_at":"2026-02-14T12:51:50.583734+01:00","close_reason":"Closed","labels":["observability","quality"],"dependencies":[{"issue_id":"kura-training-316.11","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:57.569278+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.11","depends_on_id":"kura-training-316.10","type":"blocks","created_at":"2026-02-14T12:19:58.361499+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.12","title":"Calibration Protocol v1 fuer training_load_v2 festlegen","description":"Warum:\nDie aktuelle Load/Confidence-Heuristik ist brauchbar, aber nicht empirisch kalibriert; damit fehlt belastbare Interpretierbarkeit.\n\nWie:\nSpezifiziere ein Calibration-Protocol v1 für training_load_v2 (Datenbasis, Zielmetriken, Tuning-Grenzen, Versionierung der Parameter).\n\nImplementierungsplan (deterministisch):\n1) Definiere Calibration-Inputs (repräsentative Kohorten + Label-Proxy).\n2) Definiere Zielmetriken (Brier/Calibration-Error/Ranking-Stabilität) und Akzeptanzschwellen.\n3) Parameter-Registry mit schema_version für reproduzierbare Tuning-Läufe.\n4) Architecture-Tests für Mindestinvarianten (keine globale HR-Pflicht, monotone Sensor-Verbesserung).\n\nAkzeptanz:\n- Kalibrierungsprotokoll ist als Contract und Tests codifiziert.\n- Tuning-Läufe sind reproduzierbar und versioniert.\n","acceptance_criteria":"Kalibrierungsprotokoll inkl. Metriken, Parameter-Versionierung und Invarianten ist testbar codifiziert.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:57.708807+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:51:50.71127+01:00","closed_at":"2026-02-14T12:51:50.71127+01:00","close_reason":"Closed","labels":["analytics","calibration"],"dependencies":[{"issue_id":"kura-training-316.12","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:57.710396+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.13","title":"training_load_v2 datengetrieben kalibrieren und versionieren","description":"Warum:\nOhne praktische Kalibrierung bleibt das Protokoll Theorie und die Confidence-Werte potenziell fehlskaliert.\n\nWie:\nImplementiere datengetriebene Kalibrierung für training_load_v2 mit versionierten Parametern und sicherem Rollout.\n\nImplementierungsplan (deterministisch):\n1) Calibration-Runner implementieren (offline replay / deterministic seeds).\n2) Optimierte Parameter in versionierte Registry schreiben und im Runtime-Pfad laden.\n3) A/B-Shadow-Vergleich alt vs. kalibriert mit Guardrails.\n4) Fallback auf vorige Parameter-Version via Feature-Flag.\n\nAkzeptanz:\n- training_load_v2 nutzt versionierte, kalibrierte Parameter.\n- Rollback auf vorherige Parameter ist ohne Schemaänderung möglich.\n- Vergleichsreport zeigt verbesserte Kalibrierungsmetriken.\n","acceptance_criteria":"Kalibrierte Parameter sind produktiv nutzbar, versioniert und rollback-faehig.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:57.845208+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:51:50.841049+01:00","closed_at":"2026-02-14T12:51:50.841049+01:00","close_reason":"Closed","labels":["analytics","calibration"],"dependencies":[{"issue_id":"kura-training-316.13","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:57.84761+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.13","depends_on_id":"kura-training-316.12","type":"blocks","created_at":"2026-02-14T12:19:58.462292+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.14","title":"Import-Mapping v2 Spezifikation auf Modalitaeten vertiefen","description":"Warum:\nImport-Mapping v2 ist aktuell Grundgerüst; vor breiter Nutzung fehlt sportartspezifische Abdeckung und Präzision.\n\nWie:\nErweitere die Mapping-Spezifikation auf Sport-/Modalitätsprofile (Kraft, Running, Cycling, Hybrid) mit Provider/Format-Matrix und Measurement-State-Regeln.\n\nImplementierungsplan (deterministisch):\n1) Feldkatalog je Modalität definieren (core vs optional vs provider-spezifisch).\n2) Matrix je Provider/Format auf supported/partial/not_available aktualisieren.\n3) Mapping-Regeln auf Blocktypen + intensity anchors + provenance-Confidence konkretisieren.\n4) Architekturtests auf \"keine provider-spezifischen Pflichtfelder\" und Blockmodell-Kompatibilität erweitern.\n\nAkzeptanz:\n- Matrix deckt die Zielmodalitäten explizit ab.\n- Core-Contract bleibt provider-agnostisch.\n- Regeln sind testbar und versioniert.\n","acceptance_criteria":"Provider/Format-Matrix deckt Running/Cycling/Strength/Hybrid explizit und provider-agnostisch ab.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:57.984652+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:51:50.963224+01:00","closed_at":"2026-02-14T12:51:50.963224+01:00","close_reason":"Closed","labels":["contract","imports"],"dependencies":[{"issue_id":"kura-training-316.14","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:57.986847+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.15","title":"Import-Mapping v2 Ausbau implementieren inkl. Golden-Fixtures","description":"Warum:\nSpezifikation ohne Implementierung schützt nicht vor realen Import-Regressionen.\n\nWie:\nSetze die erweiterte Import-Mapping-v2-Spezifikation um, inkl. Golden-Fixtures und End-to-End-Contract-Checks.\n\nImplementierungsplan (deterministisch):\n1) Mapper je Provider/Format gemäß 316.14 erweitern.\n2) Golden-Fixtures pro Modalität (running/cycling/strength/hybrid) hinzufügen.\n3) Contract- und Integrationstests auf block_type/intensity_anchors/measurement_state/provenance erweitern.\n4) Fehlerklassifikation vereinheitlichen (parse/mapping/validation) für Monitoring.\n\nAkzeptanz:\n- Imports erzeugen konsistente session.logged-kompatible Blöcke über Zielmodalitäten.\n- Golden-Fixtures schützen gegen Mapping-Regressionen.\n- Monitoring kann Fehlertypen stabil unterscheiden.\n","acceptance_criteria":"Erweiterte Mapping-Regeln laufen stabil durch Golden-Fixtures und E2E-Tests.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:58.120275+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:51:51.084457+01:00","closed_at":"2026-02-14T12:51:51.084457+01:00","close_reason":"Closed","labels":["implementation","imports"],"dependencies":[{"issue_id":"kura-training-316.15","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:58.12186+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.15","depends_on_id":"kura-training-316.14","type":"blocks","created_at":"2026-02-14T12:19:58.56398+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.16","title":"Hardening Gate fuer 316.10-316.15","description":"Warum:\nDie drei Follow-up-Stränge müssen als gemeinsamer Hardening-Release abgesichert werden, sonst entstehen Teiloptimierungen ohne belastbaren Rollout.\n\nWie:\nBaue einen gemeinsamen Rollout-Gate-Task für 316.10-316.15 (QA-Matrix, Shadow-Ergebnisse, Flag-Plan, Exit-Kriterien).\n\nImplementierungsplan (deterministisch):\n1) Gate-Checklist als executable spec (Pflichtmetriken + Schwellen).\n2) Freigabe nur bei grünem Status für Error-Codes, Calibration und Import-Mapping.\n3) Rollback-Runbook (Flags/Parameter-Versionen) verifizieren.\n4) Abschlussbericht mit absoluten Metriken und Rest-Risiken.\n\nAkzeptanz:\n- Ein einzelner Gate-Status entscheidet über produktiven Ramp-up.\n- Rollback ist getestet und dokumentiert.\n- Rest-Risiken und next actions sind explizit erfasst.\n","acceptance_criteria":"Gemeinsamer Rollout-Gate mit klaren Exit-Kriterien und getestetem Rollback liegt vor.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:58.259629+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:51:51.208247+01:00","closed_at":"2026-02-14T12:51:51.208247+01:00","close_reason":"Closed","labels":["qa","rollout"],"dependencies":[{"issue_id":"kura-training-316.16","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:58.261392+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.16","depends_on_id":"kura-training-316.11","type":"blocks","created_at":"2026-02-14T12:19:58.664844+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.16","depends_on_id":"kura-training-316.13","type":"blocks","created_at":"2026-02-14T12:19:58.765036+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.16","depends_on_id":"kura-training-316.15","type":"blocks","created_at":"2026-02-14T12:19:58.868082+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.2","title":"Executable Architecture Specs fuer Kerninvarianten","description":"Warum:\nArchitekturentscheidungen sollen dauerhaft durch CI erzwungen werden, nicht durch vergessene Doku.\n\nWie:\nUebersetze die Invarianten aus der Spezifikation in `tests/architecture/`.\n\nAkzeptanz:\n- Test: Keine globale Pflicht fuer HR/Power/GPS.\n- Test: Jeder leistungsrelevante Block braucht mind. einen Intensitaetsanker (oder explizit not_applicable).\n- Test: `measurement_state` ist verpflichtend fuer optionale Messgroessen.\n- Test: Gemischte Sessions mit mehreren Blocktypen sind gueltig.","acceptance_criteria":"Invarianten werden in tests/architecture/ per CI erzwungen.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:23.926558+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:23:31.061898+01:00","closed_at":"2026-02-14T11:23:31.061898+01:00","close_reason":"Closed","labels":["architecture","tests"],"dependencies":[{"issue_id":"kura-training-316.2","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:23.928531+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.2","depends_on_id":"kura-training-316.1","type":"blocks","created_at":"2026-02-14T10:20:24.96704+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":9,"issue_id":"kura-training-316.2","author":"jonzim-cmd","text":"Architecture-Contracts umgesetzt in tests/architecture/test_93_unified_training_session_contract.py inkl. Runtime-Guards auf Rust-Tests. Abgedeckt: keine globale HR-Pflicht, Anchor-Regel fuer Performance-Bloecke, measurement_state-Pflicht fuer Metrics, Hybrid-Session-Validitaet.","created_at":"2026-02-14T10:23:30Z"}]}
{"id":"kura-training-316.3","title":"Implementiere Event-Contract + Persistenz fuer session.logged v1","description":"Warum:\nOhne persistentes Zielschema bleibt das Modell nur Theorie und kann nicht stabil weiterentwickelt werden.\n\nWie:\nImplementiere Event-Contract und Persistenz fuer `session.logged v1` (inkl. blocks[]), plus Provenance-Felder (manual/imported/inferred/corrected). Halte Rueckwaertskompatibilitaet fuer bestehende Logs sicher.\n\nAkzeptanz:\n- Session mit mehreren Blocktypen kann geschrieben und gelesen werden.\n- Contract-Validierung greift serverseitig.\n- Datenverlustfreie Speicherung der Intensitaetsanker und measurement_state.","acceptance_criteria":"Session-Blocks werden robust gespeichert/gelesen, inkl. Provenance und measurement_state.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.057225+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:35:54.748673+01:00","closed_at":"2026-02-14T11:35:54.748673+01:00","close_reason":"Closed","labels":["backend","events","persistence"],"dependencies":[{"issue_id":"kura-training-316.3","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.05869+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.3","depends_on_id":"kura-training-316.2","type":"blocks","created_at":"2026-02-14T10:20:25.069401+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":10,"issue_id":"kura-training-316.3","author":"jonzim-cmd","text":"Umsetzung gestartet: Event-Contract fuer session.logged v1 ist in API-Validierung aktiv (inkl. block_type, dose/work, intensity anchor policy, metrics measurement_state, contract_version). Event-Conventions + system config wurden erweitert (training_session_block_model_v1), inklusive Agent-Redaction-Whitelist. user_profile handler verarbeitet session.logged bereits grundlegend; naechster Schritt in 316.3 ist Persistenz-/Read-Path-Vertiefung fuer weitere Projektionen.","created_at":"2026-02-14T10:23:37Z"},{"id":11,"issue_id":"kura-training-316.3","author":"jonzim-cmd","text":"Implementierung erweitert: session.logged ist jetzt end-to-end im Contract + Read-Pfad verankert. Neben API-Validierung wurde die Projection-Routing-Logik ergänzt (training_timeline + session_feedback), inklusive session block expansion (repeat-level) fuer set-orientierte Aggregationen. user_profile/quality_health reagieren auf session.logged. Akzeptanz erfuellt: gemischte Sessions werden gespeichert, gelesen und in zentrale Projektionen uebernommen.","created_at":"2026-02-14T10:35:54Z"}]}
{"id":"kura-training-316.4","title":"Vollstaendigkeitsstufen und block-spezifische Validierung","description":"Warum:\nDas Hauptdilemma ist \"vollstaendig loggen\" ohne Nutzer mit unmoeglichen Pflichten zu blockieren.\n\nWie:\nBaue einen Vollstaendigkeits- und Validierungsdienst mit Stufen:\n- log_valid\n- analysis_basic\n- analysis_advanced\nRegeln sind block-spezifisch statt global.\n\nAkzeptanz:\n- Kraft-Set ohne HR ist log_valid, sofern Block-Pflichtfelder vorhanden sind.\n- Intervall (z. B. 8x2'/1' + pace oder Borg) ist ohne HR gueltig.\n- Fehlende optionale Daten werden als not_measured/not_applicable markiert.","acceptance_criteria":"log_valid/analysis_basic/analysis_advanced funktionieren ohne globale HR-Pflicht.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.189557+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:35:55.160351+01:00","closed_at":"2026-02-14T11:35:55.160351+01:00","close_reason":"Closed","labels":["domain-model","validation"],"dependencies":[{"issue_id":"kura-training-316.4","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.19092+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.4","depends_on_id":"kura-training-316.3","type":"blocks","created_at":"2026-02-14T10:20:25.167975+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":12,"issue_id":"kura-training-316.4","author":"jonzim-cmd","text":"Vollstaendigkeitsstufen umgesetzt: workers/src/kura_workers/training_session_completeness.py liefert log_valid / analysis_basic / analysis_advanced inkl. Confidence. Regeln sind block-spezifisch, ohne globale HR-Pflicht. Tests decken Kraft ohne HR, Intervall mit Pace/Borg ohne HR und explicit not_measured/not_applicable ab (workers + tests/architecture).","created_at":"2026-02-14T10:35:55Z"}]}
{"id":"kura-training-316.5","title":"Bot-Parser und Rueckfragenstrategie auf Blockmodell umstellen","description":"Warum:\nDer Bot ist die zentrale Eingabeoberflaeche; falsche Rueckfragen zerstoeren Vertrauen und Datenqualitaet.\n\nWie:\nPasse Parsing und Nachfragen an das neue Modell an. Der Bot identifiziert zuerst Blocktypen und fragt nur fehlende Pflichtfelder dieses Blocktyps nach.\n\nAkzeptanz:\n- Bei Kraft-Logs keine HR-Zwangsfrage.\n- Bei Intervallen werden nur fehlende Strukturdaten/Anker nachgefragt.\n- Rueckfragen sind priorisiert und minimal (nur was fuer log_valid fehlt).","acceptance_criteria":"Bot fragt nur blockrelevante Pflichtdaten nach und erzwingt keine irrelevanten Metriken.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.323899+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:49:28.192818+01:00","closed_at":"2026-02-14T11:49:28.192818+01:00","close_reason":"Closed","labels":["bot","logging","ux"],"dependencies":[{"issue_id":"kura-training-316.5","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.325822+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.5","depends_on_id":"kura-training-316.4","type":"blocks","created_at":"2026-02-14T10:20:25.266945+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":13,"issue_id":"kura-training-316.5","author":"jonzim-cmd","text":"Implemented block-relevant session.logged clarification strategy in agent session audit. Added session.logged gap detection for block-required fields (dose.work + intensity anchor policy), clarification prompts for missing fields, and explicit no-HR-coercion anchor messaging (anchors can be pace/power/Borg/RPE/%reference/HR or not_applicable). Added runtime tests in routes::agent::tests and architecture contract test test_95_block_relevant_clarification_contract.py. Full quality gates passed: ruff, workers unit, workers integration, cargo test --workspace.","created_at":"2026-02-14T10:49:28Z"}]}
{"id":"kura-training-316.6","title":"Projection v2: modality-spezifisch + globale Last mit Confidence","description":"Warum:\nEin einheitliches Datenmodell braucht auch ein einheitliches Analysemodell, sonst bleibt die Plattform fachlich fragmentiert.\n\nWie:\nImplementiere Projection v2 mit zwei Ebenen:\n1) modality-spezifische Last/Qualitaet (Kraft, Sprint, Endurance, Plyo)\n2) vereinheitlichte Gesamtlast mit Confidence anhand verfuegbarer Daten\n\nAkzeptanz:\n- Fehlende Sensorik reduziert Confidence statt Session-Invalidierung.\n- Basisanalyse funktioniert mit manual-only Daten.\n- Zusatzzsensorik (HR/Power/GPS) verbessert Analysegrad ohne Schemawechsel.","acceptance_criteria":"Analysen laufen mit Sparse-Daten und skalieren mit Sensorqualitaet.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.463189+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:09:46.067341+01:00","closed_at":"2026-02-14T12:09:46.067341+01:00","close_reason":"Closed","labels":["analytics","projections"],"dependencies":[{"issue_id":"kura-training-316.6","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.465475+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.6","depends_on_id":"kura-training-316.4","type":"blocks","created_at":"2026-02-14T10:20:25.367038+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.7","title":"Legacy-Kompatibilitaet und Migrationspfad (set.logged \u003c-\u003e session.logged)","description":"Warum:\nBestehende Daten und Features duerfen beim Umbau nicht brechen.\n\nWie:\nErstelle Kompatibilitaetsadapter zwischen `set.logged` und `session.logged v1`, inkl. Replay-/Backfill-Strategie fuer bestehende Historie.\n\nAkzeptanz:\n- Alte Kraftdaten bleiben in Timelines/Insights konsistent.\n- Neue Sessions koennen parallel mit Legacy-Views koexistieren.\n- Migrationsweg ist idempotent und testbar.","acceptance_criteria":"Migration ist idempotent und bricht bestehende Views nicht.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.596121+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:09:46.063642+01:00","closed_at":"2026-02-14T12:09:46.063642+01:00","close_reason":"Closed","labels":["compatibility","migration"],"dependencies":[{"issue_id":"kura-training-316.7","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.598369+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.7","depends_on_id":"kura-training-316.3","type":"blocks","created_at":"2026-02-14T10:20:25.466143+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.7","depends_on_id":"kura-training-316.4","type":"blocks","created_at":"2026-02-14T10:24:11.711437+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.8","title":"QA-Matrix, Feature-Flag-Rollout und Monitoring","description":"Warum:\nBei tiefen Modellumbauten entstehen Risiken erst in realen Nutzungsprofilen.\n\nWie:\nDefiniere QA-Matrix (Kraft, Sprint, Endurance, Hybrid, Low-Data-User), Feature-Flag-Rollout, Shadow-Mode-Vergleich und Monitoring fuer Validierungs-/Parser-Fehler.\n\nAkzeptanz:\n- Vergleich Alt-vs-Neu fuer repraesentative Sessions dokumentiert.\n- Rollback/Disable-Pfad ueber Feature-Flag vorhanden.\n- Monitoring zeigt Parse-Fail-Rate, Missing-Anchor-Rate, Confidence-Verteilung.","acceptance_criteria":"Risiken sind ueber Shadow-Mode und Metriken kontrolliert.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.730174+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:09:46.105522+01:00","closed_at":"2026-02-14T12:09:46.105522+01:00","close_reason":"Closed","labels":["observability","qa","rollout"],"dependencies":[{"issue_id":"kura-training-316.8","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.732319+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.8","depends_on_id":"kura-training-316.5","type":"blocks","created_at":"2026-02-14T10:20:25.568389+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.8","depends_on_id":"kura-training-316.6","type":"blocks","created_at":"2026-02-14T10:20:25.675639+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.8","depends_on_id":"kura-training-316.7","type":"blocks","created_at":"2026-02-14T10:20:25.784794+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.9","title":"Import-Mapping v2 Spezifikation (Garmin/Strava/TP/FIT/TCX/GPX)","description":"Warum:\nExterne Imports sind geplant; ohne fruehes Mapping drohen spaet teure Contract-Breaks.\n\nWie:\nDefiniere Import-Mapping v2 (Garmin/Strava/TrainingPeaks; FIT/TCX/GPX) auf das gleiche Kernmodell inkl. measurement_state/provenance. Fokus ist Spezifikation, nicht finaler Vollausbau.\n\nAkzeptanz:\n- Feld-Matrix pro Quelle (supported/partial/not_available) liegt vor.\n- Mapping erzeugt dieselben Blocktypen wie manuelles Logging.\n- Keine provider-spezifischen Felder als harte Kernpflicht.","acceptance_criteria":"Mapping-Matrix v2 liegt vor und passt ins Kernmodell ohne harte Provider-Pflichten.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.864173+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:09:46.069062+01:00","closed_at":"2026-02-14T12:09:46.069062+01:00","close_reason":"Closed","labels":["contract","imports"],"dependencies":[{"issue_id":"kura-training-316.9","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.866409+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.9","depends_on_id":"kura-training-316.1","type":"blocks","created_at":"2026-02-14T10:20:25.903241+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.9","depends_on_id":"kura-training-316.3","type":"blocks","created_at":"2026-02-14T10:20:26.021432+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.9","depends_on_id":"kura-training-316.4","type":"blocks","created_at":"2026-02-14T10:24:11.860834+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-31yb","title":"Define gold-standard strength model path (hierarchical Bayesian + exercise-specific error model)","description":"WHY:\nA gold-standard strength module needs a latent true-strength model and explicit observation error handling; point-proxy trend fits are not enough for scientific-grade estimation.\n\nHOW:\nDefine and stage hierarchical Bayesian strength modeling:\n- latent strength state + observation model per exercise\n- exercise/protocol-specific error terms and covariates (fatigue/readiness)\n- posterior predictive checks and calibration diagnostics\n- deterministic fallback mode for sparse/noisy contexts.\n\nIMPLEMENTATION TASKS:\n1) Formal model specification + prior choices + identifiability checks.\n2) Offline fit/refit workflow and online approximation path.\n3) Diagnostics surface (R-hat/ESS or equivalent + PPC summaries).\n4) Rollout plan with compatibility gates and rollback policy.\n\nACCEPTANCE:\n- Model spec is executable with reproducible diagnostics.\n- Projection outputs remain machine-readable and backward compatible.\n- Release gate criteria are explicit and test-enforced.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:26:01.014739+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:34.938459+01:00","closed_at":"2026-02-20T19:28:34.938459+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo).","dependencies":[{"issue_id":"kura-training-31yb","depends_on_id":"kura-training-8a71","type":"blocks","created_at":"2026-02-20T18:40:32.296002+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-33v","title":"DB Migration: invite_tokens + access_requests + consent","description":"## Was\nSQL-Migration für das Access Gate System.\n\n## Tabellen\n\n### invite_tokens\n- id: UUID PK (gen_random_uuid)\n- token: TEXT UNIQUE NOT NULL — der eigentliche Token-String (kura_inv_ Prefix, 32 Zeichen random)\n- email: TEXT NULLABLE — optional an Email gebunden (wenn aus approve-request generiert)\n- created_by: UUID REFERENCES users(id) — Admin der den Token erstellt hat\n- created_at: TIMESTAMPTZ DEFAULT now()\n- expires_at: TIMESTAMPTZ — z.B. 7 Tage nach Erstellung\n- used_at: TIMESTAMPTZ NULLABLE — wann eingelöst\n- used_by: UUID REFERENCES users(id) NULLABLE — wer eingelöst hat\n\n### access_requests\n- id: UUID PK (gen_random_uuid)\n- email: TEXT NOT NULL\n- name: TEXT NULLABLE\n- context: TEXT NULLABLE — \"Was trainierst du?\"\n- status: TEXT DEFAULT 'pending' — pending|approved|rejected\n- created_at: TIMESTAMPTZ DEFAULT now()\n- reviewed_at: TIMESTAMPTZ NULLABLE\n- reviewed_by: UUID REFERENCES users(id) NULLABLE\n- invite_token_id: UUID REFERENCES invite_tokens(id) NULLABLE — nach Approval verlinkt\n\n### users Tabelle erweitern\n- consent_anonymized_learning: BOOLEAN DEFAULT false\n- invited_by_token: UUID REFERENCES invite_tokens(id) NULLABLE\n\n## RLS\n- invite_tokens: nur admin lesen/schreiben\n- access_requests: INSERT public (kein Auth nötig), SELECT/UPDATE nur admin\n- consent_anonymized_learning: User kann eigenen Wert lesen/updaten\n\n## Hinweise\n- Token-Format: kura_inv_ + 32 hex chars (wie API keys)\n- Index auf invite_tokens.token (Lookup bei Signup)\n- Index auf access_requests.email + status (Admin-Queries)","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:44:22.436846+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:03:27.972639+01:00","closed_at":"2026-02-13T13:03:27.972639+01:00","close_reason":"Migration 20260229000001 implemented","dependencies":[{"issue_id":"kura-training-33v","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:21.520248+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-3e6","title":"Integration Tests for Semantic and Inference Handlers","description":"Add database-backed integration tests for semantic_memory, strength_inference, readiness_inference, and inference.nightly_refit job behavior (including retractions and edge cases).","notes":"Initiale Integrationstests ergänzt: Semantic Memory Projection, Strength/Readiness Inference, inference.nightly_refit job enqueue","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T09:04:47.444995+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T11:06:47.414576+01:00","closed_at":"2026-02-11T11:06:47.414576+01:00","close_reason":"DB-backed Integrationstests für semantic_memory, strength_inference, readiness_inference und inference.nightly_refit inkl. Retraktions-/Edge-Cases ergänzt; lokal gegen Postgres verifiziert","labels":["integration","testing","workers"]}
{"id":"kura-training-3f6","title":"Legal Ops: DPA/SCC evidence packet for active processors","description":"Finalize signed AVV/DPA + SCC documentation for Supabase, Resend, and optional OpenAI usage; store references in legal ops runbook and define quarterly review ownership.","status":"open","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T18:49:47.036174+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T18:49:47.036174+01:00"}
{"id":"kura-training-3ii","title":"Read Path: GET /v1/events mit Cursor-Pagination","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:06.26606+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T07:33:04.862031+01:00","closed_at":"2026-02-08T07:33:04.862031+01:00","close_reason":"GET /v1/events with cursor pagination, filtering (event_type, since, until), RLS enforcement. Tested and working."}
{"id":"kura-training-3ipz","title":"Fix training_load sensor presence detection to require numeric sensor values","description":"Sensor bonuses and signal-density counters currently trigger on key presence (e.g. heart_rate_avg=None) instead of valid numeric values. This inflates confidence/analysis tier and telemetry quality counters. Repro: compute_row_confidence_v1 increases from 0.71 to 0.74 when heart_rate_avg key is present with None.","status":"closed","priority":1,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-19T23:02:02.133742+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T23:11:29.75889+01:00","closed_at":"2026-02-19T23:11:29.75889+01:00","close_reason":"Closed","comments":[{"id":46,"issue_id":"kura-training-3ipz","author":"jonzim-cmd","text":"Fix umgesetzt: Sensorpräsenz bewertet jetzt nur noch valide numerische \u003e0-Signale statt bloßer Key-Präsenz. Implementiert als zentrale sensor_presence_v1-Logik in training_load_calibration_v1 und in training_load_v2 Signal-Density wiederverwendet. Dadurch keine Confidence-/Telemetry-Inflation bei heart_rate_avg=None/\"\"/0. Tests: test_training_load_calibration_v1.py::test_sensor_bonus_requires_valid_numeric_signal_values, test_training_load_v2.py::test_signal_density_counts_only_valid_sensor_values.","created_at":"2026-02-19T22:11:27Z"}]}
{"id":"kura-training-3kh","title":"Browser Auth: OAuth PKCE im Frontend verdrahten","description":"## Warum\nOhne funktionierende Browser-Sessions sind Settings und Setup tote Mockups.\nDas ist das Fundament für ALLES was nach Login passiert.\n\n## Was\n- Login-Page (/login) an POST /v1/auth/token anbinden (OAuth PKCE flow)\n- Signup-Page (/signup) an POST /v1/auth/register anbinden (mit invite_token + consent)\n- Token Management: Access Token in Memory, Refresh via POST /v1/auth/token (grant_type=refresh_token)\n- React Auth Context Provider: User-Info (email, display_name, is_admin, member_since), loading state, login/logout actions\n- Route Guards: /settings und /setup redirecten zu /login wenn nicht authentifiziert\n- Logout: Tokens invalidieren, Context clearen, redirect zu /\n\n## Bestehende Backend-Endpoints\n- POST /v1/auth/register (invite-gated, braucht invite_token + consent_anonymized_learning)\n- GET /v1/auth/authorize (HTML form, aber wir machen SPA-Flow)\n- POST /v1/auth/token (code exchange + refresh)\n- OAuth Client: kura-cli (loopback redirect)\n  → Braucht ggf. einen neuen OAuth Client \"kura-web\" mit Web-Redirect\n\n## Akzeptanzkriterien\n- User kann sich mit Invite-Link registrieren und ist danach eingeloggt\n- User kann sich einloggen und sieht seine echten Daten in Settings\n- Token refresht automatisch vor Ablauf (30 min access token)\n- Logout funktioniert sauber\n- Nicht-eingeloggte User werden von /settings und /setup zu /login redirected","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:33:06.33927+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T15:00:53.249421+01:00","closed_at":"2026-02-13T15:00:53.249421+01:00","close_reason":"Backend: POST /v1/auth/email/login + GET /v1/auth/me + self-service API key endpoints. Frontend: AuthProvider context, login/signup pages wired to API, settings page with real data, token refresh. Route guards on /settings."}
{"id":"kura-training-3n4","title":"exercise_progression alias fragmentation","description":"exercise_progression queries events by exercise_key, but does not resolve aliases. If user logs 'Kniebeuge' then creates alias Kniebeuge-\u003ebarbell_back_squat, the progression for barbell_back_squat misses the old Kniebeuge events. Data is fragmented until agent consistently uses exercise_id. Options: (a) resolve aliases at query time, (b) re-index on alias creation, (c) document as known limitation.","status":"closed","priority":2,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-08T15:18:42.59717+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:17:19.575344+01:00","closed_at":"2026-02-09T08:17:19.575344+01:00","close_reason":"Alias-aware handlers implemented: exercise_progression resolves through aliases and DELETEs stale projections, training_timeline resolves exercise keys through aliases. Plus conventions in system layer to prevent fragmentation at source."}
{"id":"kura-training-3ou","title":"Draft-Visibility + Promotion + Hygiene-Signale","description":"Warum: Persist-Intent-Drafts werden bereits geschrieben, sind aber für Agent/User im normalen Kontext kaum sichtbar und schwer in formale Writes zu überführen. Was muss gelten: (1) Draft-Sichtbarkeit im agent context mit kompakter Liste offener Drafts, (2) robuster Conversion-Workflow Draft→formales Event inkl. sauberer Auflösung, (3) Draft-Hygiene-Metriken als Quality-Health-Signal mit sinnvollen Schwellwerten. Umsetzung über API+CLI+Workers+Architekturtests.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-15T12:42:25.130755+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T13:02:47.852619+01:00","closed_at":"2026-02-15T13:02:47.852619+01:00","close_reason":"Closed"}
{"id":"kura-training-3ou.1","title":"P3: Draft-Hygiene als Quality-Health-Signal","description":"Warum: Nicht die pure Draft-Rate, sondern Backlog/Alter/Auflösung zeigen Persist-Hygiene und helfen bei besserem Nudge. Was muss gelten: quality_health enthält draft_hygiene (backlog_open, median_age_hours, resolution_rate_7d, status) mit defensiven Schwellen und erklärbarer Ableitung; Architekturtests pinnen Felder.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T12:42:41.903392+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T13:03:01.899757+01:00","closed_at":"2026-02-15T13:03:01.899757+01:00","close_reason":"Closed"}
{"id":"kura-training-3ou.2","title":"P1: Draft-Sichtbarkeit im agent context","description":"Warum: Persistierte Drafts sind ohne expliziten Query schwer sichtbar, obwohl sie für Follow-up wichtig sind. Was muss gelten: /v1/agent/context liefert observations_draft mit open_count, oldest_draft_age_hours und recent_drafts (timestamp, summary, observation_id). Quelle sind provisional.persist_intent.* observation.logged/open_observations. Architekturtests erzwingen Contract.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T12:42:41.904338+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T13:02:47.388369+01:00","closed_at":"2026-02-15T13:02:47.388369+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-3ou.2","depends_on_id":"kura-training-3ou","type":"parent-child","created_at":"2026-02-15T12:42:41.905019+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-3ou.3","title":"P2: Draft-Conversion Workflow (CLI + API)","description":"Warum: Drafts sollen mit minimaler Reibung in formale Events überführt und danach sauber aufgelöst werden. Was muss gelten: observation draft list/show/promote im CLI; promote schreibt formalen Event-Flow und retractet den Draft mit Referenz. Keine Doppelarbeit, klare Provenance.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T12:42:41.915562+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T13:02:47.538285+01:00","closed_at":"2026-02-15T13:02:47.538285+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-3ou.3","depends_on_id":"kura-training-3ou","type":"parent-child","created_at":"2026-02-15T12:42:41.916108+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3ou.3","depends_on_id":"kura-training-3ou.2","type":"blocks","created_at":"2026-02-15T12:43:01.695101+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-3ou.4","title":"P3: Draft-Hygiene als Quality-Health-Signal","description":"Warum: Nicht die pure Draft-Rate, sondern Backlog/Alter/Auflösung zeigen Persist-Hygiene und helfen bei besserem Nudge. Was muss gelten: quality_health enthält draft_hygiene (backlog_open, median_age_hours, resolution_rate_7d, status) mit defensiven Schwellen und erklärbarer Ableitung; Architekturtests pinnen Felder.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T12:42:53.509046+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T13:02:47.703388+01:00","closed_at":"2026-02-15T13:02:47.703388+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-3ou.4","depends_on_id":"kura-training-3ou","type":"parent-child","created_at":"2026-02-15T12:42:53.510318+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3ou.4","depends_on_id":"kura-training-3ou.3","type":"blocks","created_at":"2026-02-15T12:43:01.838919+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-3pw","title":"CLI: Admin invite commands","description":"## Was\nCLI-Commands für Invite-Verwaltung. Thin client über Admin-API.\n\n## Commands\n\n### kura admin list-requests [--status pending|approved|rejected]\n- GET /v1/admin/access-requests?status=...\n- JSON output: Array of requests\n\n### kura admin approve-request \u003cid\u003e\n- POST /v1/admin/access-requests/{id}/approve\n- Output: { token, invite_url, expires_at }\n\n### kura admin reject-request \u003cid\u003e\n- POST /v1/admin/access-requests/{id}/reject\n\n### kura admin create-invite [--email foo@bar.com] [--expires-days 7]\n- POST /v1/admin/invites\n- Output: { token, invite_url, expires_at }\n\n### kura admin list-invites [--status unused|used|expired]\n- GET /v1/admin/invites?status=...\n\n## Hinweise\n- Pattern wie bestehende admin commands (create-user, create-key)\n- JSON-only output (Agent-first)\n- Alle erfordern Admin-Token","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:45:24.699032+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:05:00.532777+01:00","closed_at":"2026-02-13T13:05:00.532777+01:00","close_reason":"5 CLI commands: list-requests, approve-request, reject-request, create-invite, list-invites","dependencies":[{"issue_id":"kura-training-3pw","depends_on_id":"kura-training-0yc","type":"blocks","created_at":"2026-02-13T12:47:00.742547+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3pw","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:42.278082+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-3q00","title":"MCP Retrieval-FSM: Loop-Guard + Max-Reloads + Stop-Reasons","description":"Warum: Bei großen Historien kann der Agent wiederholt denselben Reload-Pfad fahren (z.B. gleicher cursor), was zu Endlosschleifen führt.\\n\\nWie: Implementiere in mcp-runtime einen Retrieval-FSM mit Session-Zustand: begrenzte Reloads pro Fenster, Signatur-Loop-Erkennung, deterministische Stop-Reasons und maschinenlesbare Recovery-Hinweise.","design":"FSM gilt für retrieval-nahe Tools (agent_context/projection/system reads). Guard darf keine stillen Drops erzeugen; stattdessen strukturierter blocked_precondition/loop_guard Output mit reason_code und next_action. Non-retrieval Schritte sollen den Loop-Zustand gezielt resetten können.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T10:56:25.573997+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T11:03:46.192865+01:00","closed_at":"2026-02-19T11:03:46.192865+01:00","close_reason":"Implemented session-scoped retrieval FSM in mcp-runtime with loop-guard, max-reloads window, deterministic stop reasons, and guarded precondition responses.","dependencies":[{"issue_id":"kura-training-3q00","depends_on_id":"kura-training-5lkb","type":"blocks","created_at":"2026-02-19T10:56:35.283979+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-3wz","title":"Persist-Intent UX v1: relevante Besprechungsergebnisse sicher in Kura verankern","description":"Problem: Relevante Besprechungsergebnisse bleiben heute oft nur im Chat. Bei Kontextverlust/Compaction ist die Information faktisch weg, obwohl der Nutzer davon ausgeht, dass sie in Kura verankert wurde.\nWarum: Die bestehende Confirm-Logik ist auf Write-Proof/High-Impact fokussiert und deckt den Übergang \"besprochen\" -\u003e \"persistiert\" nicht als eigene, UX-stabile Entscheidung ab.\nZiel: Ein persistenter, testbarer Persist-Intent-Flow mit niedriger Reibung: Agent bleibt autonom, fragt aber bei relevanten unsicheren Fällen gezielt nach und zeigt immer klaren Speicherstatus.","design":"Phasen:\n1. Executable Spec: persist_intent_policy_v1 als Architekturvertrag in tests/architecture.\n2. Runtime-Entscheider: auto_save | auto_draft | ask_first mit Anti-Spam-Regeln.\n3. Speicherschicht: write-with-proof fuer harte Writes, observation.logged fuer sichere Draft-Erfassung.\n4. User-Hints: save_confirmation_mode als Preference-Override (auto|always|never).\n5. MCP-Runtime: klare Tool-Semantik fuer non-2xx + persist_intent-relevante Outputs.\n6. Telemetrie + Regression: Messbar machen, ob zu oft gefragt wird und ob Ergebnisse trotz Compaction erhalten bleiben.\n\nLeitprinzip: Kein Prompt-Only-Verhalten. Die Quelle der Wahrheit sind Contracts + Tests + persistierte Events.","acceptance_criteria":"1. Child-Tasks mit klaren Dependencies angelegt (Spec -\u003e Implementierung -\u003e Regression).\n2. Jeder Child-Task enthält explizit Warum/Wie und konkrete Artefakte (Dateien/Tests/Endpoints).\n3. Abschlusskriterium: Relevante Besprechungsergebnisse überleben Compaction deterministisch, ohne Nachfrage-Spam.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:26:05.653653+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:54:01.499891+01:00","closed_at":"2026-02-15T11:54:01.499891+01:00","close_reason":"Closed"}
{"id":"kura-training-3wz.1","title":"Executable Spec: persist_intent_policy_v1 als Architekturvertrag","description":"Warum: Ohne expliziten Architekturvertrag wird Persist-Intent-Logik wieder implizit und regressionsanfällig, besonders nach Compaction/Session-Wechsel.\nWie: Persist-Intent als v1-Contract pinnen (Modi, Trigger, Anti-Spam, Status-Transparenz) und in Architecture-Tests + Coverage-Matrix dauerhaft verankern.","design":"- Neue Spec in tests/architecture (naechste freie Nummer): persist_intent_policy_v1 Contract.\n- Invarianten:\n  - erlaubte Modi: auto_save | auto_draft | ask_first\n  - anti-spam: max eine Speicher-Rueckfrage pro Themenblock/Turn\n  - status-transparenz: jede relevante Antwort muss saved|draft|not_saved markieren\n  - fail-safe: bei unsicherem Persist-Claim keine Saved-Formulierung ohne Proof\n- test_60_agent_contract_coverage_matrix.py um persist_intent erweitern (schema_pin/positive_case/negative_case).\n- Rust Runtime-Testnamen referenzieren (routes::agent::tests::...).","acceptance_criteria":"1. Architecture-Test failt, wenn persist_intent_policy_v1 fehlt oder driftet.\n2. Coverage-Matrix enthaelt persist_intent mit schema_pin/positive_case/negative_case.\n3. Referenzierte Runtime-Tests laufen gruen.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:26:05.805088+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:53:40.371509+01:00","closed_at":"2026-02-15T11:53:40.371509+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-3wz.1","depends_on_id":"kura-training-3wz","type":"parent-child","created_at":"2026-02-15T11:26:05.805761+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-3wz.2","title":"API Runtime: Persist-Intent Decision Engine (auto_save|auto_draft|ask_first)","description":"Warum: Die Persistenzentscheidung darf nicht in Prompt-Text versteckt sein. Sie muss zentral, deterministisch und testbar im API-Flow liegen.\nWie: Decision Engine im write-with-proof-Pfad einbauen, die fuer relevante Inhalte auto_save|auto_draft|ask_first entscheidet und die Entscheidung inkl. Grundcodes zurückgibt.","design":"- Neue Response-Sektion persist_intent im Agent-Write-Response:\n  - mode, reason_codes, grouped_items, user_prompt(optional), status_label\n- Trigger-Logik:\n  - auto_save: klare Logging-Intention + verifizierbarer Write-Proof\n  - auto_draft: relevante aber noch unsichere Besprechungsergebnisse\n  - ask_first: high-impact/mehrdeutig/widerspruechlich\n- Anti-Spam-Mechanik serverseitig: Rueckfragen pro Turn/Themenblock deckeln.\n- Runtime-Tests fuer positive/negative Faelle (Trainingseinheit klar vs. unklar vs. grosse Planaenderung).","acceptance_criteria":"1. persist_intent wird maschinenlesbar im API-Response geliefert.\n2. ask_first wird in Low-Risk-Routinefaellen nicht unnoetig ausgelöst.\n3. Tests belegen, dass bei Unsicherheit kein falscher Saved-Claim erzeugt wird.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:26:05.97349+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:53:46.594515+01:00","closed_at":"2026-02-15T11:53:46.594515+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-3wz.2","depends_on_id":"kura-training-3wz","type":"parent-child","created_at":"2026-02-15T11:26:05.974175+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3wz.2","depends_on_id":"kura-training-3wz.1","type":"blocks","created_at":"2026-02-15T11:26:06.83248+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-3wz.3","title":"Draft Persistence: observation.logged fuer relevante Besprechungsergebnisse","description":"Warum: Nutzerrelevante Erkenntnisse sollen nicht durch fehlende finale Bestätigung verloren gehen.\nWie: Relevante Besprechungsergebnisse im auto_draft-Pfad als strukturierte observation.logged-Entwuerfe persistieren (mit Provenance/Confidence), statt nur im Chat zu verbleiben.","design":"- Mapping-Regeln fuer Draft-Kandidaten auf observation.logged (dimension, value, context_text, confidence, provenance, scope).\n- Qualitätsmarkierung fuer Drafts (z. B. tags oder provenance source_type), damit spaeteres Confirm/Upgrade moeglich ist.\n- Integration in open_observations-Projektion und relevante Handler-Tests.\n- Sicherstellen, dass Draft-Persistenz die Saved-Semantik nicht faelschlich signalisiert.","acceptance_criteria":"1. Relevante unsichere Besprechungsergebnisse werden als Draft persistiert statt verloren.\n2. Projektionen zeigen Drafts konsistent inkl. Provenance/Confidence.\n3. Keine Vermischung von Draft und Saved im User-Wording.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:26:06.145567+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:53:50.475449+01:00","closed_at":"2026-02-15T11:53:50.475449+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-3wz.3","depends_on_id":"kura-training-3wz","type":"parent-child","created_at":"2026-02-15T11:26:06.146284+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3wz.3","depends_on_id":"kura-training-3wz.1","type":"blocks","created_at":"2026-02-15T11:26:06.992938+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3wz.3","depends_on_id":"kura-training-3wz.2","type":"blocks","created_at":"2026-02-15T11:26:07.148256+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-3wz.4","title":"User Override: save_confirmation_mode (auto|always|never)","description":"Warum: Der Agent braucht einen Nutzer-Hinweis fuer den bevorzugten Speicher-Interaktionsstil, ohne Safety-Gates zu brechen.\nWie: Neue Preference save_confirmation_mode (auto|always|never) analog zu bestehenden Override-Mechanismen; Kombination mit Safety-Floors.","design":"- user_override_controls_v1 erweitern (system_config + Tests).\n- write_verification/policy: save_confirmation_mode in Persist-Intent-Entscheidung einbeziehen.\n- Interview/Onboarding-Discoverability ergaenzen, damit Nutzer den Modus setzen kann.\n- Safety-Floor: never darf harte Integritaets-/High-Impact-Gates nicht umgehen.","acceptance_criteria":"1. save_confirmation_mode ist end-to-end konfigurierbar und wirksam.\n2. always erzwingt Nachfrage, never reduziert Nachfrage nur innerhalb erlaubter Safety-Grenzen.\n3. Tests pinnen Override- und Safety-Verhalten.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:26:06.309436+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:53:46.589093+01:00","closed_at":"2026-02-15T11:53:46.589093+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-3wz.4","depends_on_id":"kura-training-3wz","type":"parent-child","created_at":"2026-02-15T11:26:06.310581+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3wz.4","depends_on_id":"kura-training-3wz.1","type":"blocks","created_at":"2026-02-15T11:26:07.291436+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-3wz.5","title":"MCP UX-Hardening: persist_intent Surfacing + non-2xx Semantik","description":"Warum: Gute Serverlogik hilft nicht, wenn MCP-Clients non-2xx als \"complete\" behandeln oder Persist-Entscheidungen nicht klar surfaced bekommen.\nWie: MCP-Toolausgaben fuer kura_events_write so haerten, dass Persist-Intent-Entscheidungen und API-Fehler klar als handlungsrelevant erkennbar sind.","design":"- kura_events_write: fuer write_with_proof-Antwort persist_intent/claim_guard prominent strukturieren.\n- non-2xx-Verhalten verbessern: status !=2xx nicht als normaler Abschluss fuer Nutzerfluss maskieren.\n- Kompatibilitaets-Fallback beibehalten, aber deutlich markieren, wenn Verification-Contract nicht durchgesetzt ist.\n- MCP-Runtime-Tests fuer error/completion-Semantik.","acceptance_criteria":"1. Agent sieht Persist-Intent-Ausgabe robust und konsistent ueber MCP.\n2. Fehlgeschlagene Writes werden nicht als \"erledigt\" fehlinterpretiert.\n3. Tests decken Erfolg, Fallback und non-2xx-Faelle ab.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:26:06.491054+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:53:54.08083+01:00","closed_at":"2026-02-15T11:53:54.08083+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-3wz.5","depends_on_id":"kura-training-3wz","type":"parent-child","created_at":"2026-02-15T11:26:06.492242+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3wz.5","depends_on_id":"kura-training-3wz.2","type":"blocks","created_at":"2026-02-15T11:26:07.438238+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3wz.5","depends_on_id":"kura-training-3wz.4","type":"blocks","created_at":"2026-02-15T11:26:07.585526+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-3wz.6","title":"Observability + Regression: Persist-Intent UX gegen Spam und Datenverlust absichern","description":"Warum: Ohne Messung regressiert UX entweder in Nachfrage-Spam oder in stilles Nicht-Speichern.\nWie: Telemetrie + Szenario-Regression einfuehren, die Nachfragefrequenz, Persistenzquote und Verlustfaelle nach Compaction sichtbar macht.","design":"- Lernsignale/Qualitaetsmetriken fuer persist_intent:\n  - ask_first_rate\n  - auto_saved_rate\n  - auto_draft_rate\n  - unsaved_relevant_outcome_rate\n- Szenario-Regressionen (Agent-Runtime):\n  - Trainingseinheit-Besprechung -\u003e Saved oder Draft mit explizitem Status\n  - keine Mehrfachrueckfrage fuer denselben Themenblock\n  - context-loss-sicher: Ergebnis bleibt in Events/Projections rekonstruierbar\n- Optionales Runbook-Update fuer Betriebsauswertung.","acceptance_criteria":"1. Persist-Intent-UX ist metrisch beobachtbar.\n2. Regressionstests verhindern Nachfrage-Spam und stillen Datenverlust.\n3. Nachweisbarer Compaction-resilienter Ablauf fuer relevante Besprechungsergebnisse.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T11:26:06.659851+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T11:53:57.981822+01:00","closed_at":"2026-02-15T11:53:57.981822+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-3wz.6","depends_on_id":"kura-training-3wz","type":"parent-child","created_at":"2026-02-15T11:26:06.6608+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3wz.6","depends_on_id":"kura-training-3wz.2","type":"blocks","created_at":"2026-02-15T11:26:07.736114+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3wz.6","depends_on_id":"kura-training-3wz.3","type":"blocks","created_at":"2026-02-15T11:26:07.885473+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3wz.6","depends_on_id":"kura-training-3wz.4","type":"blocks","created_at":"2026-02-15T11:26:08.03417+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3wz.6","depends_on_id":"kura-training-3wz.5","type":"blocks","created_at":"2026-02-15T11:26:08.182946+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-40k","title":"Agent context bundle endpoint (/v1/agent/context)","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T07:42:56.578755+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T07:56:43.080659+01:00","closed_at":"2026-02-11T07:56:43.080659+01:00","close_reason":"Implemented /v1/agent/context bundle endpoint with limits, OpenAPI docs, and CLI context command"}
{"id":"kura-training-4sv","title":"Rollout-Hardening: Supabase Pro Cutover (DB + Auth) vor Public Launch","description":"## Warum\nDer Supabase-Cutover ist launch-kritisch und scheitert ohne klare Reihenfolge, harte Gates und explizite Rollback-Pfade. Dieses Issue dient als Orchestrator fuer eine kontextarme KI: jede Arbeitseinheit ist als Child-Task mit klaren Deliverables modelliert.\n\n## Verbindlicher Entscheid\n- `AUTH_STRATEGY = B (DB-only migration)` fuer diesen gesamten Track.\n- Full Supabase Auth (Strategie A) ist explizit **nicht** Teil dieses Cutovers und laeuft als Folge-Track nach stabilem Go-live.\n\n## Scope\n- Produktion auf Supabase Pro fuer DB vorbereiten und umstellen\n- Bestehende API-authentifizierung bleibt erhalten (Strategie B)\n- Docker/VPS Runtime fuer API/Worker bleibt bestehen\n- Cutover mit minimaler Downtime, reproduzierbarer Generalprobe und dokumentiertem Rollback\n\n## Nicht-Scope\n- Re-Platforming auf Supabase Auth waehrend dieses Launch-Cutovers\n- Re-Architektur der gesamten Produkt-Infra ausserhalb DB/Auth\n- Performance-Tuning jenseits cutover-relevanter Stabilitaetsmetriken\n\n## Umsetzungsreihenfolge (verbindlich)\n1. `kura-training-4sv.2` - Executable Spec + hard decision gate\n2. `kura-training-4sv.1` - Supabase Baseline (Provisioning + Guardrails)\n3. `kura-training-4sv.3` - Runtime Config Wiring\n4. `kura-training-4sv.4` - Schema Parity + Idempotenz\n5. `kura-training-4sv.5` - Auth Compatibility auf Supabase (Strategie B)\n6. `kura-training-4sv.6` - Dry-Run Migration + Rollback Probe\n7. `kura-training-4sv.7` - Runbook + Monitoring + Go/No-Go\n\n## Harte Go/No-Go Gates\n- Dry-Run Downtime \u003c= 15 Minuten\n- Rollback-Probe \u003c= 30 Minuten bis Service-Recovery\n- 0 offene P0/P1 Defekte im Cutover-Pfad\n- Auth Failure Rate und API 5xx bleiben nach Cutover innerhalb definierter Alert-Schwellen\n- Schema-Parity-Preflight blockiert Deploys bei Migration Drift\n\n## Kontext fuer kontextarme KI\n- Erst Child-Tasks strikt in Reihenfolge abarbeiten.\n- Jede grosse Architekturentscheidung zuerst als Executable Spec (`tests/architecture/`) absichern.\n- Vor Abschluss jedes Implementierungs-Tasks: AGENTS.md Quality Gates ausfuehren.\n- Alle operativen Schritte (Cutover, Rollback, Monitoring) in `docs/runbooks/supabase-cutover.md` zentral dokumentieren.","acceptance_criteria":"1) AUTH_STRATEGY=B verbindlich entschieden. 2) DB-Cutover mit Schema-Parity/Dry-Run/Runbook erfolgreich. 3) Go/No-Go-Gates messbar und erfüllt.","notes":"Session handoff 2026-02-13: Keep as independent launch-critical track. Can run in parallel with wvp, but production go-live should require both security/reliability policy and Supabase cutover readiness.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T08:20:41.498765+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T08:37:26.910908+01:00","closed_at":"2026-02-16T08:37:26.910908+01:00","close_reason":"Closed","comments":[{"id":4,"issue_id":"kura-training-4sv","author":"jonzim-cmd","text":"Observed on production DB for user 019c4b87-1fc2-70d1-a4d3-ead28d47cd53: projection jobs for update_quality_health and update_training_timeline repeatedly dead with error relation external_import_jobs does not exist. Root cause: migration parity drift (DB applied up to 20260223000001 while code/handlers expect 20260224000001+). This needs rollout hardening gate before launch.","created_at":"2026-02-13T11:42:19Z"},{"id":14,"issue_id":"kura-training-4sv","author":"jonzim-cmd","text":"Status 2026-02-15 (actual rollout): Supabase DB cutover on VPS is live and healthy; API + worker now run against Supabase pooler URL, gateway health is green, and source data (users/events/projections/auth tables) was copied from VPS Postgres with verified row-count parity. Remaining launch-critical work is now mostly hardening/documentation: architecture contract tests for decision invariants, deploy preflight for migration drift, rollback probe timing, and final runbook/alert signoff.\n","created_at":"2026-02-15T21:27:25Z"},{"id":34,"issue_id":"kura-training-4sv","author":"jonzim-cmd","text":"Status update 2026-02-15: kura-training-4sv.7 is now closed (runbook + monitoring + alert drill evidence delivered). Remaining children kura-training-4sv.8 and kura-training-4sv.9 are blocked by current Supabase organization billing state (plan=free), preventing spend-guardrail and PITR enablement. Baseline/runbook reports now include reproducible API evidence and explicit manual next actions for unblocking.","created_at":"2026-02-15T22:40:02Z"},{"id":37,"issue_id":"kura-training-4sv","author":"jonzim-cmd","text":"Status 2026-02-16: PITR enablement and restore drill are complete (child kura-training-4sv.9 closed). Baseline/runbook now show pitr_enabled=true and restore evidence. Remaining launch-critical child is kura-training-4sv.8 (manual spend alerts + hard cap dashboard configuration + documentation).","created_at":"2026-02-16T06:56:05Z"},{"id":39,"issue_id":"kura-training-4sv","author":"jonzim-cmd","text":"Final status 2026-02-16: all rollout-hardening child tasks 4sv.1-4sv.9 are complete. Go/No-Go gates in docs/runbooks/supabase-cutover.md are now PASS for rollback, restore, runtime health, data integrity, auth compatibility, PITR, and spend guardrails.","created_at":"2026-02-16T07:37:26Z"}]}
{"id":"kura-training-4sv.1","title":"[task] Supabase Pro Baseline: Provisioning + Guardrails","description":"## Warum\nOhne feste Supabase-Baseline fehlen harte Rahmenbedingungen fuer alle Folge-Tasks (Migration, Auth, Runbook). Eine kontextarme KI braucht hier explizite Zielwerte statt implizites Wissen.\n\n## Scope\n- Supabase Pro Provisioning fuer Produktion (und Staging, falls noch nicht vorhanden)\n- Region, TLS, Backups/PITR, Spend Guardrails\n- Secrets-Inventar inkl. Owner und Zielsystem (VPS/.env/Deployment Secret Store)\n\n## Konkrete Schritte\n1. Projekt(e) provisionieren und Projekt-Referenzen dokumentieren.\n2. DB-Endpunkte festhalten: Direct-Connection (Migration/Admin) und Pooler (Runtime).\n3. Auth-Endpunkte festhalten: Issuer und JWKS URL.\n4. Backup/PITR-Retention und Restore-Fenster konfigurieren.\n5. Budget Alerts + harte Monatsgrenze definieren.\n\n## Deliverables\n- `docs/runbooks/supabase-cutover.md` Abschnitt \"Provisioning Baseline\"\n- `docs/reports/supabase-pro-baseline-YYYY-MM-DD.md` mit allen gesetzten Parametern (ohne Secret-Werte)\n- Secrets-Matrix (Key-Name, Quelle, Owner, Rotation-Intervall)\n\n## Acceptance Criteria\n- Baseline-Dokument enthaelt Region, Backups/PITR, Spend Guardrails, DB/Auth Endpunkte.\n- Alle benoetigten Secrets sind mit exaktem Env-Var-Namen dokumentiert.\n- Restore-Drill-Fenster (Datum + Owner) ist dokumentiert.\n","acceptance_criteria":"Supabase Baseline inkl. Region/Backups/Spend/Secrets ist dokumentiert und verifiziert.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T15:38:25.816746+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T22:50:28.424797+01:00","closed_at":"2026-02-15T22:50:28.424797+01:00","close_reason":"Closed","labels":["launch-critical","rollout","supabase"],"dependencies":[{"issue_id":"kura-training-4sv.1","depends_on_id":"kura-training-4sv","type":"parent-child","created_at":"2026-02-15T15:38:25.819891+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-4sv.1","depends_on_id":"kura-training-4sv.2","type":"blocks","created_at":"2026-02-15T17:14:10.34444+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":15,"issue_id":"kura-training-4sv.1","author":"jonzim-cmd","text":"Provisioning baseline captured in runtime: project `slawzzhovquintrsmfby` (EU), direct endpoint `db.slawzzhovquintrsmfby.supabase.co:5432/postgres`, session pooler `aws-1-eu-west-1.pooler.supabase.com:5432/postgres`, publishable key configured. VPS currently uses session pooler because direct endpoint is not reachable from that network path (IPv6 routing limitation). Remaining for closure: baseline report + secrets matrix in repo, spend/backup guardrails + restore drill window documented.\n","created_at":"2026-02-15T21:27:25Z"},{"id":20,"issue_id":"kura-training-4sv.1","author":"jonzim-cmd","text":"Repo artifact added: docs/reports/supabase-pro-baseline-2026-02-15.md and baseline section in docs/runbooks/supabase-cutover.md.","created_at":"2026-02-15T21:28:20Z"},{"id":28,"issue_id":"kura-training-4sv.1","author":"jonzim-cmd","text":"Baseline documentation is now explicit and verified where automation exists:\n- project/region/status/engine captured\n- DB direct + pooler endpoints captured\n- Auth issuer/JWKS endpoints captured\n- SSL enforcement verified and enabled via Supabase CLI\n- backup/PITR runtime status captured from Supabase CLI (`pitr_enabled=false` currently)\n- restore drill window documented (2026-02-20 10:00-10:30 UTC, owner jonzim-cmd)\n\nRemaining operator actions that cannot be fully automated in current CLI version are now tracked as dedicated child tasks:\n- `kura-training-4sv.9` PITR enablement + restore drill evidence\n- `kura-training-4sv.8` spend alerts + monthly hard cap\n","created_at":"2026-02-15T21:50:28Z"}]}
{"id":"kura-training-4sv.2","title":"[task] Decision Gate: Supabase Cutover Invariants + AUTH_STRATEGY=B","description":"## Warum\nDer Supabase-Cutover scheitert ohne verbindliche Architekturentscheidung fuer Auth, Rollen und Connection-Modi. Dieses Issue ist ein **hartes Decision Gate**: ohne finale Entscheidung kein Start von Provisioning/Implementierung.\n\n## Verbindliche Entscheidung (Gate Output)\n- `AUTH_STRATEGY = B (DB-only migration)`\n- `ROLE_MODEL = bestehende Kura-Rollen beibehalten (app_writer/app_reader/app_worker/app_migrator), angelegt auf Supabase Postgres`\n- `CONNECTION_POLICY = API ueber Pooler (transaction mode) fuer stateless Queries; Worker + Migrator ueber Direct Connection (5432) fuer LISTEN/NOTIFY und migrationskritische Operationen`\n- `TRANSACTION_INVARIANT = alle Pfade mit SET LOCAL oder SET ROLE laufen in expliziter Transaktion (BEGIN/COMMIT)`\n- `IDENTITY_POLICY = keine Umschaltung auf Supabase Auth in diesem Track; bestehende users/api_keys/oauth_* bleiben Auth-Source-of-Truth`\n\n## Scope\nErstelle ausfuehrbare Spezifikation (keine reine Prosa), die die Entscheidung dauerhaft erzwingt:\n1. Rollenmodell und Grants/SET ROLE-Verhalten fuer Supabase.\n2. Connection-Mode-Regeln (Pooler vs Direct) inkl. LISTEN/NOTIFY-Regel fuer Worker.\n3. Transaktionsinvariante fuer RLS-Kontext (`SET LOCAL kura.current_user_id`) und Worker-Rollenwechsel.\n4. Auth-Strategie B als verbindlicher Scope fuer `kura-training-4sv`.\n5. Identity-Mapping-Regel: `user_identities` bleibt vorbereitet, aber wird erst im Strategie-A-Track aktiviert.\n\n## Konkrete Schritte\n1. 3-5 Satz Entscheidungszusammenfassung in Beads/CLAUDE.md festhalten.\n2. Architektur-Tests unter `tests/architecture/` anlegen/erweitern (Supabase-Cutover-Contracts).\n3. SQL-POC dokumentieren: bestehende Kura-Rollen koennen in Supabase-Projekt angelegt und verwendet werden.\n4. Offene Punkte explizit als TODO im Issue-Kommentar erfassen; kein stiller Scope-Drift.\n\n## Deliverables\n- Executable Specs fuer die obigen 5 Invarianten\n- Decision Record mit finalen Schluesseln (`AUTH_STRATEGY`, `ROLE_MODEL`, `CONNECTION_POLICY`, `TRANSACTION_INVARIANT`, `IDENTITY_POLICY`)\n- Kurze Migration-Impact-Tabelle fuer `.3/.4/.5`\n\n## Acceptance Criteria\n- Issue schliesst nur mit dokumentiertem Decision Record; kein \"spaeter entscheiden\".\n- Strategie B ist verbindlich fuer alle Child-Tasks von `kura-training-4sv`.\n- Architektur-Tests failen bei Abweichung von Rollenmodell, Connection-Policy oder Transaktionsinvariante.\n- LISTEN/NOTIFY-Anforderung (Worker Direct Connection) ist explizit abgesichert.\n- Scope fuer Full Supabase Auth ist aus diesem Track ausgeschlossen und als Folge-Issue referenziert.","acceptance_criteria":"Decision Record gesetzt (AUTH_STRATEGY=B) und als ausführbare Invarianten abgesichert.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T15:38:25.960953+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T22:36:03.421272+01:00","closed_at":"2026-02-15T22:36:03.421272+01:00","close_reason":"Closed","labels":["architecture","launch-critical","supabase"],"dependencies":[{"issue_id":"kura-training-4sv.2","depends_on_id":"kura-training-4sv","type":"parent-child","created_at":"2026-02-15T15:38:25.96293+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":16,"issue_id":"kura-training-4sv.2","author":"jonzim-cmd","text":"Decision gate is operationally enforced in production run: AUTH_STRATEGY=B (DB-only), custom Kura roles exist on Supabase (`app_reader/app_writer/app_worker/app_migrator/kura`), and role switching works after explicit `GRANT ... WITH SET TRUE` for `postgres`. Important nuance discovered during rollout: initial grants had `set_option=false`, causing worker crash on `SET ROLE app_worker`; fixed live. Remaining for closure: encode these invariants as executable tests under `tests/architecture/` and finalize documented connection policy deviation (session pooler currently used for worker due direct endpoint reachability constraints).\n","created_at":"2026-02-15T21:27:25Z"},{"id":23,"issue_id":"kura-training-4sv.2","author":"jonzim-cmd","text":"Decision gate implemented as executable spec + decision record.\n\nWhat landed:\n1. Decision record in `CLAUDE.md` with hard keys (`AUTH_STRATEGY=B`, role model, connection policy, transaction invariant, identity policy).\n2. New architecture contracts in `tests/architecture/test_120_supabase_cutover_contract.py`:\n   - hard-gate keys present in decision record\n   - custom role model contract in `docker/postgres/init.sql`\n   - worker dedicated LISTEN URL contract (`KURA_WORKER_LISTEN_DATABASE_URL`)\n   - API `kura.current_user_id` transaction-handle contract\n   - worker `SET LOCAL ROLE` repair-path contract\n3. Runtime wiring support for connection policy:\n   - `workers/src/kura_workers/config.py` adds `listen_database_url`\n   - `workers/src/kura_workers/worker.py` uses dedicated listen URL for `LISTEN kura_jobs`\n   - `docker/compose.production.yml` supports `KURA_WORKER_LISTEN_DATABASE_URL`\n4. Docs updated in runbook/baseline report to reflect the dedicated LISTEN path.\n\nQuality gates:\n- `ruff check workers/src/ workers/tests/` passed\n- `pytest workers/tests/ -q --ignore=workers/tests/test_integration.py` passed\n- `pytest workers/tests/test_integration.py -q` passed\n- `cargo test --workspace` passed\n","created_at":"2026-02-15T21:36:03Z"}]}
{"id":"kura-training-4sv.3","title":"[task] Runtime Config Wiring fuer Supabase (API/Worker/CLI)","description":"## Warum\nAktuell ist Runtime-Konfiguration auf lokales Docker-Postgres zugeschnitten. Fuer reproduzierbare Cutover-Schritte braucht es klare, validierte Supabase-Konfiguration in API/Worker/CLI.\n\n## Scope\n- Env-Var-Modell fuer Supabase DB + Auth etablieren\n- Startup-Validierung mit klaren Fehlermeldungen\n- Deployment-Konfigurationen auf neues Modell heben\n\n## Konkrete Schritte\n1. Konfigurationsstruktur in `api/src/main.rs`, `workers/src/kura_workers/config.py`, `cli/src/commands/admin.rs` auf Supabase-faehige Variablen erweitern.\n2. Runtime vs Migration-URL sauber trennen (Pooler vs Direct).\n3. Auth-Provider-Konfiguration (Issuer/JWKS/Audience) zentralisieren.\n4. `docker/compose.production.yml` und relevante Scripts auf konsistente Variablen anpassen.\n5. Tests fuer Missing/Invalid Config Cases ergaenzen.\n\n## Deliverables\n- Dokumentierte Env-Var-Matrix fuer local/staging/prod\n- Konfigurationsvalidierung in API/Worker mit actionable Fehlern\n- Anpassungen in Deployment-/Utility-Skripten\n\n## Acceptance Criteria\n- API/Worker/CLI starten mit Supabase-Config reproduzierbar und failen klar bei fehlenden Pflichtvariablen.\n- Konfigurationsnamen sind in Code, Runbook und Deployment konsistent.\n- Keine impliziten Defaults auf lokale Docker-DB in Production-Pfaden.\n","acceptance_criteria":"Supabase-Konfiguration ist konsistent, validiert und deployment-faehig.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T15:38:26.100242+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T22:50:35.860665+01:00","closed_at":"2026-02-15T22:50:35.860665+01:00","close_reason":"Closed","labels":["config","launch-critical","supabase"],"dependencies":[{"issue_id":"kura-training-4sv.3","depends_on_id":"kura-training-4sv","type":"parent-child","created_at":"2026-02-15T15:38:26.101153+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-4sv.3","depends_on_id":"kura-training-4sv.1","type":"blocks","created_at":"2026-02-15T17:14:31.028647+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":17,"issue_id":"kura-training-4sv.3","author":"jonzim-cmd","text":"Runtime wiring progressed: `docker/compose.production.yml` now supports explicit DB URL overrides (`KURA_API_DATABASE_URL`, `KURA_WORKER_DATABASE_URL`) via commit `f969c52`; deployed on VPS via `docker/.env.production` and verified in container env. API/worker/proxy are healthy and run against Supabase pooler URL. Remaining for closure: finalize env-var matrix in docs, enforce production-safe config validation (no silent local fallback path), and add config failure-mode tests.\n","created_at":"2026-02-15T21:27:25Z"},{"id":24,"issue_id":"kura-training-4sv.3","author":"jonzim-cmd","text":"Connection-policy wiring advanced: worker now supports dedicated LISTEN DB URL via KURA_WORKER_LISTEN_DATABASE_URL (fallback to DATABASE_URL), implemented in workers config/worker and compose.production. This unblocks direct-connection LISTEN once VPS network path supports direct endpoint.","created_at":"2026-02-15T21:36:08Z"},{"id":26,"issue_id":"kura-training-4sv.3","author":"jonzim-cmd","text":"Runtime config wiring hardening completed for production paths:\n\n1. `docker/compose.production.yml` now requires explicit `KURA_API_DATABASE_URL` and `KURA_WORKER_DATABASE_URL` (no local `kura-postgres` fallback for API/worker).\n2. Worker LISTEN path now supports dedicated URL via `KURA_WORKER_LISTEN_DATABASE_URL` while query path remains on `DATABASE_URL`.\n3. `scripts/deploy.sh` now requires Supabase runtime URLs in env preflight.\n4. Added worker config tests (`workers/tests/test_worker_config.py`) and architecture contracts covering connection wiring and production URL requirements.\n5. Docs aligned in runbook + baseline report.\n\nAll quality gates passed after this change (ruff, workers tests incl integration, cargo workspace tests).\n","created_at":"2026-02-15T21:44:29Z"}]}
{"id":"kura-training-4sv.4","title":"[task] Schema Parity auf Supabase: Migration + Idempotenz","description":"## Warum\nVor dem Cutover muss gesichert sein, dass die bestehende Migration-Historie auf Supabase identisch funktioniert und keine Runtime-Pfade an fehlenden Tabellen sterben.\n\n## Scope\n- Vollstaendige Migration-Paritaet auf Supabase\n- Idempotenz-Checks\n- Worker-/Projection-Relevanztests fuer bekannte Risikopfade\n\n## Konkrete Schritte\n1. Frische Supabase-DB aufsetzen und komplette `migrations/` anwenden.\n2. Migrationslauf erneut ausfuehren und auf No-Op/Idempotenz pruefen.\n3. Repräsentative Worker/Projection-Pfade durchlaufen (inkl. `external_import_jobs`-Abhaengigkeiten).\n4. `scripts/`-Preflight fuers Deploy bauen/erweitern, das Applied-vs-Required Migration Drift blockiert.\n5. Ergebnisse als reproduzierbares Protokoll dokumentieren.\n\n## Deliverables\n- Migrations-Protokoll (erste Ausfuehrung + Idempotenz-Rerun)\n- Preflight-Check fuer Schema-Parity im Deployment\n- Dokumentierte Query/Checkliste fuer \"critical tables present\"\n\n## Acceptance Criteria\n- Alle Migrationen laufen auf Supabase ohne Fehler und sind idempotent.\n- Deployment wird bei Schema-Drift hart blockiert.\n- Bekannte Dead-Job-Ursachen (fehlende Tabellen) sind durch Guardrails abgesichert.\n","acceptance_criteria":"Migrationen sind auf Supabase fehlerfrei, idempotent und deployment-gated.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T15:38:26.236714+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T22:50:36.080293+01:00","closed_at":"2026-02-15T22:50:36.080293+01:00","close_reason":"Closed","labels":["launch-critical","migrations","supabase"],"dependencies":[{"issue_id":"kura-training-4sv.4","depends_on_id":"kura-training-4sv","type":"parent-child","created_at":"2026-02-15T15:38:26.237928+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-4sv.4","depends_on_id":"kura-training-4sv.3","type":"blocks","created_at":"2026-02-15T15:38:26.977618+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":18,"issue_id":"kura-training-4sv.4","author":"jonzim-cmd","text":"Schema/data parity execution completed against Supabase target: migrations applied successfully (32/32 up to `20260229000002`), custom roles created, full public-table copy from VPS source performed with snapshot transaction + truncate/copy + sequence reset, verification showed `table_count=45` and `mismatch_count=0`; key counts match (`users=1`, `events=270`, `projections=35`, auth-related tables present). Remaining for closure: automated idempotence rerun evidence and deploy-time migration drift preflight gate.\n","created_at":"2026-02-15T21:27:25Z"},{"id":25,"issue_id":"kura-training-4sv.4","author":"jonzim-cmd","text":"Schema parity hardening completed with deploy-time drift gate.\n\nWhat landed:\n1. New deploy preflight script `scripts/check-migration-drift.sh`.\n   - Compares repo migration versions (`migrations/*.sql`) vs DB `_sqlx_migrations`.\n   - Fails on missing required migrations, unexpected applied migrations, or failed entries (`success = FALSE`).\n2. `scripts/deploy.sh` now enforces this preflight before service start and blocks deploy on drift.\n3. Executable contract added in `tests/architecture/test_121_schema_drift_preflight_contract.py` to keep the gate wired.\n4. Runbook/report updated to reflect that preflight now exists and is part of cutover pre-checks.\n5. Drift gate executed against production Supabase pooler DB and passed (`required == applied`).\n\nQuality gates all green after change:\n- ruff\n- workers unit tests\n- workers integration tests\n- cargo test --workspace\n","created_at":"2026-02-15T21:42:07Z"},{"id":27,"issue_id":"kura-training-4sv.4","author":"jonzim-cmd","text":"Schema parity gate is now enforced at deploy time:\n\n1. Added `scripts/check-migration-drift.sh` to compare repository migrations vs `_sqlx_migrations` and fail on drift/failed entries.\n2. Wired drift check into `scripts/deploy.sh` before service start.\n3. Added executable contract `tests/architecture/test_121_schema_drift_preflight_contract.py` to prevent regression.\n4. Drift gate executed against Supabase target and passed (`required == applied`).\n5. Runbook/report updated to reflect gate is implemented.\n\nThis resolves the previously documented dead-job risk from missing migration tables by blocking deploys on migration drift.\n","created_at":"2026-02-15T21:44:30Z"}]}
{"id":"kura-training-4sv.5","title":"[task] Auth Compatibility on Supabase (Strategie B: DB-only)","description":"## Warum\nFuer den Launch-Cutover gilt verbindlich `AUTH_STRATEGY=B`: Auth bleibt in der API, waehrend die DB auf Supabase migriert. Ziel ist Kompatibilitaet und Risikominimierung, nicht Re-Platforming auf Supabase Auth.\n\n## Scope (Strategie B)\n- Bestehende Auth-Logik in `api/src/routes/auth.rs` bleibt die ausstellende/verifizierende Authority.\n- API verifiziert weiterhin eigene OAuth-/Session-Tokens gegen migrierte Tabellen (`users`, `api_keys`, `oauth_*`).\n- Supabase wird als Postgres-Backend genutzt; kein Wechsel auf Supabase Auth Flows in diesem Task.\n\n## Konkrete Schritte\n1. Sicherstellen, dass Auth-Pfade nach DB-Migration auf Supabase unveraendert funktionieren.\n2. Role/Transaction-Invarianten aus `.2` in Auth-relevanten Query-Pfaden einhalten.\n3. Fehlercodes/Failure-Modes fuer DB- und Token-Fehler klar trennen.\n4. Regression-Tests fuer Login/Refresh/Device/PKCE unter Supabase-DB ausfuehren.\n5. Doku: \"Nicht Teil dieses Tasks\" fuer Supabase Auth (Strategie A).\n\n## Deliverables\n- Auth-Kompatibilitaetsnachweis auf Supabase-DB (ohne Supabase Auth)\n- Regression-Testprotokoll fuer bestehende Auth-Flows\n- Klarer Ausschluss von Full Supabase Auth im Tasktext\n\n## Acceptance Criteria\n- Bestehende Auth-Flows funktionieren auf Supabase-DB ohne funktionalen Regressionen.\n- Kein Produktionspfad ist von Supabase Auth Token-Issuance abhaengig.\n- Scope ist explizit auf Strategie B begrenzt; Full Supabase Auth wird auf Folge-Issue verwiesen.","acceptance_criteria":"Bestehende Auth-Flows laufen auf Supabase-DB stabil; kein Supabase-Auth-Cutover in diesem Task.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T15:38:26.382319+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T23:01:01.260318+01:00","closed_at":"2026-02-15T23:01:01.260318+01:00","close_reason":"Closed","labels":["auth","launch-critical","supabase"],"dependencies":[{"issue_id":"kura-training-4sv.5","depends_on_id":"kura-training-4sv","type":"parent-child","created_at":"2026-02-15T15:38:26.384445+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-4sv.5","depends_on_id":"kura-training-4sv.4","type":"blocks","created_at":"2026-02-15T15:38:27.077618+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":29,"issue_id":"kura-training-4sv.5","author":"jonzim-cmd","text":"Implemented Strategy-B auth compatibility evidence on Supabase DB. Added DB-bound auth regression tests in api/src/routes/auth.rs covering login credential validation, PKCE exchange fail+success, refresh rotation+replay rejection, and device-code consume-once behavior. Executed \nrunning 15 tests\ntest routes::auth::tests::invite_email_binding_accepts_matching_email ... ok\ntest routes::auth::tests::invite_email_binding_rejects_mismatch ... ok\ntest routes::auth::tests::normalize_email_trims_and_lowercases ... ok\ntest routes::auth::tests::oidc_email_verified_supports_bool_and_string ... ok\ntest routes::auth::tests::normalize_user_code_removes_separators_and_uppercases ... ok\ntest routes::auth::tests::generate_user_code_uses_expected_shape ... ok\ntest routes::auth::tests::loopback_redirect_accepts_valid_localhost_callback ... ok\ntest routes::auth::tests::loopback_redirect_rejects_non_loopback_or_invalid_path ... ok\ntest routes::auth::tests::validate_oauth_client_inactive_client_is_rejected ... ok\ntest routes::auth::tests::validate_oauth_client_unknown_client_is_rejected ... ok\ntest routes::auth::tests::exchange_authorization_code_rejects_wrong_pkce_without_consuming_code ... ok\ntest routes::auth::tests::exchange_authorization_code_consumes_code_and_issues_tokens ... ok\ntest routes::auth::tests::refresh_tokens_rotates_old_tokens_and_invalidates_previous_refresh_token ... ok\ntest routes::auth::tests::device_token_consumes_approved_device_code_once ... ok\ntest routes::auth::tests::authenticate_email_password_user_id_validates_credentials ... ok\n\ntest result: ok. 15 passed; 0 failed; 0 ignored; 0 measured; 326 filtered out; finished in 0.76s against Supabase session pooler: 15 passed, 0 failed. Cleaned up prefixed test rows and verified users_total=1, users_test=0, clients_test=0. Added evidence report docs/reports/supabase-auth-compatibility-2026-02-15.md, updated runbook/report docs, and added architecture contract tests/architecture/test_122_auth_strategy_b_contract.py for AUTH_STRATEGY=B scope.","created_at":"2026-02-15T22:01:01Z"}]}
{"id":"kura-training-4sv.6","title":"[task] Dry-Run: Snapshot Migration + Rollback Probe","description":"## Warum\nOhne geuebten Dry-Run ist das reale Cutover-Risiko zu hoch. Eine kontextarme KI braucht eine reproduzierbare Prozedur mit messbaren SLOs.\n\n## Scope\n- End-to-End Generalprobe von Snapshot bis Umschalten\n- Downtime-Messung\n- Rollback-Probe unter Zeitdruck\n\n## Konkrete Schritte\n1. Snapshot aus aktuellem VPS-Postgres ziehen.\n2. Snapshot nach Supabase importieren und Migrations-/Integrity-Checks laufen lassen.\n3. Freeze-Fenster simulieren, Delta anwenden, Runtime auf Supabase umstellen.\n4. Smoke-Tests fuer Login/Auth, kritische API-Pfade und Worker-Ausfuehrung durchfuehren.\n5. Rollback auf alten Stack testen (DB + Auth), Zeit und Datenabweichung dokumentieren.\n\n## Deliverables\n- Dry-Run-Protokoll mit Zeitstempeln, Downtime und Fehlern\n- Verwendete Kommandos/Skripte in reproduzierbarer Reihenfolge\n- Rollback-Protokoll mit Triggern und Recovery-Zeit\n\n## Acceptance Criteria\n- Gemessene Downtime im Dry-Run \u003c= 15 Minuten.\n- Vollstaendiger Rollback in \u003c= 30 Minuten geprobt und dokumentiert.\n- Keine Datenintegritaetsabweichung in den definierten Stichproben.\n","acceptance_criteria":"Dry-Run misst Downtime/Rollback reproduzierbar und erfuellt Schwellwerte.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T15:38:26.523474+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T23:14:58.431417+01:00","closed_at":"2026-02-15T23:14:58.431417+01:00","close_reason":"Closed","labels":["cutover","dry-run","supabase"],"dependencies":[{"issue_id":"kura-training-4sv.6","depends_on_id":"kura-training-4sv","type":"parent-child","created_at":"2026-02-15T15:38:26.524792+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-4sv.6","depends_on_id":"kura-training-4sv.5","type":"blocks","created_at":"2026-02-15T15:38:27.179858+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":19,"issue_id":"kura-training-4sv.6","author":"jonzim-cmd","text":"Dry-run-like execution was performed on live infrastructure path: source snapshot copy from VPS Postgres to Supabase, runtime cutover to Supabase URLs, post-cutover health checks green (`kura health` OK), and worker recovered after role grant fix. Not yet complete for AC closure: formal downtime measurement artifact (\u003c=15m), explicit rollback drill with timed recovery (\u003c=30m), and documented rollback trigger matrix.\n","created_at":"2026-02-15T21:27:25Z"},{"id":21,"issue_id":"kura-training-4sv.6","author":"jonzim-cmd","text":"Repo artifact added: docs/reports/supabase-dry-run-2026-02-15.md with executed migration/cutover timeline and open gate items.","created_at":"2026-02-15T21:28:20Z"},{"id":30,"issue_id":"kura-training-4sv.6","author":"jonzim-cmd","text":"Formal timed rollback drill completed on VPS (2026-02-15, 22:09:42Z-22:12:09Z). Measured phases: rollback-to-local runtime 73s, restore-to-supabase runtime 74s. Both pass gates (rollback \u003c=30m, downtime proxy \u003c=15m). Data-integrity spot checks remained identical before/after across local+supabase for users/events/projections/oauth_clients/user_identities/api_keys (1/270/35/2/1/1). Operational finding captured: nginx proxy can serve stale upstream after API recreation unless recreated; mitigation validated by forcing proxy recreate each phase. Runbook and dry-run report updated with trigger matrix, measured timings, and exact command sequence.","created_at":"2026-02-15T22:14:58Z"}]}
{"id":"kura-training-4sv.7","title":"[task] Runbook + Monitoring + Go/No-Go Gate","description":"## Warum\nSelbst mit funktionierendem Dry-Run bleibt Launch-Risiko hoch ohne Runbook, Alerts und harte Go/No-Go Gates.\n\n## Scope\n- Produktions-Runbook (Cutover + Rollback)\n- Monitoring-/Alerting-Setup\n- Entscheidbare Go/No-Go-Checkliste\n\n## Konkrete Schritte\n1. `docs/runbooks/supabase-cutover.md` mit Pre-Checks, Freeze, Umschalten, Validierung, Rollback finalisieren.\n2. Dashboard/Alerts definieren fuer:\n   - Auth-Fehlerrate\n   - DB-Latenz / Connection Errors\n   - API 5xx und Worker Dead-Jobs\n3. Alert-Schwellen und Eskalationswege dokumentieren (Owner + Reaktionszeit).\n4. Go/No-Go-Tabelle mit harten Schwellwerten und Abbruchkriterien einfuegen.\n5. Post-Cutover 24h-Checkliste + Kommunikationsvorlagen anhaengen.\n\n## Deliverables\n- Vollstaendiges Cutover-Runbook\n- Monitoring- und Alert-Definitionen (inkl. Test der Alerts)\n- Sign-off Checkliste fuer Launch-Freigabe\n\n## Acceptance Criteria\n- Runbook deckt End-to-End Cutover und Rollback ohne Wissensluecken ab.\n- Alerts sind konfiguriert und mindestens einmal testweise ausgeloest/verifiziert.\n- Go/No-Go Entscheidung kann objektiv anhand dokumentierter Gates getroffen werden.\n","acceptance_criteria":"Cutover-Runbook, Alerts und objektive Go/No-Go Gates sind komplett.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T15:38:26.663343+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T23:39:48.403491+01:00","closed_at":"2026-02-15T23:39:48.403491+01:00","close_reason":"Runbook + monitoring gates + alert drill evidence completed and verified.","labels":["launch-critical","monitoring","runbook","supabase"],"dependencies":[{"issue_id":"kura-training-4sv.7","depends_on_id":"kura-training-4sv","type":"parent-child","created_at":"2026-02-15T15:38:26.665232+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-4sv.7","depends_on_id":"kura-training-4sv.6","type":"blocks","created_at":"2026-02-15T15:38:27.279592+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":22,"issue_id":"kura-training-4sv.7","author":"jonzim-cmd","text":"Initial runbook scaffold added at docs/runbooks/supabase-cutover.md (cutover, validation, rollback, gates). Monitoring/alert definitions and tested alert triggers are still pending.","created_at":"2026-02-15T21:28:25Z"},{"id":31,"issue_id":"kura-training-4sv.7","author":"jonzim-cmd","text":"Completed: runbook finalized with monitoring/alert matrix, rollback trigger matrix, objective Go/No-Go table, 24h post-cutover checklist, and communication templates in docs/runbooks/supabase-cutover.md. Alert trigger evidence documented in docs/reports/supabase-monitoring-drill-2026-02-15.md (auth failure drill, DB connection-error drill, API 5xx incident replay, worker dead-job signal validation). Architecture contracts added in tests/architecture/test_124_supabase_runbook_monitoring_contract.py and tests/architecture/test_125_supabase_guardrail_gate_contract.py.","created_at":"2026-02-15T22:39:48Z"}]}
{"id":"kura-training-4sv.8","title":"[task] Supabase Spend Guardrails (Alerts + Hard Cap)","description":"## Warum\\nKosten- und Ausfallrisiken brauchen harte finanzielle Guardrails vor Launch. Die aktuelle CLI liefert keinen verifizierten Spend-Alert/Hard-Cap-Status fuer die Organisation.\\n\\n## Scope\\n- Spend-Alert-Schwellen konfigurieren\\n- Monatlichen Hard Cap setzen\\n- Verifizierten Nachweis in Runbook/Baseline dokumentieren\\n\\n## Konkrete Schritte\\n1. Dashboard: Alerts fuer 50%, 80%, 95% Monatsbudget setzen.\\n2. Dashboard: monatlichen Hard Cap setzen.\\n3. Werte (ohne sensitive Billing-Daten) in Baseline-Report dokumentieren.\\n4. Owner + Eskalationspfad im Runbook eintragen.\\n\\n## Deliverables\\n- Aktualisierte docs/reports/supabase-pro-baseline-2026-02-15.md mit Schwellwerten/Cap\\n- Runbook-Abschnitt mit Owner/Eskalationspfad\\n\\n## Acceptance Criteria\\n- Alerts und Hard Cap sind gesetzt\\n- Konfiguration ist dokumentiert und fuer Go/No-Go nutzbar","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T22:50:16.538253+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T08:37:04.50271+01:00","closed_at":"2026-02-16T08:37:04.50271+01:00","close_reason":"Closed","labels":["cost","launch-critical","supabase"],"dependencies":[{"issue_id":"kura-training-4sv.8","depends_on_id":"kura-training-4sv","type":"parent-child","created_at":"2026-02-15T22:50:16.540824+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-4sv.8","depends_on_id":"kura-training-4sv.7","type":"blocks","created_at":"2026-02-15T22:50:16.549173+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":32,"issue_id":"kura-training-4sv.8","author":"jonzim-cmd","text":"Blocking evidence captured in docs/reports/supabase-pro-baseline-2026-02-15.md: organization plan is currently free, and Management API exposes only project add-on endpoints (GET/PATCH /v1/projects/{ref}/billing/addons). Probed org billing alert/cap routes return 404. Spend alerts (50/80/95) and monthly hard cap therefore require manual dashboard/billing action after paid-plan enablement.","created_at":"2026-02-15T22:39:56Z"},{"id":36,"issue_id":"kura-training-4sv.8","author":"jonzim-cmd","text":"2026-02-16 update after Pro+PITR completion: plan is now pro and PITR is no longer a blocker (kura-training-4sv.9 closed). This issue remains open only for manual billing dashboard actions: configure spend alerts (50/80/95) and monthly hard cap, then document owner/escalation evidence in baseline/runbook.","created_at":"2026-02-16T06:56:01Z"},{"id":38,"issue_id":"kura-training-4sv.8","author":"jonzim-cmd","text":"Completed 2026-02-16: spend guardrails are now configured in Supabase dashboard (alerts 50/80/95 + monthly hard cap), with owner/escalation evidence documented in docs/reports/supabase-pro-baseline-2026-02-15.md and go/no-go status updated to PASS in docs/runbooks/supabase-cutover.md. Supporting references updated in docs/reports/supabase-dry-run-2026-02-15.md, docs/reports/supabase-monitoring-drill-2026-02-15.md, and architecture contract test tests/architecture/test_125_supabase_guardrail_gate_contract.py.","created_at":"2026-02-16T07:37:04Z"}]}
{"id":"kura-training-4sv.9","title":"[task] Supabase PITR Enablement + Restore Drill Evidence","description":"## Warum\\nPITR ist aktuell fuer das Produktionsprojekt deaktiviert (CLI-Check 2026-02-15: pitr_enabled=false). Ohne PITR fehlt ein belastbarer Daten-Wiederherstellungspfad fuer den Launch.\\n\\n## Scope\\n- PITR fuer Projekt slawzzhovquintrsmfby aktivieren\\n- Retention/Fenster dokumentieren\\n- Restore-Drill durchfuehren und Ergebnis protokollieren\\n\\n## Konkrete Schritte\\n1. PITR in Supabase Dashboard aktivieren.\\n2. Verifizieren per {\n  \"backups\": [],\n  \"physical_backup_data\": {},\n  \"pitr_enabled\": false,\n  \"region\": \"eu-west-1\",\n  \"walg_enabled\": true\n} (pitr_enabled=true).\\n3. Restore-Drill im Zeitfenster ausfuehren und Recovery-Zeit messen.\\n4. Ergebnis in docs/reports dokumentieren.\\n\\n## Deliverables\\n- Aktualisierter Baseline-Report mit pitr_enabled=true + Retention\\n- Restore-Drill-Protokoll mit Dauer und Ergebnis\\n\\n## Acceptance Criteria\\n- PITR ist aktiviert und verifiziert\\n- Restore-Drill ist dokumentiert und reproduzierbar","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T22:50:17.538284+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T07:55:54.295156+01:00","closed_at":"2026-02-16T07:55:54.295156+01:00","close_reason":"PITR enabled and restore drill documented","labels":["backup","launch-critical","supabase"],"dependencies":[{"issue_id":"kura-training-4sv.9","depends_on_id":"kura-training-4sv","type":"parent-child","created_at":"2026-02-15T22:50:17.539676+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-4sv.9","depends_on_id":"kura-training-4sv.7","type":"blocks","created_at":"2026-02-15T22:50:17.542909+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":33,"issue_id":"kura-training-4sv.9","author":"jonzim-cmd","text":"Blocking evidence captured in docs/reports/supabase-pro-baseline-2026-02-15.md: supabase backups list still reports pitr_enabled=false, and PATCH /v1/projects/slawzzhovquintrsmfby/billing/addons with addon_type=pitr/addon_variant=pitr_7 returns HTTP 400 (Organization is not entitled to the selected PITR duration). PITR enablement and restore drill remain blocked until org entitlement/plan upgrade.","created_at":"2026-02-15T22:39:56Z"},{"id":35,"issue_id":"kura-training-4sv.9","author":"jonzim-cmd","text":"2026-02-16 execution evidence: Supabase project slawzzhovquintrsmfby now has addons compute_instance=ci_small and pitr=pitr_7. CLI verification shows pitr_enabled=true. PITR restore drill executed via supabase backups restore --project-ref slawzzhovquintrsmfby --timestamp 1771224287 --yes and recovered to ACTIVE_HEALTHY in ~6s. Evidence documented in docs/reports/supabase-pitr-restore-drill-2026-02-16.md and reflected in docs/reports/supabase-pro-baseline-2026-02-15.md + docs/runbooks/supabase-cutover.md.","created_at":"2026-02-16T06:55:50Z"}]}
{"id":"kura-training-4u6","title":"Semantic Layer: pgvector + pre-trained embeddings","description":"Exercise and food resolution via embedding similarity. Pre-trained sentence transformer, pgvector for storage/query. Cross-language matching (Kniebeuge ~ barbell back squat). Background worker computes embeddings on new exercises. Enhances but doesn't replace per-user alias system.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:27.62076+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T09:05:13.785525+01:00","closed_at":"2026-02-11T09:05:13.785525+01:00","close_reason":"Closed"}
{"id":"kura-training-4uv","title":"Settings: Privacy \u0026 Datenexport","description":"## Warum\nDSGVO Art. 15/20 (Auskunftsrecht + Datenportabilität). User muss seine Daten exportieren können.\nConsent-Transparenz zeigt dem User was er zugestimmt hat.\n\n## Was\n### Consent-Toggle\n- Toggle-UI für \"Anonymisierte Nutzungsdaten\" — visuell sichtbar aber DISABLED\n- Darunter Hinweis: \"Während der Early-Access-Phase ist die Zustimmung zur anonymisierten\n  Datenanalyse Teilnahmebedingung. Du kannst diese Einstellung nach dem öffentlichen Launch ändern.\"\n- Kein Backend-Call nötig, rein informativer UI-State\n\n### Datenexport\n- Button \"Meine Daten herunterladen\"\n- Synchroner Download (Kura-Datenvolumen ist klein genug)\n- Ruft ab: GET /v1/events (alle eigenen Events) + GET /v1/projections (alle eigenen Projections)\n- Packt beides in eine JSON-Datei: { events: [...], projections: [...], exported_at: \"...\" }\n- WICHTIG: Kein system_config, kein agent_behavior — NUR User-eigene Daten\n- Dateiname: kura-export-{date}.json\n\n## Abhängigkeit\n- Blocked by: Browser Auth (kura-training-3kh)\n\n## Akzeptanzkriterien\n- Consent-Toggle sichtbar, disabled, mit EA-Hinweis\n- Export-Button lädt JSON mit allen eigenen Events + Projections herunter\n- Export enthält KEINE System-Daten (system_config, agent_behavior, etc.)","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:34:34.170601+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T15:01:37.479097+01:00","closed_at":"2026-02-13T15:01:37.479097+01:00","close_reason":"Implemented in settings page: Consent toggle (disabled during EA with hint text), data export button downloads events + projections as JSON.","dependencies":[{"issue_id":"kura-training-4uv","depends_on_id":"kura-training-3kh","type":"blocks","created_at":"2026-02-13T14:34:42.140742+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-4z2","title":"Setup-Seite: Echte Agent-Connection Guides","description":"## Warum\nDie Setup-Seite ist der zentrale Ort wo User ihren AI-Agent mit Kura verbinden.\nAktuell zeigt sie generische CLI-Commands. Sie braucht echte, kopierbare Werte.\n\n## Was\n### CLI-Tab (existiert, erweitern)\n- Schritt 1: cargo install kura-cli (oder Download-Link)\n- Schritt 2: kura login (öffnet Browser → OAuth Flow)\n- Schritt 3: \"Erstelle einen API Key\" → Link zu /settings#api-keys\n- Schritt 4: Agent-spezifische Config (CLAUDE.md snippet, ChatGPT tool config, etc.)\n- Alle Werte mit Copy-Button\n\n### MCP-Tab (aktuell \"Coming Soon\", vorbereiten)\n- Wenn MCP Server noch nicht live: \"Coming Soon\" mit Erklärung was MCP ist\n- Wenn MCP Server live: Kopierbare Felder:\n  - Server Name: \"Kura\"\n  - Server URL: https://mcp.kura.dev/mcp (oder was auch immer die URL wird)\n  - Auth: \"API Key verwenden\" → Link zu /settings#api-keys\n  - Pro-Agent Config-Snippet (Claude Desktop JSON, etc.)\n\n### Per-Agent Tabs\n- Claude (Code + Desktop): CLAUDE.md snippet + Desktop MCP config\n- ChatGPT: Custom GPT tool configuration\n- Other: Generische REST API docs\n\n## Abhängigkeit\n- Blocked by: API Key Management (kura-training-cj0) — User muss Keys erstellen können\n  bevor die Setup-Seite sinnvoll ist\n\n## Akzeptanzkriterien\n- Jeder Config-Wert hat einen Copy-Button\n- CLI-Guide verweist auf Settings für Key-Erstellung\n- MCP-Guide zeigt entweder \"Coming Soon\" oder echte Config\n- Agent-spezifische Snippets sind korrekt und vollständig","notes":"Completed 2026-02-13: setup now enforces auth, first-login routing sends users to setup, CLI API-key step links to /settings#api-keys (no admin command), all CLI/MCP values include copy buttons, and MCP section is prepped with generated per-agent snippets plus coming-soon vs live endpoint mode via NEXT_PUBLIC_KURA_MCP_URL.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:35:27.005775+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:30:40.056417+01:00","closed_at":"2026-02-13T19:30:20.788266+01:00","close_reason":"Setup flow hardened: auth-gated /setup, first-login routing to setup, CLI key creation path now points to /settings#api-keys, copy buttons added across CLI + MCP setup values, and MCP UI now supports coming-soon vs configured endpoint with generated per-agent snippets (NEXT_PUBLIC_KURA_MCP_URL).","dependencies":[{"issue_id":"kura-training-4z2","depends_on_id":"kura-training-cj0","type":"blocks","created_at":"2026-02-13T14:35:35.219332+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-56jn","title":"Phase 4 jump: trial-distribution jump capability estimator with device/surface comparability","description":"WHY:\nJump performance is noisy across attempts and devices; best-trial-only logic overstates certainty and hides measurement bias.\n\nHOW:\nImplement a jump estimator using trial distributions and device/surface comparability:\n- ingest attempt-level observations (height/contact_time where available)\n- model within-session variance and device-specific error assumptions\n- produce latent jump capability estimate with uncertainty band\n- require protocol metadata for cross-session comparability.\n\nIMPLEMENTATION TASKS:\n1) Add jump trial normalization and variance estimation.\n2) Define device/surface comparability policy.\n3) Implement latent-state aggregation across sessions.\n4) Add replay evaluation and caveat emission for thin/noisy data.\n\nACCEPTANCE:\n- Jump output is uncertainty-first and machine-readable.\n- Device/surface mismatch produces degraded comparability status.\n- Tests cover trial-distribution behavior and insufficiency semantics.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:37:38.991671+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:35.147804+01:00","closed_at":"2026-02-20T19:28:35.147804+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo).","dependencies":[{"issue_id":"kura-training-56jn","depends_on_id":"kura-training-pp5m","type":"blocks","created_at":"2026-02-20T18:40:32.545444+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-57d","title":"Data Integrity: Event Conventions für Korrekturen","description":"Event Conventions für event.retracted und Null-Semantik in profile.updated definieren und in event_conventions.py aufnehmen.\n\nevent.retracted: Universelles Retraction-Pattern — ein Event-Typ für alle Korrekturen. Felder: retracted_event_id (required), reason (optional). Retraction ist bewusst getrennt von Correction, weil es handler-agnostisch funktioniert.\n\nprofile.updated Null-Semantik: Explizit dokumentieren, dass null-Werte 'Feld entfernen' bedeuten. Ist implizit schon so, muss aber in den Conventions stehen damit der Agent es weiß.\n\nDesignentscheidung: Nur event.retracted, KEIN *.corrected Pattern. Retraction + neues Event ist sauberer als Delta-Corrections, weil: (a) kein Handler typ-spezifische Correction-Logik braucht, (b) idempotent, (c) auditierbar. Correction wäre Overengineering.\n\nLiefert: Erweiterte event_conventions in system_config, die der Agent beim Session-Start liest.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:23.33533+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T15:49:56.795669+01:00","closed_at":"2026-02-09T15:49:56.795669+01:00","close_reason":"event.retracted convention + profile.updated null_semantics + data_correction convention in system_config. 6 new tests (210 total). No handler changes — those are dru + k71."}
{"id":"kura-training-59r","title":"Legal: Gesundheitsdaten (Art. 9 DSGVO) sauber absichern","description":"Fuehre ein Art.-9-konformes Schutzkonzept fuer trainings- und gesundheitsnahe Daten ein: explizite Einwilligung, Zweckbindung, Widerrufspfad, Datenminimierung, rollenbasierte Zugriffstrennung, Auditierung und klare UI-Texte. Pruefe, welche Daten als besondere Kategorien einzustufen sind und welche Verarbeitungen auf Einwilligung beruhen muessen.","acceptance_criteria":"- Datenklassifikation mit Art.-9-Bewertung vorhanden\\n- Einwilligungs-/Widerrufsflow in UI + API spezifiziert\\n- Zugriffskontrollen und Auditanforderungen umgesetzt oder geplant\\n- Datenschutzhinweise enthalten expliziten Art.-9-Abschnitt","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T18:22:44.142567+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T18:49:35.917433+01:00","closed_at":"2026-02-16T18:49:35.917433+01:00","close_reason":"Implemented explicit Art. 9 health-data consent at signup, account consent management endpoint, and consent enforcement for health-related event writes."}
{"id":"kura-training-5ez","title":"Security Hardening v1 (Chat-first, low-UX-friction)","description":"## Why\nKura ist chat-first und agent-zentriert. Missbrauch bei Registrierung und Agent-Write-Pfaden kann sowohl lokale Datenqualität als auch indirekt globale Lernpipelines beeinflussen. Das Ziel ist, Abuse-Risiko und Prompt-Injection-Einfluss deutlich zu reduzieren, ohne den normalen Chat-Flow für legitime Nutzer spürbar zu verschlechtern.\n\n## What (Outcome)\nEin abgestuftes Security-Hardening für Registrierung, adaptive Abuse-Erkennung und globale Lernpipeline-Resilienz mit minimaler UX-Reibung. Sicherheitsmaßnahmen priorisieren reversible, risikobasierte Eingriffe statt pauschaler Feature-Sperren.\n\n## How\n1) Registrierung: Invite-/Identity-Härtung und verifizierbare Signale vor voller Aktivierung.\n2) Adaptive Abuse: robuste small-n-resistente Signale, klarere Schwellwerte für Block vs. Throttle.\n3) Prompt-Injection-/Data-Influence-Resilienz: untrusted Input darf nicht instruktionswirksam werden; globale Aggregation bekommt per-user dominance guards.\n4) Executable Specs: neue/angepasste Architektur- und Runtime-Tests sichern Invarianten dauerhaft.\n\n## Non-Goals\n- Kein Captcha-zentrierter UI-Flow.\n- Keine pauschale Probation, die Kernfunktionen neuer Nutzer deaktiviert.\n- Keine schwergewichtige manuelle Review-Pflicht für alltägliche Chat-Nutzung.\n\n## Recovery Notes\nWenn Kontext verloren geht, zuerst diese Reihenfolge verfolgen:\n1) Auth-Härtung implementieren und testen.\n2) Adaptive-Abuse-Signalhärtung implementieren und testen.\n3) Cross-user influence guards + Architekturtests abschließen.\n4) Quality Gates und Push.\n","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-15T12:23:47.601665+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T12:32:20.063935+01:00","closed_at":"2026-02-15T12:32:20.063935+01:00","close_reason":"Closed","labels":["abuse","architecture","auth","prompt-injection","security"]}
{"id":"kura-training-5ez.1","title":"Auth: Invite-bound registration hardening","description":"## Why\nBot- oder Wegwerf-Registrierungen sind der billigste Angriffsvektor. Wenn die Eingangskontrolle schwach ist, wandert Last und Datenmüll ins gesamte System.\n\n## Scope\n- Registrierung im Invite-Modus härten.\n- Invite-Token gegen registrierte Email validieren (wenn Invite-Email vorhanden).\n- Optionaler/fehlender Nachweis darf nicht zu stiller Vollaktivierung führen.\n\n## Implementation Plan\n1) Auth-Register-Flow anpassen: Invite-Bindung prüfen.\n2) Klare Fehlermeldungen für legitime Nutzer (UX-schonend).\n3) Tests für positive/negative Fälle ergänzen.\n\n## Acceptance\n- Invite-only Registrierung bleibt möglich.\n- Mismatch zwischen Invite-Email und Signup-Email wird verlässlich blockiert.\n- Regressionstests decken Allow/Reject-Pfade ab.\n\n## Recovery Notes\nBei Kontextverlust: zuerst `api/src/routes/auth.rs` und Invite-Validierung prüfen, dann Testmodule unter `api/src/routes/auth.rs` erweitern.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T12:23:58.276002+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T12:32:19.455112+01:00","closed_at":"2026-02-15T12:32:19.455112+01:00","close_reason":"Closed","labels":["auth","security","signup"],"dependencies":[{"issue_id":"kura-training-5ez.1","depends_on_id":"kura-training-5ez","type":"parent-child","created_at":"2026-02-15T12:23:58.276726+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5ez.2","title":"Adaptive abuse: small-n robust scoring + safer block thresholds","description":"## Why\nDas aktuelle denied-ratio Signal ist bei kleinem n empfindlich. Das erzeugt unnötige Throttle/Blocks für legitime Nutzungsmuster (z. B. token expiry/retries).\n\n## Scope\n- small-n-resistente denied-ratio Bewertung im adaptive abuse middleware.\n- Schärfere Trennung von Throttle vs. Block (hohe Sicherheit für Block).\n- Signale/Telemetry so erweitern, dass False-Positive-Analyse einfacher wird.\n\n## Implementation Plan\n1) Smoothing und Mindestvolumen für harte Aktionen ergänzen.\n2) 401/403/404 differenziert bewerten, um triviale 404 nicht zu übergewichten.\n3) Unit-Tests für Abuse-Scoring und Cooldown-Verhalten ergänzen/aktualisieren.\n\n## Acceptance\n- Bei n=10 und moderater Fehlerrate keine unnötigen Blocks.\n- Klare Bedingungen für Block bleiben bestehen (hohe Last + konsistente Risk-Signale).\n- Tests decken small-n und high-confidence-abuse Szenarien ab.\n\n## Recovery Notes\nBei Kontextverlust: `api/src/middleware/adaptive_abuse.rs` (Signaldefinition, evaluate_abuse_risk, apply_cooldown_policy + Tests) als Single Source of Truth verwenden.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T12:24:06.447169+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T12:32:19.605439+01:00","closed_at":"2026-02-15T12:32:19.605439+01:00","close_reason":"Closed","labels":["abuse","security","ux"],"dependencies":[{"issue_id":"kura-training-5ez.2","depends_on_id":"kura-training-5ez","type":"parent-child","created_at":"2026-02-15T12:24:06.447848+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5ez.3","title":"Cross-user learning: anti-dominance guards (no feature probation)","description":"## Why\nEin einzelner Account sollte globale Lernartefakte nicht dominieren können. Cross-user Pipelines müssen robust gegen Sybil/Spam-Einflüsse sein, ohne normale User-Features zu sperren.\n\n## Scope\n- Dominance-Guards für cross-user Pipelines (learning clustering / unknown-dimension mining).\n- Per-user contribution caps pro Cluster/Proposal-Run.\n- Keine Produkt-Feature-Sperre im Chat-Flow.\n\n## Implementation Plan\n1) Aggregation so begrenzen, dass pro pseudonymized user nur begrenzter Beitrag zählt.\n2) Schwellen in bestehenden min_support/min_unique_users Logik sauber integrieren.\n3) Tests für deterministisches Verhalten und Anti-Dominanz ergänzen.\n\n## Acceptance\n- Ein Account kann Cluster-/Proposal-Score nicht durch Volumen alleine dominieren.\n- min_unique_users bleibt wirksam; Determinismus bleibt erhalten.\n- Bestehende legitime Cross-user-Signale bleiben verwertbar.\n\n## Recovery Notes\nBei Kontextverlust: `workers/src/kura_workers/issue_clustering.py` und `workers/src/kura_workers/unknown_dimension_mining.py` zuerst lesen; dort die Cross-user-Aggregationslogik anpassen.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T12:24:15.544528+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T12:32:19.759166+01:00","closed_at":"2026-02-15T12:32:19.759166+01:00","close_reason":"Closed","labels":["learning","security","workers"],"dependencies":[{"issue_id":"kura-training-5ez.3","depends_on_id":"kura-training-5ez","type":"parent-child","created_at":"2026-02-15T12:24:15.545198+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5ez.4","title":"Executable specs: architecture contracts for security hardening","description":"## Why\nArchitekturentscheidungen sollen als executable specs bestehen bleiben, damit Kontextverlust/Teamwechsel nicht zu stillen Regressionen führt.\n\n## Scope\n- Neue Architektur-Spec-Tests in `tests/architecture/` für Auth-Härtung, Abuse-Härtung und Cross-user-Guards.\n- Runtime-Kontrakt-Tests ergänzen, wo Invarianten im Rust/Python Runtime-Code abgesichert werden.\n\n## Implementation Plan\n1) `tests/architecture/` um Kontraktfälle erweitern.\n2) Falls notwendig Runtime-Tests in `api`/`workers` ergänzen und in Architekturtests referenzieren.\n3) Quality Gates vollständig ausführen.\n\n## Acceptance\n- Architekturtests schlagen fehl, wenn die neuen Sicherheitsinvarianten verletzt werden.\n- Runtime-Tests decken kritische Entscheidungslogik ab.\n- Vollständige Quality Gates grün oder mit explizit dokumentierter technischer Blockade.\n\n## Recovery Notes\nBei Kontextverlust: zuerst neue Tests in `tests/architecture/` ansehen; diese definieren die finalen Invarianten und verweisen auf Runtime-Testnamen.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T12:24:23.651761+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T12:32:19.911797+01:00","closed_at":"2026-02-15T12:32:19.911797+01:00","close_reason":"Closed","labels":["architecture","security","tests"],"dependencies":[{"issue_id":"kura-training-5ez.4","depends_on_id":"kura-training-5ez","type":"parent-child","created_at":"2026-02-15T12:24:23.652498+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ez.4","depends_on_id":"kura-training-5ez.1","type":"blocks","created_at":"2026-02-15T12:24:29.310187+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ez.4","depends_on_id":"kura-training-5ez.2","type":"blocks","created_at":"2026-02-15T12:24:29.451616+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ez.4","depends_on_id":"kura-training-5ez.3","type":"blocks","created_at":"2026-02-15T12:24:29.60098+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5g4","title":"OAuth hardening: add DB-backed tests for unknown/inactive clients","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T07:42:56.57877+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T07:52:30.964615+01:00","closed_at":"2026-02-11T07:52:30.964615+01:00","close_reason":"DB-backed OAuth client validation tests added (unknown + inactive client) in api auth route; cargo test passes"}
{"id":"kura-training-5gxn","title":"Configurable Retrieval-FSM thresholds via runtime config","description":"Warum: FSM-Grenzwerte sind aktuell hart codiert. Für Betriebs-Tuning (verschiedene Nutzerlasten, Agent-Verhalten) brauchen wir Anpassbarkeit ohne Code-Deploy.\\n\\nWie: mcp-runtime liest Retrieval-FSM-Thresholds aus Runtime-Config (Env), verwendet sichere Defaults+Bounds und zeigt die aktive Konfiguration in Observability/Status.","design":"Einführung von KURA_MCP_RETRIEVAL_FSM_WINDOW_SECS, KURA_MCP_RETRIEVAL_FSM_MAX_RELOADS, KURA_MCP_RETRIEVAL_FSM_MAX_REPEAT_SIGNATURE_STREAK. Parser clampt in sichere Bereiche, FSM nutzt die geladene Policy, Tests pinnen Parser- und Contract-Verhalten. Executable architecture spec wird erweitert.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T11:08:30.600432+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T11:13:51.744777+01:00","closed_at":"2026-02-19T11:13:51.744777+01:00","close_reason":"Made retrieval FSM thresholds runtime-configurable via env policy loader with safe bounds, surfaced configured policy in observability/status, and added parser + architecture contract tests."}
{"id":"kura-training-5hc","title":"Collaboration UX V1: Intent Handshake, Challenge Mode, Trace Digest, Memory Tiers","description":"Warum:\nKura ist bereits stark bei Safety, Verification und Agent-Contracts. Für die Zusammenarbeit Mensch\u003c-\u003eAgent fehlen aber drei Dinge: expliziter Zielabgleich vor riskanten Aktionen, transparent nachvollziehbare Vertrauensspur pro Aktion, und ein klarer anti-sycophancy Modus.\n\nProduktrealität (wichtig):\n- Kura ist agent-first und hat keine User-UI für Settings.\n- Alles Nutzerverhalten wird im Chat gesteuert.\n- Backend liefert die maschinenlesbare Wahrheit, der Agent macht sie im Chat sichtbar.\n\nWas:\nDieses Epic liefert eine chat-first Collaboration-Schicht über dem bestehenden write-with-proof/autonomy/reliability Fundament:\n1) Intent Handshake\n2) Trace Digest\n3) Challenge Mode (default=auto, chat-toggle)\n4) Memory Tier Contract\n5) Post-Task Reflection\n\nArchitekturregel laut AGENTS.md:\nNeue Entscheidungen nicht als neue docs/design/*.md dokumentieren. Das \"Warum\" bleibt in Beads, das \"Was muss gelten\" wird als ausführbare Spezifikation in tests/architecture/ umgesetzt.","design":"Autorisierte Implementierungsreihenfolge (verbindlich):\n0. kura-training-5hc.6 -\u003e tests/architecture Harness bootstrap\n1. kura-training-5hc.1 -\u003e Intent Handshake Contract\n2. kura-training-5hc.2 -\u003e Trace Digest Contract\n3. kura-training-5hc.3 -\u003e Challenge Mode Contract (chat-only activation)\n4. kura-training-5hc.4 -\u003e Memory Tier Contract\n5. kura-training-5hc.5 -\u003e Post-Task Reflection + learning integration\n\nLeitplanken:\n- Keine UI-Annahmen in den Contracts.\n- Challenge-Mode Steuerung ausschließlich über Chat + persistierte Preference-Events.\n- Trace Digest wird im Backend erzeugt; Agent muss ihn im Chat kompakt/explainable darstellen.\n- Alle Contracts versioniert, deterministisch, maschinenlesbar.","acceptance_criteria":"1) Für alle Teilbereiche existieren ausführbare Invarianten in tests/architecture/.\n2) Kein neues Design-Dokument unter docs/design/ für diese Entscheidungen.\n3) Runtime-Verhalten ist via API/Worker-Tests abgesichert und deterministisch.\n4) Bestehende Sicherheitsgrenzen (workflow_gate, claim_guard, autonomy_gate) bleiben unverletzt.\n5) Challenge Mode ist chat-only steuerbar und standardmäßig auto.\n6) Trace Digest ist backendseitig erzeugt und vom Agenten im Chat nutzbar/explainable.\n7) Jeder Subtask enthält kompaktionssichere Recovery-Notizen (Start/Resume/Verify).","notes":"Epic completed. Subtasks closed: kura-training-5hc.6, kura-training-5hc.1, kura-training-5hc.2, kura-training-5hc.3, kura-training-5hc.4, kura-training-5hc.5.\n\nImplemented contracts end-to-end:\n- intent_handshake.v1 (high-impact pre-execution alignment)\n- trace_digest.v1 (compact provenance)\n- challenge_mode.v1 (chat-first default auto + discoverability)\n- memory_tier_contract.v1 (tier/freshness + high-impact confirm-first guard)\n- post_task_reflection.v1 (delivery certainty + next-step loop)\n\nExecutable architecture specs are in tests/architecture and wired into existing quality gates via workers/tests/test_architecture_specs.py.\n\nVerification summary:\n- ruff check workers/src/ workers/tests/ -\u003e passed\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py -\u003e 585 passed, 135 skipped\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q -\u003e 84 passed\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- cargo test --workspace -\u003e passed\n\nNo new docs/design/*.md created.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:48:11.571397+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:40:29.35021+01:00","closed_at":"2026-02-13T19:40:29.350214+01:00","labels":["agent-first","collaboration","reliability"]}
{"id":"kura-training-5hc.1","title":"Intent Handshake Contract V1 (pre-execution alignment)","description":"Warum:\nVor nicht-trivialen Agent-Aktionen fehlt ein verbindlicher Zielabgleich. Das führt zu unnötigen Rückfragen, riskanten Fehlwrites oder stillen Annahmen.\n\nWas:\nEin Intent-Handshake vor high-impact Aktionen. Der Agent muss vor Ausführung maschinenlesbar festhalten:\n- Ziel\n- geplante Aktion\n- Annahmen\n- Nicht-Ziele\n- Risiko-/Impact-Klasse\n- Erfolgskriterium\n\nChat-Realität:\nDer Handshake wird im Backend als Contract geführt, aber vom Agenten im Chat kurz angezeigt/bestätigt. Keine UI-Abhängigkeit.","design":"Contract V1:\n- versioniertes Handshake-Objekt\n- deterministische required fields\n- referenzierbar pro Write-Operation (high-impact)\n\nRuntime-Verhalten:\n- high-impact write ohne gültigen Handshake -\u003e block oder confirm-first\n- bestehende Sicherheitskette (workflow_gate/claim_guard/autonomy_gate) bleibt führend\n\nSpec-first:\n- Invarianten zuerst in tests/architecture/\n- danach API/CLI/MCP-Anpassung\n- kein neues docs/design/*.md","acceptance_criteria":"1) Handshake-Contract ist versioniert und maschinenlesbar.\n2) High-impact writes ohne Handshake werden deterministisch geblockt oder confirm-first.\n3) tests/architecture/ enthält Invarianten zu required fields, versioning und gate behavior.\n4) API-Tests: happy path, missing-field, stale/invalid handshake, mismatch.\n5) Chat-Ausgabe des Agents enthält eine kompakte Handshake-Bestätigung vor der Ausführung.","notes":"Implemented Intent Handshake Contract V1 end-to-end for high-impact writes.\n\nContract/runtime changes:\n- api/src/routes/agent.rs:\n  - Added AgentIntentHandshake + INTENT_HANDSHAKE_SCHEMA_VERSION (`intent_handshake.v1`)\n  - Added strict validation: required fields, schema version, impact_class match, staleness window\n  - Enforced handshake requirement for high-impact writes in `/v1/agent/write-with-proof`\n  - Added AgentIntentHandshakeConfirmation to response\n- cli/src/commands/mcp.rs:\n  - Added `intent_handshake` + `intent_goal` tool args\n  - Auto-generates default handshake for high-impact write_with_proof calls when omitted\n\nArchitecture/spec tests:\n- tests/architecture/test_10_intent_handshake_contract.py\n\nRuntime test coverage:\n- api/src/routes/agent.rs tests include stale handshake rejection and contract coverage\n- cargo test --workspace passed\n\nExample handshake confirmation (chat-facing):\n- \"Intent bestätigt: Ziel='...', Aktion='...', Erfolg='...'\"\n\nVerification run:\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- cargo test --workspace -\u003e passed\n- full worker/rust quality gates passed\n\nNo new docs/design/*.md created.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:48:16.806396+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:38:58.06393+01:00","closed_at":"2026-02-13T19:38:58.063934+01:00","labels":["agent-contract","collaboration"],"dependencies":[{"issue_id":"kura-training-5hc.1","depends_on_id":"kura-training-5hc","type":"parent-child","created_at":"2026-02-13T18:48:16.80728+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.1","depends_on_id":"kura-training-5hc.6","type":"blocks","created_at":"2026-02-13T19:01:45.159052+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5hc.2","title":"Trace Digest V1 (compact provenance for each agent action)","description":"Warum:\nKura liefert bei write-with-proof bereits starke Vertrauensbausteine (Receipts, Verification, Claim Guard, Workflow/Autonomy Gates), aber sie sind verteilt über mehrere Felder. Für Menschen im Chat fehlt dadurch eine einheitliche, sofort lesbare Spur pro Aktion. Das macht es unnötig schwer, schnell zu verstehen, ob ein Ergebnis wirklich gespeichert, noch pending oder nur teilweise abgesichert ist. Ein versionierter Trace Digest löst genau diese Lücke, ohne neue UI und ohne zweite Wahrheit.\n\nWas:\nFühre `trace_digest.v1` als backend-generierten, maschinenlesbaren Contract pro Agent-Aktion ein. Der Agent muss den Digest im Chat in zwei Modi verwenden: kompakte Standard-Zusammenfassung und detaillierte Belegansicht auf Nachfrage (\"warum\", \"beleg\", \"details\").\n","design":"Contract V1 (backend-generated, deterministisch):\n- schema_version\n- action_id + correlation_id\n- receipt_event_ids (stabil sortiert) + write_path\n- verification: status, required_checks, verified_checks\n- claim_guard: allow_saved_claim, claim_status, uncertainty_markers, deferred_markers\n- workflow_gate: phase, status, transition\n- autonomy_gate: decision, action_class, reason_codes\n- session_audit: status, mismatch_detected, mismatch_repaired, mismatch_unresolved\n- repair_feedback: status\n- warnings: count + normalized warning_codes\n- chat_summary_template_id (deterministische Render-Regel)\n\nChat-Contract (kein UI-Panel):\n- Nach jeder relevanten Write-Aktion muss der Agent eine kurze Digest-Zeile ausgeben.\n- Bei \"warum/beleg/details\" muss der Agent denselben Digest in detaillierter Form aufklappen.\n- Keine zweite Wahrheit: Chat-Ausgabe ist ausschließlich aus Digest-Feldern ableitbar.\n\nSpec-first Ablauf:\n1) tests/architecture/*trace_digest* zuerst (Pflichtfelder + Cross-Field-Invarianten)\n2) API-Response /v1/agent/write-with-proof um digest erweitern\n3) CLI/MCP-Parsing + Chat-Render-Regeln\n4) Optional: Digest-Event/Signal für spätere Audits\n5) Kein neues docs/design/*.md","acceptance_criteria":"1) `trace_digest.v1` ist versioniert, maschinenlesbar und Teil des write-with-proof Contracts.\n2) Pflichtfelder sind vorhanden: event_ids, verification status, claim_guard, workflow/autonomy Entscheidungen, repair/session audit Status.\n3) tests/architecture/ erzwingt Feldpflichten und Cross-Field-Invarianten (z. B. pending verification =\u003e kein saved-claim).\n4) API-Tests decken Statusmatrix ab: verified|pending|failed x clean|repaired|needs_clarification.\n5) Chat-Kurzfassung und Detailmodus sind deterministisch aus demselben Digest ableitbar und getestet.\n6) Keine UI-Annahme: Sichtbarkeit erfolgt ausschließlich über Agent-Antworten im Chat.","notes":"Implemented Trace Digest V1 as backend-generated provenance contract for each write-with-proof action.\n\nContract/runtime changes:\n- api/src/routes/agent.rs:\n  - Added AgentTraceDigest + TRACE_DIGEST_SCHEMA_VERSION (`trace_digest.v1`)\n  - Built digest deterministically from receipts/verification/claim_guard/workflow/audit/repair\n  - Added `trace_digest` to AgentWriteWithProofResponse\n  - Added chat fields: `chat_summary_template_id=trace_digest.chat.short.v1` + `chat_summary`\n\nArchitecture/spec tests:\n- tests/architecture/test_20_trace_digest_contract.py\n\nExample trace_digest.v1 payload (redacted):\n{\n  \"schema_version\": \"trace_digest.v1\",\n  \"action_id\": \"action_...\",\n  \"correlation_id\": \"corr_...\",\n  \"receipt_event_ids\": [\"...\"],\n  \"verification_status\": \"verified\",\n  \"claim_status\": \"verified\",\n  \"workflow_status\": \"allowed\",\n  \"autonomy_decision\": \"allow\",\n  \"repair_status\": \"none\",\n  \"warning_count\": 0,\n  \"chat_summary_template_id\": \"trace_digest.chat.short.v1\"\n}\n\nChat short/detail derivation:\n- short: uses `trace_digest.chat_summary`\n- detail: full `trace_digest` object fields from same source of truth (no second truth)\n\nVerification run:\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- cargo test --workspace -\u003e passed\n- full worker/rust quality gates passed\n\nNo new docs/design/*.md created.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:48:22.049456+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:39:12.506638+01:00","closed_at":"2026-02-13T19:39:12.506643+01:00","labels":["agent-contract","provenance","trust"],"dependencies":[{"issue_id":"kura-training-5hc.2","depends_on_id":"kura-training-5hc","type":"parent-child","created_at":"2026-02-13T18:48:22.050857+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.2","depends_on_id":"kura-training-5hc.1","type":"blocks","created_at":"2026-02-13T18:48:42.951833+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.2","depends_on_id":"kura-training-5hc.6","type":"blocks","created_at":"2026-02-13T19:01:50.370165+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5hc.3","title":"Challenge Mode V1 (anti-sycophancy collaboration contract)","description":"Warum:\nGute Zusammenarbeit braucht konstruktiven Widerspruch, aber nur dann, wenn er echten Mehrwert hat. Ohne klaren Modus entsteht entweder zu viel Zustimmung (Sycophancy) oder unnötige Reibung. In Kura gibt es keine UI für Settings, daher muss diese Steuerung vollständig im Chat und über persistierte Präferenzen funktionieren. Ein klarer Default (`auto`) plus expliziter Onboarding-Hinweis macht den Modus sichtbar und kontrollierbar.\n\nWas:\nImplementiere `challenge_mode.v1` als chat-gesteuerten Contract mit drei Zuständen: `auto` (Default), `on`, `off`. Der Agent muss im Onboarding/Primer aktiv erwähnen, dass `auto` an ist und per Chat deaktiviert werden kann.\n","design":"Preference-Contract (Source of Truth):\n- Persistenz über `preference.set` mit key=`challenge_mode`\n- Zulässige Werte: `auto | on | off`\n- Default bei fehlender Präferenz: `auto` (kein silent fallback auf off)\n- Optionaler Intro-Marker: `challenge_mode_intro_seen=true` (oder gleichwertiger deterministischer Marker), damit die Pflicht-Erklärung nicht in jedem Turn wiederholt wird\n\nVerhaltensmatrix:\n- auto:\n  - challenge nur bei Triggern (high-impact, niedrige Sicherheit, widersprüchliche Evidenz, relevante Alternativen)\n- on:\n  - bei jeder nicht-trivialen Empfehlung mindestens 1 Risiko + 1 Alternative\n- off:\n  - keine proaktive Challenge im Normalfall; Sicherheits-/Integritätsgrenzen (workflow_gate, claim_guard, autonomy_gate) bleiben immer verpflichtend\n\nChat-only Aktivierung und Discoverability:\n- Benutzer kann im Chat umschalten, z. B.:\n  - \"challenge mode aus/off/deaktivieren\" =\u003e `off`\n  - \"challenge mode an/on\" =\u003e `on`\n  - \"challenge mode auto\" =\u003e `auto`\n- Verpflichtender Onboarding-Hinweis (einmalig pro Nutzerkontext):\n  - \"Challenge Mode ist standardmäßig auf auto aktiv. Sag 'Challenge Mode aus', wenn ich weniger challengen soll.\"\n- Keine UI-Annahme, keine UI-Settings\n\nSpec-first Ablauf:\n1) tests/architecture/*challenge_mode* (Default + Trigger + Sicherheitsgrenzen)\n2) Preference/Persistenz-Contract + Parser-Mapping\n3) Onboarding/Primer-Text + Capability/Context-Hinweis\n4) Kein neues docs/design/*.md","acceptance_criteria":"1) Wenn keine Nutzerpräferenz gesetzt ist, gilt deterministisch `challenge_mode=auto`.\n2) Onboarding/Primer enthält den Pflicht-Hinweis, dass auto aktiv ist und per Chat deaktiviert werden kann.\n3) Chat-Umschaltungen (`auto|on|off`) werden deterministisch auf persistierte Präferenzen gemappt und getestet.\n4) Tests decken Verhaltensmatrix ab: auto (trigger-basiert), on (proaktiv), off (nur sicherheitskritische Einwände).\n5) tests/architecture/ erzwingt Contract-Invarianten inklusive Default-Verhalten und Trigger-Determinismus.\n6) Keine UI-Abhängigkeit: komplette Aktivierung/Steuerung läuft im Chat.","notes":"Implemented Challenge Mode V1 as chat-first, backend contract with default `auto`.\n\nContract/runtime changes:\n- workers/src/kura_workers/system_config.py:\n  - Added `operational.challenge_mode` contract (`challenge_mode.v1`)\n  - default: auto, allowed: auto|on|off\n  - storage contract: preference.set key `challenge_mode`\n  - discoverability includes onboarding hint + intro marker key\n- workers/src/kura_workers/event_conventions.py:\n  - Added preference keys: `challenge_mode`, `challenge_mode_intro_seen`\n- workers/src/kura_workers/interview_guide.py:\n  - Added mandatory onboarding hint in collaboration primer\n- api/src/routes/agent.rs:\n  - Added challenge_mode resolution in agent context meta\n  - deterministic normalization for mode values + source tracking\n\nArchitecture/spec tests:\n- tests/architecture/test_30_challenge_mode_contract.py\n\nWorker tests:\n- workers/tests/test_system_config.py\n- workers/tests/test_interview_guide.py\n\nOnboarding hint proof:\n- \"Challenge Mode ist standardmäßig auf auto aktiv. ... 'Challenge Mode aus' ...\"\n\nChat examples (contract-level behavior):\n- auto (default): trigger-based challenge on risk/conflict/high-impact\n- on: proactive risk + alternative for non-trivial recommendations\n- off: no proactive challenge by default, safety boundaries stay active\n\nVerification run:\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- worker/rust quality gates passed\n\nNo new docs/design/*.md created.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:48:27.283974+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:39:26.995458+01:00","closed_at":"2026-02-13T19:39:26.995462+01:00","labels":["collaboration","preferences","ux"],"dependencies":[{"issue_id":"kura-training-5hc.3","depends_on_id":"kura-training-5hc","type":"parent-child","created_at":"2026-02-13T18:48:27.284893+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.3","depends_on_id":"kura-training-5hc.1","type":"blocks","created_at":"2026-02-13T18:48:48.150806+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.3","depends_on_id":"kura-training-5hc.6","type":"blocks","created_at":"2026-02-13T19:01:55.571709+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.3","depends_on_id":"kura-training-5hc.2","type":"blocks","created_at":"2026-02-13T19:10:08.653945+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5hc.4","title":"Memory Tier Contract V1 (working/project/principles + freshness rules)","description":"Warum:\nKura hat mehrere Kontextquellen (u. a. user_profile, semantic_memory, open_observations), aber derzeit keinen einheitlichen Tier-Vertrag mit klaren Freshness-Regeln. Dadurch können alte oder unsichere Annahmen zu still als verlässlich behandelt werden. Besonders bei high-impact Entscheidungen muss eindeutig sein, wie frisch und belastbar eine Gedächtnisgrundlage ist. Ein Memory-Tier-Contract macht diese Grenze maschinenlesbar und im Chat erklärbar.\n\nWas:\nDefiniere `memory_tier_contract.v1` mit den Tiers `working | project | principles` inklusive Freshness-/Confidence-Semantik und Gate-Regeln für high-impact Aktionen. Keine UI-Settings: Steuerung und Transparenz erfolgen über Contract-Felder und Chat-Erklärungen.\n","design":"Tier-Semantik (v1):\n- working: kurzlebiger, sessionsnaher Kontext\n- project: mittelfristige Ziele/Pläne und laufende Vorhaben\n- principles: langfristige Präferenzen/Leitplanken/Constraints\n\nPro Memory-Eintrag (maschinenlesbar):\n- tier\n- source (projection/event lineage)\n- confidence (0..1 oder Band)\n- observed_at / last_verified_at\n- freshness_state (`fresh|aging|stale`)\n- stale_reason (optional)\n- expires_at (optional, falls tier-abhängig)\n\nGate-Regeln:\n- High-impact write auf Basis `stale` oder unklarer Memory-Einträge =\u003e confirm_first oder block (deterministisch)\n- Widerspruch zwischen neuer expliziter User-Aussage und altem Memory =\u003e alte Grundlage als conflicted/stale markieren, nicht still weiterverwenden\n- Prinzipien-/Präferenzregeln dürfen frische explizite User-Statements nicht überschreiben\n\nChat-Contract (kein UI):\n- Agent muss auf Nachfrage Entscheidung + Memory-Herkunft in einer kurzen Form erklären können (tier + freshness + confidence)\n- Erklärtext darf nur aus den Contract-Feldern abgeleitet werden\n\nSpec-first Ablauf:\n1) tests/architecture/*memory_tier* zuerst\n2) system/agent contract Felder implementieren\n3) Runtime-Gates + fallback Verhalten\n4) Kein neues docs/design/*.md","acceptance_criteria":"1) Tier-Semantik und Freshness-Regeln sind versioniert, maschinenlesbar und im Agent-/System-Contract verfügbar.\n2) High-impact Entscheidungen dürfen stale Memory nicht still als sichere Grundlage verwenden.\n3) tests/architecture/ erzwingt Tier-Pflichten, Prioritätsregeln und Freshness-Gates.\n4) Worker/API-Tests decken expiry/demotion, conflict handling und fallback behavior ab.\n5) Agent kann Herkunft/Freshness einer Entscheidung im Chat deterministisch aus Contract-Feldern erklären.\n6) Keine UI-Abhängigkeit: Verhalten ist vollständig backend-/chat-getrieben.","notes":"Implemented Memory Tier Contract V1 with freshness semantics and high-impact stale guard.\n\nContract/runtime changes:\n- api/src/routes/agent.rs:\n  - Added AgentMemoryTierContract (`memory_tier_contract.v1`) + tier snapshots\n  - tiers: working/project/principles with freshness_state + confidence_band + source\n  - added memory_tier_contract to agent context meta\n  - added confirm-first reason codes:\n    - memory_principles_missing_confirm_first\n    - memory_principles_stale_confirm_first\n  - merged memory stale guard into autonomy gate for high-impact writes\n\nArchitecture/spec tests:\n- tests/architecture/test_40_memory_tier_contract.py\n\nRuntime tests:\n- api/src/routes/agent.rs test:\n  - memory_guard_escalates_high_impact_allow_to_confirm_first_when_preferences_missing\n\nExample memory tier snapshot (redacted):\n{\n  \"tier\": \"principles\",\n  \"freshness_state\": \"aging\",\n  \"confidence_band\": \"medium\",\n  \"source\": \"projection:user_profile/me.preferences\"\n}\n\nHigh-impact stale gating behavior:\n- high-impact + missing/stale principles context =\u003e autonomy decision escalates to `confirm_first`\n\nVerification run:\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- cargo test --workspace -\u003e passed\n- worker/rust quality gates passed\n\nNo new docs/design/*.md created.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:48:32.513862+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:39:40.609548+01:00","closed_at":"2026-02-13T19:39:40.609551+01:00","labels":["agent-contract","memory","reliability"],"dependencies":[{"issue_id":"kura-training-5hc.4","depends_on_id":"kura-training-5hc","type":"parent-child","created_at":"2026-02-13T18:48:32.514785+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.4","depends_on_id":"kura-training-5hc.1","type":"blocks","created_at":"2026-02-13T18:48:53.368336+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.4","depends_on_id":"kura-training-5hc.6","type":"blocks","created_at":"2026-02-13T19:02:00.772964+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.4","depends_on_id":"kura-training-5hc.3","type":"blocks","created_at":"2026-02-13T19:10:13.893088+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5hc.5","title":"Post-Task Reflection Contract V1 (delivery quality loop)","description":"Warum:\nNach einer Agent-Aktion fehlt heute ein verpflichtender Abschlussvertrag, der klar trennt zwischen \"gesichert\", \"unsicher\" und \"als nächstes zu prüfen\". Dadurch gehen Restrisiken leicht unter und der Mensch muss nachfragen, obwohl die Informationen intern schon vorhanden sind. Das bremst die Zusammenarbeit und schwächt den Learning-Loop. Ein Post-Task Reflection Contract macht den Abschluss jeder relevanten Aktion konsistent, prüfbar und im Chat sofort nutzbar.\n\nWas:\nFühre `post_task_reflection.v1` als maschinenlesbaren, chat-first Abschluss-Contract ein: Was wurde geändert, was bleibt riskant/offen, was ist der nächste Verifikationsschritt. Reflection-Signale sollen in die bestehende Learning-Telemetrie integriert werden.\n","design":"Contract V1 (deterministisch):\n- schema_version\n- action_id / related_trace_digest_id\n- change_summary (was wurde geschrieben/geändert, inkl. event_id Referenzen)\n- certainty_state (`confirmed|partial|unresolved`)\n- residual_risks[] (klar benannt)\n- next_verification_step (konkret + ausführbar)\n- clarification_question (optional, wenn unresolved)\n- follow_up_recommended (bool + reason)\n- emitted_learning_signal_types[]\n\nChat-Contract (kein UI):\n- Nach jeder relevanten Task-Ausführung liefert der Agent eine kurze Reflection-Zeile.\n- Wenn certainty_state != confirmed, muss die Antwort einen konkreten nächsten Verifikationsschritt (oder eine fokussierte Klärungsfrage) enthalten.\n- Reflection-Text darf nur aus Reflection/Digest-Contractfeldern abgeleitet werden.\n\nLearning-Integration:\n- Reflection erzeugt/erweitert standardisierte Lernsignale für Qualität und Friktion.\n- Signal-Mapping bleibt deterministisch und testbar (kein freies Heuristik-Logging).\n\nSpec-first Ablauf:\n1) tests/architecture/*post_task_reflection* zuerst\n2) API/Runtime Contract + Response Felder\n3) Learning-Telemetrie + Backlog-Bridge Mapping\n4) Kein neues docs/design/*.md","acceptance_criteria":"1) `post_task_reflection.v1` ist versioniert, maschinenlesbar und pro relevanter Agent-Aktion verfügbar.\n2) Reflection enthält immer change_summary + certainty_state + residual_risk/next_verification (oder klare Begründung, warum nicht nötig).\n3) Wenn certainty_state `partial` oder `unresolved` ist, ist ein konkreter nächster Verifikationsschritt oder eine gezielte Klärungsfrage verpflichtend.\n4) tests/architecture/ erzwingt Pflichtfelder und Invarianten, inklusive Konsistenz zum Trace-Digest.\n5) Learning-Telemetrie- und Backlog-Bridge-Tests decken Reflection-Signal-Mapping ab.\n6) Chat-Ausgabe ist deterministisch aus Reflection-Contract ableitbar und UI-unabhängig.","notes":"Implemented Post-Task Reflection Contract V1 and integrated deterministic reflection learning signals.\n\nContract/runtime changes:\n- api/src/routes/agent.rs:\n  - Added AgentPostTaskReflection (`post_task_reflection.v1`)\n  - Added `post_task_reflection` to write-with-proof response\n  - Deterministic certainty mapping: confirmed|partial|unresolved from verification + session/repair status\n  - Enforced next step generation for non-confirmed states\n  - Added reflection signal emission (`post_task_reflection_*`)\n- workers/src/kura_workers/learning_telemetry.py:\n  - Added taxonomy entries:\n    - post_task_reflection_confirmed -\u003e outcome_signal\n    - post_task_reflection_partial -\u003e friction_signal\n    - post_task_reflection_unresolved -\u003e friction_signal\n\nArchitecture/spec tests:\n- tests/architecture/test_50_post_task_reflection_contract.py\n\nWorker/API tests:\n- workers/tests/test_learning_telemetry.py\n- api/src/routes/agent.rs reflection/trace tests\n\nExample reflection object (redacted):\n{\n  \"schema_version\": \"post_task_reflection.v1\",\n  \"action_id\": \"action_...\",\n  \"related_trace_digest_id\": \"action_...\",\n  \"certainty_state\": \"partial\",\n  \"residual_risks\": [\"read_after_write_not_fully_verified\"],\n  \"next_verification_step\": \"retry_read_after_write_with_same_idempotency_keys\"\n}\n\nChat reflection examples:\n- confirmed: \"Reflection: certainty=confirmed, next_step=none\"\n- unresolved: \"Reflection: certainty=unresolved, next_step=verification_or_clarification\"\n\nVerification run:\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- cargo test --workspace -\u003e passed\n- worker/rust quality gates passed\n\nNo new docs/design/*.md created.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:48:37.749404+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:39:59.014594+01:00","closed_at":"2026-02-13T19:39:59.014598+01:00","labels":["collaboration","learning-loop","quality"],"dependencies":[{"issue_id":"kura-training-5hc.5","depends_on_id":"kura-training-5hc","type":"parent-child","created_at":"2026-02-13T18:48:37.750516+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.5","depends_on_id":"kura-training-5hc.2","type":"blocks","created_at":"2026-02-13T18:48:58.573989+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.5","depends_on_id":"kura-training-5hc.3","type":"blocks","created_at":"2026-02-13T18:49:03.777865+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.5","depends_on_id":"kura-training-5hc.6","type":"blocks","created_at":"2026-02-13T19:02:05.971669+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.5","depends_on_id":"kura-training-5hc.4","type":"blocks","created_at":"2026-02-13T19:10:19.120627+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5hc.6","title":"Architecture Spec Harness Bootstrap (tests/architecture as executable source of truth)","description":"Warum:\nGemäß AGENTS.md müssen neue Architekturentscheidungen als ausführbare Tests in tests/architecture/ abgesichert werden. Ohne Harness besteht Risiko, dass 5hc.1-5hc.5 inkonsistent oder nicht CI-verbindlich werden.\n\nWas:\nBaue den minimalen, CI-fähigen Architekturtest-Harness für tests/architecture/ als verbindliche Grundlage für alle weiteren Collaboration-Contracts.","design":"Scope:\n- tests/architecture/ Struktur + Naming-Konvention\n- ausführbarer Runner lokal + in CI\n- ein erster Smoke-Spec-Test als Referenzmuster\n- keine neue docs/design/*.md\n\nHinweis zur Polyglot-Repo-Struktur:\nHarness darf Rust/API- und Worker-seitige Invarianten integrieren, solange Ausführung reproduzierbar und deterministisch bleibt.","acceptance_criteria":"1) tests/architecture/ existiert mit lauffähigem Test-Entry.\n2) Runner ist in CI/Quality-Gate integriert.\n3) Ein Smoke-Architecture-Test beweist End-to-End-Ausführung.\n4) Bead-Notes enthalten genaue lokalen Befehle für den Architekturtest-Lauf.","notes":"Implemented executable architecture-spec harness and CI gate wiring.\n\nNew architecture test paths:\n- tests/architecture/conftest.py\n- tests/architecture/test_00_harness_smoke.py\n- tests/architecture/test_10_intent_handshake_contract.py\n- tests/architecture/test_20_trace_digest_contract.py\n- tests/architecture/test_30_challenge_mode_contract.py\n- tests/architecture/test_40_memory_tier_contract.py\n- tests/architecture/test_50_post_task_reflection_contract.py\n\nGate/CI hook:\n- workers/tests/test_architecture_specs.py (executes `pytest -q tests/architecture` inside existing worker pytest gate)\n- scripts/run-architecture-tests.sh for direct local run\n\nVerification run:\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_architecture_specs.py -q -\u003e pass (included in full worker suite)\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py -\u003e 585 passed, 135 skipped\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q -\u003e 84 passed\n- cargo test --workspace -\u003e passed\n- ruff check workers/src/ workers/tests/ -\u003e passed\n\nNo new docs/design/*.md created.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T19:01:39.960019+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:38:42.482385+01:00","closed_at":"2026-02-13T19:38:42.482388+01:00","labels":["architecture-tests","ci","collaboration"],"dependencies":[{"issue_id":"kura-training-5hc.6","depends_on_id":"kura-training-5hc","type":"parent-child","created_at":"2026-02-13T19:01:39.961233+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5lkb","title":"Retrieval-FSM + Observability + Replay Contracts","description":"Warum: Trotz budgetierter Context-Slices kann der Agent bei Reload-Schleifen (gleicher Cursor, gleiche Abfrage, zu viele Nachladeversuche) in Sackgassen laufen. Ohne Laufzeitbeobachtung bleiben diese Fehlerbilder unsichtbar und schwer debugbar.\\n\\nWie: MCP-Runtime bekommt einen Retrieval-FSM mit Loop-Guard, Max-Reloads und klaren Stop-Reasons. Zusätzlich werden Observability-Kennzahlen und Replay/Golden-Tests eingeführt, damit Verhalten deterministisch überprüfbar und regressionssicher bleibt.","design":"Scope-Entscheidung: (1) Retrieval-FSM für context/projection/system-reloads in mcp-runtime, (2) session-basierte Observability-Signale (overflow-rate, reload-depth, context-hit-rate, abort-reasons), (3) replaybare Workflow-Tests plus ausführbare Architecture-Specs. Keine stillen Abbrüche; jeder Guard-Abbruch liefert maschinenlesbare Gründe und Recover-Hinweise.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-19T10:56:12.129176+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T11:03:38.340127+01:00","closed_at":"2026-02-19T11:03:38.340127+01:00","close_reason":"Delivered retrieval FSM safeguards, observability, replay tests, and architecture contracts to reduce dead-end loops and improve runtime debuggability."}
{"id":"kura-training-5mb0","title":"Add compatibility extractor for agent metrics across projection schema variants","description":"Agent feedback showed false regressions (frequency=0, profile empty) although prod projections contain valid values (current_frequency.last_4_weeks=1.25, user.profile present, goals count=3, readiness_today present). Root cause is likely consumer-side parsing assumptions on old key paths or conflation of plan sessions with actual training frequency. Implement a compatibility extractor in agent-context consumer path that reads canonical fields from current schemas and falls back to legacy aliases. Expose explicit labels for 'actual frequency' vs 'planned sessions/week' to prevent semantic mix-ups.","acceptance_criteria":"1) Compatibility extractor resolves frequency/profile/readiness across schema variants. 2) Output clearly separates actual vs planned metrics. 3) No false 'empty profile' when user.profile exists. 4) Add tests with current and legacy-shaped fixtures.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T23:17:06.311784+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T23:34:02.529223+01:00","closed_at":"2026-02-20T23:34:02.529223+01:00","close_reason":"Added cross-schema metric compatibility snapshot in agent context + MCP runtime with current/legacy fallback tests.","labels":["agent-context","compatibility","mcp"]}
{"id":"kura-training-5si","title":"Decision 13 F7: Robust Integrity Throttling Calibration (Bayesian + Legacy Guardrails)","description":"## Entscheidungszusammenfassung (Warum)\n\nProd-Daten von Fred (Stand 2026-02-14) zeigen ein reales Kalibrierungsproblem: `save_claim_mismatch_rate_pct=33.33` bei nur `2/6` Samples triggert `integrity_slo_status=degraded` und strict throttling. Beide Mismatch-Faelle sind `verification_status=pending` mit `read_after_write_unverified` und nicht offensichtliche Datenkorruption. Gleichzeitig bleibt `INV-004 onboarding_phase_violation` offen, weil historische Planning-Events vor der finalen Onboarding-Gate-Einfuehrung geloggt wurden. Ergebnis: Guards sind grundsaetzlich sinnvoll, aber aktuell nicht robust genug fuer kleine Stichproben, Legacy-Kontext und wiederholte Recompute-Signale.\n\n## Zielbild (Was muss gelten)\n\n1. Integrity-Throttling soll robust gegen Small-Sample-Rauschen sein (Posterior-Risiko statt harte Punktquote).\n2. Protokoll-Friktion und echte Datenintegritaet sollen getrennt gemessen und nur risikoangemessen fuer Autonomie-Gates verwendet werden.\n3. Legacy-Ereignisse ohne neue Severity-Felder muessen deterministisch kompatibel ausgewertet werden.\n4. INV-004 muss zukunftssicher bleiben, aber Legacy-Onboarding-Sequenzen duerfen nicht dauerhaft als aktive Integritaetsverletzung laufen.\n5. Wiederholte identische `quality_issue_detected`-Signale duerfen Lernen/Monitoring nicht aufblaehen (dedupe/cooldown).\n\n## Umsetzung als Dependency-Chain (Wie)\n\n- `kura-training-5si.1`: Policy-/Formel-Spec fixieren (inkl. Warum und Entscheidungsgrenzen).\n- `kura-training-5si.2`: Executable Specs in `tests/architecture/` fuer die neuen Invarianten.\n- `kura-training-5si.3`: API-Contract haerten (Severity/Weight/Domain/Reason-Codes, Legacy-safe).\n- `kura-training-5si.4`: Worker-SLO auf Bayesian/robuste Risikologik + Split protocol vs integrity.\n- `kura-training-5si.5`: INV-004 Legacy-Grandfathering + expliziter Migrationspfad.\n- `kura-training-5si.6`: Dedupe/Cooldown fuer wiederholte Quality-Issue-Signale.\n- `kura-training-5si.7`: Replay/Kalibrierung gegen Fred-Daten und End-to-End-Verifikation.\n\n## Compaction-Rescue (wenn Kontext verloren geht)\n\n1. `scripts/bd-safe.sh prime`\n2. `scripts/bd-safe.sh show kura-training-5si`\n3. `scripts/bd-safe.sh show kura-training-5si.1`\n4. Danach strikt entlang Dependencies arbeiten; keine Implementierung vor den Architecture-Spec-Tests.\n","design":"Issue-chain nach AGENTS.md: Warum im Bead, Was-gilt in tests/architecture. Keine separaten Design-Dokumente fuer neue Entscheidungen.","acceptance_criteria":"Alle Child-Tasks mit Dependencies und Compaction-Rescue-Text vorhanden; Umsetzung erst nach gruenen Architecture-Specs.","notes":"Recovery anchor: zuerst 5si.1 (Spec), dann 5si.2 (Architecture specs), dann 5si.3/5si.4/5si.5/5si.6 parallelisierbar gemaess Dep-Graph, Abschluss in 5si.7.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-14T15:34:24.700749+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T15:52:38.1581+01:00","closed_at":"2026-02-14T15:52:38.1581+01:00","close_reason":"F7 umgesetzt: robuste Integrity-Throttling-Kalibrierung inkl. Tests","labels":["agent-runtime","architecture","integrity-slo","quality-health"]}
{"id":"kura-training-5si.1","title":"Spec: Robust Save-Claim Scoring + Throttle Semantics (Warum/Wie freeze)","description":"## Entscheidungszusammenfassung (Warum)\n\nDie bestehende SLO-Logik reagiert bei kleinen Samples zu hart: 2 Pending-Faelle in 6 Checks fuehren bereits zu degraded, obwohl der Kontext eher Readback-Friktion als Integritaetsbruch zeigt. Gleichzeitig koennen Legacy-Events ohne `mismatch_severity` den Fortschritt der Severity-Umstellung aushebeln, weil sie als binar-kritisch zaehlen. Diese Spec kalibriert die Entscheidung auf Risiko statt auf rohe Zaehler und trennt signaltechnisch zwischen Integritaet und Protokoll-Reibung. Ziel ist weniger False-Positive-Throttling bei unveraendert hoher Schutzwirkung gegen echte Dateninkonsistenz.\n\n## Was muss gelten (Policy Contract)\n\n1. Save-Claim-Risiko basiert auf posteriorer Wahrscheinlichkeit statt punktueller Quote.\n2. Eingangssignal ist gewichteter Mismatch (`mismatch_weight`), nicht nur bool.\n3. Legacy-Ereignisse ohne Severity erhalten explizite, deterministische Fallback-Klassifikation.\n4. Autonomie-Throttle richtet sich primaer nach Integritaetsrisiko; reine Protokoll-Friktion darf nicht gleich streng wirken.\n5. INV-004 bleibt fuer neue Events strikt aktiv, aber Legacy-Sequenzen bekommen ein nachvollziehbares Grandfathering.\n\n## Wie (konkrete Formel und Gates)\n\n### 1) Posterior-Risiko fuer Save-Claim\n\n- Beobachtung: `m = Summe mismatch_weight`, `n = sample_count`.\n- Modell: `p ~ Beta(alpha0 + m, beta0 + n - m)`.\n- Prior (`alpha0`, `beta0`) wird aus historical baseline (empirical Bayes) parametrisiert und im Code als explizite Konstante dokumentiert.\n- Entscheidungslogik (initiale Vorgabe, in 5si.7 kalibrierbar):\n  - `degraded`, wenn `P(p \u003e degraded_limit) \u003e= 0.95`\n  - `monitor`, wenn `P(p \u003e monitor_limit) \u003e= 0.80`\n  - sonst `healthy`\n\n### 2) Risk split\n\n- `save_claim_integrity_risk`: fuer Autonomy-Gate relevant.\n- `save_claim_protocol_friction`: Beobachtung/UX/Lernen, aber kein direkter harter Throttle-Trigger allein.\n\n### 3) Legacy fallback\n\nWenn `mismatch_severity`/`mismatch_weight` fehlen:\n- Klassifikation ueber vorhandene Felder (`allow_saved_claim`, `verification_status`, `uncertainty_markers`, echo completeness falls vorhanden).\n- Fallback darf nicht pauschal alles auf `critical/1.0` setzen, wenn eindeutige Protokoll-Friktion vorliegt.\n- Mapping muss zentral an einer Stelle definiert und getestet werden.\n\n### 4) INV-004 legacy rule\n\n- Rule bleibt fuer neue Planning/Coaching-Ereignisse unveraendert strikt.\n- Legacy-Historie vor Gate-Einfuehrung (oder explizit markierter Migrationszeitraum) wird als grandfathered behandelt.\n- Grandfathering muss transparent im Projection-Payload sichtbar sein (`legacy_policy_applied`, `why`).\n\n## Nicht-Ziele\n\n- Keine Abschwaechung fuer echte Echo-/Integritaetsfehler mit klar hohem Risiko.\n- Kein Entfernen von Guardrails; nur robustere Kalibrierung und saubere Trennschaerfe.\n- Keine neuen Markdown-Design-Dokumente.\n\n## Compaction-Rescue\n\nWenn unklar ist, wie zu implementieren:\n1. Erst `kura-training-5si.2` lesen (architecture-spec test contract).\n2. Danach in 5si.3/5si.4/5si.5 die jeweilige Vertragsschicht umsetzen.\n3. Keine Schwellwertaenderung ohne Replay/Backtest in `kura-training-5si.7`.\n","design":"Formel- und Policy-Spec fuer robuste Integritaetsbewertung; dient als einzige verbale Quelle fuer Warum/Wie gemaess AGENTS.md. Umsetzung folgt ausschliesslich ueber executable specs + Code.","acceptance_criteria":"Spezifikation benennt mathematische Regel, Gate-Entscheidungen, Legacy-Fallback und INV-004-Policy eindeutig; keine unklaren stillen Defaults.","notes":"Abgeschlossen: Policy-Spec umgesetzt in Codekonstanten und Entscheidungslogik (posterior risk, protocol/integrity split, INV-004 legacy policy cutoff, quality_issue cooldown).","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T15:34:24.839582+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T15:52:37.194047+01:00","closed_at":"2026-02-14T15:52:37.194047+01:00","close_reason":"Spec umgesetzt und in Code/Test-Vertrag verankert","labels":["integrity-slo","spec"],"dependencies":[{"issue_id":"kura-training-5si.1","depends_on_id":"kura-training-5si","type":"parent-child","created_at":"2026-02-14T15:34:24.84061+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.1","depends_on_id":"kura-training-znc","type":"blocks","created_at":"2026-02-14T15:34:27.010117+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.1","depends_on_id":"kura-training-1ls","type":"blocks","created_at":"2026-02-14T15:34:27.103547+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5si.2","title":"Executable Architecture Specs: Posterior Risk, Legacy Fallback, INV-004 Guardrail, Dedupe","description":"## Warum\n\nAGENTS.md fordert fuer neue Entscheidungen: \"Warum\" in Beads, \"Was muss gelten\" als executable specs in `tests/architecture/`. Ohne diese Absicherung waeren Kalibrierungsveraenderungen regressionsanfaellig und koennten spaetere Deployments wieder in over-sensitive Verhalten zurueckfallen lassen.\n\n## Was muss als Testvertrag entstehen\n\n1. **Posterior statt Punktquote**\n- Test stellt sicher, dass niedrige Samplezahl mit moderatem Mismatch nicht automatisch `degraded` ausloest.\n- Test stellt sicher, dass hohe persistente Mismatch-Last weiterhin `degraded` ausloest.\n\n2. **Legacy-Fallback deterministisch**\n- Alte `quality.save_claim.checked` ohne Severity-Felder werden reproduzierbar klassifiziert.\n- Fallback unterscheidet \"protocol friction\" vs \"integrity risk\" soweit aus Legacy-Feldern ableitbar.\n\n3. **Throttle an Integritaetsrisiko gekoppelt**\n- Reine Protokoll-Friktion darf nicht allein strict throttle triggern.\n- Integritaetsrisiko oberhalb definierter Grenze triggert weiterhin strict throttle.\n\n4. **INV-004 Legacy-Guardrail**\n- Planning-Events in Legacy-Zeitraum fuehren nicht dauerhaft zu offener INV-004.\n- Post-policy Events ohne onboarding close/override bleiben blockierend.\n\n5. **Dedupe/Cooldown**\n- Wiederholte identische offene Issues erzeugen nicht bei jedem Recompute ein neues `quality_issue_detected`.\n- State change oder Cooldown-Ablauf erzeugt wieder ein Signal.\n\n## Konkrete Test-Orte (vorgeschlagen)\n\n- `tests/architecture/test_13_integrity_posterior_contract.py`\n- `tests/architecture/test_14_integrity_protocol_split_contract.py`\n- `tests/architecture/test_15_inv004_legacy_grandfathering_contract.py`\n- `tests/architecture/test_16_quality_issue_dedupe_contract.py`\n- Coverage-Matrix aktualisieren: `tests/architecture/test_60_agent_contract_coverage_matrix.py`\n\nHinweis: Dateinamen koennen angepasst werden, solange die Invarianten klar und auffindbar bleiben.\n\n## Compaction-Rescue\n\nWenn eine neue Session startet:\n1. `scripts/bd-safe.sh show kura-training-5si.2`\n2. zuerst diese Specs schreiben/aktualisieren\n3. dann erst 5si.3/5si.4/5si.5/5si.6 umsetzen, bis alle Specs gruen sind\n","design":"Executable-Spec first: diese Bead definiert die dauerhaften Invarianten als Tests in tests/architecture/, bevor Implementierung angepasst wird.","acceptance_criteria":"Neue/angepasste tests/architecture pruefen Posterior-Risiko, Legacy-Mapping, INV-004-Grandfathering und Dedupe; alle gruen.","notes":"Abgeschlossen: Executable specs hinzugefügt: tests/architecture/test_13_integrity_posterior_contract.py, test_14_integrity_protocol_split_contract.py, test_15_inv004_legacy_grandfathering_contract.py, test_16_quality_issue_dedupe_contract.py; test_12 angepasst auf neue Legacy-Semantik.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T15:34:24.973837+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T15:52:37.350867+01:00","closed_at":"2026-02-14T15:52:37.350867+01:00","close_reason":"Executable architecture specs hinzugefügt und grün","labels":["architecture","tests"],"dependencies":[{"issue_id":"kura-training-5si.2","depends_on_id":"kura-training-5si","type":"parent-child","created_at":"2026-02-14T15:34:24.974874+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.2","depends_on_id":"kura-training-5si.1","type":"blocks","created_at":"2026-02-14T15:34:25.745658+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5si.3","title":"API write_verification: mismatch severity contract harden + legacy-safe payload completeness","description":"## Warum\n\nIn Prod fehlen aktuell bei allen 6 `quality.save_claim.checked`-Events die Felder `mismatch_severity`/`mismatch_weight`. Dadurch faellt der Worker auf Legacy-Binary zurück und ueberbewertet Pending-Protokollfaelle. Die API muss deshalb den Vertrag lueckenlos liefern und fuer Legacy-Rohdaten eine kontrollierte Klassifikation bereitstellen.\n\n## Wie\n\n1. `api/src/routes/agent/write_verification.rs`\n- Sicherstellen, dass `build_save_claim_checked_event(...)` immer schreibt:\n  - `mismatch_severity`\n  - `mismatch_weight`\n  - `mismatch_domain`\n  - `mismatch_reason_codes`\n- Klassifikationspfad pruefen fuer:\n  - echo missing -\u003e critical\n  - echo partial -\u003e warning\n  - proof pending + echo complete -\u003e info (protocol)\n  - verified clean -\u003e none\n- Legacy-/edge-Faelle explizit branchen statt impliziter bool-Ableitung.\n\n2. Learning-Signale\n- `save_claim_mismatch_attempt` soll dieselbe semantische Schicht (severity + weight + reason) transportieren, damit Clustering und Worker konsistent bleiben.\n\n3. Testabdeckung\n- Bestehende Rust-Contract-Tests erweitern/anpassen.\n- Neue Testfaelle fuer Backcompat-Mapping ohne Severity-Felder.\n\n## Nicht-Ziele\n\n- Keine Aenderung der grundlegenden write-with-proof API-Schnittstelle.\n- Keine UI-Aenderungen.\n\n## Compaction-Rescue\n\nWenn unklar: zuerst `kura-training-5si.2` lesen, dann die dort genannten Vertragsfaelle 1:1 in Rust-Tests abbilden und erst danach Implementierung finalisieren.\n","design":"API soll den Save-Claim-Vertrag vollstaendig und legacy-sicher liefern, damit Worker nicht auf harte binar-Fallbacks zurueckfaellt.","acceptance_criteria":"Neue quality.save_claim.checked Events enthalten immer mismatch_severity/weight/domain/reason_codes; Legacy-Mapping zentralisiert und getestet; keine stillen default-Backdoors.","notes":"Abgeschlossen: API mismatch severity contract gehärtet. classify_mismatch_severity behandelt mismatch ohne save_echo requirement als protocol/info; mismatch_reason_codes werden in learning.signal.logged übertragen.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T15:34:25.105041+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T15:52:37.485324+01:00","closed_at":"2026-02-14T15:52:37.485324+01:00","close_reason":"API-Vertrag gehärtet (protocol/info fallback + reason codes)","labels":["agent-contract","api"],"dependencies":[{"issue_id":"kura-training-5si.3","depends_on_id":"kura-training-5si","type":"parent-child","created_at":"2026-02-14T15:34:25.10659+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.3","depends_on_id":"kura-training-5si.1","type":"blocks","created_at":"2026-02-14T15:34:25.836723+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.3","depends_on_id":"kura-training-5si.2","type":"blocks","created_at":"2026-02-14T15:34:26.234917+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5si.4","title":"Worker quality_health: Bayesian integrity estimator + protocol/integrity split","description":"## Warum\n\nDie aktuellen Schwellen (`healthy_max=0.0`, `monitor_max=1.0`) auf Punktquote sind fuer kleine n zu empfindlich. Bei 2/6 Pending-Faellen kippt das System direkt in strict, obwohl der Kontext eher unsichere Readbacks als harte Integritaetsverletzung zeigt. Die Metrik muss probabilistisch und robust werden.\n\n## Wie\n\n1. `workers/src/kura_workers/handlers/quality_health.py`\n- `_compute_save_claim_slo(...)` umstellen auf Posterior-Risiko (Beta-Binomial, weighted mismatches).\n- Eingang: `mismatch_weight` (fallback-regel aus API-Vertrag/legacy mapping).\n- Output erweitern um nachvollziehbare Felder, z. B.:\n  - `posterior_prob_gt_monitor`\n  - `posterior_prob_gt_degraded`\n  - `prior_alpha`, `prior_beta`\n  - `integrity_weighted_sum`, `integrity_sample_count`\n- `save_claim_integrity_risk` und `save_claim_protocol_friction` getrennt reporten.\n\n2. Autonomy policy coupling\n- `_autonomy_policy_from_slos(...)` und vor-/nachgelagerte Gate-Logik so anpassen, dass strict throttle an Integritaetsrisiko gebunden bleibt.\n- Protokoll-Friktion kann monitor/ux triggern, aber nicht automatisch dieselbe harte Wirkung wie Integritaetsbruch bekommen.\n\n3. Legacy compatibility\n- Wenn Severity-Felder fehlen, zentrale fallback-Klassifikation verwenden.\n- Keine stillen verstreuten Heuristiken in mehreren Modulen.\n\n4. Tests\n- `workers/tests/test_quality_health.py` um Posterior-, Low-sample- und split-risk-Faelle erweitern.\n- Integrationsfall mit realistischen event streams abdecken.\n\n## Nicht-Ziele\n\n- Keine Absenkung von Schutzwirkung bei klaren critical-Mismatches.\n- Kein Entfernen bestehender Projection-Felder ohne Backcompat.\n\n## Compaction-Rescue\n\nDie mathematische Regel steht in `kura-training-5si.1`; die harten Invarianten in `kura-training-5si.2`. Nur entlang dieser beiden Quellen implementieren.\n","design":"Worker implementiert robuste Integritaetsmetrik (Bayesian/Posterior) und trennt Integritaets-Risiko von Protokoll-Reibung fuer Autonomieentscheidungen.","acceptance_criteria":"quality_health Projection liefert posterior-basierte Integritaetsmetrik + separate protocol-friction Metrik; autonomy_policy reagiert auf integrity risk; Regressionstests gruen.","notes":"Abgeschlossen: quality_health Save-Claim-SLO auf posterior risk (Beta-Approximation) umgestellt; legacy fallback differenziert; integrity/protocol-fraction getrennt reportet; autonomy throttling basiert damit auf integrity risk statt reiner protocol friction.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T15:34:25.241828+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T15:52:37.618632+01:00","closed_at":"2026-02-14T15:52:37.618632+01:00","close_reason":"Posterior-Risk + protocol/integrity split implementiert","labels":["integrity-slo","quality-health","workers"],"dependencies":[{"issue_id":"kura-training-5si.4","depends_on_id":"kura-training-5si","type":"parent-child","created_at":"2026-02-14T15:34:25.243133+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.4","depends_on_id":"kura-training-5si.1","type":"blocks","created_at":"2026-02-14T15:34:25.937689+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.4","depends_on_id":"kura-training-5si.2","type":"blocks","created_at":"2026-02-14T15:34:26.326513+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.4","depends_on_id":"kura-training-5si.3","type":"blocks","created_at":"2026-02-14T15:34:26.609733+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5si.5","title":"INV-004 hardening: legacy onboarding grandfathering + explicit migration path","description":"## Warum\n\nFreds Daten enthalten `training_plan.created` und `projection_rule.created`, aber kein `workflow.onboarding.closed`/`override`. Laut Produktkontext entstand das in einer fruehen Phase vor stabiler Onboarding-Gate-Einfuehrung. Ohne Legacy-Regel bleibt INV-004 permanent offen und beeinflusst Status/Throttle unnoetig.\n\n## Wie\n\n1. INV-004 Evaluierung erweitern\n- Legacy-Grenze (policy activation point) explizit definieren.\n- Planning/Coaching-Ereignisse vor dieser Grenze als \"legacy grandfathered\" kennzeichnen.\n- Projection muss klar zeigen, dass ein Legacy-Pfad angewendet wurde (kein stilles Ignorieren).\n\n2. Zukunftssicherheit\n- Fuer neue Ereignisse bleibt bestehende Regel unveraendert: ohne onboarding close oder override -\u003e violation.\n\n3. Transparenz\n- `quality_health` soll bei grandfathering ein maschinenlesbares Feld liefern, z. B.:\n  - `legacy_policy_applied: true`\n  - `legacy_policy_reason: ...`\n  - `legacy_policy_cutoff: ...`\n\n4. Optionaler Datenpfad\n- Falls sinnvoll: einmaliger systematischer Migrations-/repair-event, damit Historie sauber schliesst statt dauerhaft in Sonderlogik zu leben.\n\n## Nicht-Ziele\n\n- Kein globales Deaktivieren von INV-004.\n- Kein stilles Auto-Close ohne sichtbaren Audit-Pfad.\n\n## Compaction-Rescue\n\nBei Unsicherheit gilt: Schutz fuer neue Daten behalten, Legacy nur explizit und auditierbar grandfathern. Tests aus 5si.2 sind die verbindliche Auslegung.\n","design":"INV-004 bleibt als Schutz aktiv, bekommt aber dokumentiertes Legacy-Grandfathering fuer historische Sequenzen vor finaler Gate-Einfuehrung.","acceptance_criteria":"Legacy-Planning-Sequenzen bleiben nachvollziehbar, aber loesen keine dauerhafte degradierung aus; neue Sequenzen ohne close/override bleiben strikt blockierend; Tests decken beide Pfade.","notes":"Abgeschlossen: INV-004 legacy grandfathering eingeführt (cutoff + transparente Metrics-Felder: planning_event_enforced_total/planning_event_legacy_total/inv004_legacy_policy_applied/inv004_policy_cutoff).","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T15:34:25.379606+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T15:52:37.752484+01:00","closed_at":"2026-02-14T15:52:37.752484+01:00","close_reason":"INV-004 legacy grandfathering implementiert","labels":["onboarding","workflow-gate"],"dependencies":[{"issue_id":"kura-training-5si.5","depends_on_id":"kura-training-5si","type":"parent-child","created_at":"2026-02-14T15:34:25.38151+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.5","depends_on_id":"kura-training-5si.1","type":"blocks","created_at":"2026-02-14T15:34:26.035999+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.5","depends_on_id":"kura-training-5si.2","type":"blocks","created_at":"2026-02-14T15:34:26.416532+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5si.6","title":"learning.signal.logged dedupe/cooldown for repeated quality_issue_detected","description":"## Warum\n\nIn den Fred-Daten wird `quality_issue_detected` fuer dieselbe Sache mehrfach emittiert (z. B. INV-004 mehrfach), weil Recompute den gleichen offenen Zustand wiederholt meldet. Das erzeugt Rauschen in Learning/Monitoring und kann Priorisierung verzerren.\n\n## Wie\n\n1. Emissionsstrategie umstellen\n- Ereignis nur emittieren, wenn:\n  - neues Issue erstmalig erkannt\n  - Severity/Status wechselt\n  - Cooldown abgelaufen ist\n- Sonst keine erneute identische Emission.\n\n2. Signature fuer Dedupe\n- Deterministische Signatur je Issue (issue_id + severity + wesentliche Kontextfelder).\n- Cooldown-Fenster explizit konfigurierbar (z. B. 24h) und im Payload nachvollziehbar.\n\n3. Backcompat\n- Bestehende Konsumenten (clustering/backlog bridge) duerfen durch niedrigere Eventfrequenz nicht brechen.\n\n4. Tests\n- Unit/Integration fuer state-change, cooldown-hit, cooldown-expiry.\n\n## Nicht-Ziele\n\n- Keine Unterdrueckung echter neuer Probleme.\n- Kein Entfernen historischer Signale.\n\n## Compaction-Rescue\n\nDedupe darf nie neue Informationen verlieren; nur identische Wiederholungen ohne Zustandsaenderung unterdruecken.\n","design":"Signal-Emission soll state-change-orientiert sein, nicht recompute-orientiert. Ziel: stabile Telemetrie ohne Spam.","acceptance_criteria":"Identische offene issues erzeugen innerhalb cooldown keine neuen quality_issue_detected events; bei statuswechsel oder cooldown-ende wird korrekt erneut emittiert; tests gruen.","notes":"Abgeschlossen: quality_issue_detected dedupe/cooldown via event-history + deterministic idempotency seed je cooldown bucket; Re-Emission bei severity change oder cooldown expiry.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T15:34:25.521883+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T15:52:37.887726+01:00","closed_at":"2026-02-14T15:52:37.887726+01:00","close_reason":"quality_issue_detected dedupe/cooldown implementiert","labels":["noise-reduction","telemetry"],"dependencies":[{"issue_id":"kura-training-5si.6","depends_on_id":"kura-training-5si","type":"parent-child","created_at":"2026-02-14T15:34:25.523901+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.6","depends_on_id":"kura-training-5si.1","type":"blocks","created_at":"2026-02-14T15:34:26.135132+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.6","depends_on_id":"kura-training-5si.2","type":"blocks","created_at":"2026-02-14T15:34:26.509307+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5si.7","title":"Calibration + replay verification on Fred data (old vs new policy)","description":"## Warum\n\nNeue Metriken und Guardrails sind nur dann sinnvoll, wenn sie auf realen Daten kalibriert sind. Ohne Replay/Backtest besteht das Risiko, dass wir nur die Art der Fehlkalibrierung wechseln.\n\n## Wie\n\n1. Vergleich alt vs neu\n- Event-Replay auf denselben Datensaetzen (inkl. Fred-Faelle).\n- Metrikvergleich pro Window:\n  - old status vs new status\n  - false degraded / missed degraded\n  - throttle decision drift\n\n2. Zielkriterien\n- Low-sample protocol-friction faellt seltener in strict degraded.\n- Klare integritaetskritische Faelle bleiben degraded.\n- INV-004 legacy-Pfad reduziert unnoetige offene Violation fuer historische Sequenzen.\n\n3. Verifikation\n- Relevante Tests + Quality Gates laut AGENTS.md:\n  - `ruff check workers/src/ workers/tests/`\n  - Python unit/integration tests\n  - `cargo test --workspace`\n\n4. Rollout-Hinweis\n- Falls Grenzfaelle bleiben: posterior thresholds in kleinen Schritten kalibrieren, jede Aenderung mit Replay protokollieren.\n\n## Deliverable\n\nKurzer Kalibrierungsbericht im Bead-Notes-Feld mit:\n- verwendete Datasets/Zeitraeume\n- gewaehlte Schwellwerte/Prior\n- beobachtete Tradeoffs\n- finale Empfehlung fuer Merge/Deploy\n\n## Compaction-Rescue\n\nWenn nur diese Bead gelesen wird: alle Upstream-Beads muessen abgeschlossen sein; dann Replay, Gate-Vergleich, Quality-Gates und erst danach Abschluss.\n","design":"Kalibrierung per Replay statt Bauchgefuehl: alte vs neue Policy auf realen Eventstreams vergleichen und Gate-Verhalten explizit pruefen.","acceptance_criteria":"Replay zeigt robuste Verbesserung (weniger false degraded bei low sample), ohne echte high-risk-Faelle zu verharmlosen; Fred-Status nachvollziehbar dokumentiert; alle quality gates gruen.","notes":"Kalibrierung/Replay abgeschlossen: Fred prod quality.save_claim.checked (6 samples, 2 pending mismatches) ergibt mit neuer Logik status=healthy, value_pct=0.0, protocol_friction_rate_pct=3.33, posterior_prob_gt_monitor=0.123998, posterior_prob_gt_degraded=0.002446 (vorher in projection: degraded bei 33.33%). Quality gates: ruff check workers/src workers/tests ok; workers unit 706 passed/135 skipped; workers integration 84 passed; tests/architecture 108 passed; cargo test --workspace komplett grün.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T15:34:25.652975+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T15:52:38.026038+01:00","closed_at":"2026-02-14T15:52:38.026038+01:00","close_reason":"Replay/Kalibrierung und alle Quality Gates erfolgreich","labels":["calibration","verification"],"dependencies":[{"issue_id":"kura-training-5si.7","depends_on_id":"kura-training-5si","type":"parent-child","created_at":"2026-02-14T15:34:25.654924+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.7","depends_on_id":"kura-training-5si.4","type":"blocks","created_at":"2026-02-14T15:34:26.71186+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.7","depends_on_id":"kura-training-5si.5","type":"blocks","created_at":"2026-02-14T15:34:26.808589+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5si.7","depends_on_id":"kura-training-5si.6","type":"blocks","created_at":"2026-02-14T15:34:26.910437+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5ur","title":"Web Profile \u0026 Settings: Seriöse Anwendung für Early Access","description":"## Warum\nRequest-Access-Feature ist live, aber das Frontend dahinter ist ein statischer Mockup.\nLogin/Signup sind UI-Shells ohne Auth. Settings zeigt hardcoded Daten.\nFür eine seriöse Early-Access-Anwendung braucht es funktionierende Auth,\nechte Settings, Legal-Pflichtseiten und einen sauberen Agent-Connection-Flow.\n\n## Scope\n1. Browser-Auth verdrahten (OAuth PKCE) — Fundament für alles\n2. Settings-Seite lebendig machen (Profil, API Keys, Privacy, Sicherheit, Support, Danger Zone)\n3. Setup-Seite mit echten kopierbaren Werten für Agent-Connection\n4. Legal-Pflichtseiten (Impressum, Datenschutz, Nutzungsbedingungen) als Platzhalter\n5. Passwort-Reset-Flow\n\n## Designprinzipien\n- Platzhalter wo Content fehlt, aber die Struktur muss vollständig sein\n- Datenexport: NUR User-Events + Projections, KEIN system_config/agent_behavior\n- Consent-Toggle: Sichtbar aber disabled während Early Access (ist Teilnahmebedingung)\n- API Key One-Time-Display Pattern (wie Sum): Key wird genau einmal gezeigt\n- Fundament vor Feature: Auth MUSS zuerst funktionieren","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:32:47.691454+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T08:56:03.321874+01:00","closed_at":"2026-02-16T08:56:03.321874+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-3kh","type":"blocks","created_at":"2026-02-13T14:45:08.045756+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-bd1","type":"blocks","created_at":"2026-02-13T14:45:13.194926+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-cj0","type":"blocks","created_at":"2026-02-13T14:45:18.386631+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-4uv","type":"blocks","created_at":"2026-02-13T14:45:23.576576+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-a6r","type":"blocks","created_at":"2026-02-13T14:45:28.763304+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-4z2","type":"blocks","created_at":"2026-02-13T14:45:33.954567+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-u1h","type":"blocks","created_at":"2026-02-13T14:45:39.138238+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-f0l","type":"blocks","created_at":"2026-02-13T14:45:44.342381+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":42,"issue_id":"kura-training-5ur","author":"jonzim-cmd","text":"Closure check 2026-02-16: remaining P1/P2 blockers for this epic are now complete, including password reset flow (kura-training-f0l) and account deletion hardening (kura-training-b3z). Browser auth, settings sections, setup flow, and legal pages were already closed; this epic can be closed as launch-prep web/auth baseline complete.","created_at":"2026-02-16T07:56:03Z"}]}
{"id":"kura-training-5ur.1","title":"Web Confidence Surface V1: Setup/Security Zustände + Browser-Smoketests","description":"Warum:\nWeb-Oberflächen für Setup/Security sollen den realen Systemzustand widerspiegeln und durch Tests abgesichert sein, damit Operatoren und Stakeholder konsistente Signale sehen.\n\nScope:\n- Setup/Security-Flows auf reale Verfügbarkeits-/Policy-Signale ausrichten (statt statischer Platzhalter, wo technisch verfügbar).\n- Browser-Smoketests für kritische Flows (Login, Setup, Settings-Bereiche) ergänzen.\n- Fehler-/Leerzustände explizit und testbar machen.\n\nWas muss gelten:\n- Kritische Web-Flows sind automatisiert testbar.\n- Zustände im UI sind konsistent mit Backend-Contracts.\n\nNicht-Ziele:\n- Kein visuelles Redesign.\n\nImplementierungsanker:\n- web/src/app/[locale]/(inner)/setup/page.tsx\n- web/src/app/[locale]/(inner)/settings/page.tsx\n- web/ (Test-Setup)\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst Test-Entrypoint und die gemappten UI-Zustände prüfen; dann gegen Backend-Signale (Env/Endpoints) verifizieren.\n","design":"Operator-/Stakeholder-UX als verifizierbare Oberfläche statt rein statischer Hinweise.","acceptance_criteria":"1) Mindestens Login, Setup und zentrale Settings-States sind per Browser-Test abgedeckt. 2) UI-Zustände für MCP/Security sind backend-konsistent oder klar als nicht verfügbar markiert. 3) Testlauf ist lokal reproduzierbar und dokumentiert.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:13:00.76081+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T06:40:26.305104+01:00","closed_at":"2026-02-14T06:40:26.305104+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-5ur.1","depends_on_id":"kura-training-5ur","type":"parent-child","created_at":"2026-02-13T20:13:00.761843+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur.1","depends_on_id":"kura-training-siq.6","type":"blocks","created_at":"2026-02-13T20:13:05.962518+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5xk","title":"Proaktive Konsistenzfunde im Chat surfacen und explizite Fix-Freigabe einholen","description":"## Entscheidungszusammenfassung (Warum)\n\nEs gibt in diesem Produkt keine separate UI fuer Backlog-Approval; der Mensch interagiert ueber den KI-Chat. Deshalb muessen proaktive Konsistenzfunde aus dem Nachtlauf im Chat sichtbar werden und eine explizite Nutzerentscheidung einholen, bevor Fixes ausgefuehrt werden. \"Intern gespeichert\" reicht nicht, wenn der Mensch keinen Trigger bekommt. Diese Aufgabe ersetzt den impliziten Backlog-Gedanken durch einen chat-zentrierten Approval-Flow. V1 bleibt sicher: kein stilles Auto-Fixing ohne Zustimmung.\n\n## Abhaengigkeit\n\n- Haengt von `kura-training-znc` ab (Severity vorhanden), damit Chat-Priorisierung (`critical/warning/info`) sinnvoll ist.\n\n## Zielbild (Produktverhalten)\n\nBeim naechsten normalen Chatkontakt soll der Agent bei offenen Konsistenzfunden proaktiv sagen:\n\n- was gefunden wurde (kurz, priorisiert)\n- warum es relevant ist (z. B. Datenintegritaetsrisiko)\n- und genau **eine** Entscheidungsfrage stellen:\n  - \"Soll ich den vorgeschlagenen Fix ausfuehren?\"\n\nOhne explizite Zustimmung darf kein Fix ausgefuehrt werden.\n\n## Muss-Invarianten\n\n1. **No silent fixes**: Kein Konsistenzfix ohne vorherige User-Entscheidung im Chat.\n2. **Chat-first surfacing**: Offene Findings muessen in den Agent-Kontext eingebunden sein, nicht nur in interne Tabellen.\n3. **Single-question discipline**: Pro Turn maximal eine Approval-Frage.\n4. **Decision traceability**: Zustimmung/Ablehnung/Snooze werden als Events protokolliert.\n5. **Nagging-Schutz**: Nach Ablehnung/Snooze keine sofortige Wiederholung derselben Frage.\n\n## Implementierungs-Scope (Wie)\n\n### A) Proaktive Findings erzeugen (nightly)\n\n- `workers/src/kura_workers/handlers/inference_nightly.py`\n  - Nightly-Pipeline um Konsistenz-Audit-Refresh erweitern.\n- Neues Worker-Modul (z. B. `workers/src/kura_workers/consistency_inbox.py`):\n  - aggregiert pro User offene Findings aus relevanten Signalen (`quality.save_claim.checked`, `learning.signal.logged`, `quality_health`)\n  - priorisiert nach `critical \u003e warning \u003e info`\n  - schreibt Ergebnis in eine fuer Agent-Kontext lesbare Projection.\n\n### B) Chat-lesbare Projection bereitstellen\n\n- Neue Projection: `consistency_inbox/overview` (pro User genau ein Datensatz)\n- Mindestschema:\n  - `schema_version`\n  - `generated_at`\n  - `pending_items_total`\n  - `highest_severity`\n  - `requires_human_decision` (bool)\n  - `items[]` mit `item_id`, `severity`, `summary`, `recommended_action`, `evidence_ref`\n  - `prompt_control` mit `last_prompted_at`, `snooze_until`, `cooldown_active`\n\n### C) Agent-Kontext erweitern\n\n- `api/src/routes/agent.rs`\n  - `AgentContextResponse` um optionales Feld `consistency_inbox` erweitern.\n  - `get_agent_context` soll `consistency_inbox/overview` laden und zurueckgeben.\n\n### D) Operational Policy im Agent-Behavior\n\n- `workers/src/kura_workers/system_config.py`\n  - `agent_behavior.operational.consistency_inbox_protocol_v1` einfuehren:\n    - `approval_required_before_fix: true`\n    - `max_questions_per_turn: 1`\n    - `allowed_user_decisions: [\"approve\", \"decline\", \"snooze\"]`\n    - `default_snooze_hours`\n    - `critical_escalation_wording` (kurz, nicht alarmistisch)\n\n### E) User-Entscheidung eventen\n\n- Event-Vertrag erweitern (Event-Conventions + API Write-Path):\n  - `quality.consistency.review.decided`\n  - Pflichtfelder:\n    - `item_ids[]`\n    - `decision` (`approve|decline|snooze`)\n    - `decision_source` (`chat_explicit`)\n    - `snooze_until` (optional)\n- Bei `approve`:\n  - nur freigegebene, sichere Aktionen ausfuehren (V1: deterministische/sichere Reparaturen)\n  - wenn nicht sicher auto-ausfuehrbar: als pending lassen + transparent im Chat kommunizieren.\n\n### F) Dedup/Cooldown\n\n- Gleiches `item_id` darf nicht in jedem Turn erneut gepusht werden.\n- Cooldown/Snooze muss serverseitig wirksam sein (nicht nur Prompt-Text).\n\n## Architecture-Spec-Tests (Pflicht laut AGENTS.md)\n\nNeue/angepasste Tests in `tests/architecture/`:\n\n1. `tests/architecture/test_63_consistency_inbox_contract.py`\n   - Kontext-Contract:\n     - `AgentContextResponse` kann `consistency_inbox` liefern.\n   - Approval-Contract:\n     - bei `requires_human_decision=true` muss Approval-Frage-konformes Verhalten erzwingbar sein.\n     - ohne `approve` darf kein Fix-Apply-Pfad laufen.\n   - Runtime-Referenzen via `assert_kura_api_test_passes(...)`:\n     - `routes::agent::tests::consistency_inbox_contract_is_exposed_in_context`\n     - `routes::agent::tests::consistency_inbox_contract_requires_explicit_approval_before_fix`\n     - `routes::agent::tests::consistency_inbox_contract_respects_snooze_cooldown`\n\n2. `tests/architecture/test_61_scenario_library_contract.py`\n   - Szenario ergaenzen fuer \"proactive consistency prompt + one-question rule\".\n\n3. `tests/architecture/test_62_user_override_controls_contract.py`\n   - Sicherstellen, dass User-Overrides den Safety-Floor \"kein Fix ohne Approval\" nicht aufheben.\n\n## Nicht-Ziele (V1)\n\n- Keine separate UI/Inbox-Oberflaeche.\n- Kein vollautomatisches Self-Healing fuer semantisch riskante Fixes.\n- Kein unendliches Reminder-Spam-Verhalten.\n\n## Akzeptanzkriterien\n\n- Nightly erstellt/aktualisiert `consistency_inbox/overview` pro User.\n- `/v1/agent/context` liefert `consistency_inbox` im Bundle.\n- Agent kann anhand Kontext + Policy genau eine Approval-Frage formulieren.\n- Ohne `approve` kein Fix-Apply.\n- `approve|decline|snooze` wird evented und beeinflusst erneute Prompts.\n- Architecture-Spec-Tests fuer diesen Contract sind gruen.\n\n## Hinweise fuer KI-Umsetzung mit wenig Kontext (compaction-resistent)\n\n- \"Backlog\" in diesem System bedeutet hier **nicht UI-Liste**, sondern serverseitig persistierter Entscheidungsbedarf, der im Chat sichtbar sein muss.\n- Sicherheit geht vor Komfort: fehlende Entscheidung =\u003e kein Fix.\n- Bei Unsicherheit lieber als pending im Chat transparent machen als still ausfuehren.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T11:46:56.738778+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T15:08:11.236213+01:00","closed_at":"2026-02-14T15:08:11.236213+01:00","close_reason":"Consistency inbox fully implemented: worker module (build_consistency_inbox), system_config protocol, event convention, agent context field, 13 Python arch tests + 3 Rust contract tests","dependencies":[{"issue_id":"kura-training-5xk","depends_on_id":"kura-training-znc","type":"blocks","created_at":"2026-02-14T11:46:56.74061+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-60ek","title":"[jkoo.2] Preflight + Node-Routing: Approval-Timeouts früh erkennen","description":"Warum:\nDie reale Failure war ein Approval-Timeout auf Mac-jz. Ohne Preflight erkennt Fred den Blocker erst nach dem Write-Versuch, was zu Verwirrung und Fallback-Druck fuehrt.\n\nWie:\nVor high-impact plan writes eine Preflight-Pruefung einbauen, die Approval/Node/Reachability-Blocker klar klassifiziert und eine eindeutige Next-Action liefert (retry, anderer node, ask user once).","design":"Artefakte:\n- mcp-runtime/src/lib.rs (Tool-Ausfuehrung + Fehlerklassifikation)\n- ggf. api/src/routes/agent.rs (strukturierte blocker-codes im response)\n- tests fuer node approval timeout\n\nUmsetzung:\n1) Preflight fuer execution target + approval requirement.\n2) Timeout als eigener stabiler Fehlercode.\n3) Kein nachtraeglicher stiller Fallback auf alternative storage.","acceptance_criteria":"1) Approval-Timeout wird als eigener Code erfasst (nicht generisch \"exec failed\").\n2) Agent-Antwort enthaelt konkrete naechste Aktion.\n3) Regression-Test fuer timed-out approval path vorhanden.","notes":"implemented:\n- Added preflight plan-write mode check before network calls.\n- Added explicit approval-timeout classification (`approval_timeout`) in MCP write error translation.\n- Added unit test coverage for approval-timeout mapping.\n\nartifacts:\n- mcp-runtime/src/lib.rs\n- tests/architecture/test_150_plan_write_contract.py\n\nverify:\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test -p kura-mcp-runtime tests::write_api_error_classification_maps_approval_timeout -- --exact\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest tests/architecture/test_150_plan_write_contract.py -q\n\nresidual risk:\n- Node-routing across external execution nodes (Mac/VPS) is controlled outside this repo.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:39:48.034107+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T18:56:09.411173+01:00","closed_at":"2026-02-20T18:56:09.411173+01:00","close_reason":"Implemented and verified","dependencies":[{"issue_id":"kura-training-60ek","depends_on_id":"kura-training-jkoo","type":"blocks","created_at":"2026-02-20T18:40:00.152083+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-60ek","depends_on_id":"kura-training-89gs","type":"blocks","created_at":"2026-02-20T18:40:07.544433+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-683","title":"Expose production HTTP /mcp endpoint (or bridge) for OAuth-first MCP setup","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-16T14:59:20.618542+01:00","updated_at":"2026-02-16T16:00:09.2551+01:00","closed_at":"2026-02-16T16:00:09.2551+01:00","close_reason":"Closed"}
{"id":"kura-training-68q","title":"Synthetic Adversarial Corpus fuer Agent-Fehlmodi aufbauen","description":"Erzeuge adversariale Szenarien fuer Halluzination, Overconfidence, Retrieval-Miss und Data-Integrity-Drift; binde sie in Regressionstests und LaaJ/Regret-Auswertung ein.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T21:09:54.399253+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T21:56:49.017883+01:00","closed_at":"2026-02-14T21:56:49.017883+01:00","close_reason":"Closed"}
{"id":"kura-training-6ei","title":"Population Priors Engine: Hierarchical Cross-User Learning mit Privacy-Gates","description":"Implement a privacy-safe population-prior engine so individual Bayesian models can borrow strength from anonymized cohorts. Include opt-in policy, aggregation thresholds, and strict separation between individual and population artifacts.","notes":"Future differentiation feature; depends on mature Bayesian projections and governance policy.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T08:36:55.192032+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T13:37:39.215678+01:00","closed_at":"2026-02-11T13:37:39.215678+01:00","close_reason":"Closed","labels":["bayesian","benchmarks","privacy"]}
{"id":"kura-training-6kf","title":"Design: Adaptives Projektionssystem (Attribute Passthrough, Raw Events, Deklarative Handler)","description":"Drei Ansätze für adaptives System statt starre Handler: (1) Attribute Passthrough — unbekannte Felder in Projektionen durchreichen statt wegwerfen, (2) Raw-Events-Projektion — letzte N Events pro User als Sicherheitsnetz, (3) Deklarative Handler — Handler-Verhalten als Config statt Code. Vor Implementierung: Vor-/Nachteile analysieren, weitere Optionen explorieren. Liquid-AI-Analogie: System reagiert auf User-Daten statt Blaupause. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:39.990394+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T22:11:01.693541+01:00","closed_at":"2026-02-09T22:11:01.693541+01:00","close_reason":"Phase 1 (Graceful Degradation) implemented. Phases 2-4 tracked separately."}
{"id":"kura-training-6m3","title":"[task] category-Feld zu allen event_conventions hinzufügen","description":"## Kontext\n\nTeil des operational_model Features (kura-training-nco). Das category-Feld klassifiziert jeden Event-Type nach seiner Rolle im System. Daraus leitet build_system_config() den operational_model Block automatisch ab.\n\n## Was zu tun ist\n\nIn workers/src/kura_workers/event_conventions.py: Jeder Eintrag in get_event_conventions() bekommt ein top-level 'category' Feld.\n\nKategorien:\n- 'tracking' — Daten-Events (set.logged, bodyweight.logged, meal.logged, sleep.logged, etc.)\n- 'correction' — Kompensations-Events (event.retracted, set.corrected)\n- 'planning' — Planungs-Events (training_plan.created/updated/archived, *_target.set)\n- 'meta' — System-Meta-Events (projection_rule.created/archived, exercise.alias_created)\n- 'identity' — Identitäts-Events (profile.updated, preference.set, injury.reported)\n- 'system' — Interne Telemetrie (learning.signal.logged, quality.save_claim.checked, observation.*)\n\n## Wie\n\n- Jeder der ~21 Event-Types bekommt category als erstes Feld nach description\n- KEIN brief_hint Feld — usage ist die Quelle, category die Klassifikation\n- Bestehende Unit-Tests in workers/tests/test_interview_guide.py anpassen (prüfen ob category dort getestet wird)\n- Arch-Test aus kura-training-1eo muss danach grün sein\n\n## Dateien\n\n- workers/src/kura_workers/event_conventions.py (Hauptänderung)\n- workers/tests/test_system_config.py (ggf. anpassen)\n- workers/tests/test_interview_guide.py (ggf. anpassen)","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-18T22:50:52.65629+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T07:49:05.719356+01:00","closed_at":"2026-02-19T07:49:05.719356+01:00","close_reason":"category field added to all 32 event_conventions","dependencies":[{"issue_id":"kura-training-6m3","depends_on_id":"kura-training-1eo","type":"blocks","created_at":"2026-02-18T22:52:09.814296+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-6t1x","title":"[feature] zjm3: Relative intensity signals (% of reference) with endurance RPE fallback","description":"Why: Load fairness across modalities requires objective relative intensity (e.g. %e1RM, %MSS, %Critical Speed/Power) in addition to subjective RPE/RIR; RPE remains valid for endurance and must stay as fallback/anchor.\\nHow: extend normalized load components with optional relative_intensity payload (value_pct, reference_type, reference_value, reference_measured_at, reference_confidence), combine with existing internal-response signals, and increase uncertainty when references are stale/missing.\\nWhat: support strength (%e1RM/%1RM), sprint/endurance (%MSS/%CS/%CP) and plyometric relative bands; keep RPE bands for endurance (6-7 threshold, 8-9 VO2max, 9-10 anaerobic-capacity oriented) as calibration guidance, not hard physiological truth.","acceptance_criteria":"1) Load pipeline accepts and persists relative_intensity fields with provenance/confidence.\\n2) Readiness/Causal/Timeline/Eval consume the same relative-intensity logic behind feature flag.\\n3) Missing or stale references trigger deterministic fallback to RPE/HR/pace with higher uncertainty (tested).\\n4) Architecture tests in tests/architecture/ enforce dual-load invariant (external+internal, no fake precision).\\n5) Docs/changelog note modality-specific behavior and fallback rules.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-19T21:24:14.462202+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T21:50:35.158038+01:00","closed_at":"2026-02-19T21:50:35.158038+01:00","close_reason":"Closed","labels":["intensity","modality","training-load","zjm3"]}
{"id":"kura-training-6v6r","title":"Strength inference session/day grouping must use user timezone","description":"WHY:\nstrength_inference currently groups fallback sessions by UTC date, which can split/merge sessions incorrectly for users near local midnight and distort trend inference.\n\nHOW:\nAlign grouping to user timezone semantics used elsewhere:\n- use normalize_temporal_point/load_timezone_preference in strength fallback grouping\n- ensure session/day keys are deterministic under timezone assumptions\n- preserve existing retraction/correction and alias behavior.\n\nIMPLEMENTATION TASKS:\n1) Replace ts.date() fallback keying with timezone-aware local-day/session logic.\n2) Add tests for near-midnight events across multiple timezones.\n3) Add diagnostics for assumed timezone fallback.\n\nACCEPTANCE:\n- Strength grouping is timezone-consistent with training_timeline/readiness/causal handlers.\n- No UTC date artifacts for cross-midnight local sessions.","status":"closed","priority":1,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:25:59.146393+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:34.530471+01:00","closed_at":"2026-02-20T19:28:34.530471+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo).","dependencies":[{"issue_id":"kura-training-6v6r","depends_on_id":"kura-training-o6wi","type":"blocks","created_at":"2026-02-20T18:39:11.466801+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-717","title":"Event dry-run simulation endpoint for projection deltas","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T07:42:51.683213+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T08:16:08.456609+01:00","closed_at":"2026-02-11T08:16:08.456609+01:00","close_reason":"Added POST /v1/events/simulate dry-run endpoint with validation, plausibility/similarity warnings, retraction-aware event-type resolution, active custom-rule matching, and predicted projection impact deltas"}
{"id":"kura-training-73i","title":"Agent Context Ranking Optimizer: Relevanz-Scoring für Projection-Auswahl","description":"Introduce a ranking layer for agent context assembly that scores candidate projections by recency, confidence, semantic relevance, and task intent. Goal: reduce prompt bloat and increase action quality under context limits.","notes":"Keep separate from current semantic resolver implementation; this is retrieval orchestration.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T08:37:00.278498+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T13:17:20.943102+01:00","closed_at":"2026-02-11T13:17:20.943102+01:00","close_reason":"Closed","labels":["agent-interface","optimization","retrieval"]}
{"id":"kura-training-78b","title":"Supabase linter warning cleanup after security baseline","description":"## Warum\nNach dem Security-Baseline-Fix fuer Supabase-Linter bleiben voraussichtlich Warnungen uebrig (keine blocker-errors), insbesondere bei RLS-Policy-Performance und Extension-Schema.\n\n## Scope\n- auth_rls_initplan-Warnungen reduzieren (Policy-Ausdruecke mit `(SELECT current_setting(...))`)\n- multiple_permissive_policies-Warnungen reduzieren (FOR ALL auf explizite Aktion splitten, ohne Verhaltensregression)\n- `extension_in_public` fuer `vector` bewerten und ggf. migrationssicher nach `extensions` verschieben\n- Unused-index-Liste nach 7-14 Tagen Produktivtraffic neu bewerten statt sofort droppen\n\n## Acceptance\n- Supabase Linter zeigt nach Follow-up keine SECURITY-ERRORS mehr und deutlich reduzierte WARN-Flut\n- Keine Regression in Auth/Event/Worker-Flows\n","acceptance_criteria":"Warn-level findings sind nachvollziehbar reduziert und dokumentiert, ohne Runtime-Regressions.","status":"open","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T08:07:37.891332+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T08:07:37.891332+01:00","labels":["performance","security","supabase"]}
{"id":"kura-training-79mg","title":"Contract-Split: startup_capsule + section_index + paged section_fetch","description":"Why:\nMonolithische Kontext-Payloads sind die Hauptquelle für overflow/truncation und verhindern zuverlässige Datenbereitstellung.\n\nHow:\nDefiniere/implementiere einen dreistufigen Contract:\n- startup_capsule.v1 (klein, non-truncatable, kritisch)\n- section_index.v1 (IDs, Priorität, critical-Flag, Größenhinweise)\n- section_fetch.v1 (paginiert, cursor-basiert, optional field projection)\nMit stabilen IDs, schema/context versioning und idempotenten Reads.\n\nCompact-survival note:\nDer Contract macht explizit, welche Daten zwingend zuerst geladen werden müssen und verhindert implizite Annahmen im Modell.","design":"API und MCP erhalten identische Kernsemantik (keine divergierenden Contracts). Antwortgrößen sind budgetiert; kritische Felder dürfen nicht im optionalen Teil landen.","acceptance_criteria":"1) startup_capsule liefert alle kritischen Startup-Signale in kleinem Payload.\n2) section_index + section_fetch ermöglichen vollständiges Nachladen ohne Monolith-Response.\n3) Versionierungs- und Cursor-Regeln sind dokumentiert und getestet.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T08:49:06.337776+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T09:16:49.639613+01:00","closed_at":"2026-02-21T09:16:49.639613+01:00","close_reason":"Closed","labels":["api","contract","mcp","payload"],"dependencies":[{"issue_id":"kura-training-79mg","depends_on_id":"kura-training-21cw","type":"parent-child","created_at":"2026-02-21T08:49:07.117225+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-79mg","depends_on_id":"kura-training-gayi","type":"blocks","created_at":"2026-02-21T08:49:07.613277+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-7an","title":"GET /v1/projections Snapshot-Endpoint (alle Dimensionen in einem Call)","description":"Neuer Endpoint der ALLE Projektionen eines Users in einem Call zurückgibt. Aktuell braucht der Agent pro Dimension einen separaten Call — bei 7+ Dimensionen zu mühsam. Ein einzelner Snapshot löst 80% der Kompositions-Probleme. Leicht zu implementieren, hoher Impact. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:42.869178+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:04:00.586791+01:00","closed_at":"2026-02-10T07:04:00.586791+01:00","close_reason":"GET /v1/projections implemented, tested, 20 projections in one call"}
{"id":"kura-training-7az","title":"Prod MCP URL convention + env wiring","description":"Warum: Setup soll eine finale produktive MCP-URL nutzen statt Platzhalter. Was: Finale URL-Konvention festlegen und in docker/.env.production.example, docker/compose.production.yml, web Docker build/runtime envs und deploy checks verdrahten. Akzeptanz: 1) Web erhält NEXT_PUBLIC_KURA_MCP_URL in Build + Runtime. 2) Production env example enthält finale MCP-URL. 3) Deploy-Workflow setzt/prüft Variable konsistent.","notes":"Umgesetzt: finale MCP-URL-Konvention und Production Env-Wiring gesetzt.\\n\\nFestlegung:\\n- Finale MCP-URL-Konvention: https://api.withkura.com/mcp\\n\\nAenderungen:\\n- docker/.env.production.example: neues KURA_WEB_PUBLIC_MCP_URL mit Default https://api.withkura.com/mcp\\n- docker/compose.production.yml: KURA_WEB_PUBLIC_MCP_URL als required routing value dokumentiert; an kura-web Build-Args und Runtime-Env als NEXT_PUBLIC_KURA_MCP_URL durchgereicht\\n- web/Dockerfile: NEXT_PUBLIC_KURA_MCP_URL in Builder+Runner ARG/ENV aufgenommen\\n- scripts/deploy.sh: Preflight require_env fuer KURA_WEB_PUBLIC_MCP_URL hinzugefuegt\\n- web setup fallback: FALLBACK_MCP_URL auf https://api.withkura.com/mcp gesetzt\\n\\nValidierung:\\n- ruff check workers/src/ workers/tests/ -\u003e PASS\\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py -\u003e PASS\\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q -\u003e PASS\\n- npm --prefix web run test:smoke -- tests/smoke/auth-setup-settings.spec.ts -\u003e PASS\\n- cargo test --workspace -\u003e FAIL (bestehender, repo-unabhaengiger Fail: routes::account::tests::update_login_email_updates_users_and_identity_rows / Duplicate Email Validation)","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T14:39:34.497516+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T14:47:43.746035+01:00","closed_at":"2026-02-16T14:47:43.746035+01:00","close_reason":"Finale MCP-URL-Konvention + Env-Wiring umgesetzt"}
{"id":"kura-training-7cy","title":"session_summary projection","description":"Projection that answers 'what did I do this week/today?' Grouped by day, shows exercises, volume, set counts. Uses session_id from metadata to group sets into sessions.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:12.873326+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:07:45.333995+01:00","closed_at":"2026-02-09T08:07:45.333995+01:00","close_reason":"session_summary killed — violates Decision 5 (Dimensions, not Answers). Data already available via training_timeline + exercise_progression composition.","dependencies":[{"issue_id":"kura-training-7cy","depends_on_id":"kura-training-nv2","type":"blocks","created_at":"2026-02-08T13:39:32.433452+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-7gz","title":"Legal: Konkrete Log-Aufbewahrungsfristen technisch durchsetzen","description":"Definiere je Logtyp verbindliche Retention-Fristen (z. B. Security/Audit/API-Access) und implementiere deren technische Durchsetzung ueber DB-Policies/Retention-Jobs. Ergaenze transparente Angaben in den Datenschutzhinweisen und dokumentiere Ausnahmen fuer Incident-Forensik mit Freigabeprozess.","acceptance_criteria":"- Retention-Matrix je Logtyp beschlossen\\n- Hintergrundjob/Policy zur Loeschung aktiv\\n- Monitoring/Alerting fuer Retention-Job vorhanden\\n- Datenschutzhinweise enthalten konkrete Fristen","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T18:22:44.126369+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T18:49:35.823261+01:00","closed_at":"2026-02-16T18:49:35.823261+01:00","close_reason":"Implemented concrete log-retention matrix with recurring worker cleanup and audit trail (log_retention_runs)."}
{"id":"kura-training-7ji","title":"Agent-Connector Backend Hardening (Compaction-resilient)","description":"Why\nKura ist ein backend-only System fuer externe Agenten (Claude/ChatGPT/etc.). Wachstum ueber Connectoren darf weder Datenqualitaet noch Safety verschlechtern, auch wenn Session-Kontext verloren geht.\n\nHow\nWir liefern einen einheitlichen, testbaren Integrationspfad: (1) Tool-call dedupe/coalescing am MCP-Ingress, (2) asynchrone Deep-Analysis Jobs ueber background_jobs, (3) harte Architecture-Spec-Invarianten inklusive Migrations-/Backfill-Kompatibilitaet.\n\nContext-Recovery\n- Einstieg: AGENTS.md + VISION.md + CLAUDE.md\n- Kritische Pfade: mcp-runtime/src/lib.rs, api/src/routes/agent.rs, api/src/routes/imports.rs, workers/src/kura_workers/worker.py, tests/architecture/\n- Resume-Rezept: bd show \u003cid\u003e -\u003e bd dep tree \u003cid\u003e -\u003e Tests in tests/architecture zuerst lesen.","design":"Guardrail: Keine UI-Annahmen. Nur Backend/MCP/Worker.","acceptance_criteria":"- Epic hat abhaengige Tasks mit expliziten Dependencies\n- Jeder Task hat Why + How + Context-Recovery\n- Implementierung endet mit gruener Architecture-Spec fuer neue Invarianten","notes":"Implementation summary\n- Added additive migration for analysis_jobs with RLS and grants.\n- Added API endpoints /v1/analysis/jobs (create/get) with background_jobs orchestration.\n- Added worker handler analysis.deep_insight with deterministic result envelope and failure path.\n- Added MCP tools kura_analysis_job_create/get.\n- Added read-side burst dedupe/coalescing in MCP runtime (safe tool whitelist only).\n- Added architecture specs + worker/rust unit tests and passed quality gates.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-17T18:30:28.247136+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T18:45:03.204401+01:00","closed_at":"2026-02-17T18:45:03.204401+01:00","close_reason":"Closed"}
{"id":"kura-training-7ji.1","title":"Architecture Spec: Connector-agnostic contracts + migration invariants","description":"Why\nCompaction-resistente Umsetzung braucht dauerhaft erzwungene Invarianten statt implizitem Kontextwissen.\n\nHow\nErgaenze tests/architecture um Vertrage fuer:\n1) connector-agnostische Verarbeitung (kein provider-spezifischer Write-Bypass),\n2) tool-call dedupe semantics (idempotent bei Burst-Retries),\n3) async deep-analysis job contract (create/get/status/result-schema),\n4) Migrations-/Backfill-Backcompat (alte Daten weiterhin lesbar, additive Evolution).\n\nContext-Recovery\n- Referenztests: tests/architecture/test_90_mcp_cli_runtime_decoupling_contract.py, test_112_temporal_grounding_contract.py\n- Neue Tests muessen WHY im Docstring tragen.","design":"Executable-spec first gemaess AGENTS.md.","acceptance_criteria":"- Neue Architecture-Tests schlagen gegen alten Stand fehl\n- Tests dokumentieren explizit Why/How\n- Keine UI-Begriffe; nur backend contracts","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T18:30:38.610566+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T18:44:52.869577+01:00","closed_at":"2026-02-17T18:44:52.869577+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-7ji.1","depends_on_id":"kura-training-7ji","type":"parent-child","created_at":"2026-02-17T18:30:38.611444+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-7ji.2","title":"API + DB: Async deep-analysis job pipeline","description":"Why\nExterne Agenten brauchen schnelle Antworten und spaetere tiefe Auswertung, ohne den synchronen Turn zu blockieren.\n\nHow\nFuehre einen neuen API-Pfad ein: create/get analysis jobs mit job_id/status/result. Persistenz via additive Migration (neue Tabelle + Indizes), Orchestrierung ueber background_jobs.\n\nContext-Recovery\n- Vorbild: api/src/routes/imports.rs async-job pattern\n- Worker Queue: workers/src/kura_workers/worker.py\n- Migrations: migrations/* additive only","design":"Schema versioned payload + provenance fields.","acceptance_criteria":"- POST create liefert job_id + queued\n- GET status liefert queued|processing|completed|failed + result/receipt\n- Nur additive Migration, bestehende Datenpfade unveraendert","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T18:30:48.977944+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T18:44:52.871137+01:00","closed_at":"2026-02-17T18:44:52.871137+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-7ji.2","depends_on_id":"kura-training-7ji","type":"parent-child","created_at":"2026-02-17T18:30:48.97888+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-7ji.2","depends_on_id":"kura-training-7ji.1","type":"blocks","created_at":"2026-02-17T18:31:40.773241+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-7ji.3","title":"Worker: Deep-analysis handler + deterministic result envelope","description":"Why\nAsynchrone Jobs sind nur nuetzlich, wenn Ergebnisse robust, nachvollziehbar und wiederholbar geliefert werden.\n\nHow\nNeuen Worker-Handler registrieren (analysis.deep_insight). Handler schreibt deterministisches Ergebnis-Envelope (schema_version, summary, evidence_refs, uncertainty, generated_at), inklusive Fehlerpfad.\n\nContext-Recovery\n- Registry: workers/src/kura_workers/registry.py\n- Retry/Dead-letter: workers/src/kura_workers/worker.py\n- Ergebnis in API-Jobtabelle persistieren.","design":"Keine model claims ohne evidence_refs/uncertainty.","acceptance_criteria":"- Handler ist registriert und wird vom Queue-Worker ausgefuehrt\n- Erfolgs- und Fehlerstatus korrekt persistiert\n- Ergebnis enthaelt schema_version + uncertainty markers","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T18:30:59.340439+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T18:44:52.872183+01:00","closed_at":"2026-02-17T18:44:52.872183+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-7ji.3","depends_on_id":"kura-training-7ji","type":"parent-child","created_at":"2026-02-17T18:30:59.341341+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-7ji.3","depends_on_id":"kura-training-7ji.2","type":"blocks","created_at":"2026-02-17T18:31:51.108514+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-7ji.4","title":"MCP runtime: Tool-call burst dedupe/coalescing for backend calls","description":"Why\nExterne Agenten senden bei Replanning/Retry oft nahe identische Tool-Calls. Ohne Dedupe entsteht Last und Rauschen.\n\nHow\nImplementiere session-lokalen dedupe window im MCP runtime Ingress fuer identische tool+args. Rueckgabe soll klar markieren, dass Antwort deduped ist, ohne fachliche Semantik zu brechen.\n\nContext-Recovery\n- Entry: mcp-runtime/src/lib.rs handle_tools_call\n- Kontextgate darf nicht gebrochen werden\n- Dedupe nur fuer sichere Kandidaten, nicht fuer mutierende Writes ohne Idempotency-Schutz.","design":"Hash(tool_name,args)+session_id+short TTL.","acceptance_criteria":"- Burst-identische Calls werden innerhalb Fenster deduped\n- Write-Tools bleiben sicher (keine semantische Write-Verfremdung)\n- Telemetrie/Warnhinweis fuer dedupe vorhanden","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T18:31:09.710328+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T18:44:52.873328+01:00","closed_at":"2026-02-17T18:44:52.873328+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-7ji.4","depends_on_id":"kura-training-7ji","type":"parent-child","created_at":"2026-02-17T18:31:09.71132+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-7ji.4","depends_on_id":"kura-training-7ji.1","type":"blocks","created_at":"2026-02-17T18:32:01.439669+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-7ji.5","title":"MCP tools: create/get deep-analysis jobs","description":"Why\nBackend-Funktion muss fuer fremde Agenten direkt nutzbar sein, sonst bleibt API-Faehigkeit ungenutzt.\n\nHow\nErweitere MCP tool_definitions + execute_tool um analysis_job_create und analysis_job_get als duenne Adapter auf neue API-Endpunkte.\n\nContext-Recovery\n- mcp-runtime/src/lib.rs tool_definitions + execute_tool + http_json helpers\n- Contract: klare status/result envelope fuer Agenten","design":"Adapter-only: keine Businesslogik in MCP Tool selbst.","acceptance_criteria":"- Neue MCP Tools sind in tools/list sichtbar\n- create/get funktionieren mit auth und strukturierter Fehlerausgabe\n- Payload limits/fallback bleiben intakt","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T18:31:20.075283+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T18:44:52.874277+01:00","closed_at":"2026-02-17T18:44:52.874277+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-7ji.5","depends_on_id":"kura-training-7ji","type":"parent-child","created_at":"2026-02-17T18:31:20.076192+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-7ji.5","depends_on_id":"kura-training-7ji.2","type":"blocks","created_at":"2026-02-17T18:32:11.776707+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-7ji.5","depends_on_id":"kura-training-7ji.4","type":"blocks","created_at":"2026-02-17T18:32:22.112109+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-7ji.6","title":"Migration safety + rollout/backfill playbook","description":"Why\nNeue Features muessen mit bestehenden Daten und laufender Produktion kompatibel bleiben.\n\nHow\nDefiniere und implementiere additive DB-Migration, Backfill/rollout steps, sowie Contract-Tests fuer Backcompat. Dokumentiere Rollback ohne Datenverlust.\n\nContext-Recovery\n- Migrations Ordner + tests/architecture\n- Bestehende Tabellen/Flows duerfen nicht breaking geaendert werden\n- Rollout via feature flag/tolerante Reader","design":"Dual-read tolerant where needed; no destructive migration.","acceptance_criteria":"- Additive migration only\n- Backcompat Tests decken Alt-Datensaetze ab\n- Rollout-/Rollback Schritte dokumentiert und testbar","notes":"Post-implementation fine-tuning\n- MCP dedupe adjusted to cache only successful read responses; error responses are no longer coalesced to avoid masking transient recovery.\n- deep_analysis event-window SQL changed to integer-day interval arithmetic to avoid implicit type-cast edge cases in make_interval(days =\u003e ...).\n- Full quality gates rerun after tuning and passed.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T18:31:30.439463+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T18:58:34.942409+01:00","closed_at":"2026-02-17T18:44:52.875147+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-7ji.6","depends_on_id":"kura-training-7ji","type":"parent-child","created_at":"2026-02-17T18:31:30.440377+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-7ji.6","depends_on_id":"kura-training-7ji.2","type":"blocks","created_at":"2026-02-17T18:32:32.440998+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-7ji.6","depends_on_id":"kura-training-7ji.3","type":"blocks","created_at":"2026-02-17T18:32:42.778719+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-7ji.6","depends_on_id":"kura-training-7ji.4","type":"blocks","created_at":"2026-02-17T18:32:53.122756+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-7ji.6","depends_on_id":"kura-training-7ji.5","type":"blocks","created_at":"2026-02-17T18:33:03.464188+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-7o2","title":"P4: Draft bewusst als Observation auflösen","description":"Warum: Nicht jeder Persist-Intent-Draft soll in ein formales Domain-Event promoted werden. Was muss gelten: Agent/API/CLI bieten einen expliziten Resolve-Pfad, der den Draft als normale observation.logged persistiert (ohne provisional.persist_intent.*) und den ursprünglichen Draft atomar retractet. So bleibt Backlog-Hygiene korrekt, ohne neue Event-Typen wie observation.archived einzuführen.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T13:08:44.207746+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T13:14:55.128023+01:00","closed_at":"2026-02-15T13:14:55.128023+01:00","close_reason":"Closed"}
{"id":"kura-training-7u9","title":"[feature] Strategie A: Full Supabase Auth Migration (post-cutover)","description":"## Warum\nStrategie A (Full Supabase Auth) bleibt strategisch sinnvoll, ist aber fuer den Launch-Cutover zu riskant. Nach stabilem DB-only Go-live soll Auth kontrolliert auf Supabase umgestellt werden.\n\n## Scope\n- Supabase Auth als ausstellende Auth-Authority evaluieren und implementieren\n- Migrationspfad fuer bestehende Nutzer/Identitaeten definieren\n- Bestehende API-Auth-Pfade kontrolliert deprecaten/ersetzen\n\n## Konkrete Schritte\n1. Zielbild und Migrationsstrategie fuer bestehende `users` + `user_identities` festlegen.\n2. Claim-/Role-Mapping von Supabase JWTs auf Kura-Autorisierung implementieren.\n3. Cutover-Plan fuer Signup/Login/Refresh/OIDC/Device-Flow erarbeiten.\n4. Sicherheits- und Rollback-Gates fuer Auth-Replatforming definieren.\n\n## Acceptance Criteria\n- Vollstaendiger Auth-Migrationsplan inkl. Daten-/Identity-Mapping vorhanden.\n- Technische Entscheidung fuer ersetzte/weiterbetriebene API-Auth-Pfade dokumentiert.\n- Separate Go/No-Go Gates fuer Auth-Replatforming definiert.","acceptance_criteria":"Full Supabase Auth ist als separater, umsetzbarer Post-Cutover-Track mit klaren Gates definiert.","status":"open","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-15T17:15:12.279878+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T17:15:12.279878+01:00","labels":["auth","post-launch","supabase"],"dependencies":[{"issue_id":"kura-training-7u9","depends_on_id":"kura-training-4sv","type":"blocks","created_at":"2026-02-15T17:15:22.595654+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-80x","title":"[validation] Differential-/Golden-Tests fuer Policy-Paritaet","description":"Warum:\n- Kernel-Refactor darf Verhalten nicht still veraendern. Wir brauchen explizite Paritaetspruefung.\n\nWie:\n- Golden Fixtures fuer repraesentative Policy-Szenarien erstellen (verified/pending/failed, monitor/degraded, high regret etc.).\n- Differential-Tests: alter Pfad vs. Kernel-Ausgabe auf reason_codes, thresholds, mode_code, regret-band, transparency-level vergleichen.\n- Zusätzliche Regression fuer advisory-only (Sidecar blockiert nie Autonomy).\n\nCompaction-Recovery:\n- Bestehende Contract-Tests 105/106/107 + Route-Tests als Ausgangspunkt verwenden.\n- Fixtures so benennen, dass Szenario und Erwartung sofort klar sind.\n\nAkzeptanz:\n- Parity-Suite ist gruen und wird Teil der Standard-Gates fuer diesen Strang.\n- Abweichungen sind nur mit bewusstem Contract-Update zulaessig.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T17:14:59.757126+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T17:31:24.878512+01:00","closed_at":"2026-02-15T17:31:24.878512+01:00","close_reason":"Differential-/Golden-Absicherung ergänzt über policy_kernel_contract_matches_reference_legacy_calculation_for_risky_case sowie zusätzliche policy_kernel_contract_* Regressionen; bestehende response/sidecar/counterfactual Contracts weiterhin grün.","dependencies":[{"issue_id":"kura-training-80x","depends_on_id":"kura-training-muh","type":"blocks","created_at":"2026-02-15T17:15:24.422272+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-87v","title":"API: POST /v1/access/request (public, no auth)","description":"## Was\nÖffentlicher Endpoint für Access Requests. Kein Auth nötig.\n\n## Endpoint\nPOST /v1/access/request\nBody: { \"email\": \"...\", \"name\": \"...\" (optional), \"context\": \"...\" (optional) }\nResponse 201: { \"status\": \"received\", \"message\": \"We will be in touch.\" }\n\n## Logik\n- Email-Validierung (Format)\n- Duplikat-Check: wenn gleiche Email mit status=pending existiert → trotzdem 201 (kein Info-Leak)\n- Rate-Limiting: max 5 Requests pro IP pro Stunde (einfacher in-memory Counter reicht erstmal)\n- INSERT in access_requests Tabelle\n- Kein Auth-Header nötig, kein RLS — direkter INSERT mit service role\n\n## Fehler\n- 400: email fehlt oder ungültig\n- 429: Rate limit\n\n## Hinweis\n- Keine Bestätigungs-Email nötig (erstmal). Einfach speichern.\n- Später optional: Bestätigungs-Email mit Double-Opt-In","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:44:37.970211+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:03:33.138385+01:00","closed_at":"2026-02-13T13:03:33.138385+01:00","close_reason":"POST /v1/access/request implemented","dependencies":[{"issue_id":"kura-training-87v","depends_on_id":"kura-training-33v","type":"blocks","created_at":"2026-02-13T12:46:45.171183+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-87v","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:26.702011+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-880","title":"Docker Compose: PostgreSQL mit pgvector, RLS, DB-Rollen, Immutability-Constraints","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:01.964022+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-07T21:53:13.110532+01:00","closed_at":"2026-02-07T21:53:13.110532+01:00","close_reason":"Closed"}
{"id":"kura-training-89gs","title":"[jkoo.1] Contract: training_plan.* nur via /v1/agent/write-with-proof","description":"Warum:\ntraining_plan.* ist ein High-Impact-Domainwrite und darf nicht auf Legacy-Events oder indirekte Degradation fallen. Der aktuelle Zustand produziert 422/Upgrade-Signale und verwirrende Laufzeitpfade.\n\nWie:\nContract im API- und Runtime-Pfad so absichern, dass training_plan.* immer write-with-proof nutzt und Legacy-Writes explizit mit maschinenlesbarem Fehler + Migration-Hinweis abgelehnt werden.","design":"Artefakte:\n- api/src/routes/events.rs\n- api/src/routes/agent.rs\n- tests/architecture/* (neuer/angepasster Contract-Test)\n- ggf. mcp-runtime/src/lib.rs fuer Tool-Routing\n\nUmsetzung:\n1) Legacy path fuer training_plan.* fail-fast mit stabilem policy/error code.\n2) write-with-proof bleibt alleiniger persistenter Pfad.\n3) Keine stille Umleitung auf observation.logged bei persist intent.","acceptance_criteria":"1) POST /v1/events mit training_plan.* liefert deterministische policy violation + docs_hint.\n2) write-with-proof happy path bleibt intakt.\n3) Architekturtest pinnt \"training_plan.* =\u003e write-with-proof only\".","notes":"implemented:\n- Enforced plan-write contract in MCP runtime so training_plan.* cannot run in mode=commit and cannot fallback to legacy commit paths.\n- Added deterministic contract error code `plan_write_requires_write_with_proof` + docs_hint + structured details.\n- Kept API-side legacy invariant (`inv_plan_write_requires_write_with_proof`) and added warning log `legacy_plan_write_blocked` for observability.\n\nartifacts:\n- mcp-runtime/src/lib.rs\n- api/src/routes/events.rs\n- tests/architecture/test_150_plan_write_contract.py\n\nverify:\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test -p kura-mcp-runtime\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test -p kura-api routes::events::tests::test_legacy_domain_invariants_block_plan_writes_on_legacy_path -- --exact\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest tests/architecture/test_150_plan_write_contract.py -q\n\nresidual risk:\n- External orchestration layers can still bypass MCP behavior if they do not use kura_events_write.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:39:48.036867+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T18:56:38.050103+01:00","closed_at":"2026-02-20T18:56:38.050103+01:00","close_reason":"Implemented and verified","dependencies":[{"issue_id":"kura-training-89gs","depends_on_id":"kura-training-jkoo","type":"blocks","created_at":"2026-02-20T18:40:07.271603+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-8a71","title":"Expose e1RM uncertainty/confidence bands and insufficient-data diagnostics","description":"WHY:\nPoint estimates without uncertainty encourage false certainty in agent decisions.\n\nHOW:\nAdd uncertainty/confidence and data sufficiency semantics to e1RM outputs:\n- interval fields around current estimate\n- confidence score and freshness markers\n- explicit insufficiency payload when evidence is thin\n- machine-readable caveats for comparability and protocol mismatch.\n\nIMPLEMENTATION TASKS:\n1) Define uncertainty schema for exercise_progression and strength_inference outputs.\n2) Compute confidence from evidence density + context quality.\n3) Add insufficiency reason codes and next-observation guidance.\n4) Add tests ensuring uncertainty is always present.\n\nACCEPTANCE:\n- e1RM output always contains uncertainty + sufficiency metadata.\n- Thin data paths never emit naked point estimates.\n- Agent can branch behavior from status/confidence without ad-hoc parsing.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:25:58.819368+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:34.836454+01:00","closed_at":"2026-02-20T19:28:34.836454+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo).","dependencies":[{"issue_id":"kura-training-8a71","depends_on_id":"kura-training-guz5","type":"blocks","created_at":"2026-02-20T18:40:32.174213+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-95ck","title":"Agent output migration: uncertainty-first machine-readable capability responses","description":"WHY:\nBackend is agent-only; responses are consumed by LLMs, not humans. Capability outputs therefore must be machine-readable and uncertainty-first, otherwise agents overstate weak estimates.\n\nHOW:\nMigrate capability-related projection payloads to a common output envelope:\n- estimate.mean + estimate.interval\n- status (ok|insufficient_data|degraded_comparability)\n- confidence and data_sufficiency blocks\n- caveats[] and recommended_next_observations[]\n- model_version and protocol/comparability metadata.\n\nIMPLEMENTATION TASKS:\n1) Define shared serialization contract and helper builders.\n2) Update strength/sprint/jump/endurance projections to emit contract.\n3) Add backward-compatible adapters for existing agent prompt consumers.\n4) Add contract tests to prevent schema drift.\n\nACCEPTANCE:\n- Agent can consume every capability projection with one deterministic parser.\n- No capability projection returns point estimate without uncertainty fields.\n- Insufficiency and degraded comparability are explicit and actionable.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:37:44.760165+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:35.350276+01:00","closed_at":"2026-02-20T19:28:35.350276+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo).","dependencies":[{"issue_id":"kura-training-95ck","depends_on_id":"kura-training-ixt8","type":"blocks","created_at":"2026-02-20T18:40:32.801264+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-97ng","title":"[task] Fix failing integration test for nightly refit learning backlog candidate","description":"Integration gate consistently fails at TestInferenceNightlyRefitIntegration::test_nightly_refit_generates_learning_backlog_candidate_payload (row is None for source_ref=ls_backlog_bridge_signature). This is pre-existing and blocks full green integration suite during deploy-flow changes. Investigate refresh_learning_backlog_candidates / issue_cluster bridge expectations and restore deterministic candidate creation in test DB.","acceptance_criteria":"1) workers/tests/test_integration.py::TestInferenceNightlyRefitIntegration::test_nightly_refit_generates_learning_backlog_candidate_payload passes reliably. 2) No regressions in adjacent nightly_refit integration tests. 3) Root cause documented in issue notes.","status":"open","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T21:35:27.790031+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T21:35:27.790031+01:00","labels":["integration","nightly-refit","testing"]}
{"id":"kura-training-9bz","title":"Projektstruktur + Rust Cargo Workspace anlegen (api, cli, core crates)","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:00.619292+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-07T21:53:09.542159+01:00","closed_at":"2026-02-07T21:53:09.542159+01:00","close_reason":"Closed"}
{"id":"kura-training-9f5","title":"Fix failing worker integration tests for nightly refit and extraction calibration","description":"## Warum\nDie verpflichtenden Quality Gates schlagen aktuell reproduzierbar in `workers/tests/test_integration.py` fehl. Solange diese Tests rot sind, ist die Session-Gate-Kette nicht voll gruen.\n\n## Reproduktion\n`set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q`\n\nFehlende Tests:\n1. `TestInferenceNightlyRefitIntegration::test_nightly_refit_generates_learning_backlog_candidate_payload`\n2. `TestInferenceNightlyRefitIntegration::test_extraction_calibration_refresh_reports_underperforming_class`\n\n## Erwartung\n- Beide Tests bestehen wieder stabil auf einer frischen lokalen DB.\n- Keine Seiteneffekte auf bestehende Inference/Calibration-Pfade.\n\n## Hinweise\nDie aktuellen Supabase-PITR-Dokumentationsaenderungen enthalten keine Worker-Codeaenderungen; der Fehler wirkt wie ein separater bestehender Defekt im Inference/Calibration-Pfad oder in Test-Fixtures.\n","acceptance_criteria":"Integration-Gate workers/tests/test_integration.py laeuft lokal wieder komplett gruen (inkl. der 2 derzeit fehlschlagenden Tests).","status":"closed","priority":1,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-16T07:58:13.714316+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T08:17:00.14691+01:00","closed_at":"2026-02-16T08:17:00.14691+01:00","close_reason":"Fixed by using dynamic NOW()-based timestamps instead of hardcoded past-week dates. Root cause: tests inserted events in W07 but DB had existing learning.signal.logged events in W08, and the bridge/calibration functions only read the latest week.","labels":["regression","tests","workers"]}
{"id":"kura-training-9g5","title":"Agent Context v2: Manifest-driven sections + lean system loading","description":"Why:\nCurrent /v1/agent/context always carries a large static system blob and agent_brief.available_sections is manually curated/hardcoded. This risks token bloat, incomplete discoverability, and drift in a growing system.\n\nWhat:\nShip a contract where the brief is a complete machine-readable section index, system payload is optional on context reads, and clients can fetch exact sections on demand.\n\nHow:\nIntroduce system manifest/section APIs, derive brief sections from the same manifest builder (single source of truth), wire MCP/CLI for targeted retrieval, and enforce invariants via architecture spec tests.\n\nDefinition of Done:\n- /v1/agent/context supports optional system payload via query contract\n- system section manifest + per-section fetch exist\n- brief section index is generated (not hardcoded curation) and machine-usable\n- MCP can reload omitted system sections without discover_debug heavy path\n- architecture tests pin completeness/consistency invariants\n- quality gates pass","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-19T09:37:39.193653+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:01:34.856151+01:00","closed_at":"2026-02-19T10:01:34.856151+01:00","close_reason":"Closed"}
{"id":"kura-training-9g5.1","title":"API: Add /v1/system/config/manifest and /v1/system/config/section","description":"Why:\nAgents need deterministic, complete, and cheap discoverability of system sections without always loading full system config.\n\nHow:\n- Add manifest endpoint returning section ids, fetch contract, and size hints\n- Add section endpoint returning one section by id\n- Centralize section extraction into reusable helper(s)\n- Keep auth and existing redaction boundaries intact\n\nNotes:\nThis task creates the canonical section index contract used by both API and MCP.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T09:37:49.567838+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:00:43.24198+01:00","closed_at":"2026-02-19T10:00:43.24198+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-9g5.1","depends_on_id":"kura-training-9g5","type":"parent-child","created_at":"2026-02-19T09:37:49.568776+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-9g5.2","title":"API: Generate agent_brief.available_sections from manifest source","description":"Why:\nManual brief curation causes missing sections and maintenance drift as contracts grow.\n\nHow:\n- Replace hardcoded available_sections list with generated entries from manifest/source-of-truth\n- Keep projection reload entries explicit and machine-readable\n- Normalize brief language/instructions to agent-oriented English\n- Include clear fetch contract fields so clients can load sections programmatically\n\nNotes:\nDo not inline large system content in brief; brief stays index-first.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T09:37:59.950754+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:00:53.5604+01:00","closed_at":"2026-02-19T10:00:53.5604+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-9g5.2","depends_on_id":"kura-training-9g5","type":"parent-child","created_at":"2026-02-19T09:37:59.951983+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9g5.2","depends_on_id":"kura-training-9g5.1","type":"blocks","created_at":"2026-02-19T09:37:59.953379+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-9g5.3","title":"API: Add include_system query contract to /v1/agent/context","description":"Why:\nSystem config is deployment-static and large; resending it on every context read wastes tokens and hurts UX latency/robustness.\n\nHow:\n- Extend AgentContextParams with include_system\n- Maintain backward compatibility default behavior\n- Ensure agent_brief.system_config_ref remains available for staleness checks\n- Add tests for include_system=true/false response shape\n\nNotes:\nThis is transport optimization; system source remains unchanged.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T09:38:10.328192+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:01:03.896933+01:00","closed_at":"2026-02-19T10:01:03.896933+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-9g5.3","depends_on_id":"kura-training-9g5","type":"parent-child","created_at":"2026-02-19T09:38:10.329338+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9g5.3","depends_on_id":"kura-training-9g5.1","type":"blocks","created_at":"2026-02-19T09:38:10.330745+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-9g5.4","title":"MCP runtime: targeted system section loading + lean agent_context","description":"Why:\nMCP currently falls back to heavy discover_debug/system blob paths during overflow recovery.\n\nHow:\n- Add MCP tools/resources for system manifest and single-section fetch\n- Extend kura_agent_context tool to pass include_system when desired\n- Update reload hints and guidance to canonical targeted endpoints\n- Keep fallback compatibility behavior explicit\n\nNotes:\nGoal is fewer oversized payloads and fewer failure modes under context overflow.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T09:38:20.723972+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:01:14.225391+01:00","closed_at":"2026-02-19T10:01:14.225391+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-9g5.4","depends_on_id":"kura-training-9g5","type":"parent-child","created_at":"2026-02-19T09:38:20.724879+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9g5.4","depends_on_id":"kura-training-9g5.1","type":"blocks","created_at":"2026-02-19T09:38:20.726277+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9g5.4","depends_on_id":"kura-training-9g5.3","type":"blocks","created_at":"2026-02-19T09:38:20.727292+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-9g5.5","title":"Architecture specs + refactor cleanup for section contract","description":"Why:\nWithout architecture invariants, section contracts and brief discoverability will regress silently.\n\nHow:\n- Add tests in tests/architecture for manifest completeness and brief generation behavior\n- Refactor duplicated section classification/fetch-hint logic into shared helpers\n- Remove now-obsolete hardcoded brief section constants\n- Ensure tests encode both why and required behavior\n\nNotes:\nUse executable specs as the long-term guardrail.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T09:38:31.09862+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:01:24.54355+01:00","closed_at":"2026-02-19T10:01:24.54355+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-9g5.5","depends_on_id":"kura-training-9g5","type":"parent-child","created_at":"2026-02-19T09:38:31.099705+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9g5.5","depends_on_id":"kura-training-9g5.2","type":"blocks","created_at":"2026-02-19T09:38:31.101191+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9g5.5","depends_on_id":"kura-training-9g5.3","type":"blocks","created_at":"2026-02-19T09:38:31.102236+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9g5.5","depends_on_id":"kura-training-9g5.4","type":"blocks","created_at":"2026-02-19T09:38:31.103153+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-9oot","title":"Onboarding v2: Deep sichtbar halten ohne Erstkontakt-Regressions","description":"Ziel: Deep-Onboarding darf nicht untergehen, ohne die hart erkämpfte Erstkontakt-Zuverlässigkeit zu brechen. Warum: Aktuell zwingt der First-Contact-Contract auf short/5min und hat keinen persistierten Abbruchstatus. Wie: Contract + Runtime + API + Worker-Workflow so erweitern, dass Quick/Deep-Fork verfügbar ist, Deep empfohlen/default ist, unvollständiges Onboarding sauber wieder angeboten wird, und finaler Abbruch dauerhaft respektiert wird. Guardrails: Erstkontakt-Sequenz (what kura is -\u003e how to use -\u003e onboarding offer) muss deterministisch erhalten bleiben.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-21T13:24:22.930316+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T13:37:34.520927+01:00","closed_at":"2026-02-21T13:37:34.520927+01:00","close_reason":"Closed","labels":["determinism","first-contact","onboarding","workflow"],"comments":[{"id":53,"issue_id":"kura-training-9oot","author":"jonzim-cmd","text":"Compacting-resilient Kontext: 1) Problemquelle ist Contract-seitig (short hardcoded), nicht nur Prompting. 2) Erfolgsbedingung ist dual: Deep sichtbar/default + Erstkontakt-Determinismus unverändert. 3) Risiko ist stiller Guard-Bruch; daher zuerst Contract-Fix, dann State, dann Tests als Gate. 4) Persistenter Abbruch muss explizit event-basiert sein, sonst wird 'nicht gefragt' mit 'abgelehnt' verwechselt.","created_at":"2026-02-21T12:24:24Z"},{"id":59,"issue_id":"kura-training-9oot","author":"jonzim-cmd","text":"E2E abgeschlossen: Contract, Runtime, API, Worker-Workflow, Architecture specs und Tests sind konsistent. Erstkontakt-Determinismus blieb erhalten; Deep wird explizit sichtbar/empfohlen; persistenter Abort verhindert weiteres Auto-Nudging.","created_at":"2026-02-21T12:37:34Z"}]}
{"id":"kura-training-9oot.1","title":"Contract-Änderung: Quick/Deep-Fork mit Deep-default","description":"Warum: Die Quelle des aktuellen Verhaltens ist der Contract (system_config + fallback constants + startup instructions). Ohne Contract-Änderung bleiben Agenten short-first. Wie: first_contact_opening_v1 interview_offer auf Fork-Format heben (quick/deep, deep empfohlen), API-/MCP-Fallbacktexte konsistent anpassen, ohne response_guard zu schwächen. Nicht verhandelbar: Reihenfolge/Guard bleibt bestehen, nur Offer-Semantik ändert sich.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T13:24:23.056315+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T13:37:33.975707+01:00","closed_at":"2026-02-21T13:37:33.975707+01:00","close_reason":"Closed","labels":["api","contract","mcp","onboarding"],"dependencies":[{"issue_id":"kura-training-9oot.1","depends_on_id":"kura-training-9oot","type":"parent-child","created_at":"2026-02-21T13:24:23.056833+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":54,"issue_id":"kura-training-9oot.1","author":"jonzim-cmd","text":"Umgesetzt: First-contact Contract bietet jetzt Quick/Deep-Fork mit Deep als recommended/default. API/MCP-Fallbacktexte und bootstrap/onboarding detail strings sind konsistent auf Fork-Semantik umgestellt, ohne die bestehende first-contact Sequenz/guard zu entfernen.","created_at":"2026-02-21T12:37:33Z"}]}
{"id":"kura-training-9oot.2","title":"Workflow-State: onboarding_aborted persistieren und respektieren","description":"Warum: Aktuell gibt es nur closed/override; 'skip' ist textuell, aber nicht persistiert. Ergebnis: kein verlässliches dauerhaftes Stoppen des Vorschlags. Wie: neues Workflow-Marker-Event für finalen Abbruch einführen, in user_profile/workflow_state abbilden, action_required/first_contact nur solange aktiv, wie nicht closed und nicht aborted. Re-Start durch expliziten User-Wunsch muss möglich bleiben.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T13:24:23.185403+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T13:37:34.061676+01:00","closed_at":"2026-02-21T13:37:34.061676+01:00","close_reason":"Closed","labels":["events","onboarding","state","workflow"],"dependencies":[{"issue_id":"kura-training-9oot.2","depends_on_id":"kura-training-9oot","type":"parent-child","created_at":"2026-02-21T13:24:23.186723+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9oot.2","depends_on_id":"kura-training-9oot.1","type":"blocks","created_at":"2026-02-21T13:24:23.674797+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":55,"issue_id":"kura-training-9oot.2","author":"jonzim-cmd","text":"Umgesetzt: Persistenter Marker workflow.onboarding.aborted eingefuehrt (event conventions, user_profile handler, events route wiring, workflow state propagation). onboarding_aborted wird aus Marker-Events abgeleitet und in workflow_state exponiert.","created_at":"2026-02-21T12:37:33Z"}]}
{"id":"kura-training-9oot.3","title":"Resume-Regel: genau 1x pro neuem Kontakt bei in_progress","description":"Warum: User soll erinnert werden, aber nicht gespammt werden. Wie: first-contact/startup-semantik so ausrichten, dass offenes Onboarding als action_required weiter auftaucht, aber UX-Hinweise auf 'einmaliger Resume-Hinweis pro Kontakt' ausgerichtet sind. Wichtig: bestehende deterministische Startup-Gate-Mechanik darf nicht regressieren.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T13:24:23.320416+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T13:37:34.157586+01:00","closed_at":"2026-02-21T13:37:34.157586+01:00","close_reason":"Closed","labels":["onboarding","startup-gate","ux"],"dependencies":[{"issue_id":"kura-training-9oot.3","depends_on_id":"kura-training-9oot","type":"parent-child","created_at":"2026-02-21T13:24:23.322226+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9oot.3","depends_on_id":"kura-training-9oot.1","type":"blocks","created_at":"2026-02-21T13:24:23.763309+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":56,"issue_id":"kura-training-9oot.3","author":"jonzim-cmd","text":"Umgesetzt: Open onboarding bleibt weiterhin suggest-bar via onboarding_needed/action_required; gleichzeitig unterdrueckt onboarding_aborted die Auto-Vorschlaege. Startup gate Text bleibt deterministisch, wurde aber auf Quick/Deep-Fork aktualisiert.","created_at":"2026-02-21T12:37:33Z"}]}
{"id":"kura-training-9oot.4","title":"Architecture Specs + Tests aktualisieren (Regression Safety)","description":"Warum: Dieses Verhalten ist fragil und bereits mehrfach regressionsanfällig gewesen. Wie: tests/architecture Invarianten für First-Contact-Zuverlässigkeit + neue Fork/aborted-Semantik ergänzen; bestehende short-only Assertions ersetzen; Unit/Integration-Tests auf Worker/API/MCP angleichen. Definition of done: alte Erstkontakt-Garantie bleibt, neue Semantik ist testbar erzwungen.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T13:24:23.451991+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T13:37:39.661754+01:00","closed_at":"2026-02-21T13:37:39.661754+01:00","close_reason":"Closed","labels":["architecture-tests","onboarding","regression"],"dependencies":[{"issue_id":"kura-training-9oot.4","depends_on_id":"kura-training-9oot","type":"parent-child","created_at":"2026-02-21T13:24:23.453725+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9oot.4","depends_on_id":"kura-training-9oot.1","type":"blocks","created_at":"2026-02-21T13:24:23.854314+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9oot.4","depends_on_id":"kura-training-9oot.2","type":"blocks","created_at":"2026-02-21T13:24:23.945463+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9oot.4","depends_on_id":"kura-training-9oot.3","type":"blocks","created_at":"2026-02-21T13:24:24.036519+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9oot.4","depends_on_id":"kura-training-9oot.5","type":"blocks","created_at":"2026-02-21T13:24:24.123067+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":57,"issue_id":"kura-training-9oot.4","author":"jonzim-cmd","text":"Umgesetzt: Architecture specs und Unit/Integration Tests auf neue Invarianten erweitert (Deep-default fork + onboarding_aborted wiring) und bestehende short-only Assertions ersetzt. Regressionsschutz bleibt aktiv.","created_at":"2026-02-21T12:37:33Z"}]}
{"id":"kura-training-9oot.5","title":"Rollout/Kompatibilität: Legacy-Sessions ohne neue Felder","description":"Warum: Bestehende Nutzerprofile haben kein aborted-Feld; alte Sessions dürfen nicht kaputtgehen. Wie: sichere Defaults (aborted=false), Marker-basierte Ableitung statt harter Schema-Annahme, bestehende closed/override-Logik unverändert kompatibel. Zusätzlich Telemetrie-/Signalpfade auf neue Transitionen prüfen.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T13:24:23.584895+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T13:37:34.344407+01:00","closed_at":"2026-02-21T13:37:34.344407+01:00","close_reason":"Closed","labels":["compatibility","onboarding","quality"],"dependencies":[{"issue_id":"kura-training-9oot.5","depends_on_id":"kura-training-9oot","type":"parent-child","created_at":"2026-02-21T13:24:23.586072+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":58,"issue_id":"kura-training-9oot.5","author":"jonzim-cmd","text":"Umgesetzt: Backward compatibility ueber sichere Defaults (onboarding_aborted=false bei Legacy-Daten) und marker-basierte Ableitung; keine migrationskritischen Schemabrueche. Alle Quality Gates gruen.","created_at":"2026-02-21T12:37:33Z"}]}
{"id":"kura-training-9qh","title":"Go-Live: Security Header Hardening am Edge/Proxy","description":"HTTP Security Header fuer API/Storage Pfade an Edge/Proxy erzwingen, damit Scanner-Funde zu Missing Headers / Content-Type Sniffing verschwinden.","acceptance_criteria":"- Header aktiv: X-Content-Type-Options=nosniff, Referrer-Policy, X-Frame-Options oder CSP frame-ancestors\n- CSP-Baseline fuer Web/API dokumentiert\n- curl -I gegen relevante Endpunkte zeigt die Header stabil\n- Security-Scan meldet keine Header-Schwachstelle mehr","status":"in_progress","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T10:23:06.190803+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T08:14:51.655648+01:00","comments":[{"id":43,"issue_id":"kura-training-9qh","author":"jonzim-cmd","text":"Code-side hardening implemented: API middleware now sets X-Content-Type-Options, Referrer-Policy, X-Frame-Options, and CSP frame-ancestors; same baseline headers added in web/next.config.ts for all routes. Added regression test in api/src/middleware/security_headers.rs and all quality gates passed. Remaining for full AC: deploy, verify with curl -I on live endpoints, and rerun security scan.","created_at":"2026-02-17T07:14:58Z"}]}
{"id":"kura-training-9qr","title":"Consent UX: force explicit health-consent decision for legacy users","description":"Add onboarding/interstitial flow so existing users without Art. 9 consent must actively accept or decline before writing health-related events; avoid silent 403 surprises.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T18:49:47.183835+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T19:35:57.309947+01:00","closed_at":"2026-02-16T19:35:57.309947+01:00","close_reason":"Closed"}
{"id":"kura-training-9qr.1","title":"Consent Interlock: machine-readable API remediation contract","description":"Why:\n- Der aktuelle 403 bei fehlender Art.-9-Einwilligung ist semantisch zu dünn für Chat-first Clients (Claude/ChatGPT Connector), die ohne UI-Kontext handeln müssen.\n- Ohne strukturierten Fehlervertrag können Agents nur generisch auf Forbidden reagieren, statt gezielt zur richtigen Aktion zu navigieren.\n\nHow:\n- AppError/API-Fehlerschema um optionale machine-readable Remediation-Felder erweitern.\n- Health-Consent-Blockade in Event-Write-Guard als spezifischen Fehlercode + next_action + URL ausgeben.\n- Vertragswerte zentral pinnen (error_code, next_action, settings path), damit Folgesysteme stabil integrieren können.\n\nOutcome:\n- Jeder blockierte Write liefert einen deterministischen Vertrag, den Agent-Clients sofort in eine konkrete Nutzeranweisung übersetzen können.\n","acceptance_criteria":"1) 403 bei fehlender Health-Consent enthält machine-readable Felder (error_code + next_action + next_action_url).\n2) Werte sind für Clients stabil und per Unit-Tests abgesichert.\n3) Bestehende Standard-Errorstruktur bleibt abwärtskompatibel (optionale Felder).","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T19:26:47.522323+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T19:35:56.874907+01:00","closed_at":"2026-02-16T19:35:56.874907+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-9qr.1","depends_on_id":"kura-training-9qr","type":"parent-child","created_at":"2026-02-16T19:26:47.523059+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-9qr.2","title":"Consent Interlock: Settings disable-confirm UX","description":"Why:\n- Bestandsnutzer können die Art.-9-Einwilligung derzeit still deaktivieren und laufen erst später im Chat in 403-Fehler.\n- Das erzeugt Überraschungseffekte und Support-Last, weil die Konsequenzen (kein Write von Training/Recovery/Schmerz/Schlaf) nicht aktiv bestätigt wurden.\n\nHow:\n- In Settings \u003e Privacy beim Deaktivieren einen expliziten Confirm-Dialog mit klaren Folgen einführen.\n- Optisch/inhaltlich klar machen, welche Fähigkeiten danach nicht mehr verfügbar sind.\n- Aktivierung (Opt-in) weiter mit einem Klick erlauben; Deaktivierung bewusst zweistufig.\n\nOutcome:\n- Nutzer treffen eine informierte Entscheidung und die Blockade wird nicht als \"unerwarteter Fehler\" erlebt.\n","acceptance_criteria":"1) Deaktivierung der Health-Consent ist ohne explizite Bestätigung nicht möglich.\n2) Dialog benennt klar die verlorenen Fähigkeiten (Health/Training-Write blockiert).\n3) Lokalisierte Texte (mind. DE/EN) vorhanden und in bestehende Settings-UX integriert.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T19:26:55.93216+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T19:35:56.985885+01:00","closed_at":"2026-02-16T19:35:56.985885+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-9qr.2","depends_on_id":"kura-training-9qr","type":"parent-child","created_at":"2026-02-16T19:26:55.93275+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9qr.2","depends_on_id":"kura-training-9qr.1","type":"blocks","created_at":"2026-02-16T19:27:18.751628+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-9qr.3","title":"Consent Interlock: proactive consent write-gate in /v1/agent/context","description":"Why:\n- Kura-Kommunikation läuft primär im externen KI-Chat. Dort muss der Agent vor einem Write wissen, ob Health-Consent fehlt.\n- Nur auf 403 zu warten ist reaktiv und erzeugt unnötige Fehlversuche im Chatflow.\n\nHow:\n- /v1/agent/context um ein stabiles consent_write_gate-Metaobjekt erweitern.\n- Gate liefert Zustand (allowed/blocked), reason code und next_action/URL für die Remediation.\n- Vertrag versionieren und in Runtime-Tests pinnen, damit er nach Refactors nicht still bricht.\n\nOutcome:\n- Agent-Clients können proaktiv sagen \"aktuell nur lesen, bitte Einwilligung in Settings aktivieren\" bevor ein Write versucht wird.\n","acceptance_criteria":"1) Agent context enthält ein machine-readable consent write gate.\n2) Gate enthält stabile Vertragsfelder inkl. schema_version, status/reason, next_action.\n3) Rust-Tests pinnen die Struktur und blocked/allowed Verhalten.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T19:27:04.976703+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T19:35:57.093085+01:00","closed_at":"2026-02-16T19:35:57.093085+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-9qr.3","depends_on_id":"kura-training-9qr","type":"parent-child","created_at":"2026-02-16T19:27:04.977966+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9qr.3","depends_on_id":"kura-training-9qr.1","type":"blocks","created_at":"2026-02-16T19:27:18.919314+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-9qr.4","title":"Consent Interlock: executable architecture contract coverage","description":"Why:\n- Diese Entscheidung muss Compaction/Kontextverlust überleben; reine Chat-Historie reicht dafür nicht.\n- Wir brauchen ausführbare Invarianten (Architecture Spec Tests), die in CI dauerhaft die Vertragsform erzwingen.\n\nHow:\n- Neue tests/architecture Contract-Datei anlegen, die gezielt die zugehörigen Rust-Runtime-Tests aufruft.\n- Contract deckt API-Error-Remediation und Agent-Context-Write-Gate ab.\n- Keine separaten Design-Docs; \"Warum\" bleibt in Beads, \"Was gilt\" liegt in Tests.\n\nOutcome:\n- Auch ohne Kontext-Historie bleibt klar und automatisiert durchgesetzt, welche Consent-Interlock-Contracts gelten.\n","acceptance_criteria":"1) tests/architecture enthält einen dedizierten Consent-Interlock-Contract.\n2) Contract verweist auf Runtime-Tests mit exakt gepinnten Invarianten.\n3) Architekturtests laufen in CI/Local durch.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T19:27:13.44727+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T19:35:57.202074+01:00","closed_at":"2026-02-16T19:35:57.202074+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-9qr.4","depends_on_id":"kura-training-9qr","type":"parent-child","created_at":"2026-02-16T19:27:13.449385+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9qr.4","depends_on_id":"kura-training-9qr.1","type":"blocks","created_at":"2026-02-16T19:27:19.073881+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9qr.4","depends_on_id":"kura-training-9qr.2","type":"blocks","created_at":"2026-02-16T19:27:19.220903+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-9qr.4","depends_on_id":"kura-training-9qr.3","type":"blocks","created_at":"2026-02-16T19:27:19.371096+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-9rd","title":"API: action_required Top-Level-Feld in AgentContextResponse","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T12:01:11.145762+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T12:04:06.262649+01:00","closed_at":"2026-02-17T12:04:06.262649+01:00","close_reason":"action_required als Top-Level-Feld in AgentContextResponse implementiert, extract_action_required() prüft Agenda"}
{"id":"kura-training-9z6","title":"Go-Live: Supabase Auth Hardening (Rate Limits, CAPTCHA, Passwortregeln)","description":"Nach Go-Live Auth-Hardening im Supabase Dashboard finalisieren. Ziel ist Abuse-Resistenz fuer Login, OTP und Password-Reset gemaess Security-Scan Findings.","acceptance_criteria":"- Auth Rate Limits gesetzt: email_sent=2/h, sign_in_sign_ups=8/5min, token_verifications=5/5min, token_refresh=60/5min\n- CAPTCHA/Bot Detection fuer Login + Password-Reset aktiv\n- secure_password_change aktiviert\n- Password-Policy (min length + complexity) dokumentiert und aktiv\n- Auth-Endpoint-Test zeigt 429 bei Burst-Angriffen","status":"in_progress","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T10:23:00.35986+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T08:42:12.756491+01:00","comments":[{"id":44,"issue_id":"kura-training-9z6","author":"jonzim-cmd","text":"Implemented fail-closed Turnstile verification for POST /v1/access/request, POST /v1/auth/register, and POST /v1/auth/supabase/register. Added frontend Turnstile widget integration for request-access and signup (including social signup callback completion), API-side action/hostname verification helper, and moderate per-IP rate limits (register 8/5min, access-request 10/10min). Added production env wiring in docker compose/Dockerfile examples for NEXT_PUBLIC_TURNSTILE_SITE_KEY and TURNSTILE_SECRET_KEY. Remaining AC for this issue still includes Supabase dashboard settings: forgot-password/login CAPTCHA enforcement, secure_password_change toggle, and final auth endpoint burst verification for all configured limits.","created_at":"2026-02-17T07:42:12Z"}]}
{"id":"kura-training-a6r","title":"Settings: Sicherheit + Support + Danger Zone","description":"## Warum\nSicherheit (2FA), Support-Zugang und Account-Löschung sind Pflicht-Sektionen\nfür eine seriöse Anwendung. 2FA und Support als Platzhalter, Deletion verdrahtet.\n\n## Was\n### Sicherheit (Platzhalter)\n- 2FA-Sektion mit \"Kommt bald\"-Badge\n- Kurzer Text: \"Zwei-Faktor-Authentifizierung wird in einer zukünftigen Version verfügbar sein.\"\n- Disabled Toggle oder Button\n\n### Support\n- Kontakt-Email (z.B. support@kura.dev oder persönliche Email)\n- Link zu Docs/GitHub (wenn vorhanden)\n- Platzhalter-Text: \"Bei Fragen oder Problemen erreichst du uns unter...\"\n\n### Danger Zone (verdrahtet)\n- Account-Löschung: Email-Bestätigung im Input, dann DELETE /v1/account\n- Klar kommunizieren: \"Alle Daten werden unwiderruflich gelöscht\" \n- Bestätigungs-Dialog vor dem finalen Delete\n- Nach Löschung: Logout + Redirect zu Landing Page\n\n## Abhängigkeit\n- Blocked by: Browser Auth (kura-training-3kh)\n\n## Akzeptanzkriterien\n- 2FA-Sektion existiert als Platzhalter\n- Support-Sektion mit Kontaktmöglichkeit\n- Account-Löschung funktioniert end-to-end (bestätigen → API call → logout → redirect)","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:34:58.524366+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T15:01:42.658317+01:00","closed_at":"2026-02-13T15:01:42.658317+01:00","close_reason":"Implemented in settings page: 2FA placeholder with Coming Soon badge, support section with email, danger zone with email-confirmed account deletion.","dependencies":[{"issue_id":"kura-training-a6r","depends_on_id":"kura-training-3kh","type":"blocks","created_at":"2026-02-13T14:35:06.677626+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-aark","title":"Restore real Turnstile keys in production env","description":"Runtime check shows TURNSTILE_SECRET_KEY=placeholder inside kura-api. Turnstile siteverify returns HTTP 400 invalid-input-secret for placeholder, causing captcha verification failures on signup/access-request. Need to set real KURA_TURNSTILE_SECRET_KEY (and site key for web build/runtime) in docker/.env.production or managed secret source, then restart api/web/proxy and verify success path.","notes":"Set provided Turnstile site/secret keys in docker/.env.production, redeploy full stack, verify captcha path.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T12:37:59.125089+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T12:58:25.591698+01:00","closed_at":"2026-02-21T12:58:25.591698+01:00","close_reason":"Applied real Turnstile site/secret keys in production env, full deploy completed, and verification shows valid secret path (invalid-input-response on dummy token instead of invalid-input-secret).","labels":["captcha","production","turnstile"],"dependencies":[{"issue_id":"kura-training-aark","depends_on_id":"kura-training-j2bf","type":"discovered-from","created_at":"2026-02-21T12:37:59.133517+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-adxg","title":"[jkoo.4] Spec-Alignment: High-Impact Klassifikation runtime vs architecture harmonisieren","description":"Warum:\nAktuell gibt es Widerspruch zwischen Runtime-High-Impact-Klassifikation fuer training_plan.updated und Architektur-Contract (risikobasiert statt pauschal). Das erzeugt inkonsistentes Verhalten und Unsicherheit bei Agent-Entscheidungen.\n\nWie:\nEinen eindeutigen Contract festlegen und Runtime + tests/architecture darauf harmonisieren. Ziel ist deterministische Klassifikation ohne implizite Sonderregeln.","design":"Artefakte:\n- tests/architecture/test_111_high_impact_plan_update_contract.py\n- mcp-runtime/src/lib.rs (Klassifikationsfunktion)\n- ggf. api policy mapping\n\nUmsetzung:\n1) Entscheiden: strict always-high-impact ODER risikobasiert mit klaren Kriterien.\n2) Contract-Test auf genau diese Regel pinnen.\n3) Runtime auf dieselbe Regel bringen.","acceptance_criteria":"1) Kein Widerspruch mehr zwischen Architekturtest und Runtime-Verhalten.\n2) Klassifikation ist maschinenlesbar dokumentiert und getestet.\n3) Bestehende Safety-Gates bleiben erhalten.","notes":"implemented:\n- Replaced MCP high-impact classification for `training_plan.updated` from always-high-impact to risk-based heuristics aligned with API/runtime contract.\n- Added thresholds and structural-change rules equivalent to existing API classifier.\n- Added MCP unit tests: routine update stays low-impact, structural rewrite escalates.\n\nartifacts:\n- mcp-runtime/src/lib.rs\n- tests/architecture/test_111_high_impact_plan_update_contract.py (still passing)\n\nverify:\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test -p kura-mcp-runtime tests::high_impact_classification_keeps_routine_plan_update_low_impact -- --exact\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test -p kura-mcp-runtime tests::high_impact_classification_escalates_large_plan_shift -- --exact\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest tests/architecture/test_111_high_impact_plan_update_contract.py -q\n\nresidual risk:\n- Heuristics rely on payload keys; malformed payloads are still rejected later by API validation.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:39:48.058149+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T18:56:18.636034+01:00","closed_at":"2026-02-20T18:56:18.636034+01:00","close_reason":"Implemented and verified","dependencies":[{"issue_id":"kura-training-adxg","depends_on_id":"kura-training-jkoo","type":"blocks","created_at":"2026-02-20T18:40:07.411428+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-adxg","depends_on_id":"kura-training-89gs","type":"blocks","created_at":"2026-02-20T18:40:07.675748+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-akn","title":"[ctv.2] Runtime model telemetry persistence","description":"Persist verified runtime model identity per request into quality/learning telemetry and write artifacts so downstream workers can score model performance automatically.","acceptance_criteria":"1) Runtime model identity stored in event/telemetry payloads for agent writes. 2) Existing analytics remains backward-compatible when field absent.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T21:19:45.191737+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:41:25.417782+01:00","closed_at":"2026-02-13T21:41:25.417782+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-akn","depends_on_id":"kura-training-d8o","type":"blocks","created_at":"2026-02-13T21:20:52.521023+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-alk","title":"session_id Konzept für set.logged Events","description":"Optionales session_id Feld in set.logged Events. Agent generiert eine ID pro Trainingseinheit, hängt sie an jeden Set. training_timeline gruppiert nach session_id statt nur Datum. Ermöglicht mehrere Sessions pro Tag. Rückwärtskompatibel: alte Events ohne session_id fallen auf Tages-Gruppierung zurück. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:46.371672+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:17:12.665462+01:00","closed_at":"2026-02-10T07:17:12.665462+01:00","close_reason":"session_id implemented: event conventions, training_timeline session grouping, exercise_progression session counting, datagen generation. Full backward compatibility."}
{"id":"kura-training-amg","title":"Performance-Baseline-Testing: Benchmark-Harness für API + Worker","description":"Keine Antwort auf: 'Wie schnell ist Snapshot für User mit 5000 Events?' oder 'Hat das Refactoring die Projection-Berechnung verlangsamt?'\n\nBenchmark-Harness bauen:\n- API-Latenz: GET /v1/projections (Snapshot), GET /v1/projections/{type}/{key}, POST /v1/events\n- Worker: Projection-Recompute-Zeit pro Handler (exercise_progression mit 500 Sets, training_timeline mit 90 Tagen)\n- Baselines definieren (z.B. Snapshot \u003c200ms, Recompute \u003c500ms)\n- Optional: In CI laufen lassen, fail bei Regression über Threshold\n\nBraucht Testdaten (Datagen existiert bereits mit 3 Profilen, 90 Tage, ~6600 Events).\n\nZiel: Stille Performance-Regression erkennen, bevor Production-User da sind.\n\nInspiration: Ramin Hasani (Liquid AI) — 'A benchmark harness runs on each target device. CI fails if p95 \u003e threshold.'","notes":"Execution anchor after spec-hardening: depends on kura-training-veh. Child order: amg.1 (baseline harness) -\u003e amg.2 (regression gate). Outputs must be machine-readable and suitable for downstream rollout gating.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T15:34:32.40621+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T07:33:11.913165+01:00","closed_at":"2026-02-14T07:33:11.913165+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-amg","depends_on_id":"kura-training-veh","type":"blocks","created_at":"2026-02-13T20:13:16.381406+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-amg.1","title":"Performance Baseline V2.1: Reproduzierbarer API+Worker Benchmark-Harness","description":"Warum:\nVor größeren Refactors fehlt ein harter Performance-Ausgangspunkt für API- und Worker-Latenzen.\n\nScope:\n- Reproduzierbaren Benchmark-Harness für API + Worker erstellen.\n- Fixes Datenset/Replay-Korpus definieren (z.B. via datagen) für vergleichbare Messungen.\n- Ergebnisartefakt maschinenlesbar persistieren (z.B. JSON-Report) inklusive p50/p95 und Messkontext.\n\nWas muss gelten:\n- Benchmarks sind reproduzierbar und scriptbar.\n- Output ist maschinenlesbar und für Folge-Gates wiederverwendbar.\n\nNicht-Ziele:\n- In diesem Schritt noch kein CI-Fail bei Regression.\n\nImplementierungsanker:\n- scripts/\n- datagen/\n- workers/src/kura_workers/eval_harness.py (nur falls nötig für standardisierte Messwerte)\n- docs/reports/ (nur für Artefakte, keine neue Designprosa)\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst das Benchmark-Entry-Script und das Baseline-Artifact prüfen; dann Messlauf lokal reproduzieren und Werte verifizieren.\n","design":"Vor Refactor zuerst messbare Baseline; Outputs maschinenlesbar für Agent-Auswertung.","acceptance_criteria":"1) Ein dokumentierter Befehl erzeugt reproduzierbar Baseline-Metriken (inkl. p50/p95) für definierte API- und Worker-Pfade. 2) Ergebnis wird als maschinenlesbares Artefakt gespeichert. 3) Messlauf ist lokal wiederholbar und deterministisch genug für Regression-Checks.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:12:08.583867+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T23:36:11.856584+01:00","closed_at":"2026-02-13T23:36:11.856584+01:00","close_reason":"Implemented reproducible API+worker baseline harness with machine-readable artifact, runbook, and executable artifact contract test.","dependencies":[{"issue_id":"kura-training-amg.1","depends_on_id":"kura-training-amg","type":"parent-child","created_at":"2026-02-13T20:12:08.585333+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-amg.1","depends_on_id":"kura-training-veh.2","type":"blocks","created_at":"2026-02-13T20:12:13.782867+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-amg.2","title":"Performance Baseline V2.2: Regression-Gate mit Thresholds","description":"Warum:\nBaseline ohne Gate schützt nicht gegen stille Performance-Regressions.\n\nScope:\n- Threshold-Policy (z.B. max allowed delta, absolute Limits) als ausführbare Gate-Logik implementieren.\n- Fail-Mechanik für Regressionen in den Qualitätslauf integrieren.\n- Override/Local-Mode klar trennen, damit CI streng bleibt.\n\nWas muss gelten:\n- Gate failt deterministisch bei Threshold-Verletzung.\n- Gate-Ergebnis ist maschinenlesbar und erklärt den Grund.\n\nNicht-Ziele:\n- Kein Tuning auf absolute Spitzenwerte; Fokus auf Regression-Schutz.\n\nImplementierungsanker:\n- scripts/\n- ggf. tests/performance/ oder workers/tests/\n- docs/reports/ für Gate-Ausgabe (Artefakt)\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst Threshold-Definition + Gate-Entrypoint lesen, dann absichtlich einen Fail simulieren, um die Gate-Wirksamkeit zu verifizieren.\n","design":"Benchmark-Werte werden zu CI-durchsetzbaren Invarianten; keine manuelle Interpretation als einziges Kontrollmittel.","acceptance_criteria":"1) Regression-Gate failt bei definierten Threshold-Verletzungen. 2) Gate liefert maschinenlesbare Failure-Reasons. 3) Erfolgs- und Fail-Szenario sind per Test/Script reproduzierbar.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:12:19.01576+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T23:40:12.808164+01:00","closed_at":"2026-02-13T23:40:12.808164+01:00","close_reason":"Implemented machine-readable performance regression gate with threshold policy, fail-on-regression exit code, wrapper script, reports, and reproducible pass/fail tests.","dependencies":[{"issue_id":"kura-training-amg.2","depends_on_id":"kura-training-amg","type":"parent-child","created_at":"2026-02-13T20:12:19.016702+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-amg.2","depends_on_id":"kura-training-amg.1","type":"blocks","created_at":"2026-02-13T20:12:24.215878+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-aok","title":"Agenda-Severity-Eskalation bei ignorierten Issues","description":"Agenda-Items eskalieren in der Priorität wenn sie über Zeit ignoriert werden. Mechanik: Item trackt seit wann es existiert und wie viele Daten betroffen sind. Eskalationsstufen z.B.: info (neu) → low (\u003e1 Woche oder \u003e20 Events) → medium (\u003e2 Wochen oder \u003e50 Events) → high (\u003e4 Wochen oder \u003e100 Events). Verhindert stille Datenkorruption über Wochen. Beispiel: 'unresolved exercises' mit 3 Sets bleibt info. Mit 300 Sets nach 4 Wochen wird es high. Zwingt den Agent hinzuschauen.","notes":"Entstanden aus Agent-Walkthrough (2026-02-10): Sorge dass stille Datenkorruption sich über Wochen aufbaut wenn Agent Agenda-Items ignoriert. Aktuell: alle observed_patterns und orphaned_event_types sind priority=info, egal wie alt oder wie viele Daten betroffen. Umsetzung in handlers/user_profile.py in _build_agenda(). Braucht: Tracking von 'first_seen' pro Agenda-Item (z.B. aus Projection-Daten oder Event-Timestamps). Eskalationslogik: Anzahl betroffener Events + Alter des Issues → höhere Priorität.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T19:47:41.887837+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T20:16:13.957055+01:00","closed_at":"2026-02-10T20:16:13.957055+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-aok","depends_on_id":"kura-training-tct","type":"blocks","created_at":"2026-02-10T19:48:42.43705+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ap7b","title":"Flip determinism rollout from canary to full for all users","description":"Switch production MCP determinism rollout mode from canary allowlist to full so all current and new users use the deterministic path. Verify live env and service health after restart.","notes":"Switch mode to full in docker/.env.production, restart api+proxy, verify effective env and health.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T12:26:48.863598+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T12:27:42.322905+01:00","closed_at":"2026-02-21T12:27:42.322905+01:00","close_reason":"Production determinism rollout switched to full; api/proxy recycled; live env verified.","labels":["determinism","ops","rollout"],"dependencies":[{"issue_id":"kura-training-ap7b","depends_on_id":"kura-training-21cw","type":"discovered-from","created_at":"2026-02-21T12:26:48.870747+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-az0","title":"Access Gate System: Request Access → Invite → Signup","description":"## Kontext\nFür den ersten Launch: Kein offenes Signup. Stattdessen Request Access → Admin-Approval → Invite-Token → Signup. Klar kommuniziert: Early Access ist kostenlos + vollständig, User helfen durch Nutzung das System zu verbessern (anonymisierte Daten für Population Priors, Algorithmen).\n\n## Access Gate Pattern\nEin Config-Schalter (SIGNUP_GATE=invite|open|payment) steuert was zwischen \"will Signup\" und \"hat Account\" passiert:\n- invite: Gültiges Token nötig (Launch-Phase)\n- open: Jeder kann (Wachstum)\n- payment: Stripe-Checkout (Monetarisierung)\n\nInvite-Tokens können auch im Payment-Modus existieren (Promo-Codes, Free Trial).\n\n## Flow\n1. Landing → \"Request Access — Free Early Access\" → /request-access\n2. User: Email, Name, optional Kontext (\"Was trainierst du?\") → access_requests Tabelle\n3. Admin: kura admin list-requests → approve-request \u003cid\u003e → invite_token generiert → Email\n4. User: /signup?invite=TOKEN → Token validiert → normaler OAuth/Email-Signup + Consent-Checkbox\n5. /signup ohne Token → Redirect zu /request-access\n\n## DSGVO / Consent\n- Explizite Checkbox bei Signup: \"Daten anonymisiert zur Verbesserung\"\n- consent_anonymized_learning Boolean am User\n- Widerruf möglich, Account-Löschung löscht alles (haben wir schon)\n- \"Anonymisiert\" = aggregierte Muster, Population Priors, Event-Nutzung. Nie individuell nach außen.\n\n## Umstellung auf Paid (später)\n- SIGNUP_GATE=payment, Stripe-Checkout einfügen\n- Bestehende User: Grandfathering\n- invite_tokens werden Promo-Codes","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:44:04.856223+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:14:39.303879+01:00","closed_at":"2026-02-13T13:14:39.303879+01:00","close_reason":"All 8 subtasks complete: DB migration, API endpoints, CLI commands, email, web request-access page, signup invite gate"}
{"id":"kura-training-b3z","title":"Account-Löschung: Passwort-Bestätigung + 30-Tage Grace Period","description":"Zwei Hardening-Maßnahmen für Production: (1) DELETE /v1/account erfordert Passwort-Re-Entry im Request Body als Bestätigung. (2) Soft-Delete mit 30-Tage Grace Period — User wird sofort deaktiviert (is_active=false), Daten werden erst nach 30 Tagen endgültig gelöscht. Innerhalb der Frist kann der Account reaktiviert werden. Braucht: Cron-Job oder Worker-Task für verzögerte Hard-Deletes.","notes":"Session handoff 2026-02-13: Account-deletion flow remains orthogonal; schedule after P1 tracks unless compliance timeline requires earlier execution.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T18:17:09.084009+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T08:56:03.067428+01:00","closed_at":"2026-02-16T08:56:03.067428+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-b3z","depends_on_id":"kura-training-lsu","type":"blocks","created_at":"2026-02-09T18:17:13.107188+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":41,"issue_id":"kura-training-b3z","author":"jonzim-cmd","text":"Implemented account deletion hardening with password re-entry and 30-day grace period. API: DELETE /v1/account now requires password confirmation payload, verifies password, deactivates user immediately, stores deletion_requested_at/deletion_scheduled_for (+30 days), revokes credentials/sessions, and enqueues account.hard_delete job in api/src/routes/account.rs. Added POST /v1/auth/reactivate-account in api/src/routes/auth.rs to restore account within grace and cancel pending hard-delete job. Worker: added handler workers/src/kura_workers/handlers/account_lifecycle.py for account.hard_delete with safety checks (still inactive, grace elapsed) before final delete_user_account call; registered in workers/src/kura_workers/handlers/__init__.py. DB: migration migrations/20260229000004_password_reset_and_account_deletion_grace.sql adds lifecycle columns/index/check and grants for delete function. Frontend: settings danger zone now requires password input and uses new delete payload in web/src/app/[locale]/(inner)/settings/page.tsx. Validation: cargo test --workspace, ruff check workers/src/ workers/tests/, PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py, PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q, pnpm --dir web build all passing on 2026-02-16.","created_at":"2026-02-16T07:56:02Z"}]}
{"id":"kura-training-b4z","title":"Event-Schema Migration: events Tabelle, Idempotency, Immutability auf DB-Level","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:04.537372+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-07T21:53:13.25639+01:00","closed_at":"2026-02-07T21:53:13.25639+01:00","close_reason":"Closed"}
{"id":"kura-training-bd1","title":"Settings: Account-Profil Sektion","description":"## Warum\nUser muss seine eigenen Account-Daten sehen und verwalten können.\n\n## Was\n- Email-Anzeige (aus Auth Context, echte Daten statt hardcoded \"user@example.com\")\n- Display Name Anzeige\n- Member Since Datum\n- Passwort ändern: Platzhalter-UI (Formular mit alt/neu/bestätigen), noch nicht verdrahtet\n- Email ändern: Platzhalter-UI, noch nicht verdrahtet\n\n## Abhängigkeit\n- Blocked by: Browser Auth (kura-training-3kh)\n- Ohne Auth Context keine echten User-Daten\n\n## Akzeptanzkriterien\n- Settings-Seite zeigt echte Email und Member-Since aus Auth Context\n- Passwort-ändern-Formular existiert als UI (submit disabled oder \"coming soon\")","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:33:21.07658+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T15:01:32.297009+01:00","closed_at":"2026-02-13T15:01:32.297009+01:00","close_reason":"Implemented in settings page: Shows real email, member since date, plan badge from auth context.","dependencies":[{"issue_id":"kura-training-bd1","depends_on_id":"kura-training-3kh","type":"blocks","created_at":"2026-02-13T14:33:35.072831+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-bdn","title":"Enrich manifest metadata per dimension","description":"Manifest currently only has last_updated and optional exercises list. Design doc 002 specifies coverage (date range from/to), freshness, and dimension-specific summaries (weeks_tracked, last_training). Decide: enrich manifest from projections table metadata? Or read and summarize each projection's data?","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T15:18:38.721601+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T16:14:02.592905+01:00","closed_at":"2026-02-08T16:14:02.592905+01:00","close_reason":"Decision 7 implemented: manifest_contribution functions, dimension coverage with freshness/status, summary extraction per dimension"}
{"id":"kura-training-bgs","title":"Advisory Scoring Layer v1 fuer Agent-Antwort/Persistenz","description":"## Warum\nKura hat bereits starke advisory-Bausteine (`response_mode_policy`, `sidecar_assessment`, `persist_intent`), aber keinen **kanonischen 4-Score-Layer** fuer Spezifitaet, Halluzinationsrisiko, Datenqualitaetsrisiko und Gesamtvertrauen. Dadurch fehlt eine klare, einheitliche Entscheidungsoberflaeche fuer Agent und Telemetrie.\n\n## Ist-Analyse (Code-Stand)\n- `POST /v1/agent/write-with-proof` berechnet heute bereits relevante Signale in `api/src/routes/agent.rs`.\n- `api/src/routes/agent/policy_kernel.rs` enthält deterministische Kernlogik fuer `response_mode_policy`, `retrieval_regret`, `laaj_sidecar`, `counterfactual_recommendation`.\n- `extract_runtime_quality_signals(...)` liefert Qualitaets-/Integritaets-/Kalibrierungssignale.\n- Architektur-Contracts existieren schon fuer Policy-Kernel, Sidecar, Counterfactual, Persist-Intent.\n\n## Zielbild\nEin expliziter `advisory_scoring_layer.v1` vor Antwort/Persistenz, der pro Write-Flow berechnet:\n1. `specificity_score`\n2. `hallucination_risk`\n3. `data_quality_risk`\n4. `confidence_score`\n\nPlus eine transparente Action-Map (nudge-only), die Chat-/Persistenzverhalten steuert, ohne Agent-Autonomie zu blockieren.\n\n## Nicht-Ziel\n- Kein neues ML-Training im Produktivpfad.\n- Keine hard-blocking Safety-Cage ueber den bestehenden Autonomy-Gates.\n- Keine intransparente Blackbox ohne Reason-Codes.\n\n## Leitplanken (muessen gelten)\n- Advisory-only: nie `block` als direkte Folge dieses Layers.\n- Deterministisch und replaybar (gleicher Input -\u003e gleicher Score).\n- Architekturentscheid als Executable Specs unter `tests/architecture/`.\n- Rueckwaertskompatibel: additive Response-Felder, bestehende Contracts bleiben gueltig.\n\n## Umsetzungspfad\n1. Contract + Executable Specs definieren.\n2. API-Schema fuer Scores/Actions einfuehren.\n3. Scoring-Formeln und Reason-Codes implementieren.\n4. Advisory Action Mapping in Write-Flow integrieren.\n5. Telemetrie + Eval/Calibration anbinden.\n6. Rollout/Shadow-Gate + Runbook + harte Qualitaetsgates.\n\n## Kontextverlust-Schutz\nAlle Child-Tasks muessen jeweils enthalten:\n- `Warum` (Produkt-/Architekturgrund)\n- `Wie` (konkrete Datei- und Testpfade)\n- Invarianten, die dauerhaft gelten muessen\n- klare Inputs/Outputs fuer den naechsten Task\n","acceptance_criteria":"4-Score Advisory Layer ist als kontextstabile, testgetriebene Umsetzungskette mit klaren Invarianten und Dependencies aufgesetzt.","notes":"Task-Reihenfolge: 1) kura-training-bgs.1 -\u003e 2) kura-training-bgs.2 -\u003e 3) kura-training-bgs.3 -\u003e 4) kura-training-bgs.4 -\u003e 5) kura-training-bgs.5 -\u003e 6) kura-training-bgs.6. Jeder Task enthaelt Warum+Wie+Invarianten fuer context-loss resilience.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-15T18:15:28.159359+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T18:39:28.370691+01:00","closed_at":"2026-02-15T18:39:28.370691+01:00","close_reason":"Closed","labels":["advisory","agent-first","architecture","quality"]}
{"id":"kura-training-bgs.1","title":"[task] Executable Spec Contract fuer Advisory Scoring v1","description":"## Warum\nOhne klaren Contract driftet Scoring-Logik schnell auseinander (API vs System-Config vs Tests). Dieser Task friert zuerst die Architektur-Invarianten ein, bevor Implementierung startet.\n\n## Wie\n1. Neuer Architektur-Contract unter `tests/architecture/`:\n   - `test_119_advisory_scoring_layer_contract.py` (oder naechste freie Nummer)\n2. Contract in `workers/src/kura_workers/system_config.py` ergaenzen:\n   - `advisory_scoring_layer_v1` mit Schema, Score-Definitionen, Safety-Regeln.\n3. Runtime-Contract-Tests in Rust festlegen (exakte Testnamen in `api/src/routes/agent.rs` Testmodul):\n   - Schema pin\n   - advisory-only/non-blocking\n   - risky-case mapping auf cautionary actions\n   - stable-case mapping auf low-friction actions\n4. Coverage-Matrix in `tests/architecture/test_60_agent_contract_coverage_matrix.py` um den neuen Contract erweitern.\n\n## Muss gelten (Invarianten)\n- Vier Scores haben Range `[0.0, 1.0]`.\n- `hallucination_risk` und `data_quality_risk`: hoeher = riskanter.\n- `specificity_score` und `confidence_score`: hoeher = besser.\n- Policy-Rolle ist `advisory_only` / `nudge_only`, niemals hard block.\n\n## Deliverables\n- Neuer Executable Spec Test + Runtime-Test-Referenzen.\n- System-Config-Contract fuer Advisory-Scoring v1.\n- Coverage-Matrix-Eintrag.\n\n## Output fuer Folge-Task\nStabile Contract-Oberflaeche (Schema + Pflichtfelder + Testnamen), auf die API-Schema-Implementierung direkt aufsetzen kann.\n","acceptance_criteria":"Neuer Architektur-Contract + Runtime-Testanker vorhanden; Invarianten sind testbar und advisory-only festgeschrieben.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T18:15:38.535404+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T18:38:26.433047+01:00","closed_at":"2026-02-15T18:38:26.433047+01:00","close_reason":"Closed","labels":["advisory","agent-first","architecture"],"dependencies":[{"issue_id":"kura-training-bgs.1","depends_on_id":"kura-training-bgs","type":"parent-child","created_at":"2026-02-15T18:15:38.536427+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-bgs.2","title":"[task] API Schema: Advisory Scores + Action Plan in write-with-proof","description":"## Warum\nDie Scores muessen als first-class API-Objekte sichtbar sein, damit Agent-Clients sie reproduzierbar nutzen koennen und Telemetrie/UX darauf aufbauen kann.\n\n## Wie\n1. Neue Response-Strukturen in `api/src/routes/agent.rs`:\n   - `AgentAdvisoryScores` (4 Scores + reason_codes/components)\n   - `AgentAdvisoryActionPlan` (advisory actions fuer response/persist)\n2. `AgentWriteWithProofResponse` additive Felder erweitern (backward-compatible).\n3. Schema-Konstanten in `api/src/routes/agent/policy.rs` pinnen (z. B. `advisory_scoring_layer.v1`).\n4. System-Contract-Exposure pruefen (`api/src/routes/agent/system_contract.rs` falls notwendig).\n\n## Muss gelten (Invarianten)\n- Additiv, keine bestehenden Felder entfernen/umbenennen.\n- OpenAPI/ToSchema bleibt konsistent.\n- Felder sind so benannt, dass Bedeutung ohne implizites Wissen klar ist.\n\n## Deliverables\n- API Schema mit neuen Typen/Feldern.\n- Rust Unit-Tests fuer Schema-Pinning.\n\n## Output fuer Folge-Task\nFinale API-Oberflaeche fuer die Berechnung in `policy_kernel`.\n","acceptance_criteria":"Additive API-Felder und Schema-Pins implementiert; bestehende Contracts bleiben kompatibel.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T18:15:48.898234+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T18:38:36.751818+01:00","closed_at":"2026-02-15T18:38:36.751818+01:00","close_reason":"Closed","labels":["advisory","agent-first","api"],"dependencies":[{"issue_id":"kura-training-bgs.2","depends_on_id":"kura-training-bgs","type":"parent-child","created_at":"2026-02-15T18:15:48.899144+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-bgs.2","depends_on_id":"kura-training-bgs.1","type":"blocks","created_at":"2026-02-15T18:16:40.691387+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-bgs.3","title":"[task] Policy-Kernel: deterministische 4-Score Berechnung","description":"## Warum\nDer Mehrwert entsteht erst durch robuste, erklaerbare Score-Berechnung aus bestehenden Signalen (Verification, Quality, Sidecar, Session-Audit), nicht durch reine Feld-Erweiterung.\n\n## Wie\n1. In `api/src/routes/agent/policy_kernel.rs` deterministische Berechnungen implementieren:\n   - `specificity_score`\n   - `hallucination_risk`\n   - `data_quality_risk`\n   - `confidence_score`\n2. `extract_runtime_quality_signals(...)` aus `api/src/routes/agent.rs` als Kerninput verwenden.\n3. Reason-Codes pro Score deduplizieren und im Response mitschicken.\n4. Referenztests fuer edge cases:\n   - verification failed\n   - pending read-after-write\n   - degraded calibration/integrity\n   - clean/verified happy path\n\n## Muss gelten (Invarianten)\n- Clamp auf `[0.0, 1.0]` fuer jeden Score.\n- Determinismus: keine Zufallskomponente, keine Zeitabhängigkeit ohne expliziten Input.\n- Risk-Scores steigen bei objektiv schlechterer Evidenzlage.\n\n## Deliverables\n- Vollstaendige Scoring-Funktionen + Unit-Tests.\n- Dokumentierte Gewichtungen/Heuristiken im Code (kurz, klar).\n\n## Output fuer Folge-Task\nStabile Score-Werte inkl. Reason-Codes fuer Action-Mapping.\n","acceptance_criteria":"Alle vier Scores sind deterministisch implementiert, geclamped und mit Tests fuer risky/stable paths abgesichert.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T18:15:59.2634+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T18:38:47.080679+01:00","closed_at":"2026-02-15T18:38:47.080679+01:00","close_reason":"Closed","labels":["advisory","agent-first","policy","quality"],"dependencies":[{"issue_id":"kura-training-bgs.3","depends_on_id":"kura-training-bgs","type":"parent-child","created_at":"2026-02-15T18:15:59.265726+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-bgs.3","depends_on_id":"kura-training-bgs.2","type":"blocks","created_at":"2026-02-15T18:16:51.020321+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-bgs.4","title":"[task] Advisory Action Mapping in Antwort/Persistenzfluss integrieren","description":"## Warum\nScores allein veraendern UX nicht. Es braucht eine transparente Action-Map, die den Agenten fuehrt (z. B. Unsicherheit markieren, genau eine Rueckfrage, Draft statt Save), ohne Autonomie abzuwuergen.\n\n## Wie\n1. Action-Mapping im Write-Flow von `api/src/routes/agent.rs` integrieren:\n   - Response-Modus-Hinweise\n   - Persistenz-Advice (`persist_now` / `draft_preferred` / `ask_first`)\n   - Clarification-Budget (`0` oder `1` Frage)\n2. Mapping mit bestehender Logik abstimmen:\n   - `persist_intent`\n   - `response_mode_policy`\n   - `claim_guard` / `autonomy_gate`\n3. Sicherstellen: Advisory Layer setzt nur Nudges, keine neuen hard blocks.\n\n## Muss gelten (Invarianten)\n- Maximal eine zusätzliche Klärungsfrage pro riskantem Schritt.\n- Keine Widersprueche zwischen Persist-Intent und Advisory-Action-Plan.\n- Bei hohem `data_quality_risk` nie \"saved\"-Wording ohne Proof.\n\n## Deliverables\n- Integrierter `AgentAdvisoryActionPlan` im Response.\n- Runtime-Tests fuer risky/stable mappings.\n\n## Output fuer Folge-Task\nRuntime-verwendbarer Action-Plan fuer Telemetrie und Kalibrierung.\n","acceptance_criteria":"Action-Plan ist integriert, advisory-only und mit Persist-Intent/Autonomy-Gate konsistent.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T18:16:09.634772+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T18:38:57.400242+01:00","closed_at":"2026-02-15T18:38:57.400242+01:00","close_reason":"Closed","labels":["advisory","agent-first","policy","ux"],"dependencies":[{"issue_id":"kura-training-bgs.4","depends_on_id":"kura-training-bgs","type":"parent-child","created_at":"2026-02-15T18:16:09.63567+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-bgs.4","depends_on_id":"kura-training-bgs.3","type":"blocks","created_at":"2026-02-15T18:17:01.355591+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-bgs.5","title":"[task] Telemetrie + Kalibrierung fuer Advisory Scores","description":"## Warum\nOhne Messung/Kalibrierung werden Schwellwerte schnell willkuerlich. Der Layer muss ueber reale Sessions beobachtbar und nachsteuerbar sein.\n\n## Wie\n1. Learning-Signale erweitern (z. B. in `api/src/routes/agent/write_verification.rs`):\n   - Score-Snapshot + gewaehlter Action-Plan.\n2. Telemetrie-Auswertung erweitern (`api/src/routes/agent_telemetry.rs`):\n   - Verteilungen, Threshold-Exceedance, Korrelationen mit Follow-through/Regret.\n3. Eval-Harness/Quality-Health koppeln, um Drift zu erkennen (workers-Seite, bestehende Muster nutzen).\n4. Konventionen in `workers/src/kura_workers/system_config.py` ergaenzen (Calibrierungs-Policy fuer Scores).\n\n## Muss gelten (Invarianten)\n- Keine stillen Schwellwert-Aenderungen ohne Testanpassung.\n- Score-Metriken sind reproduzierbar aus Eventdaten ableitbar.\n- Alerting fokussiert auf Nutzerwirkung (Regret, Data Integrity, Follow-through).\n\n## Deliverables\n- Learning-Signale + Telemetrie-Auswertung + Tests.\n- Kalibrierungs-Konventionen fuer Advisory-Scoring.\n\n## Output fuer Folge-Task\nMessbarer Rollout-Readiness-Status inkl. Tuning-Hinweisen.\n","acceptance_criteria":"Score-Telemetrie und Kalibrierungschecks liefern belastbare, testbare Monitoring-Signale.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T18:16:19.998666+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T18:39:07.71715+01:00","closed_at":"2026-02-15T18:39:07.71715+01:00","close_reason":"Closed","labels":["advisory","agent-first","quality","telemetry"],"dependencies":[{"issue_id":"kura-training-bgs.5","depends_on_id":"kura-training-bgs","type":"parent-child","created_at":"2026-02-15T18:16:20.000002+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-bgs.5","depends_on_id":"kura-training-bgs.4","type":"blocks","created_at":"2026-02-15T18:17:11.685057+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-bgs.6","title":"[task] Rollout/Runbook/Gates fuer Advisory Scoring v1","description":"## Warum\nDer Layer ist produktkritisch. Ohne kontrollierten Rollout und harte Gates riskiert man entweder unnötige Reibung oder schlechte Datenqualitaet.\n\n## Wie\n1. Rollout-Plan als Shadow/Advisory-first (keine harte Gate-Umstellung in einem Schritt).\n2. Runbook/Hand-off in Repo dokumentieren (Pfad festlegen, z. B. `docs/runbooks/advisory-scoring-v1.md`).\n3. Vollstaendige Quality-Gates aus AGENTS.md laufen lassen und Ergebnisse im Bead dokumentieren.\n4. Abschluss nur bei:\n   - gruenen Architektur-Tests\n   - gruenen relevanten Rust/Python Tests\n   - stabilen Telemetrie-Baselines\n\n## Muss gelten (Invarianten)\n- Kein regressiver Einfluss auf bestehende advisory Contracts (Response Mode, Sidecar, Persist Intent).\n- Rollback-Pfad klar dokumentiert.\n- `Warum` und Betriebsgrenzen dauerhaft nachvollziehbar.\n\n## Deliverables\n- Rollout-Checklist + Runbook + verifizierte Gate-Resultate.\n- Abschluss-Kommentar mit finalen Thresholds und bekannten Rest-Risiken.\n\n## Definition of Done\n- Alle Child-Dependencies geschlossen.\n- Tests/Gates dokumentiert und reproduzierbar.\n- Bead enthaelt genug Kontext fuer Weiterarbeit nach Compaction.\n","acceptance_criteria":"Shadow-Rollout und AGENTS-Quality-Gates sind dokumentiert, reproduzierbar und gruen.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T18:16:30.365177+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T18:39:18.044092+01:00","closed_at":"2026-02-15T18:39:18.044092+01:00","close_reason":"Closed","labels":["advisory","agent-first","rollout"],"dependencies":[{"issue_id":"kura-training-bgs.6","depends_on_id":"kura-training-bgs","type":"parent-child","created_at":"2026-02-15T18:16:30.366119+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-bgs.6","depends_on_id":"kura-training-bgs.5","type":"blocks","created_at":"2026-02-15T18:17:22.005151+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-bq81","title":"MCP: Relax overflow critical-section check for optional action_required","description":"Why:\nIn agent context overflow, MCP currently treats action_required as always-critical even though API contract marks it optional. This can overstate integrity failures.\n\nHow:\n- Align critical-missing logic with actual API optionality\n- Keep agent_brief/meta as mandatory\n- Add tests for both cases (with and without action_required)\n\nDefinition of Done:\n- integrity_status stays accurate when action_required is legitimately absent\n- No false critical_sections_missing on optional omission","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T10:00:26.62878+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:12:53.65406+01:00","closed_at":"2026-02-19T10:12:53.65406+01:00","close_reason":"Closed"}
{"id":"kura-training-bqws","title":"Deep Audit: Trainingsmetriken, Statistik und Modell-Validierung","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T22:56:49.629263+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T23:02:34.308007+01:00","closed_at":"2026-02-19T23:02:34.308007+01:00","close_reason":"Closed"}
{"id":"kura-training-br3","title":"Extend causal inference to strength and heterogeneous effects","description":"Build on initial causal_inference projection by adding strength-based outcomes (per exercise and aggregate) and subgroup/phase effect slices. Include minimum-sample guardrails per segment and caveat propagation.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T13:54:58.30949+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T14:47:00.003995+01:00","closed_at":"2026-02-11T14:47:00.003995+01:00","close_reason":"Closed","labels":["agent-first","causal","statistics"]}
{"id":"kura-training-c52","title":"[handoff] Compaction-sicherer Abschluss: Gates, Sync, Push, Recovery-Notizen","description":"Warum:\n- Kontextverlust zwischen Sessions ist real; Abschluss muss reproduzierbar und uebernehmbar sein.\n\nWie:\n- Alle in AGENTS.md geforderten Quality Gates fuer geaenderte Bereiche ausfuehren.\n- Beads-Status sauber pflegen (in_progress/close), bd sync und git push nach Session-Close-Protokoll.\n- In den finalen Issue-Notes kurz dokumentieren: was wurde geaendert, welche Tests beweisen Invarianten, was waere naechster sicherer Schritt.\n\nCompaction-Recovery:\n- Nach Compacting nur dieses Issue oeffnen, dort auf Child-Issues/Testergebnisse/naechste Schritte verweisen.\n- Keine impliziten Entscheidungen; alles in Beads/Tests sichtbar.\n\nAkzeptanz:\n- Alle Child-Issues sind geschlossen oder mit klarer Restarbeit dokumentiert.\n- Remote ist up-to-date und der Strang ist ohne Chat-Kontext fortfuehrbar.","notes":"Abschlussprotokoll (2026-02-15):\n- Code-/Spec-Arbeit fuer Policy-Kernel abgeschlossen (api/src/routes/agent/policy_kernel.rs + Route-Delegation + neue Architekturtests).\n- Quality Gates erneut ausgefuehrt:\n  1) ruff check workers/src/ workers/tests/ -\u003e PASS\n  2) PYTHONPATH=workers/src workers/.venv/bin/python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py -\u003e PASS (723 passed, 135 skipped)\n  3) cargo test --workspace -\u003e PASS\n  4) PYTHONPATH=workers/src workers/.venv/bin/python -m pytest workers/tests/test_integration.py -q -\u003e FAIL (1 failing test)\n- Verbleibender Fail: TestSessionFeedbackIntegration::test_legacy_text_infers_enjoyment (erwartet enjoyment=2.0, erhalten 4.0).\n- Follow-up fuer Restarbeit angelegt: kura-training-dtb (P1 bug, inkl. Repro + Akzeptanz).\n- Nächster sicherer Schritt: kura-training-dtb bearbeiten und Integration-Gate erneut laufen lassen.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T17:14:59.757152+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T17:51:02.739665+01:00","closed_at":"2026-02-15T17:51:02.739665+01:00","close_reason":"Handoff/Gates dokumentiert; Restarbeit als kura-training-dtb getrackt.","dependencies":[{"issue_id":"kura-training-c52","depends_on_id":"kura-training-80x","type":"blocks","created_at":"2026-02-15T17:15:34.750189+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ce1","title":"Context-Robust Agent Runtime V2: Brief-first, Overflow-Protokoll, Onboarding-Intent","description":"Warum: Aktuell kann der MCP-Tool-Payload-Limiter bei grossen Antworten entscheidungsrelevanten Kontext auf Summary/Shape reduzieren. Gleichzeitig ist Onboarding teilweise heuristisch an Event-Count gekoppelt statt strikt an Coverage/Workflow-Intent. Das fuehrt zu generischem Verhalten, instabilem Erstkontakt und zu Responses, die Kura-spezifische Moeglichkeiten nicht verlaesslich nutzen. Ziel ist ein robustes Protokoll, das auch nach Compaction/Context-Loss eindeutig weiterfuehrbar bleibt.","design":"Wie: (1) Brief-first Contract: ein kleiner, unkürzbarer agent_brief mit action_required, must_cover_intents, coverage_gaps, workflow_state, temporal_context und section_handles. (2) Kein stilles Abschneiden fuer kura_agent_context: Overflow als explizites Protokoll statt summary-only Verlust. (3) System-Config section-basiert nachladen statt als grosses Default-Payload. (4) Onboarding als Intent-Pflicht (dual-path: onboarding anbieten + skip/log-now), entkoppelt von Event-Count und an Coverage/Workflow gekoppelt. (5) Spec-first ueber tests/architecture, danach Implementierung in API/MCP/Workers.","acceptance_criteria":"1) Es existiert eine klar abhaengige Task-Chain mit Spec-first Reihenfolge. 2) Architekturtests erzwingen den Contract dauerhaft. 3) MCP/API/Worker Verhalten ist auch bei Payload-Limits deterministic und onboarding-sicher. 4) Jede Aufgabe enthaelt Why/How + Recovery-Hinweise fuer Context-Verlust.","notes":"Compaction-Rescue: 1) scripts/bd-safe.sh prime 2) scripts/bd-safe.sh show \u003cepic-id\u003e 3) zuerst Spec-Tasks umsetzen, dann Implementierung. Kritische Invarianten: kein stilles Abschneiden von Brief-Steuerung; Onboarding-Intent darf vor Workflow-Close nicht verschwinden.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-17T14:20:16.407901+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T14:34:51.879217+01:00","closed_at":"2026-02-17T14:34:51.879217+01:00","close_reason":"Completed end-to-end: dependency chain, spec-first contracts, implementation and verification all green."}
{"id":"kura-training-ce1.1","title":"Spec-first: Architecture Contracts fuer agent_brief_v1 + overflow_protocol_v1","description":"Warum: Ohne executable Specs koennen Kontext-Refactors still regressieren und wieder zu truncation-bedingtem Signalverlust fuehren. Wir brauchen einen dauerhaft erzwungenen Vertrag fuer den unkürzbaren Steuerungs-Header und fuer explizite Overflow-Semantik.","design":"Wie: Tests in tests/architecture anlegen, die erzwingen: (1) agent_brief enthaelt action_required/must_cover_intents/coverage_gaps/workflow_state/temporal_context; (2) kein stilles Abschneiden von Steuerungsfeldern bei grossen Tool-Antworten; (3) Overflow meldet omitted_sections + reload_hints strukturiert. Runtime-Tests in mcp-runtime/api pinnen das Verhalten.","acceptance_criteria":"1) Neue Architecture-Tests schlagen ohne Implementierung fehl und pinnen den Contract. 2) Runtime-Tests referenzieren gleiche Invarianten. 3) Tests dokumentieren klar, welche Felder nie im Overflow verloren gehen duerfen.","notes":"Compaction-Rescue: zuerst diesen Task oeffnen und Tests lesen; sie sind die Source-of-Truth fuer spaetere Implementierung. Reihenfolge: Tests schreiben -\u003e rot sehen -\u003e Implementierung.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T14:20:45.374836+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T14:34:33.918743+01:00","closed_at":"2026-02-17T14:34:33.918743+01:00","close_reason":"Implemented: architecture specs + API agent_brief + MCP structured overflow + onboarding coverage-based intent + full quality gates.","dependencies":[{"issue_id":"kura-training-ce1.1","depends_on_id":"kura-training-ce1","type":"parent-child","created_at":"2026-02-17T14:20:45.375731+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ce1.2","title":"Spec-first: Onboarding-Intent Reliability Contract (coverage-gebunden, dual-path)","description":"Warum: Onboarding darf nicht zufaellig durch Event-Count-Heuristiken verschwinden, solange Coverage/Workflow noch offen sind. Sonst driftet der Agent in generische Konversationen und verpasst Kura-Pflichtverhalten beim Erstkontakt.","design":"Wie: Architecture-Tests definieren Invarianten: (1) solange onboarding nicht geschlossen ist und required coverage offen ist, bleibt offer_onboarding als Pflicht-Intent aktiv; (2) Erstkontakt verlangt dual-path (onboarding anbieten + skip/log-now erlauben); (3) micro-onboarding-Luecken werden als naechste intent-gesteuerte Frage markiert statt frei zu driften.","acceptance_criteria":"1) Tests pinnen den Intent-Contract unabhaengig von Event-Count. 2) Workflow-/Coverage-Bedingungen sind explizit und maschinenlesbar. 3) Regression-Tests fuer 'viele Events aber offene Coverage' sind enthalten.","notes":"Compaction-Rescue: bei Kontextverlust nur diesen Task + Tests laden; daraus ist klar, wann onboarding verpflichtend bleibt und wann nicht.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T14:21:10.802027+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T14:34:33.920646+01:00","closed_at":"2026-02-17T14:34:33.920646+01:00","close_reason":"Implemented: architecture specs + API agent_brief + MCP structured overflow + onboarding coverage-based intent + full quality gates.","dependencies":[{"issue_id":"kura-training-ce1.2","depends_on_id":"kura-training-ce1","type":"parent-child","created_at":"2026-02-17T14:21:10.802911+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ce1.3","title":"Implementierung: /v1/agent/context brief-first Contract + section handles","description":"Warum: Der aktuelle Context-Bundle-Shape ist gross und mischt Steuerung + Payload. Fuer robuste Agentensteuerung brauchen wir einen kleinen, immer vollstaendigen Brief und explizite Nachlade-Handles.","design":"Wie: API-Contract erweitern (neue versionierte Felder) mit agent_brief und available_sections/handles. Steuerungsfelder aus dem grossen Payload herausziehen. section-basierte Nachladepfade definieren, sodass full context abrufbar bleibt ohne Dump. Kontextvertrag in tests/architecture + API-Runtime-Tests pinnen.","acceptance_criteria":"1) /v1/agent/context liefert agent_brief mit Pflichtfeldern. 2) available_sections/handles sind maschinenlesbar und fuer Nachladen nutzbar. 3) Contract-Version ist erhoeht und dokumentiert. 4) Bestehende sicherheitsrelevante Gates bleiben intakt.","notes":"Compaction-Rescue: wenn Implementierung unterbrochen wird, zuerst Contract-Structs + Tests anschauen; nur diese Felder sind fuer Pflichtsteuerung kritisch.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T14:21:33.642355+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T14:34:33.921707+01:00","closed_at":"2026-02-17T14:34:33.921707+01:00","close_reason":"Implemented: architecture specs + API agent_brief + MCP structured overflow + onboarding coverage-based intent + full quality gates.","dependencies":[{"issue_id":"kura-training-ce1.3","depends_on_id":"kura-training-ce1","type":"parent-child","created_at":"2026-02-17T14:21:33.643233+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ce1.3","depends_on_id":"kura-training-ce1.1","type":"blocks","created_at":"2026-02-17T14:21:33.644583+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ce1.4","title":"Implementierung: MCP kura_agent_context Overflow-Protokoll statt silent truncation","description":"Warum: Der MCP-Limiter kann heute bei grossen Antworten auf summary-only/minimal fallen. Dadurch gehen fuer den Agenten entscheidende Inhalte verloren, obwohl die Antwort formal erfolgreich ist.","design":"Wie: Fuer kura_agent_context kein stilles Abschneiden von Steuerungsfeldern erlauben. Envelope so umbauen, dass bei Groessenlimit ein expliziter overflow-Block mit omitted_sections/reload_hints geliefert wird und der agent_brief vollstaendig bleibt. Entweder tool-spezifische Ausnahme oder neue truncation-policy mit guarantee-sets. Tests fuer positive/negative Faelle in mcp-runtime ergänzen.","acceptance_criteria":"1) Bei uebergrossem Kontext bleibt der Pflicht-Header unveraendert vorhanden. 2) Overflow ist strukturiert und nachladbar. 3) Keine summary-only Antwort ohne maschinenlesbare omitted_sections fuer kura_agent_context.","notes":"Compaction-Rescue: zentrale Stellen sind Payload-Limiter + tool_agent_context; nach Unterbrechung zuerst Tests laufen lassen, dann diese beiden Pfade fixen.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T14:22:02.806387+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T14:34:33.922775+01:00","closed_at":"2026-02-17T14:34:33.922775+01:00","close_reason":"Implemented: architecture specs + API agent_brief + MCP structured overflow + onboarding coverage-based intent + full quality gates.","dependencies":[{"issue_id":"kura-training-ce1.4","depends_on_id":"kura-training-ce1","type":"parent-child","created_at":"2026-02-17T14:22:02.807396+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ce1.4","depends_on_id":"kura-training-ce1.1","type":"blocks","created_at":"2026-02-17T14:22:02.808939+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ce1.4","depends_on_id":"kura-training-ce1.3","type":"blocks","created_at":"2026-02-17T14:22:02.809949+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ce1.5","title":"Implementierung: Onboarding-Intent Refactor (coverage/workflow statt Event-Count)","description":"Warum: Die aktuelle Onboarding-Entscheidung kann bei \u003e=5 Events deaktivieren, auch wenn zentrale Coverage-Luecken offen sind. Das entkoppelt Agent-Verhalten von den eigentlichen Workflow-Zielen.","design":"Wie: Onboarding-Triggerlogik in user_profile/agent-Policy so umbauen, dass offer_onboarding an workflow_state + required coverage gebunden ist. Erstkontakt liefert dual-path intent (onboarding anbieten + skip/log-now). Nach Skip: micro-onboarding ueber naechste offene Coverage-Luecke. Tests in workers/api erweitern (insb. viele Events + offene Coverage).","acceptance_criteria":"1) onboarding_needed/offer_onboarding bleibt aktiv bis definierte Schliessbedingungen erfuellt sind. 2) Dual-path ist im Erstkontakt vertraglich sichtbar. 3) Micro-onboarding-Intent ist deterministisch ableitbar.","notes":"Compaction-Rescue: zuerst _should_suggest_onboarding + Agenda-Builder + entsprechende Tests aufrufen; dort liegt die Kernlogik.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T14:22:24.230904+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T14:34:33.923785+01:00","closed_at":"2026-02-17T14:34:33.923785+01:00","close_reason":"Implemented: architecture specs + API agent_brief + MCP structured overflow + onboarding coverage-based intent + full quality gates.","dependencies":[{"issue_id":"kura-training-ce1.5","depends_on_id":"kura-training-ce1","type":"parent-child","created_at":"2026-02-17T14:22:24.232013+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ce1.5","depends_on_id":"kura-training-ce1.2","type":"blocks","created_at":"2026-02-17T14:22:24.233682+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ce1.6","title":"Stabilisierung: E2E-Verifikation, Quality-Gates, Handover-Rescue","description":"Warum: Die Aenderungen betreffen API, MCP und Worker gleichzeitig. Ohne gemeinsame Verifikation bleiben Cross-Layer-Regressionsrisiken hoch, besonders nach Session-Unterbrechungen.","design":"Wie: End-to-end Tests fuer Erstkontakt und grosses Context-Payload fahren. Danach alle AGENTS.md Quality-Gates laufen lassen. Bead-Notes/Handover mit klaren Recovery-Schritten und offenen Risiken aktualisieren, damit Folge-Sessions ohne Vorwissen weitermachen koennen.","acceptance_criteria":"1) Architecture-, Runtime- und relevante Integrationstests sind gruen. 2) AGENTS.md Quality-Gates sind dokumentiert ausgefuehrt. 3) Handover enthaelt klare Next-Steps + bekannte Restrisiken.","notes":"Compaction-Rescue: bei Neustart zuerst diesen Task + Abhaengigkeiten ansehen; dort steht der komplette Abschluss-Check inklusive Quality-Gates.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-17T14:22:46.122841+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-17T14:34:33.924853+01:00","closed_at":"2026-02-17T14:34:33.924853+01:00","close_reason":"Implemented: architecture specs + API agent_brief + MCP structured overflow + onboarding coverage-based intent + full quality gates.","dependencies":[{"issue_id":"kura-training-ce1.6","depends_on_id":"kura-training-ce1","type":"parent-child","created_at":"2026-02-17T14:22:46.12386+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ce1.6","depends_on_id":"kura-training-ce1.3","type":"blocks","created_at":"2026-02-17T14:22:46.125549+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ce1.6","depends_on_id":"kura-training-ce1.4","type":"blocks","created_at":"2026-02-17T14:22:46.126799+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ce1.6","depends_on_id":"kura-training-ce1.5","type":"blocks","created_at":"2026-02-17T14:22:46.127777+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-chuq","title":"CLI-Diagnostik: startup-contract checks, overflow-inspection, replaybare traces","description":"Why:\nOhne CLI-Diagnostik sind Runtime-Probleme schwer reproduzierbar; Teams verlieren nach Kontext-Compaction den roten Faden.\n\nHow:\nErweitere CLI um deterministische Diagnosekommandos/Flags (oder bestehende Kommandos), z.B.:\n- startup contract check (critical fields present?)\n- payload/overflow inspection (welche sections fehlen?)\n- replaybarer trace output mit reason codes und fetch sequence\nDamit Incident-Analyse ohne Prompt-Historie möglich wird.\n\nCompact-survival note:\nCLI-Ausgaben sind reproduzierbar und unabhängig vom Chat-Kontext; sie tragen Why/How der Laufzeitentscheidung explizit.","design":"CLI darf keine Sonderlogik erfinden, sondern muss den gleichen Contract/Reason-Codes wie MCP/API verwenden.","acceptance_criteria":"1) Es gibt einen stabilen CLI-Weg, Startup-/Overflow-Probleme ohne UI zu diagnostizieren.\n2) Ausgaben enthalten reason codes, missing sections und next safe action.\n3) Dokumentierte Beispiele fuer Incident-Reproduktion vorhanden.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T08:49:06.775553+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T09:16:50.023211+01:00","closed_at":"2026-02-21T09:16:50.023211+01:00","close_reason":"Closed","labels":["cli","diagnostics","ops"],"dependencies":[{"issue_id":"kura-training-chuq","depends_on_id":"kura-training-21cw","type":"parent-child","created_at":"2026-02-21T08:49:07.42076+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-chuq","depends_on_id":"kura-training-cz5u","type":"blocks","created_at":"2026-02-21T08:49:08.110966+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-chuq","depends_on_id":"kura-training-kqub","type":"blocks","created_at":"2026-02-21T08:49:08.217774+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-cj0","title":"Settings: API Key Management","description":"## Warum\nAPI Keys sind der primäre Weg wie Agents (Claude, ChatGPT, CLI) sich authentifizieren.\nUser muss Keys selbst erstellen und verwalten können — ohne Admin-CLI.\n\n## Was\n- Create Key: Dialog mit Label-Eingabe + Scope-Auswahl (agent:read, agent:write, agent:resolve)\n- One-Time Display Pattern (wie Sum): Nach Erstellung wird der vollständige Key EINMAL gezeigt\n  mit Copy-Button und Warnung \"Wird nie wieder angezeigt\". Danach nur noch Prefix (kura_sk_...a3f8)\n- List Keys: Tabelle mit Label, Key-Prefix, Scopes, Created, Last-Used\n- Revoke Key: Confirmation Dialog, dann DELETE\n\n## Backend-Endpoints (existieren bereits)\n- POST /v1/admin/create-key braucht admin → NEUEN Endpoint für Self-Service:\n  POST /v1/account/api-keys (erstellt Key für eingeloggten User)\n  GET /v1/account/api-keys (listet eigene Keys)\n  DELETE /v1/account/api-keys/{id} (revoked eigenen Key)\n  → Backend-Änderung nötig! Admin-Endpoints sind für CLI, Self-Service braucht eigene Routes.\n\n## Abhängigkeit\n- Blocked by: Browser Auth (kura-training-3kh)\n\n## Akzeptanzkriterien\n- User kann Key erstellen und sieht ihn einmalig vollständig\n- User sieht Liste aller eigenen Keys (Prefix, Label, Created)\n- User kann Key revoken mit Bestätigung\n- Revoked Keys werden als durchgestrichen angezeigt (oder ausgeblendet)","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:33:53.556199+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T15:01:27.113+01:00","closed_at":"2026-02-13T15:01:27.113+01:00","close_reason":"Implemented in settings page: Create API key (one-time display), list keys with prefix, revoke keys. Backend: POST/GET/DELETE /v1/account/api-keys endpoints.","dependencies":[{"issue_id":"kura-training-cj0","depends_on_id":"kura-training-3kh","type":"blocks","created_at":"2026-02-13T14:34:01.643369+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-crs","title":"Counterfactual Recommendation API fuer begruendete What-if-Erklaerungen","description":"Expose rationale + counterfactual alternatives pro Empfehlung (inkl. fehlender Evidenz und Unsicherheitsmarkierung), ohne Chat-UX zu ueberfrachten. Fokus: nachvollziehbare Human-Agent-Challenge.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-14T21:09:54.289393+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T21:40:36.321829+01:00","closed_at":"2026-02-14T21:40:36.321829+01:00","close_reason":"Closed"}
{"id":"kura-training-cryd","title":"Goldstandard Hardening: Readiness/Load/Causal/Eval Konsistenz","description":"## Kontext\nMehrere methodische Mängel wurden identifiziert: (1) Load in readiness/causal basiert derzeit auf weight*reps und unterschätzt nicht-Strength-Modalitäten, (2) fehlende Recovery-Signale werden mit festen Defaults (6.5h/6.0/0.0) imputiert, (3) Causal nutzt UTC-Tagesgrenzen und variablen statt echten t+1-Horizont, (4) Eval-Harness rekonstruiert readiness getrennt und driftet vom Produktionspfad, (5) externe Aktivitätsimporte werden in readiness nicht als Load-Signal verarbeitet.\n\n## Warum (Risiko)\nDiese Punkte erzeugen systematische Verzerrung, scheinbare Stabilität, und potentiell falsche Interventionsempfehlungen. Sie widersprechen dem eigenen Goldstandard-Anspruch (Uncertainty-first, Missingness transparent, modality-spezifische Last).\n\n## Zielzustand\nEin konsistenter, modality-aware Readiness/Causal/Eval-Pfad mit explizitem Missingness-Handling, gap-aware Zeitachse und klaren Architektur-Invarianten via `tests/architecture/`.\n\n## Scope\n- Shared readiness signal builder als Single Source of Truth\n- Readiness Inference: keine harten Fixed-Defaults in Score-Bildung; Missingness/Unsicherheit explizit\n- Load-Signal: duration/distance/contacts + volume_kg (wo vorhanden)\n- Causal: user-timezone grouping + echter t+1 Kalendertag\n- Eval Harness: Wiederverwendung Produktionslogik\n- Architektur-Spec-Tests zur dauerhaften Absicherung\n\n## Nicht-Ziele\n- Komplett neuer wissenschaftlicher Modell-Stack (z. B. vollständige BOCPD/BSTS-Neuentwicklung)\n- UI-Redesign\n\n## Definition of Done\nAlle abhängigen Tasks sind implementiert, getestet, via Quality Gates verifiziert und gepusht.","acceptance_criteria":"Epic abgeschlossen wenn alle Child-Tasks geschlossen sind, neue Architektur-Invarianten grün laufen und Quality Gates vollständig bestanden sind.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-19T14:44:38.279521+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T15:07:10.887565+01:00","closed_at":"2026-02-19T15:07:10.887565+01:00","close_reason":"Closed"}
{"id":"kura-training-cryd.1","title":"Architektur-Specs: Missingness, Modality-Load, Timezone+t+1 und Shared Builder absichern","description":"## Hintergrund\nDie Korrekturen sind methodisch kritisch und müssen als ausführbare Verträge dauerhaft im CI abgesichert werden (statt veraltender Design-Dokumente).\n\n## Warum\nOhne formale Contracts droht Regression in Richtung fester Defaults, modality-blinder Load-Berechnung, UTC-Fehlgruppierung und Eval/Prod-Drift.\n\n## Implementierung (Wie)\n- Neue `tests/architecture/`-Contracts ergänzen, die erzwingen:\n  1) Readiness-Load nutzt modality-aware Komponenten (nicht nur `weight*reps`).\n  2) Readiness-Path enthält keine harten Fixed-Defaults für fehlende Sleep/Energy/Soreness im Scoreing.\n  3) Causal nutzt user-timezone Normalisierung und echten kalendarischen t+1-Horizont.\n  4) Eval-Harness nutzt denselben Shared-Builder wie Production-Readiness.\n- Tests als Source-Contracts (string/invariant checks) im Stil der bestehenden Architekturtests.\n\n## Akzeptanz\n- Neue Architekturtests sind hinzugefügt und grün.\n- Tests schlagen fehl, wenn jemand auf alte Anti-Patterns zurückfällt.\n- Testnamen und Assertions sind selbsterklärend für Kontext-Recovery nach Compaction.","acceptance_criteria":"Neue Architekturtests in tests/architecture sind vorhanden, schlagen bei den alten Anti-Patterns fehl und laufen im regulären Testlauf grün.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T14:44:52.165071+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T14:58:48.697483+01:00","closed_at":"2026-02-19T14:58:48.697483+01:00","close_reason":"Architektur-Contracts 137-139 hinzugefuegt und gruen.","dependencies":[{"issue_id":"kura-training-cryd.1","depends_on_id":"kura-training-cryd","type":"parent-child","created_at":"2026-02-19T14:44:52.166461+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-cryd.2","title":"Shared Readiness Signal Builder einführen (modality-aware, missingness-aware)","description":"## Hintergrund\nReadiness-Handler und Eval-Harness duplizieren derzeit Signalrekonstruktion; Causal hat eine dritte, abweichende Variante. Das führt zu methodischem Drift.\n\n## Warum\nEine gemeinsame Quelle ist notwendig, um Konsistenz und Korrektheit zu garantieren.\n\n## Implementierung (Wie)\n- Neues Modul für tägliche Readiness-Signale erstellen (Single Source of Truth).\n- Input: relevante Event-rows inkl. timezone context.\n- Output: daily signal rows inkl. Komponenten, Missingness-Metadaten, Observationsgewicht/Uncertainty-Hinweise.\n- Load-Bildung modality-aware auf Basis bestehender Komponenten (`volume_kg`, `duration_seconds`, `distance_meters`, `contacts`) statt nur `weight*reps`.\n- Externe Aktivitätsimporte (`external.activity_imported`) als Load-Quelle berücksichtigen.\n\n## Akzeptanz\n- Shared Builder existiert und wird von Readiness+Eval genutzt.\n- Load in Builder verwendet modality-aware Komponenten.\n- Missingness-Metadaten sind pro Tag verfügbar.","acceptance_criteria":"Ein gemeinsames Modul liefert tägliche readiness-signals mit modality-aware load und missingness metadata; sowohl Readiness als auch Eval referenzieren dieses Modul.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T14:45:00.651367+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T14:58:48.849846+01:00","closed_at":"2026-02-19T14:58:48.849846+01:00","close_reason":"Shared readiness_signals builder implementiert; modality-aware load inkl. external.activity_imported.","dependencies":[{"issue_id":"kura-training-cryd.2","depends_on_id":"kura-training-cryd","type":"parent-child","created_at":"2026-02-19T14:45:00.652737+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cryd.2","depends_on_id":"kura-training-cryd.1","type":"blocks","created_at":"2026-02-19T14:45:48.474917+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-cryd.3","title":"Readiness Inference auf gap-aware Zeitachse + Missingness-Unsicherheit umbauen","description":"## Hintergrund\nReadiness verarbeitet derzeit Beobachtungen indexbasiert (0..n) und nutzt harte Defaults für fehlende Komponenten.\n\n## Warum\nBei Datenlücken sind Dynamik und Unsicherheit methodisch verzerrt. Das verletzt den Goldstandard (Uncertainty-first).\n\n## Implementierung (Wie)\n- `run_readiness_inference` erweitern um optionale Tagesachsen-Offsets (echte Kalendertage) und optionale pro-Observation Unsicherheits-/Gewichtsinformation.\n- Dynamikberechnung über echte Zeitabstände statt reiner Indexfolge.\n- Missingness explizit in Diagnostik/Data-Quality ausweisen; CI/Unsicherheit bei hohem Missingness-Anteil nachvollziehbar erhöhen.\n- Handler-Ausgabe (`daily_scores`, diagnostics, data_quality) entsprechend ergänzen.\n\n## Akzeptanz\n- Readiness nutzt echte Tagesabstände.\n- Keine stillen Fixed-Defaults als primäre Missing-Strategie.\n- Missingness wird transparent in Output/Diagnostik abgebildet.","acceptance_criteria":"Readiness-Inference verarbeitet day offsets und missingness-aware uncertainty; outputs enthalten nachvollziehbare missingness diagnostics.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T14:45:11.440374+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T14:58:49.005975+01:00","closed_at":"2026-02-19T14:58:49.005975+01:00","close_reason":"Readiness inference auf day_offsets + observation_variances erweitert; missingness diagnostics integriert.","dependencies":[{"issue_id":"kura-training-cryd.3","depends_on_id":"kura-training-cryd","type":"parent-child","created_at":"2026-02-19T14:45:11.441222+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cryd.3","depends_on_id":"kura-training-cryd.1","type":"blocks","created_at":"2026-02-19T14:45:48.631712+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cryd.3","depends_on_id":"kura-training-cryd.2","type":"blocks","created_at":"2026-02-19T14:45:48.782065+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-cryd.4","title":"Causal Inference: Timezone-korrektes Grouping und echter t+1 Outcome-Horizont","description":"## Hintergrund\nCausal gruppiert Tage derzeit über UTC-Datum und nimmt den nächsten beobachteten Tag als \"t+1\".\n\n## Warum\nDas verletzt die definierte Outcome-Semantik und kann Interventionseffekte verzerren.\n\n## Implementierung (Wie)\n- User-Timezone laden und `normalize_temporal_point` für lokale Tageszuordnung nutzen.\n- Windows nur dann als t+1 labeln, wenn ein echter nächster Kalendertag vorliegt (D+1).\n- Readiness-Komposit und Load-Signal aus Shared Builder/gleicher Methodik beziehen, um Readiness/Causal Konsistenz sicherzustellen.\n\n## Akzeptanz\n- Tageszuordnung ist timezone-korrekt.\n- t+1 entspricht D+1 Kalendertag.\n- Causal nutzt methodisch konsistente Daily-Signale.","acceptance_criteria":"Causal handler nutzt timezone-normalized day grouping und kalendarisches D+1 windowing; tests decken dies ab.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T14:45:18.201984+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T14:58:49.164272+01:00","closed_at":"2026-02-19T14:58:49.164272+01:00","close_reason":"Causal handler nutzt user-timezone grouping und echten D+1-Horizont.","dependencies":[{"issue_id":"kura-training-cryd.4","depends_on_id":"kura-training-cryd","type":"parent-child","created_at":"2026-02-19T14:45:18.202681+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cryd.4","depends_on_id":"kura-training-cryd.1","type":"blocks","created_at":"2026-02-19T14:45:48.922641+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cryd.4","depends_on_id":"kura-training-cryd.2","type":"blocks","created_at":"2026-02-19T14:45:49.076424+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-cryd.5","title":"Eval Harness auf Produktions-Readiness-Pfad spiegeln","description":"## Hintergrund\nDer Eval-Harness rekonstruiert readiness daily scores aktuell separat. Das kann pass/fail-Metriken vom echten Produktionsverhalten entkoppeln.\n\n## Warum\nShadow/Regression-Gates sind nur belastbar, wenn die Evaluations-Rekonstruktion denselben Signalpfad nutzt.\n\n## Implementierung (Wie)\n- Eval-Rekonstruktion auf Shared Readiness Builder umstellen.\n- Bei Inference-Replay echte Tagesabstände an `run_readiness_inference` übergeben.\n- Relevante Unit-Tests ergänzen/aktualisieren.\n\n## Akzeptanz\n- Keine doppelte Readiness-Rekonstruktionslogik im Eval-Harness.\n- Eval-Nowcast-Metriken basieren auf denselben Signalen wie Produktions-Readiness.","acceptance_criteria":"Eval harness verwendet shared readiness signal builder und day-offset aware readiness inference.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T14:45:26.639672+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T14:58:49.307934+01:00","closed_at":"2026-02-19T14:58:49.307934+01:00","close_reason":"Eval harness nutzt shared readiness builder und day-offset replay.","dependencies":[{"issue_id":"kura-training-cryd.5","depends_on_id":"kura-training-cryd","type":"parent-child","created_at":"2026-02-19T14:45:26.640513+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cryd.5","depends_on_id":"kura-training-cryd.2","type":"blocks","created_at":"2026-02-19T14:45:49.247502+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cryd.5","depends_on_id":"kura-training-cryd.3","type":"blocks","created_at":"2026-02-19T14:45:49.383918+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-cryd.6","title":"E2E Verifikation, Quality Gates und Session-Landung","description":"## Hintergrund\nDie Änderungen sind cross-cutting; ohne komplette Gates (Python/Rust/Integration) bleibt methodisches Risiko.\n\n## Warum\nGoldstandard erfordert reproduzierbare, vollständige Verifikation statt partieller Checks.\n\n## Implementierung (Wie)\n- Alle betroffenen Unit- und Architekturtests ausführen.\n- Vollständige Projekt-Quality-Gates gemäß AGENTS.md ausführen.\n- Eventuelle Folgearbeiten als Beads dokumentieren.\n\n## Akzeptanz\n- Quality Gates laut AGENTS.md sind durchgelaufen.\n- Offene Restarbeiten sind als Beads erfasst.\n- Git sync/push erfolgreich.","acceptance_criteria":"Alle in AGENTS.md geforderten Quality Gates sind gelaufen; verbleibende Arbeit ist als Beads erfasst; Änderungen sind gepusht.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T14:45:35.98543+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T15:06:53.891133+01:00","closed_at":"2026-02-19T15:06:53.891133+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-cryd.6","depends_on_id":"kura-training-cryd","type":"parent-child","created_at":"2026-02-19T14:45:35.986075+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cryd.6","depends_on_id":"kura-training-cryd.1","type":"blocks","created_at":"2026-02-19T14:45:49.506818+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cryd.6","depends_on_id":"kura-training-cryd.2","type":"blocks","created_at":"2026-02-19T14:45:49.634036+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cryd.6","depends_on_id":"kura-training-cryd.3","type":"blocks","created_at":"2026-02-19T14:45:49.764816+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cryd.6","depends_on_id":"kura-training-cryd.4","type":"blocks","created_at":"2026-02-19T14:45:49.911053+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cryd.6","depends_on_id":"kura-training-cryd.5","type":"blocks","created_at":"2026-02-19T14:45:50.060958+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-csy","title":"Exercise-ID Similarity Warnings bei POST /v1/events","description":"Wenn ein Event mit einer unbekannten exercise_id gepostet wird, soll die API ähnliche existierende exercise_ids als Warning zurückgeben. Erweitert das bestehende Plausibility Warnings System. Beispiel: POST mit exercise_id='lu_raise' → Warning: 'New exercise_id lu_raise. Similar existing: lateral_raise'. Verhindert stille Exercise-ID-Proliferation.","notes":"Entstanden aus Agent-Walkthrough (2026-02-10): Agent hat exercise_id='lu_raise' erstellt ohne zu wissen, dass 'lateral_raise' existiert. System akzeptiert alles ohne Feedback. Bestehende Plausibility Warnings: api/src/routes/events.rs (warn_unusual_values). Erweitern um exercise_id-Check gegen existierende IDs in der events-Tabelle. Ähnlichkeit z.B. über Levenshtein oder simple contains-Prüfung. Nur für exercise_id-Feld in set.logged und exercise.alias_created Events.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T19:47:34.648019+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T20:16:13.937477+01:00","closed_at":"2026-02-10T20:16:13.937477+01:00","close_reason":"Closed"}
{"id":"kura-training-ct3","title":"Agent Security Baseline V1: UX erhalten, Extraction erschweren","description":"Definiere eine Security-Baseline für agent-first Nutzung: normale Nutzer-UX bleibt schnell und intuitiv, gleichzeitig werden systematische Extraction-/Reverse-Engineering-Versuche wirtschaftlich unattraktiv gemacht.","design":"Adaptive Security statt harter Defaults: Low-friction Standardprofil, risikobasierte Eskalation bei Missbrauchssignalen, optionale strenge Profile für High-Security-Kontexte. Keine kritische Logik im Agenten, sondern serverseitig erzwingbare Invarianten und kontrollierte Kontextausgabe.","acceptance_criteria":"1) Security-Baseline-V1 dokumentiert (Default/Adaptive/Strict). 2) Konkrete Child-Issues mit messbaren Akzeptanzkriterien angelegt. 3) Abhängigkeiten spiegeln sinnvolle Implementierungsreihenfolge wider. 4) Erfolgsmessung über Security- und UX-Metriken definiert.","notes":"execution references\n- docs/design/014-autonomous-evidence-audit-roadmap.md\n- docs/design/038-ct3-security-baseline-execution-plan.md\n\nct3 final completion snapshot\n- closed: ct3.1, ct3.2, ct3.3, ct3.4, ct3.5, ct3.6, ct3.7\n\ndelivered baseline by objective\n1) Security baseline v1 documented:\n   - docs/design/027-agent-access-threat-model-and-security-tiering.md\n   - docs/design/039-adaptive-abuse-detection-and-rate-shaping-v1.md\n   - docs/design/040-security-telemetry-and-kill-switch-v1.md\n   - docs/design/041-security-profile-rollout-and-guardrail-dashboard-v1.md\n2) Child issues with measurable ACs: all ct3.x closed with compact-safe completion notes.\n3) Dependency order respected: 2 -\u003e 3 -\u003e 4 -\u003e 5 -\u003e 7 (with 6 completed in parallel track).\n4) Security+UX success metrics implemented:\n   - `security_abuse_telemetry` with action/risk/profile/ux fields\n   - guardrail dashboard endpoint `/v1/admin/security/guardrails/dashboard`\n   - rollout decision records in `security_profile_rollout_decisions`\n\nkey runtime controls now in place\n- context redaction boundary for untrusted agent access\n- scoped auth enforcement on agent APIs\n- adaptive abuse shaping with cooldown/recovery\n- operational kill switch + incident audit trail\n- staged profile rollout (default/adaptive/strict) + user overrides\n\nhandoff summary\n- ct3 execution plan remains authoritative in docs/design/038-ct3-security-baseline-execution-plan.md\n- all child issues include rollback and residual risk notes for safe operation","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:50.666662+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T19:53:44.727157+01:00","closed_at":"2026-02-12T19:53:44.727157+01:00","close_reason":"All CT3 security baseline children are complete: redaction, scoped auth, adaptive abuse shaping, telemetry+kill switch, and profile rollout with UX guardrail dashboard."}
{"id":"kura-training-ct3.1","title":"Threat Model + Security-Tiering für Agent-Zugriffe","description":"Erstelle ein technisches Threat Model für Agentzugriffe (Prompt-Exfiltration, API-Enumeration, Context-Scraping, Scope-Eskalation) und leite daraus drei Betriebsprofile ab: default, adaptive, strict.","design":"Lieferobjekt ist eine Risiko-Matrix mit Angreiferzielen, Angriffswegen, Erkennungsmerkmalen und Gegenmaßnahmen pro Profil.","acceptance_criteria":"1) Bedrohungsmodell mit priorisierten Angriffspfaden vorliegend. 2) Profilmatrix default/adaptive/strict mit klaren Schaltern dokumentiert. 3) Jede Maßnahme hat owner, Metrik und Rollout-Plan.","notes":"Implemented artifacts\n- docs/design/027-agent-access-threat-model-and-security-tiering.md (threat model + default/adaptive/strict matrix)\n- workers/src/kura_workers/system_config.py: added agent_behavior.operational.security_tiering (switch_catalog, profiles, threat_matrix)\n- workers/tests/test_system_config.py: added security_tiering coverage tests (profiles, switch catalog, threat matrix contract)\n- migrations/20260224000001_external_import_jobs.sql: made migration idempotent (CREATE INDEX IF NOT EXISTS + guarded CREATE POLICY)\n\nTests and exact commands\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nResidual risks / non-goals\n- No automatic runtime profile switching logic was added yet; this issue delivers the threat model + machine-readable contract.\n- No new telemetry emitters were added here; metrics are defined as contract fields.\n\nFollow-up issues\n- Continue with planned chain: kura-training-ct3.6 (server-side invariant enforcement review) and blocked ct3.* children.\n\nRollback / disable path\n- Remove/ignore agent_behavior.operational.security_tiering in system_config consumers to revert to prior behavior.\n- Revert commit touching system_config/tests/docs/migration if profile contract causes integration regressions.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:50.764126+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T13:58:37.448411+01:00","closed_at":"2026-02-12T13:58:37.448411+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-ct3.1","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:50.76494+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ct3.2","title":"Untrusted-Agent Boundary + Context-Redaction Contract","description":"Definiere und implementiere eine harte Vertrauensgrenze: Agenten gelten als untrusted; /v1/agent/context liefert nur benötigte, redigierte Daten ohne interne Heuristiken/Prompts/Architekturdetails.","design":"Contract-First für Context Payloads: erlaubte Felder, Redaction-Regeln, versionierte Response-Profile und Verifikation per Integrationstests.","acceptance_criteria":"1) Redaction-Policy pro Feldklasse implementiert. 2) Interne Strategiedaten werden nicht mehr ausgeliefert. 3) Contract-Versionierung + Tests für erlaubte/verbotene Felder vorhanden. 4) Keine Regression in Kern-UX-Flows.","notes":"compact-safe completion notes\n\nexecution anchor\n- docs/design/038-ct3-security-baseline-execution-plan.md\n\nimplemented artifacts\n- api/src/routes/agent.rs\n  - added contract metadata type `AgentContextSystemContract`\n  - added context contract version metadata in `AgentContextMeta`\n  - implemented field-class based system-config redaction for `/v1/agent/context`\n  - added allowlist policy for safe system contract fields and convention subsets\n  - added tests for allowed/forbidden system fields and contract version metadata\n- api/src/main.rs\n  - registered `AgentContextSystemContract` in OpenAPI schema components\n- docs/design/038-ct3-security-baseline-execution-plan.md\n  - authoritative compact-safe CT3 execution and resume protocol\n\nbehavior changes\n- `/v1/agent/context` now returns redacted `system` payload by default.\n- internal strategy/guidance classes (`agent_behavior`, `interview_guide`, unknown top-levels, and internal conventions) are excluded.\n- response meta now exposes machine-readable contract fields:\n  - `context_contract_version=agent_context.v2.redacted`\n  - `system_contract.profile=redacted_v1`\n  - `system_contract.default_unknown_field_action=deny`\n\ntests (exact commands)\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nresidual risks / non-goals\n- redaction policy currently targets `/v1/agent/context`; `/v1/system/config` remains full-fidelity by design.\n- convention allowlist is explicit and deny-by-default; newly added safe convention keys require deliberate allowlist updates.\n\nfollow-up issues\n- kura-training-ct3.3\n- kura-training-ct3.4\n- kura-training-ct3.5\n- kura-training-ct3.7\n\nrollback / disable path\n- revert `api/src/routes/agent.rs` redaction helpers + meta contract fields.\n- if needed for emergency compatibility, bypass `redact_system_config_for_agent(...)` call in `get_agent_context` and restore direct passthrough.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:50.869432+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T19:23:25.724666+01:00","closed_at":"2026-02-12T19:23:25.724666+01:00","close_reason":"Implemented untrusted-agent boundary for /v1/agent/context with field-class redaction policy, versioned contract metadata, and regression tests for allowed/forbidden fields.","dependencies":[{"issue_id":"kura-training-ct3.2","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:50.870202+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.2","depends_on_id":"kura-training-ct3.1","type":"blocks","created_at":"2026-02-11T20:59:51.429652+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ct3.3","title":"Least-Privilege Tokens + Scope Enforcement","description":"Führe kurzlebige, minimal-scope Tokens für Agent-Operationen ein und erzwinge Scope-Prüfung serverseitig pro Endpoint/Operation.","design":"Session-gebundene Berechtigungen, TTL, Token-Rotation, deny-by-default bei Scope-Missmatch; nachvollziehbar über Audit-Trail.","acceptance_criteria":"1) Kurzlebige Agent-Tokens mit Scope-Claims aktiv. 2) Scope-Verletzungen werden serverseitig blockiert. 3) Rotation/Expiry ohne UX-Brüche nachweisbar. 4) Audit-Events für AuthZ-Entscheidungen vorhanden.","notes":"compact-safe completion notes\n\nexecution anchor\n- docs/design/038-ct3-security-baseline-execution-plan.md\n\nimplemented artifacts\n- api/src/auth.rs\n  - extended `AuthenticatedUser` with persisted `scopes`\n  - auth DB reads now load scope claims for API keys and access tokens\n  - added `require_scopes(...)` deny-by-default scope enforcement helper\n  - added audit logging for authz decisions (allow/deny with operation + scopes)\n  - added scope matching tests (exact, wildcard, fail-closed behavior)\n- api/src/routes/agent.rs\n  - enforced per-endpoint scope checks:\n    - GET `/v1/agent/capabilities` -\u003e `agent:read`\n    - GET `/v1/agent/context` -\u003e `agent:read`\n    - GET `/v1/agent/evidence/event/{event_id}` -\u003e `agent:read`\n    - POST `/v1/agent/visualization/resolve` -\u003e `agent:resolve`\n    - POST `/v1/agent/write-with-proof` -\u003e `agent:write`\n- api/src/routes/auth.rs\n  - token issuing now writes scope claims into `oauth_access_tokens` and `oauth_refresh_tokens`\n  - access-token TTL reduced to 30 minutes for short-lived agent tokens\n  - refresh rotation preserves scopes and falls back to default agent scopes when legacy scope list is empty\n- cli/src/commands/admin.rs\n  - new API keys are created with default agent scopes (`agent:read`, `agent:write`, `agent:resolve`)\n\nbehavior changes\n- scoped tokens are now first-class in auth resolution and authorization checks.\n- `/v1/agent/*` operations are blocked server-side on missing scopes (403 forbidden).\n- OAuth-issued agent tokens are short-lived (1800s) and remain refresh-rotated.\n\ntests (exact commands)\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n\nresidual risks / non-goals\n- scope checks are currently enforced on `/v1/agent/*`; non-agent routes remain unchanged in this issue.\n- clients relying on legacy unscoped credentials for agent endpoints must rotate credentials or re-authenticate.\n\nfollow-up issues\n- kura-training-ct3.4\n- kura-training-ct3.5\n- kura-training-ct3.7\n\nrollback / disable path\n- remove/bypass `require_scopes(...)` calls in `api/src/routes/agent.rs` to restore pre-ct3.3 behavior.\n- revert scope-aware token insertion in `api/src/routes/auth.rs` and auth scope extraction in `api/src/auth.rs`.\n- revert CLI key-default scopes if emergency compatibility rollback is required.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:50.967046+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T19:28:43.713919+01:00","closed_at":"2026-02-12T19:28:43.713919+01:00","close_reason":"Implemented short-lived scoped agent tokens, server-side per-endpoint scope enforcement for /v1/agent/*, scope-aware refresh rotation, and authz audit logging.","dependencies":[{"issue_id":"kura-training-ct3.3","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:50.968139+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.3","depends_on_id":"kura-training-ct3.1","type":"blocks","created_at":"2026-02-11T20:59:51.509287+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ct3.4","title":"Adaptive Abuse Detection + Rate Shaping","description":"Erkenne Extraction-Muster (z. B. systematische Enumeration, atypische Query-Sequenzen) und schalte adaptiv auf strengere Limits, statt harte Global-Limits für alle Nutzer zu erzwingen.","design":"Signalpipeline mit Heuristiken/Thresholds, progressive Drosselung und Rückfall auf Normalprofil nach Cooldown.","acceptance_criteria":"1) Missbrauchssignale und Schwellenwerte definiert. 2) Adaptive Limits greifen nur bei Risk Signals. 3) False-Positive-Rate und UX-Impact werden gemessen. 4) Recovery-/Cooldown-Mechanik implementiert.","notes":"compact-safe completion notes\n\nexecution anchor\n- docs/design/038-ct3-security-baseline-execution-plan.md\n\nimplemented artifacts\n- api/src/middleware/adaptive_abuse.rs\n  - new adaptive abuse middleware for `/v1/agent/*`\n  - deterministic risk signal extraction from recent `api_access_log`\n  - weighted risk scoring + progressive actions (`allow` / `throttle` / `block`)\n  - cooldown policy with decay + recovery transition\n  - response headers for shaping observability (`x-kura-abuse-*`)\n  - block response contract with machine-readable context (`field=security_abuse` + `received` window)\n  - unit coverage for scoring, normalization, cooldown and recovery behavior\n- api/src/middleware/mod.rs\n  - registered `adaptive_abuse` middleware module\n- api/src/main.rs\n  - wired adaptive abuse middleware into agent route stack\n- migrations/20260227000001_security_abuse_telemetry.sql\n  - added telemetry table for abuse actions, risk metrics, cooldown state, false-positive hints, and UX-impact hints\n- docs/design/039-adaptive-abuse-detection-and-rate-shaping-v1.md\n  - signal taxonomy, thresholds, runtime behavior, cooldown model, measurement contract\n\nbehavior changes\n- adaptive shaping now applies only to `/v1/agent/*` and only when risk signals rise.\n- shaping is progressive:\n  - throttle -\u003e delay (150-500ms)\n  - block -\u003e HTTP 429 + retry-after\n- cooldown prevents immediate oscillation; recovery emits explicit telemetry transition.\n- telemetry persists signal/decision/outcome tuples in `security_abuse_telemetry` for false-positive and UX-impact analysis.\n\ntests (exact commands)\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n\nresidual risks / non-goals\n- cooldown state is process-local in v1 (no shared distributed state across multiple API instances).\n- v1 shaping scope is `/v1/agent/*`; non-agent endpoints are unchanged.\n- risk scoring is heuristic/deterministic (no model-based anomaly detection in this issue).\n\nfollow-up issues\n- kura-training-ct3.5\n- kura-training-ct3.7\n\nrollback / disable path\n- remove `.layer(middleware::adaptive_abuse::agent_layer(...))` from agent router in `api/src/main.rs`.\n- revert `api/src/middleware/adaptive_abuse.rs` and module export in `api/src/middleware/mod.rs`.\n- if schema rollback needed, revert migration `20260227000001_security_abuse_telemetry.sql`.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:51.060406+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T19:39:44.998085+01:00","closed_at":"2026-02-12T19:39:44.998085+01:00","close_reason":"Implemented adaptive abuse detection and progressive rate shaping for /v1/agent/* with risk signals, cooldown/recovery, and telemetry for false-positive/UX impact measurement.","dependencies":[{"issue_id":"kura-training-ct3.4","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:51.061221+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.4","depends_on_id":"kura-training-ct3.1","type":"blocks","created_at":"2026-02-11T20:59:51.590226+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.4","depends_on_id":"kura-training-ct3.3","type":"blocks","created_at":"2026-02-11T20:59:51.831855+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ct3.5","title":"Security Telemetry + Audit Trail + Kill Switch","description":"Baue vollständige Security-Telemetrie für Agentzugriffe auf und implementiere einen operativen Kill-Switch zum schnellen Entzug von Agent-Rechten/Tokens bei Auffälligkeiten.","design":"Event-Taxonomie für Zugriff, Scope-Denials, Redaction-Hits, Risk-Score-Überschreitungen; automatisierbare Response-Policies.","acceptance_criteria":"1) Security-Telemetrie-Endpunkte/Events standardisiert. 2) Kill-Switch kann Token/Agentzugriff sofort deaktivieren. 3) Alarmierung und Runbook dokumentiert. 4) Drill/Test eines Incident-Flows erfolgreich.","notes":"compact-safe completion notes\n\nexecution anchor\n- docs/design/038-ct3-security-baseline-execution-plan.md\n\nimplemented artifacts\n- migrations/20260227000002_security_kill_switch.sql\n  - singleton kill-switch state table (`security_kill_switch_state`)\n  - append-only incident audit table (`security_kill_switch_audit`)\n  - indexes + grants for writer/reader roles\n- api/src/middleware/kill_switch.rs\n  - runtime enforcement middleware on `/v1/agent/*`\n  - active kill switch returns structured 403 + `x-kura-kill-switch: active`\n  - blocked requests are audit-logged (`blocked_request`)\n  - DB-backed status lookup for fast operational deactivation of agent access\n- api/src/routes/security.rs\n  - admin-only kill-switch control endpoints:\n    - GET /v1/admin/security/kill-switch\n    - POST /v1/admin/security/kill-switch/activate\n    - POST /v1/admin/security/kill-switch/deactivate\n    - GET /v1/admin/security/kill-switch/audit\n  - admin-only telemetry endpoint:\n    - GET /v1/admin/security/telemetry/abuse\n  - normalized incident reason handling + explicit admin authorization checks\n- api/src/middleware/mod.rs\n  - registered kill-switch middleware module\n- api/src/routes/mod.rs\n  - registered security routes module\n- api/src/main.rs\n  - OpenAPI path/schema registration for security endpoints\n  - merged security admin router\n  - layered kill-switch middleware into agent route stack\n- docs/design/040-security-telemetry-and-kill-switch-v1.md\n  - v1 behavior, data contracts, runbook, and drill procedure documented\n\nbehavior changes\n- operators can now activate/deactivate a kill switch via admin API.\n- while active, all `/v1/agent/*` calls are denied with consistent machine-readable error payload.\n- activation/deactivation and blocked-request decisions are persisted in `security_kill_switch_audit`.\n- security telemetry is queryable via `/v1/admin/security/telemetry/abuse` (from CT3.4 telemetry table).\n\ntests (exact commands)\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n\nincident drill/test reference\n- documented in docs/design/040-security-telemetry-and-kill-switch-v1.md (section: Drill / Test Procedure)\n- includes activate -\u003e verify blocked request -\u003e verify audit trail -\u003e deactivate -\u003e verify recovery\n\nresidual risks / non-goals\n- v1 kill switch is scoped to `/v1/agent/*` only (not full-platform lock).\n- no auto-paging integration yet; operational alerting remains manual/on-call process.\n- stronger distributed invalidation/propagation can be added later for multi-instance high-throughput tuning.\n\nfollow-up issues\n- kura-training-ct3.7\n\nrollback / disable path\n- remove kill-switch layer from agent router wiring in `api/src/main.rs`.\n- remove `api/src/middleware/kill_switch.rs` + module registration.\n- remove security routes merge/module if API control endpoints should be disabled.\n- revert migration `20260227000002_security_kill_switch.sql` if schema rollback is required.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:51.156147+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T19:46:14.588655+01:00","closed_at":"2026-02-12T19:46:14.588655+01:00","close_reason":"Implemented security telemetry endpoints, persistent incident audit trail, and an operational kill switch that can disable agent access immediately on /v1/agent/*.","dependencies":[{"issue_id":"kura-training-ct3.5","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:51.156896+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.5","depends_on_id":"kura-training-ct3.1","type":"blocks","created_at":"2026-02-11T20:59:51.668029+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.5","depends_on_id":"kura-training-ct3.3","type":"blocks","created_at":"2026-02-11T20:59:51.9142+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ct3.6","title":"Server-Side Invariant Enforcement Review","description":"Prüfe und härte kritische Domain-Invarianten, damit kein Agent durch Prompting/Tool-Missbrauch kritische Regeln umgehen kann.","design":"Inventory aller kritischen Invarianten mit Zuordnung zu serverseitigen Checks, inkl. Lückenanalyse und Schließungsplan.","acceptance_criteria":"1) Invariant-Inventar vollständig und priorisiert. 2) Kritische Lücken mit serverseitigen Guards geschlossen. 3) Regressionstests für Bypass-Szenarien vorhanden. 4) Policy-Verletzungen erzeugen maschinenlesbare Fehlercodes.","notes":"Implemented artifacts\n- docs/design/028-server-side-invariant-enforcement-review.md (prioritized invariant inventory + gap closure mapping)\n- api/src/error.rs: added AppError::PolicyViolation (HTTP 422, machine-readable policy/invariant error codes)\n- api/src/routes/events.rs:\n  - added validate_critical_invariants() and event-specific guards for event.retracted, set.corrected, projection_rule.created, projection_rule.archived\n  - added invariant helper validators and inv_* error code emission\n  - batch/simulate validators now preserve per-event index context for PolicyViolation\n  - added regression tests for bypass scenarios (malformed retraction/correction/rule payloads)\n\nTests and exact commands\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nResidual risks / non-goals\n- No historical replay/backfill remediation for already persisted malformed events in this issue.\n- No dynamic security-profile switching in runtime; ct3.7 remains responsible for rollout/UX dashboard.\n\nFollow-up issues\n- kura-training-ct3.7 (security profile rollout + UX guardrail dashboard)\n- kura-training-pdc.19 (next chain dependency now unblocked)\n\nRollback / disable path\n- Revert commit touching api/src/error.rs + api/src/routes/events.rs to restore pre-ct3.6 behavior.\n- If selective disable is needed, bypass validate_critical_invariants() call in validate_event while keeping generic validation intact.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:51.25517+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T14:04:24.756506+01:00","closed_at":"2026-02-12T14:04:24.756506+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-ct3.6","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:51.255935+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.6","depends_on_id":"kura-training-ct3.1","type":"blocks","created_at":"2026-02-11T20:59:51.749985+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ct3.7","title":"Security-Profile Rollout + UX Guardrail Dashboard","description":"Führe die Profile default/adaptive/strict kontrolliert aus und messe parallel Sicherheit und UX, um Überhärtung zu vermeiden.","design":"Rollout per Feature-Flags, Vergleichsmessungen und Dashboard für Security-Outcome vs UX-Kennzahlen.","acceptance_criteria":"1) Feature-Flags für Profile aktiv. 2) Dashboard mit Security- und UX-KPIs live. 3) Rollout-Entscheidungen datenbasiert dokumentiert. 4) Default-Profil bleibt für normale Nutzer friction-arm.","notes":"compact-safe completion notes\n\nexecution anchor\n- docs/design/038-ct3-security-baseline-execution-plan.md\n\nimplemented artifacts\n- migrations/20260227000003_security_profile_rollout.sql\n  - added rollout feature-flag config table (`security_profile_rollout`)\n  - added per-user profile override table (`security_profile_user_overrides`)\n  - added rollout decision record table (`security_profile_rollout_decisions`)\n  - extended `security_abuse_telemetry` with `profile` for profile-level KPI slicing\n- api/src/security_profile.rs\n  - shared profile model (`default|adaptive|strict`)\n  - rollout config loader\n  - deterministic bucket-based profile resolver + override precedence\n- api/src/middleware/adaptive_abuse.rs\n  - profile-aware scoring thresholds/cooldown/delay tuning\n  - default profile configured as low-friction baseline\n  - profile/source/bucket headers emitted for observability\n  - telemetry now persists profile tag and captures all agent requests for dashboard quality\n- api/src/routes/security.rs\n  - rollout control endpoints:\n    - GET/POST /v1/admin/security/profiles/rollout\n  - override endpoints:\n    - POST/DELETE /v1/admin/security/profiles/overrides/{user_id}\n  - decision record endpoints:\n    - POST/GET /v1/admin/security/profiles/decisions\n  - guardrail dashboard endpoint:\n    - GET /v1/admin/security/guardrails/dashboard\n  - dashboard returns paired security+UX KPIs per profile (24h window)\n- api/src/main.rs\n  - OpenAPI registration for new profile/guardrail endpoints + schemas\n  - module registration for security profile utilities\n- docs/design/041-security-profile-rollout-and-guardrail-dashboard-v1.md\n  - rollout mechanics, KPI definitions, decision-record model, residual risks\n\nbehavior changes\n- security profile rollout is now feature-flag driven and staged.\n- profile selection order: explicit user override -\u003e deterministic rollout bucket -\u003e configured default profile.\n- adaptive middleware behavior is profile-tuned:\n  - `default`: high-threshold, low-friction behavior\n  - `adaptive`: balanced baseline shaping\n  - `strict`: aggressive abuse response\n- guardrail dashboard exposes security + UX metrics together, profile-by-profile.\n- rollout decisions are now data-backed artifacts with metrics + config snapshot.\n\ndone criteria mapping\n- feature flags + staged rollout mechanics: implemented (rollout table + bucket resolver + overrides)\n- dashboard with security+UX impact: implemented (`/v1/admin/security/guardrails/dashboard`)\n- rollout decisions data-based: implemented (`security_profile_rollout_decisions` + POST/GET endpoints)\n- default profile friction-arm for normal users: implemented via high-threshold default tuning + explicit test coverage\n\ntests (exact commands)\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n\nresidual risks / non-goals\n- guardrail dashboard is a nearline operational view, not long-horizon BI.\n- rollout uses deterministic hashing (simple and explainable) rather than adaptive policy learning.\n- deeper multi-region rollout propagation concerns can be addressed in future hardening.\n\nfollow-up issues\n- none required to satisfy current acceptance criteria; optional future hardening can target distributed rollout propagation and historical BI depth.\n\nrollback / disable path\n- set rollout to safe baseline:\n  - `default_profile=default`, `adaptive_rollout_percent=0`, `strict_rollout_percent=0`\n- delete user overrides to return to rollout baseline.\n- remove profile-aware middleware behavior by reverting `api/src/security_profile.rs` + adaptive middleware integration.\n- revert migration `20260227000003_security_profile_rollout.sql` if schema rollback is required.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:51.351139+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T19:53:15.580175+01:00","closed_at":"2026-02-12T19:53:15.580175+01:00","close_reason":"Implemented profile feature flags, staged rollout controls, security-vs-UX guardrail dashboard, and data-backed rollout decision records while keeping default profile low-friction.","dependencies":[{"issue_id":"kura-training-ct3.7","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:51.351837+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.7","depends_on_id":"kura-training-ct3.2","type":"blocks","created_at":"2026-02-11T20:59:51.992072+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.7","depends_on_id":"kura-training-ct3.3","type":"blocks","created_at":"2026-02-11T20:59:52.069273+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.7","depends_on_id":"kura-training-ct3.4","type":"blocks","created_at":"2026-02-11T20:59:52.147092+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.7","depends_on_id":"kura-training-ct3.5","type":"blocks","created_at":"2026-02-11T20:59:52.222681+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.7","depends_on_id":"kura-training-ct3.6","type":"blocks","created_at":"2026-02-11T20:59:52.30312+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ctv","title":"Runtime Model Identity Attestation V1 (No Manual Mapping)","description":"Replace static model identity env mapping with per-request runtime attestation from agent gateway, so operators do not maintain per-user or per-model mapping. Keep deterministic safe fallback when attestation missing/invalid.","design":"Implement signed model attestation in /v1/agent/write-with-proof and related agent endpoints. Source of truth becomes request-scoped attestation (runtime_model_identity + issued_at + nonce/request_id + signature) verified server-side. Persist attested model identity as telemetry/event metadata for automatic per-model quality scoring. Unknown/new models default to safe confirm_first policy; tier promotion/demotion is automated from observed quality metrics with hysteresis and min-sample gates. Preserve existing quality_health gating and reason-code explainability.","acceptance_criteria":"1) Runtime identity is request-scoped and verified cryptographically (no manual env map required for normal operation). 2) Missing/invalid attestation fails closed to safe policy with explicit reason codes. 3) Telemetry persists runtime model identity per request for automated per-model scoring. 4) Automated tiering includes min sample threshold + hysteresis to avoid oscillation. 5) Tests cover valid attestation, invalid signature, replay/stale attestation, and unknown model fallback behavior.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T21:18:51.615406+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T10:52:49.860459+01:00","closed_at":"2026-02-14T10:52:49.860459+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-ctv","depends_on_id":"kura-training-wvp","type":"blocks","created_at":"2026-02-13T21:19:21.558426+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ctv","depends_on_id":"kura-training-d8o","type":"blocks","created_at":"2026-02-13T21:20:16.034149+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ctv","depends_on_id":"kura-training-ohr","type":"blocks","created_at":"2026-02-13T21:20:26.227773+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ctv","depends_on_id":"kura-training-akn","type":"blocks","created_at":"2026-02-13T21:20:36.476085+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ctv","depends_on_id":"kura-training-gh0","type":"blocks","created_at":"2026-02-13T21:20:44.30747+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-cz5u","title":"Runtime-FSM: fail-closed Gates, Retry-Budgets, deterministische Ladefolge","description":"Why:\nSelbst mit besseren APIs halluziniert das Modell weiter, wenn die Runtime nicht hart verhindert, dass mit unvollständigem Kontext generiert wird.\n\nHow:\nImplementiere eine deterministische Runtime-FSM mit pre-generation gate:\n- Ladefolge erzwingen: capsule -\u003e required critical sections -\u003e optional.\n- Wenn critical_missing_sections != []: status=blocked/degraded statt normaler Antwort.\n- Retry-Budget/Timeouts strikt begrenzen; danach strukturierte Eskalation statt Freestyle.\n\nCompact-survival note:\nDie FSM kapselt Verhalten serverseitig; Qualität hängt damit weniger von Prompt-Zustand/Kontextlänge ab.","design":"Fail-closed by default. Kein Pfad darf von \"blocked\" in freie Generierung springen ohne erneute Gate-Prüfung.","acceptance_criteria":"1) Runtime blockiert normale Antwort bei fehlenden critical sections deterministisch.\n2) Blocked/degraded reason codes sind stabil und maschinenlesbar.\n3) Keine spekulative Antwort ohne Daten-Provenance.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T08:49:06.480952+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T09:16:49.775922+01:00","closed_at":"2026-02-21T09:16:49.775922+01:00","close_reason":"Closed","labels":["fsm","runtime","safety"],"dependencies":[{"issue_id":"kura-training-cz5u","depends_on_id":"kura-training-21cw","type":"parent-child","created_at":"2026-02-21T08:49:07.220463+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cz5u","depends_on_id":"kura-training-gayi","type":"blocks","created_at":"2026-02-21T08:49:07.711986+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-cz5u","depends_on_id":"kura-training-79mg","type":"blocks","created_at":"2026-02-21T08:49:07.90883+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-cza","title":"Design Decision: training_plan dimension (prescriptive)","description":"Training plan is fundamentally different from existing dimensions: prescriptive (what SHOULD happen) vs descriptive (what DID happen). Needs own design doc. Key questions: Template vs concrete days? Load prescription (concrete kg vs RPE-based)? Plan lifecycle (active/archived/paused)? Adherence tracking (cross-dimension with training_timeline)? See Design Doc 002, Decision 9 for context.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T08:02:16.209951+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:07:39.769468+01:00","closed_at":"2026-02-09T08:07:39.769468+01:00","close_reason":"Implemented as part of Decision 9 — all 7 domain dimensions now have handlers"}
{"id":"kura-training-d2j","title":"[task] Recalibrate admin telemetry anomaly thresholds with real user traffic","description":"Follow-up to kura-training-d51: validate /v1/admin/agent/telemetry/* anomaly thresholds on real production usage from actual users (not only internal single-user traffic), then finalize severity cutoffs.","acceptance_criteria":"1) Observation window covers at least 14 days (Feb 15, 2026 to Mar 1, 2026 or later). 2) Data includes at least 5 distinct real users, \u003e=150 /v1/agent/write-with-proof calls, and \u003e=50 advisory_scoring_assessed learning signals. 3) False-positive review is documented against real sessions (sampled anomalies with true/false-positive decision). 4) Threshold/severity updates are reflected in api/src/routes/agent_telemetry.rs and pinned by runtime tests.","notes":"Must be verified on actual users (Fred production traffic), not only local/test traffic. Include concrete SQL evidence snapshot in completion notes.","status":"in_progress","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T19:02:58.432039+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T19:08:45.184576+01:00"}
{"id":"kura-training-d2p","title":"Go-Live: Supabase API/RPC Surface Minimization (DB-only)","description":"App laeuft nach AUTH_STRATEGY=B DB-only ueber eigene API. Supabase Data API/RPC/GraphQL/Realtime Surface soll minimiert werden, um Scanner-Funde (u.a. RPC Function Enumeration, API Version Disclosure) ohne UX-Verlust zu reduzieren.","acceptance_criteria":"- Usage-Audit dokumentiert: Web/API/Worker nutzen keine Supabase REST/RPC/GraphQL Endpunkte\\n- Entscheidung pro Surface dokumentiert: deaktivieren oder explizit akzeptieren\\n- Falls Data API aktiv bleibt: anon/authenticated koennen keine produktiven RPC/Tabellenzugriffe ausfuehren (grants+RLS verifiziert)\\n- Re-Scan zeigt keinen HIGH-Fund fuer RPC Enumeration mehr oder begruendete Ausnahme ist dokumentiert","status":"open","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T10:51:13.367463+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T10:51:13.367463+01:00"}
{"id":"kura-training-d51","title":"[task] Calibrate admin agent telemetry anomaly thresholds","description":"Calibrate anomaly thresholds in /v1/admin/agent/telemetry/* with real Fred session telemetry. Validate false-positive rate, adjust severity cutoffs, and lock final defaults in runtime tests.","status":"deferred","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T23:15:38.67515+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T19:03:04.522869+01:00","defer_until":"2026-03-01T00:00:00+01:00","dependencies":[{"issue_id":"kura-training-d51","depends_on_id":"kura-training-d2j","type":"blocks","created_at":"2026-02-15T19:03:04.522663+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-d8o","title":"[ctv.1] Agent API model attestation contract + verification","description":"Add request-scoped model attestation payload to agent write contract; verify signature/freshness/replay and resolve runtime model identity from attestation first.","acceptance_criteria":"1) /v1/agent/write-with-proof accepts model_attestation payload. 2) Signature+freshness verified server-side. 3) Missing/invalid attestation yields explicit reason codes and safe fallback.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T21:19:34.583242+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:41:15.833542+01:00","closed_at":"2026-02-13T21:41:15.833542+01:00","close_reason":"Closed"}
{"id":"kura-training-dd1","title":"Projection rule lifecycle API (validate/preview/apply/archive)","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T07:42:51.683247+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T08:09:40.452496+01:00","closed_at":"2026-02-11T08:09:40.452496+01:00","close_reason":"Implemented projection rule lifecycle API: validate, preview, apply (create/update), and archive endpoints with strict rule validation, event-sourced writes, preview stats, and OpenAPI schema coverage"}
{"id":"kura-training-ddf","title":"[task] AgentBrief um operational_model erweitern (Rust)","description":"## Kontext\n\nTeil des operational_model Features (kura-training-nco). Die Rust-Seite liest operational_model aus system_config und stellt es im agent_brief bereit. Der Brief ist das Erste was der Agent liest — hier muss das Paradigma ankommen.\n\n## Was zu tun ist\n\n1. AgentBrief struct erweitern:\n   - Neues Feld: pub operational_model: Option\u003cAgentOperationalModel\u003e\n   - AgentOperationalModel struct mit: paradigm (String), mutations (String), corrections (String), state_access (String), event_types (String), common_operations (Vec\u003cAgentCommonOperation\u003e)\n   - AgentCommonOperation: pattern (String), via (String), hint (String)\n\n2. build_agent_brief() anpassen:\n   - system_config Parameter hat jetzt operational_model\n   - Aus system_config.data['operational_model'] lesen und in AgentBrief einfügen\n   - KEIN Hardcoding — wenn system_config kein operational_model hat, ist das Feld None (graceful degradation)\n\n3. Bestehenden Test erweitern:\n   - agent_context_brief_contract_exposes_required_fields: prüfen dass operational_model im Brief ist wenn system_config es enthält\n   - Neuer Test: operational_model wird aus system_config gelesen, nicht hardcoded\n\n## Wie\n\n- Structs in api/src/routes/agent.rs (neben bestehendem AgentBrief)\n- Serde Deserialize für SystemConfigResponse erweitern (operational_model Feld)\n- build_agent_brief() bekommt system Option\u003c\u0026SystemConfigResponse\u003e — dort operational_model extrahieren\n- Pattern folgen: wie system_config_ref bereits im Brief ist\n\n## Dateien\n\n- api/src/routes/agent.rs (Structs + build_agent_brief + Tests)\n- api/src/routes/agent/policy.rs (ggf. Schema-Version bump)","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-18T22:51:23.227944+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T07:49:05.949159+01:00","closed_at":"2026-02-19T07:49:05.949159+01:00","close_reason":"AgentOperationalModel struct + operational_model field in AgentBrief + Rust unit test","dependencies":[{"issue_id":"kura-training-ddf","depends_on_id":"kura-training-fga","type":"blocks","created_at":"2026-02-18T22:52:10.163629+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-de9","title":"Data Integrity: API Response Warnings (Plausibilitäts-Checks)","description":"POST /v1/events und /v1/events/batch geben bei auffälligen Werten Warnings im Response zurück. Kein Reject, nur Signal.\n\nResponse-Erweiterung:\n{\n  id: '...',\n  warnings: [{field, message, severity: 'warning'}]\n}\n\nPlausibilitätsregeln sind dimension-spezifisch und könnten perspektivisch in system_config stehen (damit der Agent sie vorab kennt). Für den Anfang reichen hardcoded Regeln in der API.\n\nBeispiele:\n- weight_kg \u003e 300 bei set.logged → Warning\n- weight_kg \u003e 250 bei bodyweight.logged → Warning\n- calories \u003e 5000 bei meal.logged → Warning\n- Negative Werte bei Mengenfeldern → Warning\n\nWichtig: Das ist die schwächste Schicht (Prevention). Anomalie-Erkennung in den Handlern (Detection) ist wichtiger, weil sie auch Events erwischt, die einzeln plausibel sind aber im Kontext nicht (z.B. 1RM-Sprung von 100%). Deshalb P3, nicht P2.\n\nDesignfrage: Woher kommen die Regeln? Hardcoded? system_config? Per-User lernend? Für v1 reicht hardcoded.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:50.277755+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T16:22:04.83165+01:00","closed_at":"2026-02-09T16:22:04.83165+01:00","close_reason":"API plausibility warnings on event creation, 21 Rust unit tests, thresholds match Python handler anomaly detection","dependencies":[{"issue_id":"kura-training-de9","depends_on_id":"kura-training-57d","type":"blocks","created_at":"2026-02-09T15:42:02.813621+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-dg7r","title":"Rollout metric hardening: replace speculative_answer_rate proxy with grounded response evidence","description":"Why: speculative_answer_rate currently uses guard-signal proxy and does not yet measure user-visible speculation directly. How: add deterministic evidence source from response generation/audit path (e.g., post-response verifier signals), then feed that into rollout_guard so abort criteria reflect actual speculative outputs rather than only precondition misses.","status":"open","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T11:41:28.434357+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T11:41:34.358211+01:00"}
{"id":"kura-training-dgnq","title":"Capability Estimation v1 migration program (strength + sprint + jump + endurance)","description":"WHY:\nCurrent performance estimation is inconsistent across domains: strength uses simple Epley proxies, sprint/jump/endurance are not yet on a unified latent-state standard, and uncertainty handling differs per projection. This creates false precision risk in an agent-only backend where machine-readable confidence is critical.\n\nHOW:\nRun a strict phase migration based on capability_estimation.v1 (observation model -\u003e state model -\u003e output contract). Each phase must deliver protocol-aware comparability, explicit insufficiency handling, and deterministic output fields for agent consumption.\n\nMIGRATION ORDER (program backbone):\n1) kura-training-o6wi (foundation)\n2) strength track: kura-training-6v6r -\u003e kura-training-mxb3 -\u003e kura-training-guz5 -\u003e kura-training-8a71 -\u003e kura-training-31yb\n3) kura-training-pp5m (sprint)\n4) kura-training-56jn (jump)\n5) kura-training-ixt8 (endurance)\n6) kura-training-95ck (agent output contract rollout)\n7) kura-training-w61v (cross-capability eval/rollout gate)\n8) kura-training-klbf (causal upgrade on top of stabilized capability outcomes)\n\nCOMPACTION-RESILIENT RESUME:\nIf chat context is lost, resume from the first OPEN dependency in the sequence above. Every child issue contains self-sufficient why/how/acceptance so implementation can continue end to end without prior conversation history.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:37:38.824114+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:35.657673+01:00","closed_at":"2026-02-20T19:28:35.657673+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo).","dependencies":[{"issue_id":"kura-training-dgnq","depends_on_id":"kura-training-klbf","type":"blocks","created_at":"2026-02-20T18:40:33.171774+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-djr","title":"Timezone consistency rollout for non-timeline day/week projections","description":"Follow-up to pdc.3: body_composition, recovery, nutrition, exercise_progression and custom projections still derive day/week keys from raw timestamps. Align them to user timezone context or explicit UTC disclosure to avoid cross-dimension temporal drift.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:31:20.889348+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T22:31:19.69168+01:00","closed_at":"2026-02-11T22:31:19.69168+01:00","close_reason":"Rolled out timezone-first day/week semantics for body_composition, recovery, nutrition, exercise_progression, and custom field_tracking; added explicit UTC assumption disclosure and targeted integration/unit coverage."}
{"id":"kura-training-dqm","title":"Decision 13 Phase 1: Repair Proposal + Simulate Bridge","description":"Implement the next vertical slice from Decision 13: generate deterministic repair proposals from quality issues and validate every proposal via /v1/events/simulate before any apply path is allowed. This phase stays conservative: proposal + simulation + explainability first, no broad autonomous mutation.","design":"Reference: /Users/jz/Projekte/Life/kura-training/docs/design/013-self-healing-agentic-data-plane.md (Decision 13), sections 13.3, 13.4, 13.8 and Rollout Phase 1. Reuse existing simulation endpoint and append-only correction model. Keep all behavior inspectable, reversible, and policy-gated.","acceptance_criteria":"1) For at least INV-001 and INV-003 issue types, system creates structured repair proposals (event batches) with explicit rationale. 2) Each proposal is automatically evaluated through /v1/events/simulate and stores simulation result (warnings, projection impacts, notes). 3) Proposal artifacts distinguish states: proposed, simulated_safe, simulated_risky, rejected. 4) No proposal is auto-applied in this issue unless explicitly marked Tier A + safe by policy checks. 5) Add tests for proposal generation and simulate-bridge behavior, including one negative case where proposal is flagged risky. 6) Update docs/comments with explicit Decision 13 references.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T16:24:17.860607+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T16:37:58.916421+01:00","closed_at":"2026-02-11T16:37:58.916421+01:00","close_reason":"Closed"}
{"id":"kura-training-dru","title":"Data Integrity: Anomalie-Erkennung in Dimension-Handlern","description":"Jeder Dimension-Handler bekommt Anomalie-Erkennung in seiner Projection-Berechnung. Anomalien landen in data_quality.anomalies der Projection.\n\nWarum: Fehler werden passieren — LLMs machen Interpretationsfehler. Der Agent muss beim nächsten Projection-Read sehen, dass etwas verdächtig ist, und kann den User fragen.\n\nPro Handler:\n- exercise_progression: 1RM-Sprünge \u003e X%, unrealistische Gewichte pro Übung\n- body_composition: Gewichtsschwankungen \u003e 5kg/Tag, Messwerte außerhalb physiologischer Grenzen\n- nutrition: Tageskalorienwerte \u003e 10.000 oder \u003c 200, Makro-Summen vs Kalorien-Diskrepanz\n- recovery: Schlafdauer \u003e 24h oder \u003c 0, Energie-Level außerhalb Skala\n\nFormat in Projection:\ndata_quality.anomalies: [{event_id, field, value, expected_range, message}]\n\nWichtig: Anomalien sind WARNINGS, keine Fehler. Der Handler verarbeitet das Event trotzdem. Der Agent entscheidet, ob er korrigiert.\n\nDesignprinzip: 'Actionable, not descriptive' — jede Anomalie enthält genug Info damit der Agent handeln kann (event_id zum Retracten, field + value für die Korrektur-Konversation mit dem User).","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:32.783605+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T15:57:49.562915+01:00","closed_at":"2026-02-09T15:57:49.562915+01:00","close_reason":"Anomaly detection in 4 dimension handlers (exercise_progression, body_composition, nutrition, recovery). data_quality.anomalies in every projection. 23 new tests (233 unit + 9 integration). Code review: no issues. training_timeline, training_plan, user_profile don't need anomaly detection (aggregates/config).","dependencies":[{"issue_id":"kura-training-dru","depends_on_id":"kura-training-57d","type":"blocks","created_at":"2026-02-09T15:42:02.604622+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-dtb","title":"[quality-gate] Session-Feedback Legacy-Text inferiert negatives Feeling falsch","description":"Warum:\n- Der verpflichtende Integration-Gate ist aktuell rot: `workers/tests/test_integration.py::TestSessionFeedbackIntegration::test_legacy_text_infers_enjoyment`.\n- Die freie Texteingabe \"Training war heute richtig schlecht und müde\" wird derzeit mit `enjoyment = 4.0` statt der erwarteten negativen Einordnung (`2.0`) verarbeitet.\n- Solange der Test fehlschlägt, bleibt die Datenqualitäts-Semantik für Legacy-Textinferenz nicht verlässlich abgesichert.\n\nWie:\n- Root-Cause in der Session-Feedback-Legacy-Inferenz identifizieren (Polarity/Keyword-Mapping für negative deutschsprachige Hinweise).\n- Logik so korrigieren, dass negative Hinweise wie \"schlecht\"/\"müde\" den erwarteten niedrigen Enjoyment-Wert deterministisch liefern.\n- Regression absichern (mindestens bestehender Integration-Test + gezielter Unit-/Integration-Case für die betroffene Textklasse).\n\nRepro:\n- `set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src workers/.venv/bin/python -m pytest workers/tests/test_integration.py -q`\n\nAkzeptanz:\n- `workers/tests/test_integration.py::TestSessionFeedbackIntegration::test_legacy_text_infers_enjoyment` ist grün.\n- Integration-Gate `workers/tests/test_integration.py -q` läuft ohne Fail.\n- Bestehende Session-Feedback-Inferenztests bleiben grün.\n","notes":"Abschlussprotokoll (2026-02-15):\n- Root-Cause: _infer_enjoyment_from_text() behandelte negative Legacy-Freitext-Hinweise binär und mapte immer auf 4.0, auch bei mehrfach starken Negativsignalen (z.B. \"schlecht\" + \"müde\").\n- Fix: abgestufte Heuristik eingeführt (mehrere negative Treffer ohne positive Gegensignale =\u003e enjoyment 2.0, einzelner negativer Treffer =\u003e 4.0).\n- Regression-Absicherung ergänzt:\n  1) test_normalize_feedback_infers_strong_negative_legacy_text\n  2) test_normalize_feedback_infers_mild_negative_legacy_text\n- Gate-Ergebnisse:\n  - ruff check workers/src/ workers/tests/ -\u003e PASS\n  - PYTHONPATH=workers/src workers/.venv/bin/python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py -\u003e PASS (725 passed, 135 skipped)\n  - PYTHONPATH=workers/src workers/.venv/bin/python -m pytest workers/tests/test_integration.py -q -\u003e PASS (85 passed)\n  - cargo test --workspace -\u003e PASS\n- Akzeptanz erfüllt: previously failing Integration-Test test_legacy_text_infers_enjoyment ist grün und der komplette Integration-Gate ist ohne Fail.","status":"closed","priority":1,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-15T17:50:00.134194+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T17:57:57.66483+01:00","closed_at":"2026-02-15T17:57:57.66483+01:00","close_reason":"Legacy-Text-Enjoyment-Inferenz korrigiert; alle Gates inkl. Integration grün."}
{"id":"kura-training-dxl","title":"Decision 13 Phase 2: Agent write receipts + read-after-write guard","description":"Implement Roadmap 011 Workstream F4 and Decision 13.5 protocol hardening: require durable write receipts (event ids + idempotency keys), enforce read-after-write projection verification before any user-facing saved/tracked claim, and add explicit deferred/uncertainty markers when write proof is incomplete.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T16:38:36.398059+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T16:51:49.841629+01:00","closed_at":"2026-02-11T16:51:49.841629+01:00","close_reason":"Closed"}
{"id":"kura-training-dz8","title":"API Skeleton: axum + sqlx + utoipa, Health-Endpoint, Error-Struktur, Request-IDs, Tracing","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:03.330477+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-07T21:53:13.183937+01:00","closed_at":"2026-02-07T21:53:13.183937+01:00","close_reason":"Closed"}
{"id":"kura-training-e0g","title":"Setup: OAuth-first AI connect flow, API-key fallback","description":"Warum: Nutzer sind nicht techaffin; manueller API-Key-Flow ist zu komplex. Was: Setup-Seite auf OAuth-first umstellen (Mit Kura verbinden), API-Key nur als Experten-Fallback. CLI-Setup soll kura login als Standard nutzen; MCP-Text darf keine Pflicht zu manuellem Key suggerieren. Akzeptanz: 1) Setup zeigt klaren OAuth-first-Pfad. 2) API-Key nur optional/expert. 3) Erste Anmeldung fuehrt weiterhin in Setup. 4) Smoke/Build bleibt gruen fuer Web.","notes":"Umgesetzt: Setup auf OAuth-first umgestellt; API-Key nur noch als Experten-Fallback.\\n- Web Setup UI: Connect-with-Kura CTA fuer eingeloggte Nutzer (OAuth Device Verify Link) und API-Key-Fallback in Advanced-Card.\\n- CLI Setup Steps: install + kura login + configure; API-Key nicht mehr als Pflichtschritt.\\n- MCP Setup: Auth-Feld zeigt OAuth (Connect with Kura), plus Advanced-Fallback mit Bearer/API-Key-Snippet.\\n- Lokalisierung aktualisiert: de/en/en-US/ja.\\n\\nValidierung:\\n- ruff check workers/src/ workers/tests/ -\u003e PASS\\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py -\u003e PASS\\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q -\u003e PASS\\n- npm --prefix web run test:smoke -- tests/smoke/auth-setup-settings.spec.ts -\u003e PASS\\n\\nBekannte bestehende Repo-Probleme (nicht durch diese UI-Aenderung verursacht):\\n- cargo test --workspace: 1 Fail in routes::account::tests::update_login_email_updates_users_and_identity_rows (Duplicate Email Validation)\\n- npm --prefix web run build: PageNotFoundError /_document\\n- npm --prefix web run lint: interaktiver ESLint-Setup-Prompt (kein non-interactive lint moeglich)","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-16T14:20:56.860264+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T14:27:28.465659+01:00","closed_at":"2026-02-16T14:27:28.465659+01:00","close_reason":"OAuth-first Setup umgesetzt; API-Key als Experten-Fallback"}
{"id":"kura-training-e37","title":"Fix flaky account email change test and verify production env readiness","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-16T14:58:38.54726+01:00","updated_at":"2026-02-16T14:58:38.730439+01:00","closed_at":"2026-02-16T14:58:38.730439+01:00","close_reason":"Closed"}
{"id":"kura-training-ebx","title":"[feature] Strategie A: Full Supabase Auth Migration (post-cutover)","description":"## Warum\nStrategie A (Full Supabase Auth) bleibt strategisch sinnvoll, ist aber fuer den Launch-Cutover zu riskant. Nach stabilem DB-only Go-live soll Auth kontrolliert auf Supabase umgestellt werden.\n\n## Scope\n- Supabase Auth als ausstellende Auth-Authority evaluieren und implementieren\n- Migrationspfad fuer bestehende Nutzer/Identitaeten definieren\n- Bestehende API-Auth-Pfade kontrolliert deprecaten/ersetzen\n\n## Konkrete Schritte\n1. Zielbild und Migrationsstrategie fuer bestehende `users` + `user_identities` festlegen.\n2. Claim-/Role-Mapping von Supabase JWTs auf Kura-Autorisierung implementieren.\n3. Cutover-Plan fuer Signup/Login/Refresh/OIDC/Device-Flow erarbeiten.\n4. Sicherheits- und Rollback-Gates fuer Auth-Replatforming definieren.\n\n## Acceptance Criteria\n- Vollstaendiger Auth-Migrationsplan inkl. Daten-/Identity-Mapping vorhanden.\n- Technische Entscheidung fuer ersetzte/weiterbetriebene API-Auth-Pfade dokumentiert.\n- Separate Go/No-Go Gates fuer Auth-Replatforming definiert.","acceptance_criteria":"Full Supabase Auth ist als separater, umsetzbarer Post-Cutover-Track mit klaren Gates definiert.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-15T17:15:20.151314+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T17:16:26.177527+01:00","closed_at":"2026-02-15T17:16:26.177527+01:00","close_reason":"duplicate of kura-training-7u9","labels":["auth","post-launch","supabase"],"dependencies":[{"issue_id":"kura-training-ebx","depends_on_id":"kura-training-4sv","type":"blocks","created_at":"2026-02-15T17:15:25.393522+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-efn","title":"Agent Policy Kernel v1: atomarer Entscheidungs-Kern (compaction-safe)","description":"Warum:\n- Die Agent-Policy ist aktuell in Contracts und Runtime-Logik gespiegelt; Drift-Risiko zwischen /workers/src/kura_workers/system_config.py und /api/src/routes/agent.rs ist hoch.\n- Ziel ist deterministisches, auditiertes Verhalten fuer response_mode, personal_failure_profile, sidecar_retrieval_regret und counterfactual_recommendation.\n\nWie:\n- Ein atomarer, pure-function Policy-Kern wird als Single Source of Decisioning eingefuehrt.\n- API/Route bleibt Orchestrierungsschicht; Vertragsoberflaechen (Schema-Felder) bleiben kompatibel.\n- Neue Architekturentscheidungen werden als executable specs in tests/architecture festgeschrieben (gem. AGENTS.md).\n\nCompaction-Recovery:\n1) scripts/bd-safe.sh prime\n2) scripts/bd-safe.sh show \u003cdieses-epic\u003e\n3) Child-Issues in Dependency-Reihenfolge abarbeiten\n4) Nach jedem Child-Issue Quality Gates laufen lassen\n\nGuardrails:\n- Advisory-not-cage Semantik muss erhalten bleiben.\n- Keine Forced Personalization; Unsicherheit muss explizit bleiben.\n- Keine neuen Design-Docs als Source of Truth; Invarianten in Tests.\n\nDone wenn:\n- Alle Child-Issues abgeschlossen und auf Remote synchronisiert sind.\n- Architecture Specs + Runtime-Tests gruen sind und Drift-Schutz aktiv ist.","notes":"Execution Map (compaction-safe):\n1) kura-training-14e [spec]\n2) kura-training-x6o [impl kernel]\n3) kura-training-muh [integration]\n4) kura-training-80x [parity validation]\n5) kura-training-c52 [handoff + full gates + sync/push]\n\nFast Recovery Commands:\n- scripts/bd-safe.sh prime\n- scripts/bd-safe.sh show kura-training-efn\n- scripts/bd-safe.sh show kura-training-14e\n\nArchitecture-Spec Rule Reminder:\n- Neue Architekturentscheidungen nur ueber tests/architecture/ als executable specs festhalten (AGENTS.md).\n- Kein neuer Design-Doc als Source of Truth fuer diese Entscheidung.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-15T17:14:07.261665+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T17:51:19.153553+01:00","closed_at":"2026-02-15T17:51:19.153553+01:00","close_reason":"Epic-Deliverables umgesetzt, validiert und gepusht; verbleibender nicht-blockierender Integrations-Fail als kura-training-dtb erfasst.","dependencies":[{"issue_id":"kura-training-efn","depends_on_id":"kura-training-14e","type":"blocks","created_at":"2026-02-15T17:15:45.080132+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-efn","depends_on_id":"kura-training-x6o","type":"blocks","created_at":"2026-02-15T17:15:55.418081+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-efn","depends_on_id":"kura-training-muh","type":"blocks","created_at":"2026-02-15T17:16:05.75215+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-efn","depends_on_id":"kura-training-80x","type":"blocks","created_at":"2026-02-15T17:16:16.05272+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-efn","depends_on_id":"kura-training-c52","type":"blocks","created_at":"2026-02-15T17:16:26.337786+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-f0l","title":"Passwort-Reset Flow","description":"## Warum\nOhne Passwort-Reset ist jedes vergessene Passwort ein manueller Support-Fall.\nFür eine seriöse Anwendung Pflicht.\n\n## Was\n### Frontend\n- \"Passwort vergessen?\" Link auf Login-Seite (existiert bereits als toter Link)\n- /forgot-password Seite: Email-Eingabe → \"Falls ein Account existiert, senden wir eine Email\"\n  (Info-Leakage-Schutz: immer gleiche Antwort)\n- /reset-password?token=xxx Seite: Neues Passwort + Bestätigung eingeben\n\n### Backend (NEU)\n- POST /v1/auth/forgot-password: Generiert Reset-Token, speichert in DB, sendet Email via Resend\n- POST /v1/auth/reset-password: Validiert Token, setzt neues Passwort\n- Reset-Token: 1 Stunde gültig, einmalig verwendbar, kura_rst_ Prefix\n- Email: Deutsch, mit Reset-Link zum Frontend\n\n### Datenbank\n- Neue Tabelle oder Spalte für password_reset_tokens (token_hash, user_id, expires_at, used_at)\n\n## Abhängigkeit\n- Blocked by: Browser Auth (kura-training-3kh) — Login muss funktionieren bevor Reset Sinn macht\n- Braucht: RESEND_API_KEY konfiguriert (existiert bereits für Invite-Emails)\n\n## Akzeptanzkriterien\n- User kann \"Passwort vergessen\" klicken, Email eingeben, Link bekommen\n- Reset-Link führt zu Formular, neues Passwort setzen funktioniert\n- Token ist nach 1h oder Verwendung ungültig\n- Keine Info-Leakage (gleiche Antwort ob Account existiert oder nicht)","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:36:11.689633+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T08:56:02.804723+01:00","closed_at":"2026-02-16T08:56:02.804723+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-f0l","depends_on_id":"kura-training-3kh","type":"blocks","created_at":"2026-02-13T14:36:19.735609+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":40,"issue_id":"kura-training-f0l","author":"jonzim-cmd","text":"Implemented password reset end-to-end. Backend: added POST /v1/auth/forgot-password and POST /v1/auth/reset-password in api/src/routes/auth.rs with non-enumerating forgot response, 1h one-time kura_rst_ token flow, Resend email dispatch, and token/session revocation on reset. DB: added migration migrations/20260229000004_password_reset_and_account_deletion_grace.sql with password_reset_tokens table (token_hash, user_id, expires_at, used_at) plus RLS/internal policy. Frontend: added forgot/reset pages at web/src/app/[locale]/(inner)/forgot-password/page.tsx and web/src/app/[locale]/(inner)/reset-password/page.tsx and wired login link in web/src/app/[locale]/(inner)/login/page.tsx. Validation: cargo test --workspace, ruff check workers/src/ workers/tests/, PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py, PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q, pnpm --dir web build all passing on 2026-02-16.","created_at":"2026-02-16T07:56:02Z"}]}
{"id":"kura-training-f1t","title":"Go-Live: withkura.com auf eigenem Server hosten und Cloudflare Cutover","description":"Web-Frontend auf bestehendem Server (getsumapp.com Host) produktiv ausrollen, Cloudflare DNS/TLS für withkura.com konfigurieren, Backend-URL und Supabase-kompatiblen Runtime-Pfad verifizieren, inklusive Smoke-Check und Rollback-Hinweisen.","notes":"Server Go-Live abgeschlossen: kura-web (127.0.0.1:3001), public API (127.0.0.1:8330), cloudflared ingress erweitert, alle Container healthy. Externer Blocker: DNS-Zone withkura.com wird von vorhandenem cloudflared cert/tunnel-route tooling nicht direkt verwaltet (route dns hängt an getsumapp.com-Zone). Für finalen Internet-Go-Live müssen CNAMEs in der withkura.com-Cloudflare-Zone gesetzt werden: withkura.com, www.withkura.com, api.withkura.com -\u003e 39fb06de-cfa5-4fda-a372-badfc9945a2c.cfargotunnel.com.","status":"in_progress","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T10:29:06.264415+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T11:03:26.403758+01:00"}
{"id":"kura-training-faz","title":"Projection freshness SLA metadata in API responses","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T07:42:51.528706+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T08:02:06.34401+01:00","closed_at":"2026-02-11T08:02:06.34401+01:00","close_reason":"Added ProjectionMeta freshness SLA metadata (age_seconds + fresh/warming/stale status) across projection and agent context responses with core classification tests"}
{"id":"kura-training-fga","title":"[task] operational_model in build_system_config() ableiten","description":"## Kontext\n\nTeil des operational_model Features (kura-training-nco). Kernstück: build_system_config() generiert operational_model automatisch aus den event_conventions Kategorien + usage-Texten. Kein manuell gepflegter Block.\n\n## Was zu tun ist\n\nNeue Funktion _build_operational_model() in workers/src/kura_workers/system_config.py die:\n\n1. get_event_conventions() aufruft\n2. Events nach category gruppiert\n3. Für jede relevante Kategorie einen kompakten Einzeiler ableitet:\n   - mutations: 'All writes are new events via POST /v1/events — no UPDATE, no DELETE'\n   - corrections: Abgeleitet aus usage-Text der category=correction Events (event.retracted hat usage: 'To correct a wrong event: retract it and log the correct replacement event in the same batch.')\n   - state_access: 'Read projections (GET /v1/projections), not raw events'\n   - event_types: 'Free-form strings — new types work immediately, no registration needed'\n4. Einen paradigm-Einzeiler: 'Event Sourcing: all state changes are immutable events, corrections are compensating events'\n5. common_operations: Die 3-5 häufigsten Operationen mit Einzeiler-Beispiel (retract, correct, log new type, read state)\n\ncommon_operations wird aus event_conventions abgeleitet — z.B. für jedes category=correction Event: {pattern: event_type, via: 'POST /v1/events', hint: erster Satz von usage}.\n\n## Wie\n\n- _build_operational_model() als reine Funktion (testbar)\n- Aufgerufen in build_system_config(), Ergebnis unter key 'operational_model'\n- Ableitungslogik aus vorhandenen Daten, KEIN hardcoded Text außer den paradigm-level Aussagen (die SIND stabil — Event Sourcing ändert sich nicht)\n- Unit-Test: test_system_config.py prüft dass operational_model die erwartete Struktur hat\n\n## Dateien\n\n- workers/src/kura_workers/system_config.py (Hauptänderung)\n- workers/tests/test_system_config.py (Tests)","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-18T22:51:09.537173+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T07:49:05.837984+01:00","closed_at":"2026-02-19T07:49:05.837984+01:00","close_reason":"_build_operational_model() derives from categories+usage, added to build_system_config()","dependencies":[{"issue_id":"kura-training-fga","depends_on_id":"kura-training-1eo","type":"blocks","created_at":"2026-02-18T22:52:09.938756+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-fga","depends_on_id":"kura-training-6m3","type":"blocks","created_at":"2026-02-18T22:52:10.049482+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-fknf","title":"MCP Observability: overflow-rate, reload-depth, context-hit-rate, abort-reasons","description":"Warum: Ohne messbare Runtime-Signale ist unklar, wann der Agent gegen Budget-/Reload-Grenzen läuft.\\n\\nWie: Ergänze session-basierte Telemetrie in der MCP-Runtime und expose sie in Status/Discovery-Payloads. Metriken müssen direkt für Debugging und Tuning nutzbar sein.","design":"Erfasse pro Session mindestens: context_calls, context_overflow_count, overflow_rate, current/max reload depth, context_hit_rate, abort_reasons. Daten sollen klein bleiben (aggregiert), maschinenlesbar sein und keine Rohdaten-Leaks enthalten.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T10:56:25.571312+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T11:03:46.332254+01:00","closed_at":"2026-02-19T11:03:46.332254+01:00","close_reason":"Added retrieval observability aggregation (overflow_rate, reload depth, context_hit_rate, abort_reasons) and surfaced it in runtime_observability plus discover/status session payloads.","dependencies":[{"issue_id":"kura-training-fknf","depends_on_id":"kura-training-5lkb","type":"blocks","created_at":"2026-02-19T10:56:35.444093+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-fknf","depends_on_id":"kura-training-3q00","type":"blocks","created_at":"2026-02-19T10:56:35.924732+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-fncv","title":"Refactor capability_estimation handler to declarative capability config map","description":"WHY: capability_estimation currently repeats per-capability constants (required observation counts, comparability fields, caveat codes, recommendation texts) inline, which raises drift risk across strength/sprint/jump/endurance paths.\\n\\nHOW: Introduce a typed declarative config map and shared builder helpers so per-capability differences are data-driven while calculation code stays focused on signal extraction.\\n\\nACCEPTANCE:\\n- Constants move from inline branches into shared config table.\\n- Existing projection outputs remain schema-compatible and tests stay green.\\n- New capability additions require minimal boilerplate.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T19:33:10.96466+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:44:03.03813+01:00","closed_at":"2026-02-20T19:44:03.03813+01:00","close_reason":"Refactored capability_estimation to typed declarative capability spec map and shared envelope builders; added architecture coverage."}
{"id":"kura-training-g6wk","title":"Rollout/Observability: Canary, Guardrails, Abort-Kriterien","description":"Why:\nAuch gute Architektur kann Produktion verschlechtern, wenn Rollout unkontrolliert erfolgt.\n\nHow:\nFeature-flagged Rollout mit Canary/Abort-Kriterien:\n- Metriken: overflow_rate, critical_missing_rate, blocked_rate, speculative_answer_rate.\n- Stufenweiser Rollout + sofortiger rollback switch.\n- Post-rollout Verifikation anhand realer Startup/Onboarding/Advanced-Use Flows.\n\nCompact-survival note:\nDie Metriken und Gates machen Wirkung sichtbar, auch wenn der ursprüngliche Implementierungskontext verloren geht.","design":"Safety-first rollout: neue Pfade laufen parallel als shadow/canary bevor sie default werden.","acceptance_criteria":"1) Feature flags und Canary-Plan sind implementiert.\n2) Klare Abort-/Rollback-Kriterien existieren und sind geprobt.\n3) Nach Rollout sinken overflow/critical-missing Ereignisse signifikant ohne Regressions in Advanced Use.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T08:49:06.918524+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T11:41:38.259329+01:00","closed_at":"2026-02-21T11:41:38.259329+01:00","close_reason":"Closed","labels":["observability","rollout","sre"],"dependencies":[{"issue_id":"kura-training-g6wk","depends_on_id":"kura-training-21cw","type":"parent-child","created_at":"2026-02-21T08:49:07.517819+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-g6wk","depends_on_id":"kura-training-cz5u","type":"blocks","created_at":"2026-02-21T08:49:08.325936+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-g6wk","depends_on_id":"kura-training-kqub","type":"blocks","created_at":"2026-02-21T08:49:08.436735+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-g6wk","depends_on_id":"kura-training-chuq","type":"blocks","created_at":"2026-02-21T08:49:08.540706+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-gayi","title":"Spec-first: Executable Architecture Tests fuer Retrieval-Invarianten","description":"Why:\nOhne codifizierte Invarianten regressieren wir bei der nächsten Optimierung wieder in Truncation-getriebene Halluzinationen.\n\nHow:\nSpec-first in tests/architecture: fail-closed bei fehlenden critical sections, deterministische Fetch-Reihenfolge (capsule -\u003e required sections -\u003e optional), und Verbot von normaler Antwort bei critical_missing_sections != [].\n\nCompact-survival note:\nDiese Tests sind die langfristige, selbst-erklärende Quelle des \"Was muss gelten\" auch nach Kontextverlust.","design":"Schreibe Architekturtests als executable specs entsprechend AGENTS.md: keine separaten neuen Design-Dokumente, sondern dauerhafte Invarianten in tests/architecture.","acceptance_criteria":"1) tests/architecture enthält Invarianten für startup capsule, critical gate, und overflow behavior.\n2) Tests schlagen ohne Implementierung fehl und grünen nach Umsetzung.\n3) CI bindet diese Tests in den Quality Gates ein.","notes":"Implementing executable specs + runtime tests for deterministic retrieval platform v1.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T08:49:06.195827+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T09:16:49.506429+01:00","closed_at":"2026-02-21T09:16:49.506429+01:00","close_reason":"Closed","labels":["architecture","runtime","spec-tests"],"dependencies":[{"issue_id":"kura-training-gayi","depends_on_id":"kura-training-21cw","type":"parent-child","created_at":"2026-02-21T08:49:07.017735+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-gh0","title":"[ctv.3] Automatic model tiering from observed quality","description":"Compute per-model quality score from observed metrics and automatically promote/demote model tiers with min-sample and hysteresis guards.","acceptance_criteria":"1) Worker computes per-model reliability status. 2) Tier decision deterministic with min samples+hysteresis. 3) Unknown/new model defaults to safe confirm_first until evidence sufficient.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T21:19:54.725946+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:41:32.839547+01:00","closed_at":"2026-02-13T21:41:32.839547+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-gh0","depends_on_id":"kura-training-akn","type":"blocks","created_at":"2026-02-13T21:21:02.735412+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-goy","title":"Onboarding interview design (agent-side)","description":"Design the onboarding interview flow: agent conducts adaptive interview with new user, produces standard events (preference.set, exercise.alias_created, goal.set, profile.updated). Inspired by Anthropic Interviewer. Interview is agent-side, not Kura-side — Kura receives the resulting events.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:17.788435+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T20:48:06.472316+01:00","closed_at":"2026-02-08T20:48:06.472316+01:00","close_reason":"Implemented Decision 8: interview guide in system layer, context_seeds, coverage computation, profile.updated + injury.reported events, bootstrap response, 126 tests passing","dependencies":[{"issue_id":"kura-training-goy","depends_on_id":"kura-training-nv2","type":"blocks","created_at":"2026-02-08T13:39:32.511804+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-gqs","title":"Adaptive Response-Mode Thresholds mit Outcome-Signalen kalibrieren","description":"Nutze reale Verlaufssignale (Korrekturen, Follow-through, user challenge rate), um evidence_score-Gewichte und adaptive A/B-Schwellen datengetrieben zu justieren. Definiere Offline-Eval + Guardrails gegen Scheingenauigkeit.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T21:09:54.181822+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T21:27:35.830559+01:00","closed_at":"2026-02-14T21:27:35.830559+01:00","close_reason":"Closed"}
{"id":"kura-training-guz5","title":"RIR/RPE-aware e1RM estimator in exercise_progression and strength_inference","description":"WHY:\nCurrent strength e1RM uses pure Epley(weight,reps) and ignores effort context (RIR/RPE), producing biased estimates for submaximal sets.\n\nHOW:\nImplement effort-adjusted e1RM for strength paths:\n- derive effective reps-at-failure using explicit RIR or inferred RIR from RPE\n- keep deterministic fallback to baseline Epley if effort context is missing\n- preserve comparability-group boundaries and correction/retraction semantics.\n\nIMPLEMENTATION TASKS:\n1) Add estimator function with explicit source metadata (explicit/inferred/fallback).\n2) Integrate into exercise_progression and strength_inference.\n3) Add tests for 70x3 @RIR3 vs 70x3 @RIR0 separation.\n4) Add anomaly handling tuned for new estimator behavior.\n\nACCEPTANCE:\n- e1RM differs by effort context for same load/reps when RIR/RPE differs.\n- Fallback behavior remains deterministic and auditable.\n- Existing projections remain backward compatible in structure.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:25:58.72716+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:34.733962+01:00","closed_at":"2026-02-20T19:28:34.733962+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo).","dependencies":[{"issue_id":"kura-training-guz5","depends_on_id":"kura-training-mxb3","type":"blocks","created_at":"2026-02-20T18:39:11.610143+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-guz5","depends_on_id":"kura-training-6v6r","type":"blocks","created_at":"2026-02-20T18:39:11.626674+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-he1","title":"Enforce HTTPS and add HSTS","description":"Redirect HTTP to HTTPS, add Strict-Transport-Security header. Production security requirement.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T11:00:02.097685+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T11:16:10.404403+01:00","closed_at":"2026-02-08T11:16:10.404403+01:00","close_reason":"Closed"}
{"id":"kura-training-hj7","title":"Shell-Sonderzeichen in Übungsnamen absichern","description":"Übungsnamen mit \u0026 (z.B. 'Clean \u0026 Push Press') brechen curl-Calls im Shell. Agent musste auf Temp-Files ausweichen. Betrifft CLI und jede Shell-basierte Agent-Integration. Lösung: CLI muss Escaping korrekt handhaben, API-Docs sollten auf JSON-File-Input hinweisen. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":3,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:43:02.05986+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:43:41.29831+01:00","closed_at":"2026-02-10T07:43:41.29831+01:00","close_reason":"Note im CLI-Code (cli/src/main.rs) hinterlassen bei --data Argument. Fix kommt wenn CLI Event-Create richtig ausgebaut wird (--data-file / stdin)."}
{"id":"kura-training-hwo","title":"Derivative-Enriched Projections: Werte mit eingebauter Dynamik","description":"## Ursprung\n\nAus einem Vortrag über ein mathematisches Framework mit diesen Eigenschaften:\n- Basic type ist Winkel (periodisch), mit variabler Auflösung und Dimensionen\n- Winkel sind nicht statisch, sondern dynamisch (enthalten Info über ihre eigene Veränderung im nächsten Schritt, 1-3 Ableitungen)\n- Kurze, periodische Propagationen (wenige Schichten)\n- Niedrige Auflösung von Werten und Gradienten\n\n## Was das für Kura ausgelöst hat\n\n### Kernproblem heute\nProjections sind **Zustandsfotos**. Eine 1RM ist eine Zahl, ein Wochenvolumen ist eine Zahl. Der Agent muss Trends *selbst rekonstruieren*, indem er Zeitreihen vergleicht. Und ob ein Trend an Fahrt gewinnt oder verliert (Beschleunigung), muss er aus Trends ableiten. Das ist viel kognitive Arbeit für den Agenten — und fehleranfällig.\n\n### Idee: Werte tragen ihre eigenen Ableitungen\nStatt:\n```json\n{\"bench_press_1rm\": 100.0}\n```\nKönnte ein Wert seine Dynamik mitbringen:\n```json\n{\n  \"bench_press_1rm\": {\n    \"value\": 100.0,\n    \"velocity\": 2.5,\n    \"acceleration\": -0.5\n  }\n}\n```\nEin einziger Lesevorgang sagt dem Agenten: \"Du bist bei 100kg, wirst stärker (+2.5kg/Woche), aber die Zuwächse flachen ab (-0.5kg/Woche²).\"\n\n### Drei konkrete Designprinzipien\n\n**1. Derivative-enriched projections**\nJeder quantitative Wert in einer Projection trägt Richtung und Momentum. Der Agent liest nicht \"Zahl + Zeitreihe\", sondern \"Zustand + Dynamik\". Erweiterung des Projection-Formats, kein neues System.\n\n**2. Phase statt Trend**\nStatt \"1RM steigt\" modellieren wir \"User ist in Phase X eines Zyklus\". Training ist fundamental zyklisch:\n- Wochenrhythmus (welche Tage, Lastverteilung)\n- Mesozyklus (Akkumulation → Intensivierung → Deload → Peak)\n- Supercompensation (Belastung → Ermüdung → Erholung → Überkompensation)\n- Schlaf, Ernährung haben Wochenmuster\n\nWinkel/periodische Werte sind die natürliche Darstellung für zyklische Phänomene. Jemand in der Deload-Woche sieht nach \"Regression\" aus wenn man nur linear schaut — Phase-Modellierung erkennt das als normal.\n\n**3. Low resolution, high meaning**\nDer Agent braucht keine Präzision. Er braucht:\n- ↑↑ (steigt beschleunigt)\n- ↑→ (steigt, flacht ab)\n- →↓ (stagniert, kippt)\nDas ist fast die \"angle with low resolution\"-Idee: wenige diskrete Zustände, aber dynamisch.\n\n## Wo das hingehört\n\nNatürlicher Ort ist die **Bayesian-Schicht (kqf)**. Die Bayesian Engine berechnet nicht nur Schätzwerte, sondern Schätzwerte *mit ihren Ableitungen*. Die Projections werden dadurch von \"Fakten, aus denen der Agent Dynamik ableiten muss\" zu \"Fakten MIT Dynamik\".\n\nAuch ohne Bayesian könnte man einfache Derivative-Enrichment auf bestehende Projections anwenden (lineare Regression über letzte N Wochen → velocity, Änderung der velocity → acceleration). Aber die Bayesian-Schicht macht es richtig (Unsicherheitsquantifizierung, nicht-lineare Trends, zyklische Modelle).\n\n## Was wir bewusst NICHT übernehmen\n\n\"Short periodic propagations (few layers at a time)\" auf die Worker-Pipeline zu mappen wäre erzwungen. Projections recomputen vollständig, nicht inkrementell. Vielleicht relevant bei massiver Skalierung, aber nicht jetzt.\n\n## Bezug zu bestehender Architektur\n\n- Passt zu agent_behavior: Agent bekommt reichere Daten → kann autonomere Entscheidungen treffen\n- Passt zu projection_schemas: output_schema erweitern um derivative-enriched Typen\n- Passt zu data_quality: velocity/acceleration mit Konfidenz → Agent weiß, wie verlässlich die Dynamik-Info ist\n- Decision 10 Phase 4 (Cross-Pollination): Derivative-Enrichment könnte ein Cross-Dimension Pattern sein (gleiche Logik für 1RM, Gewicht, Schlafqualität)","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T20:27:08.940161+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T13:07:14.99276+01:00","closed_at":"2026-02-11T13:07:14.99276+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-hwo","depends_on_id":"kura-training-kqf","type":"blocks","created_at":"2026-02-10T20:27:12.598247+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-i85","title":"[task] Scale Harmonization v1 absichern (1-10 / 0-10)","description":"## Warum\nCommit `c2868af` vereinheitlicht subjektive Ratings auf 1-10 (Soreness 0-10) und entfernt stille 1-5-Konvertierungen. Diese semantische Aenderung braucht einen expliziten Bead fuer Nachvollziehbarkeit, Guardrails und Folgearbeiten.\n\n## Scope\n- Canonical Scale Contract festschreiben: enjoyment/quality/exertion/energy/RPE = 1-10, soreness/pain/RIR = 0-10.\n- Legacy-Inferenz und Normalisierungslogik auf den neuen Contract absichern.\n- Drift-Schutz gegen erneute stille 1-5-Rueckkonvertierung in API/Workers/Datagen.\n\n## Konkrete Schritte\n1. Contract-/Architekturtests ergaenzen oder schärfen, die gemischte 1-5/1-10 Skalen verhindern.\n2. Prüfen, dass Session-Audit, Feedback-Inferenz, Readiness/Causal-Pipelines und Event-Conventions konsistent auf 1-10/0-10 rechnen.\n3. Monitoring-Hinweis ergänzen: Historische Daten mit alter Skala klar kennzeichnen oder mit Version-Metadaten ausweisen.\n4. Dokumentierte Migrationsnotiz fuer Downstream-Consumer (API/UI/Eval).\n\n## Acceptance Criteria\n- Es existiert ein testbarer, zentraler Scale-Contract ohne stille Auto-Konvertierung auf 1-5.\n- Regressionstests decken positive/negative Legacy-Textfaelle und Soreness-Normalisierung (0-10) ab.\n- Event-/Projection-Pfade zeigen keine inkonsistenten Skalen mehr.\n- Historische/Legacy-Skalenbehandlung ist explizit dokumentiert.","acceptance_criteria":"Scale-Contract ist testbar fixiert; keine stille 1-5-Rueckkonvertierung mehr moeglich.","status":"open","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T19:09:11.753777+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T19:09:11.753777+01:00","labels":["contract","quality","session-feedback"],"dependencies":[{"issue_id":"kura-training-i85","depends_on_id":"kura-training-pdc.20","type":"blocks","created_at":"2026-02-15T19:09:22.06724+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-idfe","title":"Onboarding cleanup/refactor: Contract drift reduzieren + Lifecycle vervollstaendigen","description":"Ziel: Nach der Quick/Deep-Einfuehrung verbleibende technische Schulden abbauen. Warum: Mehrere doppelte Contract/Fallback-Pfade und Legacy-Tokens erhoehen Drift-Risiko; State-Ableitung API vs Worker ist nicht einheitlich; Restart-Lifecycle fehlt. Wie: gemeinsame State-Ableitung einfuehren, deprecated token aufraeumen, onboarding.restarted als expliziten Lifecycle-Punkt implementieren, Architekturtests weniger string-fragil auf Runtime-Verhalten ausrichten. Nicht verhandelbar: Erstkontakt-Determinismus darf nicht regressieren.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-21T13:42:27.243879+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T14:02:15.662239+01:00","closed_at":"2026-02-21T14:02:15.662239+01:00","close_reason":"Closed","labels":["cleanup","determinism","onboarding","refactor"],"comments":[{"id":60,"issue_id":"kura-training-idfe","author":"jonzim-cmd","text":"Compacting-resilient Umsetzungshinweis: 1) Erstkontakt-Determinismus ist das primäre Nicht-Regressionsziel. 2) State-Drift API/Worker zuerst beheben, sonst sind weitere Lifecycle-Änderungen unsicher. 3) Restart-Lifecycle muss semantisch den Gate-Pfad wieder auf onboarding-open stellen. 4) Abschluss erst nach vollen AGENTS Quality Gates + Push.","created_at":"2026-02-21T12:42:28Z"}]}
{"id":"kura-training-idfe.1","title":"Workflow-State-Ableitung vereinheitlichen (API an user_profile workflow_state ausrichten)","description":"Warum: aktuell divergente Berechnung (Worker sequenziell, API marker-exists). Wie: zentrale Helper fuer workflow_state aus user_profile + fallback auf Marker-Historie; fetch_workflow_state und agent_brief nutzen dieselbe Semantik; edge-case bei retracted Markern bleibt korrekt.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T13:42:27.370739+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T14:02:03.961139+01:00","closed_at":"2026-02-21T14:02:03.961139+01:00","close_reason":"Closed","labels":["api","onboarding","state","worker"],"dependencies":[{"issue_id":"kura-training-idfe.1","depends_on_id":"kura-training-idfe","type":"parent-child","created_at":"2026-02-21T13:42:27.372494+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-idfe.2","title":"Lifecycle komplettieren: workflow.onboarding.restarted","description":"Warum: mit aborted fehlt ein expliziter Weg zur Re-Aktivierung. Wie: neues Event in conventions/handlers/routes/gates; restarted hebt aborted auf und oeffnet onboarding wieder; planning writes nach restart respektieren Gate wieder.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T13:42:27.498739+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T14:02:04.088058+01:00","closed_at":"2026-02-21T14:02:04.088058+01:00","close_reason":"Closed","labels":["events","lifecycle","onboarding"],"dependencies":[{"issue_id":"kura-training-idfe.2","depends_on_id":"kura-training-idfe","type":"parent-child","created_at":"2026-02-21T13:42:27.500842+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-idfe.2","depends_on_id":"kura-training-idfe.1","type":"blocks","created_at":"2026-02-21T13:42:27.98815+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-idfe.3","title":"Legacy token cleanup: onboarding_skipped_by_user entfernen oder mappen","description":"Warum: token ist historisch, aber nicht als persistierter Zustand implementiert. Wie: response_guard auf persistente Workflow-Events stutzen (closed/override/aborted/restarted) und verbliebene Legacy-Hinweise aus Architekturtests entfernen.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T13:42:27.629644+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T14:02:15.265535+01:00","closed_at":"2026-02-21T14:02:15.265535+01:00","close_reason":"Closed","labels":["cleanup","guard","onboarding"],"dependencies":[{"issue_id":"kura-training-idfe.3","depends_on_id":"kura-training-idfe","type":"parent-child","created_at":"2026-02-21T13:42:27.631829+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-idfe.3","depends_on_id":"kura-training-idfe.1","type":"blocks","created_at":"2026-02-21T13:42:28.081717+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-idfe.4","title":"Architecture tests robust machen (behavior-first statt reine Stringsuche)","description":"Warum: string-basierte Assertions sind bei Refactors fragil. Wie: API/MCP Runtime-Verhalten durch konkrete Rust runtime-tests absichern und diese aus tests/architecture triggern; nur minimale source-presence checks behalten.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T13:42:27.760755+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T14:02:15.525083+01:00","closed_at":"2026-02-21T14:02:15.525083+01:00","close_reason":"Closed","labels":["architecture-tests","onboarding","testing"],"dependencies":[{"issue_id":"kura-training-idfe.4","depends_on_id":"kura-training-idfe","type":"parent-child","created_at":"2026-02-21T13:42:27.762641+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-idfe.4","depends_on_id":"kura-training-idfe.1","type":"blocks","created_at":"2026-02-21T13:42:28.174906+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-idfe.4","depends_on_id":"kura-training-idfe.2","type":"blocks","created_at":"2026-02-21T13:42:28.266434+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-idfe.4","depends_on_id":"kura-training-idfe.3","type":"blocks","created_at":"2026-02-21T13:42:28.360531+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-idfe.4","depends_on_id":"kura-training-idfe.5","type":"blocks","created_at":"2026-02-21T13:42:28.635451+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-idfe.5","title":"Contract/Fallback text cleanup im MCP/API konsolidieren","description":"Warum: wiederholte Texte/Defaults erzeugen Drift. Wie: wiederverwendbare Konstanten/Helper je Runtime einfuehren und duplizierte Strings reduzieren; semantics unveraendert.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T13:42:27.892462+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T14:02:15.392028+01:00","closed_at":"2026-02-21T14:02:15.392028+01:00","close_reason":"Closed","labels":["api","mcp","onboarding","refactor"],"dependencies":[{"issue_id":"kura-training-idfe.5","depends_on_id":"kura-training-idfe","type":"parent-child","created_at":"2026-02-21T13:42:27.894617+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-idfe.5","depends_on_id":"kura-training-idfe.1","type":"blocks","created_at":"2026-02-21T13:42:28.452618+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-idfe.5","depends_on_id":"kura-training-idfe.2","type":"blocks","created_at":"2026-02-21T13:42:28.54223+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ie9v","title":"Harden startup onboarding contract against tool-surface mismatch","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T07:53:57.230549+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T08:07:17.348576+01:00","closed_at":"2026-02-21T08:07:17.348576+01:00","close_reason":"Implemented context-first startup gate, overflow-safe startup capsule, and first-contact bootstrap scoping with passing quality gates"}
{"id":"kura-training-imvf","title":"Fix session_feedback load/enjoyment alignment for endurance and mixed modalities","description":"load_to_enjoyment_alignment currently correlates enjoyment only with total_volume_kg from set rows. Endurance sessions (duration/distance) collapse to zero load, producing systematic insufficient_data/neutral results despite meaningful training load variation. Should use modality-agnostic load (e.g. load_v2 or duration/distance-aware surrogate).","status":"closed","priority":2,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-19T23:02:11.195564+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T23:14:35.141182+01:00","closed_at":"2026-02-19T23:14:35.141182+01:00","close_reason":"Closed","comments":[{"id":48,"issue_id":"kura-training-imvf","author":"jonzim-cmd","text":"Fix umgesetzt: Session-Feedback-Load ist jetzt modalitätsagnostisch. _aggregate_session_load berechnet zusätzlich total_duration_seconds, total_distance_meters, total_contacts und load_score via training_load_calibration_v1::compute_row_load_components_v2. _compute_load_to_enjoyment_alignment verwendet primär session_load.load_score (Fallback auf total_volume_kg für Backward-Kompatibilität). Damit funktionieren Korrelationen auch für Endurance/Mixed-Sessions ohne kg-Volumen. Tests: test_session_feedback.py::test_load_to_enjoyment_alignment_prefers_modality_agnostic_load_score plus Erweiterung von ::test_build_projection_accepts_session_logged_expanded_rows_for_load.","created_at":"2026-02-19T22:14:30Z"}]}
{"id":"kura-training-ip9i","title":"Add explicit rollout backfill command for capability_estimation projections","description":"WHY: New capability_estimation rows and upgraded strength envelopes are currently refreshed via event traffic/nightly refit. For deterministic rollout, operators need an explicit one-shot backfill command/runbook that recomputes projections for all users immediately after deploy.\\n\\nHOW: Add a reproducible worker/CLI path (or SQL+job helper script) to enqueue projection.update across all users for capability-related trigger event types and document expected completion checks.\\n\\nACCEPTANCE:\\n- One command can trigger full recompute/backfill after deploy.\\n- Runbook includes verification queries for coverage and lag.\\n- Process is idempotent and safe to rerun.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T19:33:10.82926+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:44:02.935446+01:00","closed_at":"2026-02-20T19:44:02.935446+01:00","close_reason":"Implemented one-shot capability backfill command + worker job fan-out with dedupe, plus runbook verification queries for coverage/lag."}
{"id":"kura-training-ipu","title":"Configure CORS properly","description":"Configure CORS with explicit allowed origins instead of permissive defaults. Production security requirement.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T11:00:02.970538+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T11:16:10.414816+01:00","closed_at":"2026-02-08T11:16:10.414816+01:00","close_reason":"Closed"}
{"id":"kura-training-ixt8","title":"Phase 5 endurance: threshold/critical-speed capability estimator with reference freshness","description":"WHY:\nEndurance capability needs threshold-oriented modeling (critical speed/power style) with reference freshness and confidence handling; single-session proxies are not enough.\n\nHOW:\nImplement endurance threshold estimation with reference-aware uncertainty:\n- use distance/time/power/HR and relative_intensity references when present\n- degrade confidence when references are stale or low-confidence\n- estimate latent endurance threshold state with interval + drift diagnostics\n- emit explicit insufficiency guidance when protocol evidence is thin.\n\nIMPLEMENTATION TASKS:\n1) Build threshold observation extraction with freshness/confidence weighting.\n2) Implement threshold state model + short-horizon forecast.\n3) Add caveats for stale references and weak protocol coverage.\n4) Integrate replay metrics and rollout checks.\n\nACCEPTANCE:\n- Endurance projection exposes threshold estimate + uncertainty + freshness diagnostics.\n- Stale/missing references never produce fake precision.\n- Eval harness reports calibrated quality metrics for endurance windows.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:37:44.743873+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:35.249829+01:00","closed_at":"2026-02-20T19:28:35.249829+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo).","dependencies":[{"issue_id":"kura-training-ixt8","depends_on_id":"kura-training-56jn","type":"blocks","created_at":"2026-02-20T18:40:32.677452+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-iz3","title":"CLI: Admin/User bedienbar im Rechte-Scope (auth + telemetry + write-with-proof UX)","description":"Expose admin telemetry in kura CLI, enforce tokened admin API calls, and add user-friendly write-with-proof path aligned with temporal-basis contract.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T12:08:12.254001+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T12:11:56.545159+01:00","closed_at":"2026-02-15T12:11:56.545159+01:00","close_reason":"Closed"}
{"id":"kura-training-j2bf","title":"Harden production secret provisioning for Turnstile keys in deploy path","description":"Why: deploy via compose currently depends on KURA_TURNSTILE_SITE_KEY/SECRET interpolation, and missing values force unsafe placeholder injection during targeted backend rollouts.\\n\\nWhat: define and enforce a safe secret provisioning path (env file or secret manager), plus deploy preflight checks to prevent accidental placeholder usage in live environments.\\n\\nAcceptance:\\n- deploy fails fast with actionable message when Turnstile keys are missing\\n- documented secure provisioning path exists\\n- targeted backend rollout does not require ad-hoc placeholder values","notes":"Implement hardened deploy preflight for Turnstile secrets and add core-only deploy path to avoid placeholder env hacks.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T12:21:00.205362+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T12:49:42.483515+01:00","closed_at":"2026-02-21T12:49:42.483515+01:00","close_reason":"Deploy hardening implemented: strict placeholder/missing Turnstile preflight and --core-only deploy mode to avoid placeholder hacks.","labels":["deploy","secrets","turnstile"],"dependencies":[{"issue_id":"kura-training-j2bf","depends_on_id":"kura-training-21cw.1","type":"discovered-from","created_at":"2026-02-21T12:21:00.209469+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-jkoo","title":"Plan-Write Reliability V1: approval-aware write-with-proof ohne stille Fallbacks","description":"Warum:\nFred scheiterte beim Plan-Update trotz klarer User-Intention, weil der Ausfuehrungspfad mehrere schwache Stellen hatte: node approval timeout, Legacy-Write-Pfad, undeutliche Fehlersprache und inkonsistente Runtime-vs-Spec-Signale.\n\nWie:\nDieses Epic haertet den Plan-Write-End-to-End-Flow fuer training_plan.* so, dass Writes deterministisch ueber /v1/agent/write-with-proof laufen, Approval-Blocker frueh erkannt werden, degradierende Fallbacks nicht still passieren, und Fehler in klare naechste Nutzeraktionen uebersetzt werden. Parallel werden Architektur-Specs und Runtime auf denselben Contract gebracht.\n\nScope:\n- Contract-Enforcement fuer training_plan.*\n- Preflight/Node-Routing fuer Approval-Blocker\n- Error-Translation fuer User-taugliche Hinweise\n- Spec-Alignment High-Impact\n- Observability fuer Approval/Legacy-Signale","design":"Implementierungsreihenfolge (verbindlich):\n1) kura-training-89gs Contract-Hardening\n2) kura-training-60ek Preflight/Node-Routing\n3) kura-training-adxg Spec-Alignment High-Impact\n4) kura-training-0tgs Error-Translation\n5) kura-training-mn23 Observability\n\nLeitprinzipien:\n- Kein stiller Fallback fuer Plan-Writes.\n- Keine Prompt-Heuristik als alleinige Sicherheit.\n- Contract und Tests in tests/architecture sind Source-of-Truth.","acceptance_criteria":"1) training_plan.* wird nicht mehr erfolgreich ueber Legacy-/v1/events geschrieben.\n2) Approval-Blocker werden vor dem Write transparent gemacht oder mit klarer Aktion beantwortet.\n3) Runtime-Fehler haben stabile Codes plus nutzerverstaendliche Mapping-Nachricht.\n4) Architekturtests pinnen den Contract und bleiben gruen.\n5) Metriken/Events machen Approval-Timeouts und Legacy-Upgrade-Signale sichtbar.","notes":"completed summary:\n- training_plan.* writes are now contract-enforced in MCP runtime: commit/legacy fallback blocked with explicit error code.\n- MCP write error handling now maps technical failures to stable, actionable classes (`write_preflight_blocked`, `plan_write_requires_write_with_proof`, `approval_timeout`).\n- High-impact classification for training_plan.updated in MCP is now risk-based and aligned with architecture intent.\n- Added architecture spec test for plan-write contract primitives and runtime test execution across API + MCP runtime.\n- Added API warning log for blocked legacy plan writes to improve observability.\n\nchanged artifacts:\n- api/src/routes/events.rs\n- mcp-runtime/src/lib.rs\n- tests/architecture/conftest.py\n- tests/architecture/test_132_agent_write_preflight_and_event_type_policy_contract.py\n- tests/architecture/test_150_plan_write_contract.py\n\nquality gates run (all green):\n1) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n2) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n3) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n4) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nresidual risk / follow-up:\n- External node orchestration approval routing (Mac/VPS selection) is outside this repository; only error-classification side is covered here.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:39:38.843119+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T18:56:50.027169+01:00","closed_at":"2026-02-20T18:56:50.027169+01:00","close_reason":"Implemented end-to-end and fully verified"}
{"id":"kura-training-k71","title":"Data Integrity: Retraction-Support in Handlern (Full Replay)","description":"Handler müssen event.retracted verarbeiten können. Wenn ein retracted Event den eigenen Typ betrifft, wird die Projection per Full Replay neu berechnet.\n\nWarum Full Replay statt inkrementeller Subtraktion:\n- Korrekt bei jeder Aggregation (keine Rückwärts-Rechnung nötig)\n- Korrekturen sind selten → Performance unkritisch\n- Handler-Logik bleibt sauber (eine Berechnung, nicht zwei Pfade)\n- Bayesian Stats brauchen später sowieso Full Replay\n\nImplementierung pro Handler:\n1. Subscription auf event.retracted\n2. Prüfen ob retracted_event_id einen Event betrifft, der diesen Handler betrifft (event_type check)\n3. Alle Events des Users für eigene Event-Typen laden, retracted Events rausfiltern\n4. Projection komplett neu berechnen\n5. UPSERT wie gewohnt\n\nEdge Cases die durchdacht werden müssen:\n- exercise_progression hat Keys pro exercise_id — welche Keys sind betroffen?\n- Alias-Events retracten: Was passiert mit konsolidierten Projections?\n- Retraction eines Events das schon retracted wurde (idempotent ignorieren)\n- Performance bei Usern mit vielen Events (Pagination? Limit?)\n\nDas ist das komplexeste Ticket. Sorgfalt vor Geschwindigkeit.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:41.493674+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T16:14:01.10177+01:00","closed_at":"2026-02-09T16:14:01.10177+01:00","close_reason":"Full Replay retraction support in all 7 handlers + router + 18 integration tests","dependencies":[{"issue_id":"kura-training-k71","depends_on_id":"kura-training-57d","type":"blocks","created_at":"2026-02-09T15:42:02.675694+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-k71","depends_on_id":"kura-training-dru","type":"blocks","created_at":"2026-02-09T15:42:02.744699+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-kk0","title":"Decision 13 Phase 3/F5: Autonomous Tier-A repair apply path","description":"Implement policy-gated Tier-A auto-apply in quality_health: auto-apply only tier=A + simulated_safe + no warnings + no unknown impacts + deterministic source, emit quality.fix.applied/rejected and quality.issue.closed artifacts, rerun invariants for verification, and add tests for positive/negative/idempotency recurrence guard.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T16:59:22.678583+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T17:10:42.146516+01:00","closed_at":"2026-02-11T17:10:42.146516+01:00","close_reason":"Closed"}
{"id":"kura-training-klbf","title":"Upgrade causal effect estimator to doubly-robust AIPW/TMLE with robust uncertainty","description":"WHY:\nCurrent causal estimator (custom logistic-IPW + bootstrap) is a good baseline but not the strongest option under model misspecification.\n\nHOW:\nUpgrade to doubly-robust causal estimation (AIPW/TMLE style) with cross-fitting and robust uncertainty diagnostics:\n- retain existing caveat semantics for overlap/weights/confounding risk\n- add estimator-level diagnostics and fallback behavior\n- preserve current output contract for agent consumers.\n\nIMPLEMENTATION TASKS:\n1) Implement doubly-robust estimator and cross-fitting path.\n2) Add estimator selection/fallback policy.\n3) Extend eval metrics for causal robustness and calibration.\n4) Update architecture tests for required diagnostics and caveat continuity.\n\nACCEPTANCE:\n- Causal outputs remain stable in schema and improved in statistical robustness.\n- Failures degrade gracefully with explicit diagnostics, not silent fallback.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:26:24.096964+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:35.557538+01:00","closed_at":"2026-02-20T19:28:35.557538+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo).","dependencies":[{"issue_id":"kura-training-klbf","depends_on_id":"kura-training-w61v","type":"blocks","created_at":"2026-02-20T18:40:33.050241+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-kmd","title":"Deploy OAuth-first MCP bridge to production and verify /mcp discovery endpoints","description":"Deploy commit af6fab1 to production stack (kura-api + kura-proxy) and verify these public endpoints return non-404: /mcp, /.well-known/oauth-authorization-server, /.well-known/oauth-protected-resource/mcp, /oauth/authorize, /oauth/token, /oauth/register. Confirm Claude/ChatGPT connector click-auth flow works end-to-end.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T16:04:38.564801+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T16:25:58.752683+01:00","closed_at":"2026-02-16T16:25:58.752683+01:00","close_reason":"Closed"}
{"id":"kura-training-kqf","title":"Inference Dimensions: Bayesian strength estimates, fatigue-readiness scores","description":"When PyMC/Stan engine arrives, computed values like Bayesian Strength Estimates or Fatigue-Readiness Scores could become their own dimension type. Not raw data, not agent composition — statistical inference. This is Decision 6 (Three Layers of Intelligence) materialized as projections. Prerequisite: PyMC/Stan integration.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T08:13:51.040943+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T09:05:24.007736+01:00","closed_at":"2026-02-11T09:05:24.007736+01:00","close_reason":"Closed"}
{"id":"kura-training-kqub","title":"MCP Capability/Tool-Surface Hardening gegen Startup-Mismatch","description":"Why:\nDer bisherige Tool-Surface-Mismatch (required_first_tool nicht exposed) erzeugt reproduzierbare Startup-Deadlocks.\n\nHow:\nHarmonisiere MCP Capability Negotiation und Tool-Registry:\n- required_first_tool muss im exposed surface vorhanden sein ODER formal auf fallback_first_tool gemappt werden.\n- mcp_status gibt harte, überprüfbare Felder inkl. reason/status für startup gate.\n- Keine stillen Widersprüche zwischen Status und Tool-Liste.\n\nCompact-survival note:\nDer Agent kann deterministisch feststellen, ob er starten darf, statt aus widersprüchlichen Signalen zu raten.","design":"Capability contract als explizite Invariante behandeln; bei Verletzung sofort blocked reason statt opportunistischem Tool-Roulette.","acceptance_criteria":"1) required_first_tool/tool-registry mismatch wird technisch verhindert oder explizit auf fallback gemappt.\n2) mcp_status Felder sind konsistent und testbar.\n3) Startup-Deadlocks durch Tool-Surface-Widerspruch treten nicht mehr auf.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T08:49:06.620895+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T09:16:49.898665+01:00","closed_at":"2026-02-21T09:16:49.898665+01:00","close_reason":"Closed","labels":["capability","mcp","startup"],"dependencies":[{"issue_id":"kura-training-kqub","depends_on_id":"kura-training-21cw","type":"parent-child","created_at":"2026-02-21T08:49:07.32378+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-kqub","depends_on_id":"kura-training-gayi","type":"blocks","created_at":"2026-02-21T08:49:07.812949+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-kqub","depends_on_id":"kura-training-79mg","type":"blocks","created_at":"2026-02-21T08:49:08.005217+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ksu","title":"[task] 404-Paradigm-Hint für nicht-existente REST-Verb-Pfade","description":"## Kontext\n\nErgänzung zum operational_model Feature (kura-training-nco). Brief = Prophylaxe (korrigiert mentales Modell vor erster Aktion). 404-Hint = Diagnose (fängt den Agent genau im Moment der falschen Aktion ab).\n\nFreds Analyse: Agents unter Druck neigen zu direktem Probieren statt Dokumentation lesen. Wenn ein Agent POST /v1/events/{id}/retract oder DELETE /v1/events/{id} versucht, soll die 404-Response das Event-Sourcing-Paradigma erklären.\n\n## Was zu tun ist\n\nIn der Rust API: Wenn ein Request auf /v1/events/{id}/* oder ähnliche nicht-existente Pfade trifft, die nach REST-CRUD-Verben aussehen (retract, delete, update, void, cancel), soll die 404-Response einen paradigm_hint enthalten:\n\n{\n  \"error\": \"not_found\",\n  \"message\": \"No endpoint at this path\",\n  \"paradigm_hint\": \"Kura uses Event Sourcing. Corrections are compensating events, not REST verbs. To retract: POST /v1/events with event_type 'event.retracted'. See system_config.conventions.data_correction for the full correction pattern.\"\n}\n\n## Wie\n\n- Entweder als Fallback-Route in axum Router (/v1/events/{id}/{action} catch-all)\n- Oder als Tower middleware/layer die 404s anreichert wenn der Pfad bestimmte Patterns matched\n- Lightweight — nur String-Matching auf dem Pfad, kein DB-Zugriff\n- Feuert unabhängig vom Client (CLI, curl, MCP, urllib)\n\n## Dateien\n\n- api/src/routes/events.rs oder api/src/main.rs (Fallback-Route)\n- api/src/routes/agent.rs (falls agent-spezifischer Pfad)","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-18T22:51:38.779099+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T07:50:40.236726+01:00","closed_at":"2026-02-19T07:50:40.236726+01:00","close_reason":"Fallback handler in main.rs returns paradigm_hint for REST-CRUD attempts on /v1/events/","dependencies":[{"issue_id":"kura-training-ksu","depends_on_id":"kura-training-1eo","type":"blocks","created_at":"2026-02-18T22:52:10.274814+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet","title":"Evidence-OS Architektur: Objective/Goal-Pack + Advisory + Override-Rationale","description":"Warum:\nKura muss als Evidence OS skalieren: generische Datenerfassung + sportnahe Spezifität, ohne harte, fragil codierte Coach-Logik. Das aktuelle System ist in Teilen strength-zentriert und hat Modalitäts-Fallback-Risiken. Ohne eine gezielte Foundation-Schärfung würden neue Sport-Features inkonsistent und teuer in Wartung/Regression werden.\n\nWie:\nDieses Feature liefert eine inkrementelle, rückwärtskompatible Architektur-Erweiterung entlang bestehender Event/Projection/Advisory-Muster. Kern ist: objective-first Datenmodell, advisory-only Konflikthinweise, override-rationale als Lernsignal, open-set Modalitätsrouting und per-objective/per-modality Gates. Keine Big-Bang-Umstellung; additive Migration + Backfill für Bestandnutzer sind Pflicht.\n\nInvarianten (kompaktierungsfest):\n- Mensch + Agent bleiben Entscheidungsträger; System bleibt advisory-first.\n- Neue Architekturentscheidungen werden als executable specs in tests/architecture verankert (kein separates Design-Dokument als Source of Truth).\n- Legacy-Datenpfade (goal.set etc.) bleiben kompatibel und werden sauber in objective_state überführt.\n- Rollout gilt erst als abgeschlossen nach Deep Audit über Codepfade + Datenpfade + Policies.\n","design":"Umsetzungsreihenfolge:\n1) Spec Contracts (Objective + Goal-Pack Registry)\n2) objective_state Projection\n3) Objective Advisory Engine\n4) Open-set Modality + Agent Context Surfaces\n5) Bestandsnutzer Migration/Backfill/Recalc\n6) Eval Gates (grouped)\n7) Deep Audit\n\nPflicht-Gates:\n- Alle neuen Invarianten als tests/architecture.\n- Additive/replay-safe Migration + idempotente Recalculation.\n- Keine hard blocks durch objective/advisory Layer (außer bestehende Safety-Invarianten).\n- Per-objective + per-modality Regressionen werden separat bewertet.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T20:53:52.670869+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:19.004138+01:00","closed_at":"2026-02-20T22:20:19.004138+01:00","close_reason":"Objective/Goal-Pack Evidence-OS foundation implemented end-to-end with migration/backfill path, statistical robustness extensions, architecture spec coverage, and green quality gates.","labels":["advisory","architecture","goal-pack","objective"]}
{"id":"kura-training-ktet.1","title":"[spec] Objective Contract + Goal-Pack Registry + Event-Konventionen v2","description":"Warum:\nOhne ein kanonisches Objective-Modell bleibt die Plattform zwischen Goal-Freitext, Sportarten-Denken und impliziten Heuristiken fragmentiert. Das erschwert Analysen, Warnungen und konsistente Agent-Entscheidungen über unterschiedliche Nutzertypen.\n\nWie:\nDefiniere einen stabilen Objective-Vertrag mit primary_goal, secondary_goals, anti_goals, mode (journal|collaborate|coach), hypothesis(optional), success_metrics, constraint_markers, source und confidence. Goal-Packs sind nur Templates (Startpunkte), keine zwingenden Regeln. Event-Konventionen erweitern um objective.* und advisory.override.*; goal.set bleibt gültig und wird als Legacy-Input klar gemappt.\n\nDefinition of Done:\n- Event-Konventionen enthalten Objective/Override-Felder mit klarer Semantik und Beispielen.\n- Backward-Compatibility-Regeln für goal.set sind explizit spezifiziert.\n- Contract-Tests pinnen Pflichtfelder, Default-Semantik und Kompatibilität.\n","design":"Executable Specs (tests/architecture):\n- test_155_objective_contract.py\n  Invariant: objective payload parser-stabil, Pflichtfelder vorhanden, mode-Werte gültig, unknown fields toleriert wenn additive.\n- test_156_goal_pack_registry_contract.py\n  Invariant: Registry enthält mindestens performance/physique/health/explore; Packs markieren advisory_template=true.\n- test_168_legacy_goal_compatibility_contract.py\n  Invariant: bestehende goal.set Events bleiben konsumierbar und deterministisch in objective semantics überführbar.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T20:54:24.8566+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:04.001215+01:00","closed_at":"2026-02-20T22:20:04.001215+01:00","close_reason":"Objective contract + goal-pack registry + event conventions implemented and architecture-spec pinned.","labels":["architecture","event-conventions","objective"],"dependencies":[{"issue_id":"kura-training-ktet.1","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T20:54:24.857586+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.10","title":"[migration] Bestandsnutzer-Backfill + Recalculation für objective_state/advisory/modality","description":"Warum:\nNeue Objective-/Advisory-/Modalitätslogik ohne saubere Bestandnutzer-Migration würde inkonsistente Ergebnisse, stille Drift und Vertrauensverlust erzeugen.\n\nWie:\nImplementiere additive Migration + append-only Backfill + kontrollierte Projection-Recalculation für bestehende Nutzer. Rollout in Batches/Partitionen mit Idempotency, Checkpointing und Telemetrie (coverage, duration, failure_rate, drift deltas). Führe Shadow-Validation pre/post aus; bei auffälliger Drift wird Rollout pausiert und als Issue erfasst.\n\nMigrationsprinzipien:\n- Keine destruktiven Umschreibungen historischer Events.\n- Recompute ist replay-safe und wiederholbar.\n- Legacy goal.set/Import-Daten bleiben interpretierbar.\n\nDefinition of Done:\n- Backfill/Recalc kann mehrfach ohne Seiteneffekte laufen.\n- Monitoring zeigt Abdeckung + Fehlerraten + Drift.\n- Rollout-Kriterien (go/no-go) sind implementiert und überprüfbar.\n","design":"Executable Specs (tests/architecture):\n- test_166_objective_migration_backfill_contract.py\n  Invariant: Migration ist additive, append-only, replay-safe.\n- test_167_projection_recalc_idempotency_contract.py\n  Invariant: gleiche Inputs -\u003e gleiche Projection Outputs.\n- test_168_legacy_goal_compatibility_contract.py\n  Invariant: bestehende goal.set Semantik bleibt erhalten.\n- test_171_post_migration_regression_guard_contract.py\n  Invariant: Post-Migration drift innerhalb definierter Grenzen.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T21:00:39.454175+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:12.606733+01:00","closed_at":"2026-02-20T22:20:12.606733+01:00","close_reason":"Backfill/recalc path implemented with objective backfill job, deduped enqueue logic, executable script, and runbook checks.","labels":["backfill","migration","objective","recalc"],"dependencies":[{"issue_id":"kura-training-ktet.10","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T21:00:39.455072+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.10","depends_on_id":"kura-training-ktet.2","type":"blocks","created_at":"2026-02-20T21:00:50.294428+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.10","depends_on_id":"kura-training-ktet.3","type":"blocks","created_at":"2026-02-20T21:00:50.422489+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.10","depends_on_id":"kura-training-ktet.6","type":"blocks","created_at":"2026-02-20T21:00:50.547738+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.10","depends_on_id":"kura-training-ktet.7","type":"blocks","created_at":"2026-02-20T21:00:50.674139+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.10","depends_on_id":"kura-training-ktet.13","type":"blocks","created_at":"2026-02-20T21:05:43.954899+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.10","depends_on_id":"kura-training-ktet.14","type":"blocks","created_at":"2026-02-20T21:05:44.076311+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.10","depends_on_id":"kura-training-ktet.15","type":"blocks","created_at":"2026-02-20T21:05:44.197613+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.11","title":"[audit] Deep Audit nach Implementierung: Konsistenz, Regressionen, Policy-Fit","description":"Warum:\nNach einer solchen Foundation-Änderung reicht \"Tests grün\" nicht aus. Es braucht einen systematischen Deep Audit, der Cross-Layer-Konsistenz und reale Policy-Wirkung überprüft.\n\nWie:\nFühre einen Deep Audit über Worker, API, Projectionen, Eval-Gates, Telemetrie und Legacy-Kompatibilität durch. Prüfe insbesondere advisory-only Verhalten, Override-Autonomie, Objective-Trackability, Modalitätsfairness und Post-Migration-Drift. Alle Findings werden als konkrete Beads erfasst (keine losen Notizen).\n\nDefinition of Done:\n- Audit-Artefakte zeigen status pro Invariante (pass/fail/risk).\n- Offene Risiken sind als priorisierte Beads mit Dependencies angelegt.\n- Abschluss nur, wenn keine kritischen ungeklärten Regressionen verbleiben.\n","design":"Executable Specs (tests/architecture):\n- test_169_evidence_os_consistency_audit_contract.py\n  Invariant: objective/advisory/override/modality surfaces sind cross-layer konsistent.\n- test_170_advisory_override_policy_fit_contract.py\n  Invariant: warnings sind übersteuerbar; safety invariants bleiben aktiv.\n- test_171_post_migration_regression_guard_contract.py\n  Invariant: nach Migration keine kritische Regression gegenüber Baseline.\n\nAudit-Umfang:\n- API contracts, projection contracts, policy contracts, eval gate outcomes, migration telemetry.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T21:00:39.586684+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:12.942125+01:00","closed_at":"2026-02-20T22:20:12.942125+01:00","close_reason":"Deep audit completed: cross-layer invariants validated by architecture specs and full gate suite.","labels":["audit","quality","regression"],"dependencies":[{"issue_id":"kura-training-ktet.11","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T21:00:39.587832+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.11","depends_on_id":"kura-training-ktet.4","type":"blocks","created_at":"2026-02-20T21:00:50.93079+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.11","depends_on_id":"kura-training-ktet.5","type":"blocks","created_at":"2026-02-20T21:00:51.066151+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.11","depends_on_id":"kura-training-ktet.9","type":"blocks","created_at":"2026-02-20T21:00:51.200028+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.11","depends_on_id":"kura-training-ktet.10","type":"blocks","created_at":"2026-02-20T21:00:51.327143+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.11","depends_on_id":"kura-training-ktet.16","type":"blocks","created_at":"2026-02-20T21:05:44.471558+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.12","title":"[spec] Objective-aware Statistical Method Contract v1","description":"Warum: Die aktuelle Statistik-/Eval-Logik ist überwiegend global gemittelt (z. B. capability gate mean_confidence, shadow deltas als Gesamtmittel), wodurch Objective-/Modality-spezifische Regressionen verdeckt werden können. Wie: Definiere einen methodischen Vertrag für objective-/modality-stratifizierte Auswertung inklusive Estimand-Definitionen, Unsicherheits- und Sample-Size-Policy, Aggregationsregeln und Fallback-Verhalten bei kleinen Gruppen. DoD: Methodik ist als executable specs testgepint und referenziert in Eval-/Inference-Komponenten.","design":"Executable Specs: tests/architecture/test_172_objective_statistical_contract.py (stratification + aggregation policy), tests/architecture/test_179_small_sample_shrinkage_contract.py (small-n handling + fallback transparency).","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T21:05:34.447888+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:04.829163+01:00","closed_at":"2026-02-20T22:20:04.829163+01:00","close_reason":"Objective-aware statistical method contract v1 implemented and pinned via architecture specs.","labels":["objective","spec","statistics"],"dependencies":[{"issue_id":"kura-training-ktet.12","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T21:05:34.449868+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.12","depends_on_id":"kura-training-ktet.1","type":"blocks","created_at":"2026-02-20T21:05:42.602029+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.13","title":"[impl] Stratified Calibration + Confidence Recalibration (Objective/Modality)","description":"Warum: Confidence/Thresholds sind aktuell überwiegend global und können bei Architektur-Shift falsch kalibriert sein. Wie: Erweitere Eval/Calibration auf objective_mode x modality x quality_band Segmente; implementiere segmentweise Kalibrierungsmetriken (z. B. Brier/ECE/coverage) und robuste Aggregation (gewichtet + shrinkage). Passe rollout thresholds und policy inputs auf segmentierte Signale an. DoD: Kalibrierungsberichte und Gates sind segmentiert und verhindern verdeckte Gruppenregressionen.","design":"Executable Specs: tests/architecture/test_173_stratified_calibration_contract.py (segment metrics required), tests/architecture/test_178_uncertainty_calibration_drift_contract.py (drift guard for calibration/confidence).","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T21:05:34.616247+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:04.919617+01:00","closed_at":"2026-02-20T22:20:04.919617+01:00","close_reason":"Stratified calibration and confidence drift guard implemented across objective_mode/modality/quality_band.","labels":["calibration","eval","statistics"],"dependencies":[{"issue_id":"kura-training-ktet.13","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T21:05:34.617464+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.13","depends_on_id":"kura-training-ktet.12","type":"blocks","created_at":"2026-02-20T21:05:42.728106+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.13","depends_on_id":"kura-training-ktet.2","type":"blocks","created_at":"2026-02-20T21:05:42.844776+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.14","title":"[impl] Causal Estimand Registry v2 (Objective/Modality aware)","description":"Warum: Causal-Pfade fokussieren derzeit vor allem readiness/strength und riskieren objective mismatch bei Multi-Sport-/Health-/Physique-Zielen. Wie: Führe explizite Estimand-Registry v2 ein (intervention x outcome x objective_mode x modality) mit klarer Confounder-Liste, Positivity/Overlap-Diagnostik und segmentierter Evidenz-Ausgabe. Ergänze Outcome-Mapping auf capability-/performance-relevante Targets ohne harte Sportsilo-Logik. DoD: Causal-Ausgaben benennen Estimand eindeutig, enthalten passende Caveats und bleiben rückwärtskompatibel.","design":"Executable Specs: tests/architecture/test_174_causal_estimand_registry_v2_contract.py (estimand identity + confounder contract), tests/architecture/test_176_statistical_robustness_guard_contract.py (overlap/positivity guardrails surfaced).","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T21:05:34.778051+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:05.010675+01:00","closed_at":"2026-02-20T22:20:05.010675+01:00","close_reason":"Causal estimand registry v2 implemented and integrated into causal inference output contract.","labels":["causal","estimand","statistics"],"dependencies":[{"issue_id":"kura-training-ktet.14","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T21:05:34.778828+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.14","depends_on_id":"kura-training-ktet.12","type":"blocks","created_at":"2026-02-20T21:05:42.958116+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.14","depends_on_id":"kura-training-ktet.2","type":"blocks","created_at":"2026-02-20T21:05:43.081193+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.14","depends_on_id":"kura-training-ktet.6","type":"blocks","created_at":"2026-02-20T21:05:43.212971+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.15","title":"[impl] Population Priors Cohorting v2 + Hierarchical Shrinkage","description":"Warum: Population-Prior-Cohorting ist derzeit primär training_modality + experience_level; Objective-Kontext fehlt und kann Fehl-Pooling verursachen. Wie: Erweitere cohorting um objective_mode (und relevante objective-tags), baue hierarchische Shrinkage-/Fallback-Strategie (global\u003c-\u003ecohort\u003c-\u003etarget) mit transparenter Blend-Metadaten aus. Stelle sicher, dass kleine Kohorten nicht übergewichtet werden. DoD: Prior-Aufbau und Prior-Nutzung sind objective-aware, privacy-safe und stabil bei kleinen Segmenten.","design":"Executable Specs: tests/architecture/test_175_population_prior_cohorting_v2_contract.py (cohort key semantics + compatibility), tests/architecture/test_179_small_sample_shrinkage_contract.py (shrinkage fallback behavior).","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T21:05:34.932498+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:05.101767+01:00","closed_at":"2026-02-20T22:20:05.101767+01:00","close_reason":"Population priors cohorting v2 with objective dimension and hierarchical shrinkage/fallback metadata implemented.","labels":["population-priors","shrinkage","statistics"],"dependencies":[{"issue_id":"kura-training-ktet.15","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T21:05:34.9338+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.15","depends_on_id":"kura-training-ktet.12","type":"blocks","created_at":"2026-02-20T21:05:43.347015+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.15","depends_on_id":"kura-training-ktet.14","type":"blocks","created_at":"2026-02-20T21:05:43.477595+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.16","title":"[gate] Statistical Robustness Gate (Simpson, small-n, drift)","description":"Warum: Nach Umstellung können scheinbar gute Globalmetriken echte Gruppenprobleme maskieren. Wie: Ergänze robustheitsorientierte Gates für Simpson-Paradox-Indikatoren (Sign-Reversal/Delta-Reversal), small-sample-Sicherheit und calibration drift je Segment. Ergebnisse werden nightly in Telemetry/Quality-Surface ausgewiesen und blockieren Rollout bei kritischen Befunden. DoD: Gate bewertet Robustheit segmentiert, failt bei kritischen statistischen Anti-Patterns und ist CI/nightly integriert.","design":"Executable Specs: tests/architecture/test_176_statistical_robustness_guard_contract.py, tests/architecture/test_177_simpson_paradox_detection_contract.py, tests/architecture/test_178_uncertainty_calibration_drift_contract.py.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T21:05:35.093966+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:05.197474+01:00","closed_at":"2026-02-20T22:20:05.197474+01:00","close_reason":"Statistical robustness gate implemented with Simpson detection, drift checks, and small-sample policy surface.","labels":["gate","robustness","statistics"],"dependencies":[{"issue_id":"kura-training-ktet.16","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T21:05:35.095326+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.16","depends_on_id":"kura-training-ktet.13","type":"blocks","created_at":"2026-02-20T21:05:43.596492+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.16","depends_on_id":"kura-training-ktet.14","type":"blocks","created_at":"2026-02-20T21:05:43.713768+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.16","depends_on_id":"kura-training-ktet.15","type":"blocks","created_at":"2026-02-20T21:05:43.83229+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.2","title":"[impl] objective_state Projection (active objective + constraints + confidence)","description":"Warum:\nObjective-Logik muss als Projection verfügbar sein, sonst bleibt sie nur Event-Rohmaterial und ist für Agent/Analysen inkonsistent. Zudem brauchen Bestandnutzer eine nachvollziehbare objective_state-Ableitung.\n\nWie:\nImplementiere objective_state als full-recompute, idempotente Projection aus objective.* plus legacy goal.set. Speichere active_objective, objective_history, active_constraints, inferred_confidence, unresolved_fields und source lineage. user_profile/manifest referenzieren objective_state als first-class Kontextfläche.\n\nMigration/Bestandsnutzer:\n- Wenn keine objective.* Events existieren, generiere objective_state deterministisch aus bestehenden goal.set/profile Signalen mit source=legacy_inferred.\n- Keine destruktive Umschreibung historischer Events.\n\nDefinition of Done:\n- Recompute ist deterministisch bei gleicher Eventfolge.\n- Legacy-Nutzer erhalten stabilen objective_state ohne manuelle Intervention.\n- Projection Schema ist testgepint und API-konsumierbar.\n","design":"Executable Specs (tests/architecture):\n- test_162_objective_state_projection_contract.py\n  Invariant: projection enthält active_objective/objective_history/constraints/confidence/unresolved_fields.\n- test_167_projection_recalc_idempotency_contract.py\n  Invariant: erneute Recompute-Läufe liefern identisches Ergebnis bei identischer Eventbasis.\n- test_168_legacy_goal_compatibility_contract.py\n  Invariant: legacy goal.set -\u003e objective_state mapping bleibt stabil.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T20:54:24.992943+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:04.100364+01:00","closed_at":"2026-02-20T22:20:04.100364+01:00","close_reason":"objective_state projection implemented with deterministic replay, legacy mapping, and API-consumable schema.","labels":["objective","projection","workers"],"dependencies":[{"issue_id":"kura-training-ktet.2","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T20:54:24.993756+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.2","depends_on_id":"kura-training-ktet.1","type":"blocks","created_at":"2026-02-20T20:54:42.318901+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.3","title":"[impl] Objective-Consistency Advisory Engine (warnings only)","description":"Warum:\nOhne objective-konsistente Hinweise bleibt die Plattform entweder zu generisch (keine Richtung) oder zu hart (falsche Automatik). Gewünscht ist evidenzbasierte Unterstützung ohne Autonomieverlust.\n\nWie:\nBaue eine Objective-Consistency Advisory Engine, die Konflikte zwischen Ziel, Datenlage und Hypothese als Warnings mit reason_codes + confidence surfaced. Der Layer bleibt strikt advisory-only: keine automatischen Plan-Blocks, kein stilles Durchregieren. Hypothesis-/Phasenkontext kann geplante kurzfristige Dips legitimieren.\n\nDefinition of Done:\n- Warnings enthalten nachvollziehbare Gründe, Evidenzbezug und Unsicherheitsangabe.\n- policy_role bleibt advisory_only.\n- objective ohne messbaren Tracking-Pfad erzeugt nachvollziehbaren Warnhinweis.\n","design":"Executable Specs (tests/architecture):\n- test_157_objective_advisory_only_contract.py\n  Invariant: objective warnings dürfen Autonomie nicht blockieren.\n- test_160_objective_trackability_contract.py\n  Invariant: objective ohne beobachtbaren Messpfad wird als trackability gap markiert.\n- test_170_advisory_override_policy_fit_contract.py (shared with audit)\n  Invariant: advisory bleibt übersteuerbar, Safety-Invarianten bleiben wirksam.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T20:54:25.141979+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:04.197901+01:00","closed_at":"2026-02-20T22:20:04.197901+01:00","close_reason":"Objective-consistency advisory projection implemented as warnings-only with trackability and staleness signals.","labels":["advisory","objective","policy"],"dependencies":[{"issue_id":"kura-training-ktet.3","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T20:54:25.142985+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.3","depends_on_id":"kura-training-ktet.2","type":"blocks","created_at":"2026-02-20T20:54:42.458942+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.4","title":"[impl] Override-Rationale Events + Lernsignale","description":"Warum:\nBewusste Abweichungen von Warnungen sind wertvolles Wissen. Ohne strukturierte Override-Rationale verliert das System Lernfähigkeit und reproduziert dieselben Fehlannahmen.\n\nWie:\nFühre strukturierte Override-Rationale-Events ein (why, scope, expected_outcome, review_point, actor). Aggregiere diese Signale in Telemetry/Quality-Health, damit häufig sinnvolle Overrides erkennbar und in späteren Heuristiken berücksichtigbar sind. Overrides dürfen warnings überstimmen, aber nicht Safety-Invarianten umgehen.\n\nDefinition of Done:\n- Override-Rationale wird persistiert und ist im Kontext auffindbar.\n- Aggregierte Lernsignale sind messbar (Counts, rate, outcome linkage).\n- Policy-Grenze zwischen advisory override und safety invariant ist testgepint.\n","design":"Executable Specs (tests/architecture):\n- test_158_override_rationale_contract.py\n  Invariant: override rationale Pflichtfelder vorhanden; warnings übersteuerbar; safety invariants nicht deaktivierbar.\n- test_170_advisory_override_policy_fit_contract.py\n  Invariant: advisory/policy Verhalten konsistent bei Overrides.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T20:54:25.307085+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:04.288755+01:00","closed_at":"2026-02-20T22:20:04.288755+01:00","close_reason":"Override-rationale event surface and advisory aggregation implemented with safety invariant separation.","labels":["learning","override","telemetry"],"dependencies":[{"issue_id":"kura-training-ktet.4","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T20:54:25.308254+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.4","depends_on_id":"kura-training-ktet.3","type":"blocks","created_at":"2026-02-20T20:54:42.589089+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.5","title":"[impl] Onboarding Interview auf Objective-Auflösung erweitern","description":"Warum:\nWenn Objective-Klarheit im Onboarding fehlt, entstehen diffuse Empfehlungen und inkonsistente Analysen. Gleichzeitig darf Onboarding keine harte Hürde sein.\n\nWie:\nErweitere Interview-Guide und user_profile-Agenda um objective-Auflösung: mode, primary outcome, anti-goals/constraints, gewünschte Zusammenarbeitstiefe. Bei unklaren Angaben wird ein transparenter Default (health oder explore) gesetzt, inklusive source/confidence statt stiller Annahme. Skip-and-log-now bleibt erhalten.\n\nDefinition of Done:\n- Objective-Auflösung ist im Onboardingpfad integriert.\n- Defaults sind explizit markiert und später überschreibbar.\n- Bestehende onboarding closed/override Flows bleiben funktionsgleich.\n","design":"Executable Specs (tests/architecture):\n- test_159_onboarding_objective_resolution_contract.py\n  Invariant: onboarding erzeugt objective path oder expliziten Default; skip-and-log bleibt verfügbar.\n- Erweiterung test_130_onboarding_intent_reliability_contract.py\n  Invariant: objective-Erfassung wird nicht durch Event-Count allein unterdrückt.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T20:54:25.482436+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:04.380372+01:00","closed_at":"2026-02-20T22:20:04.380372+01:00","close_reason":"Onboarding/interview objective resolution integrated with explicit default objective semantics and legacy compatibility.","labels":["objective","onboarding","user_profile"],"dependencies":[{"issue_id":"kura-training-ktet.5","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T20:54:25.483276+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.5","depends_on_id":"kura-training-ktet.1","type":"blocks","created_at":"2026-02-20T20:54:42.716273+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.5","depends_on_id":"kura-training-ktet.2","type":"blocks","created_at":"2026-02-20T20:54:42.843388+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.6","title":"[impl] Open-Set Modalitätsrouting + Major-Sport Adapter (inkl. Schwimmen)","description":"Warum:\nFalsche Fallbacks (z. B. unknown -\u003e running) erzeugen systematische Verzerrung und beschädigen sportartspezifische Analysen. Für Breite + Spezifität braucht es open-set Routing mit sauberer Unsicherheitsbehandlung.\n\nWie:\nErsetze harte Default-Fallbacks durch open-set Modalitätsrouting (`unknown`/`hybrid` + confidence). Ergänze Major-Sport Adapter für Running/Cycling/Rowing/Swimming als dünne Spezifikationsschicht über gemeinsamer Engine (keine Fork des Gesamtsystems). Bei geringer Sicherheit: generische Verarbeitung + transparente Unsicherheit.\n\nBestandsdaten:\n- Legacy-Imports mit unklarer Modalität werden nicht mehr als running umetikettiert.\n- Recalculation wird über dedizierten Migration-Task durchgeführt.\n\nDefinition of Done:\n- Kein hidden fallback auf running mehr.\n- Swimming ist als major modality in Import-Mapping/Abdeckung berücksichtigt.\n- Modality fairness surfaces zeigen parity-signale statt strength-only Bias.\n","design":"Executable Specs (tests/architecture):\n- test_163_open_set_modality_contract.py\n  Invariant: unknown bleibt unknown; confidence wird transportiert.\n- Erweiterung test_102_import_mapping_modality_coverage_contract.py\n  Invariant: major modalities enthalten running/cycling/rowing/swimming.\n- Erweiterung test_145_modality_fairness_surface_contract.py\n  Invariant: fairness surface reflektiert open-set/adapters ohne forced remap.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T20:54:25.641207+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:04.473207+01:00","closed_at":"2026-02-20T22:20:04.473207+01:00","close_reason":"Open-set modality routing implemented, unknown preserved, and major modalities including swimming covered.","labels":["imports","modality","swimming"],"dependencies":[{"issue_id":"kura-training-ktet.6","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T20:54:25.642469+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.6","depends_on_id":"kura-training-ktet.1","type":"blocks","created_at":"2026-02-20T20:54:42.969238+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.6","depends_on_id":"kura-training-ktet.2","type":"blocks","created_at":"2026-02-20T20:54:43.09804+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.7","title":"[impl] Agent Context: objective_state + advisory + override rationale surfaces","description":"Warum:\nOhne Objective-/Advisory-/Override-Surfaces im Agent-Context bleibt das Modell im Dialog bias-anfällig und kann vorhandene Evidenz nicht konsistent priorisieren.\n\nWie:\nExpose objective_state, objective advisories und override-rationale explizit in /v1/agent/context sowie relevanten response envelopes. Passe Retrieval/Ranking so an, dass objective-driven Signale priorisiert werden und strength-only Dominanz reduziert wird. Änderungen sind backward-kompatibel (additive Felder, stabile Schema-Pins).\n\nDefinition of Done:\n- Agent-Context enthält objective/advisory/override Felder mit stabiler Semantik.\n- Ranking nutzt objective-state Signale nachvollziehbar.\n- Bestehende Clients brechen nicht (additive Contracts).\n","design":"Executable Specs (tests/architecture + route tests):\n- test_164_agent_context_objective_surface_contract.py\n  Invariant: context payload enthält objective/advisory/override surfaces.\n- Rust route schema pin tests in api/src/routes/agent.rs\n  Invariant: additive Felder sind stabil versioniert und parser-sicher.\n- Kopplung mit test_157/test_158\n  Invariant: advisory-only + override semantics bleiben im API-Surface konsistent.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T20:54:25.804602+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:04.563508+01:00","closed_at":"2026-02-20T22:20:04.563508+01:00","close_reason":"Agent context now surfaces objective_state and objective_advisory with contract version bump and reload hints.","labels":["agent","api","context"],"dependencies":[{"issue_id":"kura-training-ktet.7","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T20:54:25.805741+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.7","depends_on_id":"kura-training-ktet.2","type":"blocks","created_at":"2026-02-20T20:54:43.234749+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.7","depends_on_id":"kura-training-ktet.3","type":"blocks","created_at":"2026-02-20T20:54:43.364309+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.7","depends_on_id":"kura-training-ktet.4","type":"blocks","created_at":"2026-02-20T20:54:43.493+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ktet.9","title":"[gate] Per-Objective und Per-Modality Eval-Gates","description":"Warum:\nEin globaler Durchschnitt verschleiert echte Regressionen in einzelnen Zielmodi oder Modalitäten. Qualität muss pro Zielprofil und pro Major-Sportart explizit abgesichert werden.\n\nWie:\nFühre gruppierte Eval-Gates ein (per objective mode, per major modality), die unabhängig bestehen müssen. Nightly/Parity-Reporting zeigt Ergebnisse je Gruppe mit klaren Failure-Ursachen. Gate darf nicht grün sein, wenn eine kritische Gruppe regressiert.\n\nDefinition of Done:\n- Eval-Harness liefert gruppierte Metriken + Pass/Fail pro Gruppe.\n- CI/Gates failen deterministisch bei Gruppenregression.\n- Ergebnisse sind für Rollout-Entscheidungen verwendbar.\n","design":"Executable Specs (tests/architecture):\n- test_161_cross_objective_eval_gate_contract.py\n  Invariant: objective groups werden separat bewertet; fail bei Gruppenregression.\n- test_165_major_modality_eval_gate_contract.py\n  Invariant: running/cycling/rowing/swimming müssen jeweilige Mindestwerte erfüllen.\n- test_171_post_migration_regression_guard_contract.py\n  Invariant: Post-Migration keine kritische Regression in Kernmetriken.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T20:54:33.831759+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:20:12.752895+01:00","closed_at":"2026-02-20T22:20:12.752895+01:00","close_reason":"Per-objective/per-modality eval gating implemented via stratified calibration, drift guard, robustness guard, and architecture tests.","labels":["eval","gate","quality"],"dependencies":[{"issue_id":"kura-training-ktet.9","depends_on_id":"kura-training-ktet","type":"parent-child","created_at":"2026-02-20T20:54:33.832487+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.9","depends_on_id":"kura-training-ktet.3","type":"blocks","created_at":"2026-02-20T20:54:43.620833+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.9","depends_on_id":"kura-training-ktet.6","type":"blocks","created_at":"2026-02-20T20:54:43.749645+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.9","depends_on_id":"kura-training-ktet.7","type":"blocks","created_at":"2026-02-20T20:54:43.883869+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.9","depends_on_id":"kura-training-ktet.10","type":"blocks","created_at":"2026-02-20T21:00:50.800009+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ktet.9","depends_on_id":"kura-training-ktet.16","type":"blocks","created_at":"2026-02-20T21:05:44.320457+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-lgsp","title":"API: HTTP Conditional Caching for system config manifest/section","description":"Why:\nSystem config is deployment-static and now section-addressable, but transport efficiency can improve further with ETag/If-None-Match and explicit cache metadata.\n\nHow:\n- Add strong/weak ETag strategy for /v1/system/config, /manifest, /section\n- Return 304 on unchanged payloads\n- Document cache contract for stateful and stateless clients\n\nDefinition of Done:\n- Conditional GET works across all three endpoints\n- Tests cover changed vs unchanged responses\n- No auth or redaction regression","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T10:00:16.265496+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:12:50.640877+01:00","closed_at":"2026-02-19T10:12:50.640877+01:00","close_reason":"Closed"}
{"id":"kura-training-lsg","title":"set.logged conventions: exercise_id, weight_kg, richer fields","description":"Update set.logged conventions: units in field names (weight_kg), exercise + exercise_id duality, optional fields (rpe, set_type, tempo, duration_seconds, distance_meters). Update exercise_progression handler to prefer exercise_id. Document conventions in design doc.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:08.076267+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T14:11:06.233911+01:00","closed_at":"2026-02-08T14:11:06.233911+01:00","close_reason":"Conventions documented in design doc 002, exercise_progression updated (exercise_id priority, weight_kg, rpe/set_type, input validation), validation philosophy decided (free-form, no API validation), unit tests added (15 passing), whitespace bug fixed","dependencies":[{"issue_id":"kura-training-lsg","depends_on_id":"kura-training-nv2","type":"blocks","created_at":"2026-02-08T13:39:32.361961+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-lsu","title":"MCP Server (eigenes Projekt)","description":"Separate MCP server project. Thin client over REST API, speaks MCP protocol. Tool discovery, typed schemas, persistent connection. For Claude Desktop (local) and Claude.ai (hosted). Independent from CLI.","notes":"## Agent-Native Design Considerations (aus Artikel-Review)\n\n### Completion Signals\nMCP-Tools brauchen explizite Completion-Signale, nicht nur Daten-Rückgabe. Pattern: {status: 'success'|'error'|'complete', data: {...}} — damit der Client weiß, ob eine Multi-Step-Aufgabe noch läuft oder fertig ist. REST-API nutzt HTTP-Statuscodes (reicht), MCP braucht eigene Semantik.\n\n### Context Injection / System Prompt Design\nsystem_config + user_profile/me als Agent Entry Point (Decision 7) muss im MCP Server sauber exponiert werden. Der MCP Server sollte dem Client ermöglichen, system_config als Context zu injizieren — z.B. als MCP Resource, die der Client beim Session-Start liest und in den System-Prompt einbettet.\n\n### Partial Completion Tracking\nWenn MCP-Tools intern mehrere API-Calls machen (z.B. 'logge mein komplettes Training' = mehrere set.logged Events), braucht der Client Zwischenfeedback. MCP progress notifications nutzen, nicht stumm arbeiten.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:22.793928+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T08:48:21.231893+01:00","closed_at":"2026-02-13T08:48:21.231893+01:00","close_reason":"Implemented MCP hardening + runtime decoupling for dedicated kura-mcp package: explicit completion envelopes, capability-status diagnostics, and reusable token/auth utility in mcp crate. Verified via quality gates and workspace tests.","dependencies":[{"issue_id":"kura-training-lsu","depends_on_id":"kura-training-wid","type":"blocks","created_at":"2026-02-09T13:46:43.313485+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":1,"issue_id":"kura-training-lsu","author":"jonzim-cmd","text":"Reprioritized for ChatGPT App Integration readiness. Existing MCP baseline is implemented; remaining scope is hardening + decoupling into a dedicated MCP project/runtime and production-grade operator visibility for external tester validation.","created_at":"2026-02-13T07:36:37Z"}]}
{"id":"kura-training-lydz","title":"Reduce MCP payload overflows via lean startup defaults and manifest pagination","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T08:10:31.371561+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T08:49:15.731877+01:00","closed_at":"2026-02-21T08:49:15.731877+01:00","close_reason":"Superseded by structured dependency plan in kura-training-21cw"}
{"id":"kura-training-m3k","title":"Agent-Behavior Detailausbau: Szenarien, Beispiele, User-Overrides","description":"Follow-up zu 2kb. Grundgerüst (vision + operational) steht. Noch offen: konkrete Szenarien mit Beispielen (wie der 3-Tage-Plan-Fehler), User-Override-Mechanismus in user_profile (z.B. scope=proactive), Integration mit interview_guide (Kommunikationsstil erfragen).","notes":"Session handoff 2026-02-13: Reliability UX + onboarding primer are done (m3k.1/m3k.2). Remaining work is now split into m3k.3 (scenario library) and m3k.4 (user overrides), intentionally dependent on wvp self-model/policy outputs to keep UX aligned with runtime constraints.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T07:25:51.179251+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T16:01:47.798128+01:00","closed_at":"2026-02-14T16:01:47.798128+01:00","close_reason":"All quality gates passed: 1191 tests green (706 unit + 84 integration + 293 Rust + 108 architecture specs). Agent-Behavior Detailausbau complete."}
{"id":"kura-training-m3k.1","title":"Reliability UX Protocol: saved vs inferred vs unresolved","description":"Standardize agent response behavior so users can distinguish persisted facts from inferences and open questions. Problem: current conversational confirmations can overstate certainty (e.g., saying logged while values are inferred or conflicting). Outcome: transparent reliability UX with explicit state labels and targeted follow-up prompts.","design":"Introduce response contract after logging: Saved (with receipt basis), Inferred (with confidence + provenance), Unresolved (asks one clarification). Enforce wording constraints in agent behavior policy/examples and add transcript-level tests for claim inflation. Ensure this integrates with write-with-proof artifacts and session audit results.","acceptance_criteria":"1) Response state contract documented with examples and anti-patterns. 2) Agent templates/policies updated to avoid certainty inflation. 3) Transcript tests verify correct labeling for saved/inferred/unresolved cases. 4) Clarification prompts are concise and conflict-focused. 5) User override hooks remain compatible.","notes":"Implemented artifacts\n- docs/design/032-reliability-ux-protocol-saved-inferred-unresolved.md (state contract, anti-patterns, concise clarification policy)\n- api/src/routes/agent.rs:\n  - added `reliability_ux` response contract to `AgentWriteWithProofResponse`\n  - added `AgentReliabilityUx` + `AgentReliabilityInferredFact` schema types\n  - added deterministic state derivation `saved|inferred|unresolved`\n  - added inferred fact collection from `evidence.claim.logged` and inferred repair provenance\n  - tightened clarification prompt wording to conflict-focused concise templates\n  - added regression tests for saved/inferred/unresolved labeling behavior\n- workers/src/kura_workers/system_config.py:\n  - added `agent_behavior.operational.reliability_ux_protocol` with state contract, anti-patterns, clarification style, and override-hook compatibility\n- workers/tests/test_system_config.py:\n  - added assertions for reliability_ux protocol states and override-hook compatibility\n\nTests and exact commands\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nResidual risks / non-goals\n- `assistant_phrase` is currently generated server-side as canonical baseline; no locale-specific phrasing layer yet.\n- V1 inferred-fact extraction focuses on evidence/repair provenance already present in write-with-proof flow; no separate narrative summarizer added.\n\nFollow-up issues\n- kura-training-2zc.2 (cluster reliability failures and state mismatches across users)\n- kura-training-2zc.5 (calibration/drift for inferred-fact confidence over time)\n\nRollback / disable path\n- Remove `reliability_ux` from `AgentWriteWithProofResponse` and bypass `build_reliability_ux(...)` call.\n- Revert `reliability_ux_protocol` section in system_config if policy rollout needs to pause.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T13:37:33.894493+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T15:10:14.319707+01:00","closed_at":"2026-02-12T15:10:14.319707+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-m3k.1","depends_on_id":"kura-training-pdc.5","type":"blocks","created_at":"2026-02-12T13:37:33.897178+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.1","depends_on_id":"kura-training-pdc.20","type":"blocks","created_at":"2026-02-12T13:37:33.897973+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.1","depends_on_id":"kura-training-m3k","type":"parent-child","created_at":"2026-02-12T13:40:06.219198+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-m3k.2","title":"Onboarding Collaboration Primer + Logging Guidance","description":"Add a concise onboarding primer that explains what Kura is, how collaboration works, and how users should communicate/log data for best coaching reliability.","design":"Extend interview_guide and system conventions with a short collaboration contract: context-first communication, correction loop, asking for review, and concrete logging examples. Keep it non-blocking but always available in onboarding guidance.","acceptance_criteria":"1) Interview guide includes collaboration primer and communication tips. 2) Logging guidance includes concrete examples for good set/session reporting. 3) Existing guide structure tests continue to pass and new tests assert primer presence.","notes":"Extended interview_guide with collaboration_primer, communication_tips, and logging_guidance sections to explain what Kura is, how to collaborate, and how to log better session/set data. Added guide tests for primer presence and structure.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:22:15.26046+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:31:58.047479+01:00","closed_at":"2026-02-13T09:31:58.047479+01:00","close_reason":"Implemented and tested","dependencies":[{"issue_id":"kura-training-m3k.2","depends_on_id":"kura-training-m3k","type":"parent-child","created_at":"2026-02-13T09:22:15.261679+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.2","depends_on_id":"kura-training-m3k.1","type":"blocks","created_at":"2026-02-13T09:22:56.256991+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-m3k.3","title":"Scenario Library V1: Model-Tier-Aware Agent Behavior Examples","description":"Create concrete scenario playbooks that show how agent behavior should differ by confidence, model tier, and user preference while preserving reliability UX semantics.","design":"Add executable scenario catalog (happy path, ambiguity, correction, contradiction, low-confidence, overload). Each scenario includes expected event writes, clarification strategy, and Saved/Inferred/Unresolved wording.","acceptance_criteria":"1) Scenario set covers onboarding, logging, correction, and planning transitions. 2) Each scenario specifies expected machine outputs and user-visible phrasing. 3) Regression tests or fixtures validate conformance.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:51.728608+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T07:49:18.759378+01:00","closed_at":"2026-02-14T07:49:18.759378+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-m3k.3","depends_on_id":"kura-training-m3k","type":"parent-child","created_at":"2026-02-13T09:53:51.72978+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.3","depends_on_id":"kura-training-m3k.2","type":"blocks","created_at":"2026-02-13T09:54:38.567897+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.3","depends_on_id":"kura-training-wvp.1","type":"blocks","created_at":"2026-02-13T09:54:43.785227+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":3,"issue_id":"kura-training-m3k.3","author":"jonzim-cmd","text":"Transcript 2026-02-13 regression scenario to include in Scenario Library: (a) session.completed was first guessed (enjoyment/quality) then corrected by user, (b) smith-machine comparability confusion for BSS, (c) pending read-after-write verification while receipts exist. Scenario should assert expected machine outputs and wording: Saved vs Inferred vs Unresolved, one-conflict clarification question, and explicit no-definitive-saved when claim_guard is pending.","created_at":"2026-02-13T11:42:14Z"},{"id":5,"issue_id":"kura-training-m3k.3","author":"jonzim-cmd","text":"Implemented Scenario Library V1 end-to-end. Added operational.scenario_library_v1 and operational.user_override_controls_v1 contracts in workers/src/kura_workers/system_config.py, plus executable architecture specs in tests/architecture/test_61_scenario_library_contract.py and tests/architecture/test_62_user_override_controls_contract.py. Added API runtime conformance tests for onboarding/logging, planning override confirm-first, inferred-with-provenance correction, contradiction unresolved, pending read-after-write unresolved, and overload single-conflict question in api/src/routes/agent.rs. Verified through full quality gates: ruff check, workers unit tests, workers integration tests, cargo test --workspace, and tests/architecture.","created_at":"2026-02-14T06:49:10Z"}]}
{"id":"kura-training-m3k.4","title":"User Override Controls V1: Autonomy Scope + Interaction Style","description":"Implement explicit user override controls to tune autonomy scope and interaction style without breaking safety floors.","design":"Add user_profile preference keys for autonomy scope (strict/moderate/proactive), verbosity, and confirmation strictness. Runtime policy reads overrides but never bypasses global hard invariants.","acceptance_criteria":"1) Overrides persist in profile/preferences and are visible in context. 2) Runtime policy respects overrides within safety floor bounds. 3) Tests cover override precedence and fallback defaults.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:56.949399+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T07:49:21.879064+01:00","closed_at":"2026-02-14T07:49:21.879064+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-m3k.4","depends_on_id":"kura-training-m3k","type":"parent-child","created_at":"2026-02-13T09:53:56.950359+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.4","depends_on_id":"kura-training-m3k.3","type":"blocks","created_at":"2026-02-13T09:54:49.008174+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.4","depends_on_id":"kura-training-wvp.3","type":"blocks","created_at":"2026-02-13T09:54:54.210452+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":6,"issue_id":"kura-training-m3k.4","author":"jonzim-cmd","text":"Implemented User Override Controls V1 across worker contracts + API runtime policy. Added preference keys autonomy_scope, verbosity, confirmation_strictness to event conventions/interview guide and profile coverage logic (workers/src/kura_workers/event_conventions.py, interview_guide.py, handlers/user_profile.py). Extended AgentAutonomyPolicy + write verification to apply user overrides with safety-floor clamping and confirm-first gating precedence, including concise/default phrasing behavior (api/src/routes/agent.rs, api/src/routes/agent/write_verification.rs, api/src/routes/agent/policy.rs). Added override precedence and fallback tests in api/src/routes/agent.rs and worker consistency tests in workers/tests/*. Verified with full gates: ruff, workers unit/integration, cargo workspace tests, architecture tests.","created_at":"2026-02-14T06:49:15Z"}]}
{"id":"kura-training-mjtz","title":"Fix training_timeline frequency/streak anchoring to now() instead of last training day","description":"current_frequency and current_weeks are currently computed relative to max(training_dates) instead of the actual current local date. This inflates frequency/streak for inactive users and can mislead planning/readiness decisions. Repro: old training dates in early January still report non-zero last_4_weeks/current_weeks in February.","status":"closed","priority":1,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-19T23:01:58.703998+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T23:11:29.630774+01:00","closed_at":"2026-02-19T23:11:29.630774+01:00","close_reason":"Closed","comments":[{"id":45,"issue_id":"kura-training-mjtz","author":"jonzim-cmd","text":"Fix umgesetzt: current_frequency/current streak werden jetzt gegen den aktuellen lokalen Tag (timezone-aware) statt gegen max(training_dates) berechnet. last_training bleibt weiterhin der tatsächliche letzte Trainingstag. Zusätzlich _compute_frequency gehärtet: zählt nur Tage im Intervall [cutoff, reference_date], damit Future-Daten Current-Stats nicht aufblasen. Tests: test_training_timeline.py::test_stale_training_dates_drop_out_of_current_window, ::test_future_training_dates_are_not_counted, test_integration.py::test_current_frequency_and_streak_are_anchored_to_today.","created_at":"2026-02-19T22:11:27Z"}]}
{"id":"kura-training-mn23","title":"[jkoo.5] Observability: Approval-Timeout und Legacy-Upgrade-Signale messbar machen","description":"Warum:\nOhne gezielte Metriken bleiben Approval-Timeouts und Legacy-Upgrade-Signale reaktiv statt proaktiv. Das erschwert fruehe Erkennung von Regressionen.\n\nWie:\nGezielte Telemetrie fuer Plan-Write-Flow einfuehren: approval timeout counter, legacy upgrade signal counter, klassifizierte failure reasons inkl. node/execution context.","design":"Artefakte:\n- api/src/middleware/upgrade_signal.rs\n- mcp-runtime/src/lib.rs oder bestehende telemetry hooks\n- tests/log assertions fuer signal emission\n\nUmsetzung:\n1) Bestehende Signale um dimensions erweitern (event_type, route, reason_code).\n2) Approval-timeout explizit als messbares Ereignis.\n3) Dokumentierte Query/grep-Patterns fuer Incident-Check.","acceptance_criteria":"1) Approval-Timeout ist eindeutig in Logs/Metriken auffindbar.\n2) Legacy upgrade signal ist fuer training_plan.* auswertbar.\n3) Tests sichern, dass Signale bei Fehlerpfaden wirklich emittiert werden.","notes":"implemented:\n- Added explicit legacy plan-write rejection log in API (`legacy_plan_write_blocked`, violation code attached).\n- Added stable MCP error codes that flow into retrieval/abort observability counters (`approval_timeout`, `write_preflight_blocked`, `plan_write_requires_write_with_proof`).\n- Added architecture contract test that pins presence of plan-write/error-translation primitives.\n\nartifacts:\n- api/src/routes/events.rs\n- mcp-runtime/src/lib.rs\n- tests/architecture/test_150_plan_write_contract.py\n\nverify:\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test -p kura-api routes::events::tests::test_legacy_domain_invariants_block_plan_writes_on_legacy_path -- --exact\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test -p kura-mcp-runtime\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest tests/architecture/test_150_plan_write_contract.py -q\n\nresidual risk:\n- Cross-node orchestration telemetry (Mac/VPS routing decision traces) remains outside this repository's runtime.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:39:48.117017+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T18:56:34.283391+01:00","closed_at":"2026-02-20T18:56:34.283391+01:00","close_reason":"Implemented and verified","dependencies":[{"issue_id":"kura-training-mn23","depends_on_id":"kura-training-jkoo","type":"blocks","created_at":"2026-02-20T18:40:00.201933+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-mn23","depends_on_id":"kura-training-89gs","type":"blocks","created_at":"2026-02-20T18:40:08.053907+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-mn23","depends_on_id":"kura-training-60ek","type":"blocks","created_at":"2026-02-20T18:40:08.17283+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-mo6d","title":"[task] Hardening: exercise-\u003emodality coverage to avoid endurance fallback bias","description":"Why: distance-based rows without recognized block_type can silently collapse to endurance and underreport sprint/plyometric load, creating UX-visible readiness bias.\\nHow: introduce/maintain explicit exercise-to-modality coverage rules (or registry bridge), add diagnostics for unknown distance-based exercise_ids, and enforce regression tests for representative sprint/plyometric IDs.\\nWhat: ensure modality assignment is deterministic, observable, and resilient across manual, session.logged, and external import paths.","acceptance_criteria":"1) Representative sprint + plyometric exercise_ids map to correct modality across load_v2 aggregation paths.\\n2) Unknown distance-based exercise_ids emit diagnostics/telemetry instead of silent endurance fallback.\\n3) Coverage test guards prevent regressions for common non-strength modalities.\\n4) Timeline load_v2 modality buckets reflect corrected classification in replay tests.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T21:27:56.061338+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T21:50:35.321934+01:00","closed_at":"2026-02-19T21:50:35.321934+01:00","close_reason":"Closed","labels":["hardening","modality","training-load"]}
{"id":"kura-training-muh","title":"[integration] write-with-proof auf Kernel umstellen (adapterized route)","description":"Warum:\n- Erst die Integration erzeugt den realen Drift-Schutz in der produktiven Route.\n\nWie:\n- /v1/agent/write-with-proof nutzt den Kernel als einzige Entscheidungsquelle fuer Policy-Objekte.\n- Vorhandene reason_codes, policy_role und advisory-not-cage Verhalten muessen erhalten bleiben.\n- Route behält nur Orchestrierung, Mapping und Event-Emission.\n\nCompaction-Recovery:\n- Fokusdatei: api/src/routes/agent.rs; Integrationspunkte bei build_response_mode_policy/build_personal_failure_profile/build_sidecar_assessment/build_counterfactual_recommendation.\n- Bei Unklarheit: zuerst bestehende Contract-Tests laufen lassen, dann Schritt fuer Schritt umstellen.\n\nAkzeptanz:\n- Bestehende agent runtime tests bleiben gruen.\n- Keine Regression in schema_version/policy_role/reason_codes-Struktur.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T17:14:41.845835+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T17:31:06.890624+01:00","closed_at":"2026-02-15T17:31:06.890624+01:00","close_reason":"write-with-proof Runtime nutzt jetzt den extrahierten policy_kernel via Delegation in api/src/routes/agent.rs; Schema- und Reason-Code-Verhalten blieb kompatibel (bestehende Contract-Tests grün).","dependencies":[{"issue_id":"kura-training-muh","depends_on_id":"kura-training-x6o","type":"blocks","created_at":"2026-02-15T17:15:19.183537+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-mxb3","title":"Add benchmark data + calibration for e1RM against high-intent sets and observed max attempts","description":"WHY:\nEstimator improvements need an external anchor set, otherwise replay evaluates consistency of proxies, not closeness to real performance.\n\nHOW:\nBuild benchmark corpus + calibration protocol:\n- link set context (load/reps/RIR/RPE/tempo/set_type/protocol) to stronger anchors (heavy singles/tests)\n- stratify by capability and rep/protocol regimes\n- track calibration metrics used as rollout gates.\n\nIMPLEMENTATION TASKS:\n1) Define benchmark row schema and extraction pipeline.\n2) Build training/eval splits with temporal leakage controls.\n3) Add metric suite (coverage, MAE, directional consistency, interval quality).\n4) Integrate benchmark checks into eval_harness artifacts.\n\nACCEPTANCE:\n- Benchmark artifact can be rebuilt deterministically.\n- Estimator changes can be accepted/rejected by objective metrics.\n- Gate outputs are machine-readable for rollout automation.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:26:24.077966+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:34.630292+01:00","closed_at":"2026-02-20T19:28:34.630292+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo).","dependencies":[{"issue_id":"kura-training-mxb3","depends_on_id":"kura-training-o6wi","type":"blocks","created_at":"2026-02-20T18:39:11.516332+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-my18","title":"Audit remaining handler event-id lookups for user_id scoping","description":"Post-fix scan still shows SQL patterns like WHERE id = %s in several handlers (custom_projection, router retraction fallback, deep_analysis, external_import, account_lifecycle). Review each call site for trust-boundary assumptions and add user_id scoping or documented fail-closed invariants plus regression tests where appropriate.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T23:17:08.61646+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T23:24:37.727489+01:00","closed_at":"2026-02-19T23:24:37.727489+01:00","close_reason":"Closed","comments":[{"id":51,"issue_id":"kura-training-my18","author":"jonzim-cmd","text":"Audit abgeschlossen und Hardening umgesetzt:\\n\\n1) custom_projection event lookups user-scoped gemacht (projection_rule.created + projection_rule.archived): SELECT ... FROM events WHERE id = ? AND user_id = ?\\n2) router retraction resolution user-scoped gemacht (retraction event lookup + fallback original-event type lookup)\\n3) deep_analysis status updates user-scoped gemacht (_mark_processing/_mark_failed/_mark_completed jeweils WHERE id AND user_id)\\n4) external_import status updates user-scoped gemacht (_mark_processing + _update_import_job_status jeweils WHERE id AND user_id)\\n5) Regression-Tests ergänzt: test_custom_projection.py und test_router.py prüfen explizit user_id-scoped query params\\n\\nVerifikation:\\n- ruff check workers/src/ workers/tests/\\n- pytest workers/tests/ -q --ignore=test_integration.py\\n- pytest workers/tests/test_integration.py -q\\n- cargo test --workspace\\nalles grün.","created_at":"2026-02-19T22:24:35Z"}]}
{"id":"kura-training-n01t","title":"Harden exercise_progression trigger event lookup with user_id scoping","description":"update_exercise_progression resolved trigger event by id without user_id scope. Under malformed payloads this can pull foreign-user event data. Scope lookup by (id,user_id) and cover with integration test.","status":"closed","priority":2,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-19T23:15:56.385806+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T23:17:04.56791+01:00","closed_at":"2026-02-19T23:17:04.56791+01:00","close_reason":"Closed","comments":[{"id":50,"issue_id":"kura-training-n01t","author":"jonzim-cmd","text":"Fix umgesetzt: update_exercise_progression lädt Trigger-Event jetzt per (id,user_id) statt nur id. Dadurch keine Cross-User-Triggerauflösung bei fehlerhaften Payloads. Integrationstest ergänzt: test_integration.py::TestExerciseProgressionIntegration::test_event_lookup_is_user_scoped.","created_at":"2026-02-19T22:17:04Z"}]}
{"id":"kura-training-nco","title":"[feature] Auto-generierter operational_model im agent_brief","description":"## Kontext / Warum\n\nFreds Agent konnte ein Test-Event nicht retracten, obwohl das System event.retracted vollständig unterstützt. Root Cause: falsches mentales Modell (REST-CRUD statt Event Sourcing). Der Agent suchte nach POST /v1/events/{id}/retract — gibt es nicht und soll es nicht geben. Die korrekte Methode (POST /v1/events mit event_type: event.retracted) steht in system_config.event_conventions, aber bei 287KB Context findet kein Agent das im Moment der Verwirrung.\n\nDas gleiche Problem trifft potenziell auf alle Paradigmen-Fragen zu:\n- \"Wie update ich ein Event?\" → Gar nicht. Retract + neu loggen.\n- \"Welche event_types gibt es?\" → Alle. Free-form String.\n- \"Wie query ich State?\" → Projections, nicht Events direkt.\n\n## Was gelten soll\n\nDer agent_brief (kompakt, wird als Erstes gelesen) enthält einen operational_model Block, der das Event-Sourcing-Paradigma in 3-5 Zeilen erklärt. Dieser Block wird NICHT manuell gepflegt, sondern von build_system_config() aus bestehenden Deklarationen abgeleitet:\n\n- category-Feld pro event_convention (correction, tracking, planning, meta, system)\n- operational_model wird aus den Kategorien + vorhandenen usage-Texten BERECHNET\n- Kein brief_hint als separates Feld — usage ist die Quelle, category die Klassifikation\n\nPrinzip: Der Brief ist eine Projektion des System-Configs, wie Projections Projektionen der Events sind.\n\n## Architektur-Entscheidung (AGENTS.md Workflow)\n\nTests in tests/architecture/ erzwingen die Invarianten dauerhaft:\n- Jede event_convention MUSS ein category-Feld haben\n- build_system_config() Output MUSS operational_model enthalten\n- agent_brief MUSS operational_model aus system_config lesen (nicht hardcoded)\n- operational_model enthält mindestens: mutations, corrections, state_access, event_types\n\n## Abhängigkeiten\n\nDieses Feature ist der Epic. Unteraufgaben werden als separate Tasks mit Dependencies angelegt.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-18T22:50:20.180045+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T07:50:45.421397+01:00","closed_at":"2026-02-19T07:50:45.421397+01:00","close_reason":"operational_model im agent_brief + 404-paradigm-hint — alle Subtasks erledigt"}
{"id":"kura-training-nv2","title":"Preference \u0026 Alias event types + user_profile projection","description":"Per-user alias system (exercise.alias_created, preference.set, goal.set events) and user_profile projection that answers 'what does Kura know about this user?' Foundation for agent context across sessions.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:02.247548+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T13:49:49.315141+01:00","closed_at":"2026-02-08T13:49:49.315141+01:00","close_reason":"Implemented and integration-tested"}
{"id":"kura-training-nwn","title":"CLI Skeleton: kura health, kura event create, kura event list","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:07.108039+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T07:35:58.288559+01:00","closed_at":"2026-02-08T07:35:58.288559+01:00","close_reason":"CLI with kura health, kura event create, kura event list. JSON-only, structured errors, auto-idempotency keys."}
{"id":"kura-training-ny2y","title":"Harden first-contact onboarding: response gate + startup tool-surface mismatch","description":"Observed in transcripts: onboarding signal exists but assistant still drifts into generic/hallucinated startup responses; in some sessions required_first_tool=kura_agent_brief while tool is reported missing. Need deterministic first-turn contract enforcement, startup contract mismatch detection, and brief payload hygiene (remove noisy challenge-mode hint / include first-contact opening payload).","status":"closed","priority":1,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-21T06:41:59.583921+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T06:57:43.279752+01:00","closed_at":"2026-02-21T06:57:43.279752+01:00","close_reason":"Implemented first-contact response guard, startup context fallback, and challenge-mode hint scope hardening with tests."}
{"id":"kura-training-o6wi","title":"Phase 1 foundation: shared observation/state/output protocol across capabilities","description":"WHY:\nAll capabilities need the same statistical skeleton, otherwise quality diverges by metric and downstream agent behavior becomes inconsistent.\n\nHOW:\nImplement shared foundation primitives used by strength/sprint/jump/endurance estimators:\n- observation normalization contract (value + variance + protocol_signature + comparability_group)\n- latent state snapshot contract (mean + interval + velocity + diagnostics)\n- insufficiency protocol (status + required/observed + reason codes + next observations)\n- versioned output envelope for agent-only consumption.\n\nIMPLEMENTATION TASKS:\n1) Add shared dataclasses/schemas for capability estimation outputs.\n2) Add helper utilities for protocol comparability and sufficiency checks.\n3) Wire foundation schema into projections without changing domain logic yet.\n4) Add architecture + unit tests for envelope invariants.\n\nACCEPTANCE:\n- All capability projections can emit a uniform envelope, even if domain model is still baseline.\n- Missing data always returns machine-readable insufficiency payload, never silent fallback.\n- Tests enforce the shared contract as executable spec.","notes":"2026-02-20 progress: Added executable spec contract in workers/src/kura_workers/capability_estimation_v1.py, wired into system_config conventions, and added architecture test_149 enforcing shared 3-layer pipeline, capability registry, insufficiency protocol, and deterministic phase order. Remaining in this issue: implement shared runtime schemas/helpers used by projections (not only contract declaration).","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:37:38.877902+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:34.421315+01:00","closed_at":"2026-02-20T19:28:34.421315+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo)."}
{"id":"kura-training-objl","title":"zjm3 Cleanup: Methodik-Refactor und Wartbarkeit","description":"Kontext: zjm3 ist funktional umgesetzt, aber zentrale Logik ist mehrfach verteilt (Signal-Normalisierung, Eventlisten, Mapping-Matrizen, Testfragilität). Warum: Doppelte Pfade erhöhen Drift-Risiko und erschweren sichere Weiterentwicklung. Wie: Spec-first Cleanup-Programm mit harten Dependencies; gemeinsame Utilities/Registry extrahieren; harte Codierung in deklarative Profile überführen; fragile Source-String-Contracts wo möglich durch verhaltensbasierte Tests ersetzen.","acceptance_criteria":"Cleanup-Subtasks abgeschlossen; keine Funktionsregression; Quality-Gates und Architecture-Suite bleiben grün.","status":"closed","priority":2,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-19T16:23:51.626917+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:45:01.877866+01:00","closed_at":"2026-02-19T16:45:01.877866+01:00","close_reason":"Closed"}
{"id":"kura-training-objl.1","title":"Cleanup Spec: Single-Source Signal-Normalisierung + Event-Parität","description":"Kontext: readiness/causal/eval/strength normalisieren Trainingssignale teilweise redundant. Warum: Bei Änderungen droht stiller Drift in Berechnung und UX. Wie: Architecture-Specs ergänzen, die 1) gemeinsame Normalisierungs-Utility erzwingen, 2) zentrale Event-Registry für Readiness/Causal/Eval/Nightly erzwingen, 3) identische Kernpfade für set.logged/session.logged/set.corrected/external.activity_imported sicherstellen.","acceptance_criteria":"Spec-Tests failen gegen verteilte/inkonsistente Pfade und werden durch zentrale Nutzung erfüllt.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T16:23:51.76777+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:45:01.072901+01:00","closed_at":"2026-02-19T16:45:01.072901+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-objl.1","depends_on_id":"kura-training-objl","type":"parent-child","created_at":"2026-02-19T16:23:51.769587+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-objl.2","title":"Cleanup Impl: Shared training signal normalization utility","description":"Kontext: Korrektur-Overlay + Session-Expansion + Legacy-Dedupe ist mehrfach implementiert. Warum: Hohe Wartungslast und Inkonsistenz-Risiko. Wie: gemeinsames Modul unter workers/src/kura_workers/ (z. B. training_signal_normalization.py) einführen und von readiness_signals.py, handlers/causal_inference.py, handlers/strength_inference.py, eval_harness.py konsumieren.","acceptance_criteria":"Keine lokale Duplikatlogik mehr in den genannten Modulen; Tests und Typ-/Lint-Gates bleiben grün.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-19T16:23:51.917576+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:45:01.208494+01:00","closed_at":"2026-02-19T16:45:01.208494+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-objl.2","depends_on_id":"kura-training-objl","type":"parent-child","created_at":"2026-02-19T16:23:51.919275+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-objl.2","depends_on_id":"kura-training-objl.1","type":"blocks","created_at":"2026-02-19T16:23:58.844049+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-objl.3","title":"Cleanup Impl: Zentrale Event-Typ-Registry für Inference-Pfade","description":"Kontext: Eventlisten sind in mehreren Handlern/Eval/Nightly manuell gepflegt. Warum: Uneinheitliche Trigger und Replay-Sets können unbemerkt auseinanderlaufen. Wie: zentrale Konstanten/Helper einführen (readiness/causal/eval/nightly) und alle Selektoren/Queries auf diese Registry umstellen.","acceptance_criteria":"Readiness/Causal/Eval/Nightly verwenden dieselben zentralen Eventdefinitionen; Architektur- und Unit-Tests grün.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T16:23:52.060339+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:45:01.341094+01:00","closed_at":"2026-02-19T16:45:01.341094+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-objl.3","depends_on_id":"kura-training-objl","type":"parent-child","created_at":"2026-02-19T16:23:52.061809+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-objl.3","depends_on_id":"kura-training-objl.1","type":"blocks","created_at":"2026-02-19T16:23:59.000149+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-objl.3","depends_on_id":"kura-training-objl.2","type":"blocks","created_at":"2026-02-19T16:23:59.599203+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-objl.4","title":"Cleanup Impl: Intensitätsparameter in Calibration-Profil deklarativ machen","description":"Kontext: Schwellen/Faktoren für power/hr/pace/rpe sind teils im Code verdrahtet. Warum: Rollout/Calibration sollte versionsgesteuert statt codegesteuert sein. Wie: Profile im calibration registry erweitern (inkl. defaults/fallbacks) und Berechnung nur noch aus Profilwerten ableiten.","acceptance_criteria":"Intensitäts-Hyperparameter sind profilisiert/versioniert; bestehende Funktionalität und Tests bleiben stabil.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T16:23:52.2044+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:45:01.477363+01:00","closed_at":"2026-02-19T16:45:01.477363+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-objl.4","depends_on_id":"kura-training-objl","type":"parent-child","created_at":"2026-02-19T16:23:52.207443+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-objl.4","depends_on_id":"kura-training-objl.1","type":"blocks","created_at":"2026-02-19T16:23:59.151597+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-objl.4","depends_on_id":"kura-training-objl.2","type":"blocks","created_at":"2026-02-19T16:23:59.753598+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-objl.5","title":"Cleanup Impl: External import mapping modularisieren","description":"Kontext: external_import_mapping_v2.py enthält große deklarative Matrizen + Mapper in einer Datei. Warum: Dateigröße und Kopplung erschweren Änderungen und Reviews. Wie: Profile/Matrizen in separates Modul auslagern und Mapping-Code schlank halten; Verhalten unverändert lassen.","acceptance_criteria":"Mapping-Verhalten bleibt kompatibel; Datei-Komplexität sinkt; Tests grün.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T16:23:52.359721+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:45:01.608538+01:00","closed_at":"2026-02-19T16:45:01.608538+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-objl.5","depends_on_id":"kura-training-objl","type":"parent-child","created_at":"2026-02-19T16:23:52.361412+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-objl.5","depends_on_id":"kura-training-objl.1","type":"blocks","created_at":"2026-02-19T16:23:59.298479+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-objl.6","title":"Cleanup Impl: Fragile Architektur-Stringtests auf Verhaltenscontracts heben","description":"Kontext: Einige Architecture-Tests prüfen auf konkrete Source-Strings. Warum: Refactors brechen unnötig, obwohl Verhalten korrekt bleibt. Wie: relevante String-Assertions schrittweise auf API/Verhaltens-Invarianten umstellen, ohne Schutzwirkung zu verlieren.","acceptance_criteria":"Ausgewählte fragile Tests sind behavior-first; Refactor-Freiheit steigt, Schutzgrad bleibt erhalten.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T16:23:52.503936+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:45:01.744766+01:00","closed_at":"2026-02-19T16:45:01.744766+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-objl.6","depends_on_id":"kura-training-objl","type":"parent-child","created_at":"2026-02-19T16:23:52.506068+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-objl.6","depends_on_id":"kura-training-objl.1","type":"blocks","created_at":"2026-02-19T16:23:59.456958+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-objl.6","depends_on_id":"kura-training-objl.2","type":"blocks","created_at":"2026-02-19T16:23:59.912156+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-objl.6","depends_on_id":"kura-training-objl.3","type":"blocks","created_at":"2026-02-19T16:24:00.066078+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-odw","title":"Account-Löschung (DSGVO Art. 17)","description":"DSGVO Art. 17 + Art. 9 (Gesundheitsdaten): User muss eigene Daten komplett löschen können. Admin ebenfalls. Sonst niemand. Hard DELETE auf events, projections, background_jobs, api_keys, users. Privilegierte DB-Rolle nötig (app_user hat kein DELETE auf events). Endpoints: DELETE /v1/account (self), DELETE /v1/admin/users/{id} (admin).","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T18:06:46.336955+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T18:15:17.951414+01:00","closed_at":"2026-02-09T18:15:17.951414+01:00","close_reason":"Implemented: DELETE /v1/account (self) + DELETE /v1/admin/users/{id} (admin). SECURITY DEFINER function for hard delete."}
{"id":"kura-training-ohr","title":"[ctv.4] End-to-end tests for attestation and auto-tiering","description":"Add API and worker tests for valid/invalid/stale/replayed attestations and automatic tier transitions/fallback behavior.","acceptance_criteria":"1) Rust tests cover attestation verification edge cases. 2) Python worker tests cover auto-tiering thresholds and hysteresis. 3) Full quality gates pass.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T21:20:06.046382+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:41:40.190559+01:00","closed_at":"2026-02-13T21:41:40.190559+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-ohr","depends_on_id":"kura-training-d8o","type":"blocks","created_at":"2026-02-13T21:21:10.88362+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ohr","depends_on_id":"kura-training-gh0","type":"blocks","created_at":"2026-02-13T21:21:18.531031+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-oybz","title":"Scalable Agent Context: budgeted slices + paged retrieval","description":"Warum: Bei großen Nutzerhistorien dürfen Promptgröße und API-Payload nicht unkontrolliert wachsen. Sonst steigen Latenz/Kosten und der Agent läuft in Reload-Schleifen oder reagiert mit generischer Improvisation.\\n\\nWie: Trenne statisches Systemwissen von dynamischem Nutzerkontext, führe budgetierte Context-Slices ein und ergänze paginierte Projection-Retrieval-Verträge. MCP muss deterministische Reload-Pfade mit Cursor/Budget kennen.","design":"Scope-Entscheidung: (1) paginierte Projection-Reads als deterministischer Nachladepfad, (2) /v1/agent/context um budget_tokens + overflow-Metadaten erweitern, (3) MCP-Tooling auf Budget/Pagination anheben, (4) Architektur-Spec-Tests für dauerhafte CI-Absicherung.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-19T10:33:47.110515+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:46:54.616174+01:00","closed_at":"2026-02-19T10:46:54.616174+01:00","close_reason":"Delivered budgeted agent context, paged projection retrieval, MCP-safe reload path, and executable architecture specs to keep behavior stable after compacting/context loss."}
{"id":"kura-training-oybz.1","title":"API: Projection pagination contract for deterministic reload","description":"Warum: Unpaged /v1/projections/{type} kann bei vielen Keys sehr groß werden und ist als Reload-Pfad für Context-Overflow ungeeignet.\\n\\nWie: Ergänze einen paginierten Read-Contract mit limit+cursor+next_cursor+has_more für projection_type-Listen. Cursor muss stabil/opaque sein (keyset), damit der Agent robust weiterladen kann.","design":"Implementierung in api/src/routes/projections.rs mit klarer Query- und Response-Struct. Bestehende Endpunkte bleiben kompatibel; neuer paged Read wird explizit für Agent-Retrieval genutzt.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T10:34:03.61492+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:46:37.262603+01:00","closed_at":"2026-02-19T10:46:37.262603+01:00","close_reason":"Implemented /v1/projections/{projection_type}/paged with keyset cursor, bounded limit, OpenAPI schema, and cursor contract tests.","dependencies":[{"issue_id":"kura-training-oybz.1","depends_on_id":"kura-training-oybz","type":"parent-child","created_at":"2026-02-19T10:34:03.615543+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-oybz.2","title":"API: Agent context token budget + overflow metadata","description":"Warum: Große History darf nicht automatisch zu großen Prompts führen. Ohne Budget-Mechanik bleibt Context-Größe unvorhersagbar und bricht Agent-Fokus.\\n\\nWie: /v1/agent/context um budget_tokens erweitern, included_tokens_estimate zurückgeben und optionale Sections deterministisch weglassen, wenn Budget überschritten wird. Overflow-Metadaten müssen omitted_sections + reload_hints liefern.","design":"Erweitere AgentContextParams und AgentContextMeta, füge serverseitige Budget-Enforcement-Logik mit klarer Priorisierung kritischer vs optionaler Sections hinzu. Keine stillen Trunkierungen ohne maschinenlesbare Hinweise.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T10:34:03.635306+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:46:42.124387+01:00","closed_at":"2026-02-19T10:46:42.124387+01:00","close_reason":"Implemented budget_tokens in /v1/agent/context plus included_tokens_estimate and overflow metadata with deterministic optional-section pruning and reload hints.","dependencies":[{"issue_id":"kura-training-oybz.2","depends_on_id":"kura-training-oybz","type":"parent-child","created_at":"2026-02-19T10:34:03.635938+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-oybz.2","depends_on_id":"kura-training-oybz.1","type":"blocks","created_at":"2026-02-19T10:34:15.175052+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-oybz.3","title":"MCP: Context-safe retrieval flow (budget + pagination aware)","description":"Warum: Der Agent braucht tool-seitig eindeutige, nicht-fragile Nachladepfade. Sonst entstehen Sackgassen nach Overflow oder bei großen Projection-Sets.\\n\\nWie: MCP-Toolschemas und Handler erweitern: kura_agent_context unterstützt budget_tokens; kura_projection_list unterstützt limit/cursor. Overflow-reload-hints müssen auf paginierte Nachladung verweisen.","design":"Änderungen in mcp-runtime/src/lib.rs: ToolDefinition, tool_agent_context/tool_projection_list Query-Mapping, payload reload hints und Tests. Ziel: deterministischer 'summary first, evidence on demand' Pfad.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T10:34:03.657477+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:46:48.15274+01:00","closed_at":"2026-02-19T10:46:48.15274+01:00","close_reason":"Extended MCP tool schemas/handlers for budget-aware context fetch and paged projection retrieval with cursor+limit and overflow-safe reload guidance.","dependencies":[{"issue_id":"kura-training-oybz.3","depends_on_id":"kura-training-oybz","type":"parent-child","created_at":"2026-02-19T10:34:03.65813+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-oybz.3","depends_on_id":"kura-training-oybz.2","type":"blocks","created_at":"2026-02-19T10:34:15.227582+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-oybz.3","depends_on_id":"kura-training-oybz.1","type":"blocks","created_at":"2026-02-19T10:34:31.947175+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-oybz.4","title":"Architecture specs + refactor cleanup for context scalability","description":"Warum: Neue Retrieval-/Budget-Verträge dürfen nicht regressieren und müssen Compacting überleben. Zusätzlich sollte bestehender Code für Kontextaufbereitung leichter wartbar werden.\\n\\nWie: Neue tests/architecture Spec für Budget/Pagination-Verträge, ergänzende Unit-Tests in Rust/MCP, kleine Refactors zur Entkopplung von Fetch/Prune/Overflow-Logik.","design":"Fokus auf Executable Specs statt Dokumentenpflege. Refactor nur dort, wo er die neue Skalierungslogik klarer und testbarer macht (z.B. Hilfsfunktionen für token estimate, overflow section metadata, cursor encode/decode).","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T10:34:03.731817+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T10:46:51.035133+01:00","closed_at":"2026-02-19T10:46:51.035133+01:00","close_reason":"Added executable architecture spec test for budget/pagination contracts and runtime test anchors; kept context-scaling logic in testable helper boundaries.","dependencies":[{"issue_id":"kura-training-oybz.4","depends_on_id":"kura-training-oybz","type":"parent-child","created_at":"2026-02-19T10:34:03.732607+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-oybz.4","depends_on_id":"kura-training-oybz.3","type":"blocks","created_at":"2026-02-19T10:34:15.190353+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-oybz.4","depends_on_id":"kura-training-oybz.2","type":"blocks","created_at":"2026-02-19T10:34:35.312655+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc","title":"Decision 13 Domain Gap Closure: Onboarding and coaching reliability","description":"Close domain-specific reliability gaps observed in field tests after core self-healing platform steps. Problem: platform guardrails reduce chaos, but domain-level holes still degrade UX and recommendation quality. Goal: implement concrete domain controls for onboarding completeness, phase discipline, temporal correctness, intensity semantics, and save guarantees.","design":"Reference: docs/design/013-self-healing-agentic-data-plane.md. This epic captures user-facing domain gaps discovered during live testing and expected to recur across users in different forms. Each child issue must include: root cause, failure mode, mitigation, and measurable acceptance tests.","acceptance_criteria":"1) Child issues created for onboarding baseline profile, onboarding phase transitions, timezone-first flow, RIR first-class modeling, and save-handshake enforcement. 2) Each child includes explicit problem statement and testable outcomes. 3) Work sequencing defined so dependencies are clear.","notes":"Closed remaining domain reliability gaps via pdc.22-pdc.25: global legacy-path invariant enforcement, intensity ingress contract, observation lifecycle governance, and locale-aware ingestion baseline. Quality gates executed: ruff check workers/src/ workers/tests/, full workers pytest (unit + integration), cargo test --workspace.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:02:00.911494+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:33:17.6871+01:00","closed_at":"2026-02-13T09:33:17.6871+01:00","close_reason":"All child issues implemented and validated"}
{"id":"kura-training-pdc.1","title":"Onboarding V2: Baseline Profile Completeness (explicit known/unknown/deferred)","description":"Close missing baseline profile fields during onboarding. Problem: age/body baseline is often mentioned but not captured structurally, causing downstream recommendation errors and silent omissions in summary. Implement explicit baseline slots with tri-state semantics: known, unknown, deferred.","design":"Reference Decision 13 INV-006. Add onboarding coverage area and persistence conventions for age/date_of_birth, bodyweight baseline, and optional sex/body-composition context where relevant. Ensure summaries include deferred markers instead of dropping fields.","acceptance_criteria":"1) Onboarding coverage tracks baseline profile completeness explicitly. 2) Fields can be stored as value or deferred marker. 3) User summary reflects known + deferred baseline items. 4) Data model/docs updated with conventions. 5) Tests cover mention-captured, mention-deferred, and omitted-but-flagged scenarios.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:03:31.76997+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T21:27:04.332247+01:00","closed_at":"2026-02-11T21:27:04.332247+01:00","close_reason":"Implemented INV-006 baseline tri-state in onboarding coverage/user_profile, updated conventions/docs, and added mention-captured/deferred/missing tests.","dependencies":[{"issue_id":"kura-training-pdc.1","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T17:03:31.771018+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.10","title":"Field Correction Primitive: patch-style correction event","description":"Current repair workflow relies on retract-and-relog for small field fixes, which is noisy and increases event volume. Introduce a minimal correction primitive to update specific fields while preserving immutable history and full audit trail.","design":"Add a correction event convention (for example set.corrected) referencing target_event_id and changed_fields only. Keep original event immutable, apply correction overlay in projections, and support idempotency key to avoid duplicate corrections. Retraction remains available for semantic invalidation; field-level correction is default for additive/fixup edits.","acceptance_criteria":"1) New correction event convention documented with target_event_id, changed_fields, reason, provenance, and idempotency_key.\n2) Projection logic resolves effective values using latest valid correction chain.\n3) Retract-and-relog is no longer required for pure field additions like rest_seconds.\n4) Duplicate correction submissions are idempotent.\n5) Tests cover additive correction, overwrite correction, and chain resolution.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:45:05.157004+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:27:49.137167+01:00","closed_at":"2026-02-11T19:27:49.137167+01:00","close_reason":"Implemented set.corrected convention, correction-chain overlays in projections, and additive/overwrite/chain tests with idempotency-key convention checks.","dependencies":[{"issue_id":"kura-training-pdc.10","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T18:45:05.157874+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.10","depends_on_id":"kura-training-pdc.9","type":"blocks","created_at":"2026-02-11T18:45:05.158979+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.11","title":"Automatic Session Audit Gate: mention-field mismatch detection","description":"Mentioned values are still sometimes omitted unless manually prompted. Add an automatic post-session audit gate that detects mention-present/field-missing mismatches and proposes or applies safe repairs based on confidence policy.","design":"Run a deterministic audit after session logging and before final save confirmation. Compare extracted mentions against persisted structured fields per exercise/set scope. If confidence is high and policy allows, apply auto-correction; otherwise ask one focused clarification question. Emit telemetry for detected mismatch, repair action, and unresolved mismatches.","acceptance_criteria":"1) Session-end audit runs automatically and checks mention-field consistency for core mention-bound fields.\n2) High-confidence mismatches are auto-repaired according to policy; uncertain cases ask one concise user question.\n3) Audit result is included in save receipt (clean|repaired|needs_clarification).\n4) Telemetry events emitted for mismatch_detected, mismatch_repaired, mismatch_unresolved.\n5) Tests cover clean session, auto-repair session, and clarification-required session.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:45:05.277728+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:37:19.711986+01:00","closed_at":"2026-02-11T19:37:19.711986+01:00","close_reason":"Implemented automatic session mention-field audit with policy-gated auto-repair via set.corrected, clarification fallback, save receipt audit status, and mismatch telemetry/events with tests.","dependencies":[{"issue_id":"kura-training-pdc.11","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T18:45:05.278549+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.11","depends_on_id":"kura-training-pdc.7","type":"blocks","created_at":"2026-02-11T18:45:05.279318+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.11","depends_on_id":"kura-training-2zc.1","type":"blocks","created_at":"2026-02-11T18:45:05.279888+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.11","depends_on_id":"kura-training-pdc.9","type":"blocks","created_at":"2026-02-11T18:45:05.280419+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.12","title":"Repair UX V1: progressive disclosure receipts and undo","description":"Technical repair output with raw commands and IDs can overwhelm normal users. Add a user-facing repair UX contract with plain-language summaries by default and technical details only on demand.","design":"Default response format: what changed, what stayed the same, why. Provide expandable technical details (event IDs, diffs, command trace) only when requested. Include explicit undo action for last repair batch and keep machine-readable receipt for support/debugging. Align with save-handshake state model.","acceptance_criteria":"1) Default repair feedback is plain-language and concise.\n2) Technical detail block is optional and not shown by default.\n3) Every repair returns a receipt with changed_fields_count, unchanged_metrics, and status.\n4) Undo for last repair batch is available and tested.\n5) UX integration tests verify both normal-user and power-user views.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:45:05.399898+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:41:01.269736+01:00","closed_at":"2026-02-11T19:41:01.269736+01:00","close_reason":"Added plain-language repair feedback by default, optional technical details on request, receipt contract (status/changed_fields_count/unchanged_metrics), and undo event templates with coverage tests for normal and power-user views.","dependencies":[{"issue_id":"kura-training-pdc.12","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T18:45:05.401295+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.12","depends_on_id":"kura-training-pdc.5","type":"blocks","created_at":"2026-02-11T18:45:05.402327+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.12","depends_on_id":"kura-training-pdc.11","type":"blocks","created_at":"2026-02-11T18:45:05.403183+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.13","title":"Agent Capability Manifest API: protocol negotiation without prompt edits","description":"BYOA clients should discover contract changes automatically instead of requiring manual system-prompt updates. Add a machine-readable capability manifest endpoint so agents, CLI, and MCP can self-calibrate to preferred Kura contracts.","design":"Add `GET /v1/agent/capabilities` returning protocol_version, preferred_read_endpoint, preferred_write_endpoint, required_verification_contract, supported_fallbacks, min_cli_version, min_mcp_version, and upgrade_policy metadata. Include stable schema versioning and explicit backward-compat flags so clients can negotiate behavior safely.","acceptance_criteria":"1) New endpoint `/v1/agent/capabilities` documented in OpenAPI and returns stable versioned schema.\n2) Response includes preferred endpoints (`/v1/agent/context`, `/v1/agent/write-with-proof`) plus fallback/compat metadata.\n3) Contract includes minimum client version hints for CLI/MCP.\n4) Backward compatibility policy is explicit (supported, deprecated, removed timelines/flags).\n5) Tests cover schema stability and negotiation fields.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T19:22:16.598524+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T20:14:25.183258+01:00","closed_at":"2026-02-11T20:14:25.183258+01:00","close_reason":"Added /v1/agent/capabilities endpoint with versioned schema, fallback metadata, upgrade policy, and API tests.","dependencies":[{"issue_id":"kura-training-pdc.13","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T19:22:16.599355+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.14","title":"Legacy Contract Upgrade Signals: machine-readable deprecation guidance","description":"When agents continue calling legacy endpoints, Kura should provide actionable upgrade signals automatically. This avoids hidden drift and removes reliance on manual prompt tuning.","design":"Add machine-readable upgrade notices for legacy access paths (e.g., direct events/projections flows when higher-level agent contract is available). Provide warning payload/headers with recommended endpoint migration, reason, and urgency level. Emit telemetry for legacy usage to monitor rollout quality.","acceptance_criteria":"1) Legacy contract usage produces machine-readable upgrade signal with recommended replacement endpoint/flow.\n2) Signals include reason, policy phase (supported|deprecated), and action hint.\n3) Telemetry event emitted for legacy usage and client metadata when available.\n4) Rate-limited to avoid response spam while remaining visible.\n5) Tests cover signal emission, suppression policy, and payload format.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T19:22:16.724451+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T20:14:25.25997+01:00","closed_at":"2026-02-11T20:14:25.25997+01:00","close_reason":"Added machine-readable legacy upgrade headers with rate-limited emission and telemetry logging for events/projections paths, plus middleware tests.","dependencies":[{"issue_id":"kura-training-pdc.14","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T19:22:16.725587+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.14","depends_on_id":"kura-training-pdc.13","type":"blocks","created_at":"2026-02-11T19:22:16.726649+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.15","title":"CLI Protocol Parity: write-with-proof command + compatibility doctor","description":"CLI must expose the same high-level agent contract as the API so users do not need custom prompt surgery. Add first-class write-with-proof command(s) and protocol compatibility checks.","design":"Introduce dedicated CLI command for `/v1/agent/write-with-proof` (with receipts + read-after-write targets) and ensure `kura context` maps to `/v1/agent/context`. Extend `kura doctor` to check `/v1/agent/capabilities`, detect version/contract mismatches, and output actionable remediation.","acceptance_criteria":"1) CLI has dedicated command path for write-with-proof (not only generic `kura api`).\n2) Command supports input events, read-after-write targets, timeout, and structured output parsing.\n3) `kura doctor` checks server capability manifest and warns on incompatible/legacy client usage.\n4) Help/docs updated with contract-first examples.\n5) Tests cover request serialization, doctor mismatch detection, and backward-compatible fallback behavior.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T19:22:16.846812+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T20:14:25.356676+01:00","closed_at":"2026-02-11T20:14:25.356676+01:00","close_reason":"Added dedicated CLI write-with-proof command and doctor capability/version checks with request serialization/version tests.","dependencies":[{"issue_id":"kura-training-pdc.15","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T19:22:16.848632+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.15","depends_on_id":"kura-training-pdc.13","type":"blocks","created_at":"2026-02-11T19:22:16.849654+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.15","depends_on_id":"kura-training-pdc.14","type":"blocks","created_at":"2026-02-11T20:03:41.721938+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.16","title":"MCP Auto-Calibration: capability-driven tool routing to agent contract","description":"MCP-connected agents should not need handcrafted prompt updates after backend contract changes. MCP integration must auto-detect Kura capabilities and route reads/writes through preferred agent endpoints.","design":"At MCP startup, fetch capability manifest and configure tools toward `/v1/agent/context` and `/v1/agent/write-with-proof` when available. Expose a lightweight health/capability status output for operators. On mismatch, emit concise upgrade notice and safe fallback behavior.","acceptance_criteria":"1) MCP startup performs capability negotiation against Kura.\n2) Tool routing prefers agent contract endpoints when supported.\n3) On unsupported contract, MCP falls back deterministically and surfaces concise operator notice.\n4) Capability status is observable (logs/diagnostic tool output).\n5) Integration tests cover supported, legacy fallback, and mismatch scenarios.","notes":"Deferred flag removed. MCP baseline now exists in-repo; this issue now tracks startup auto-calibration hardening: fetch /v1/agent/capabilities on boot, route to preferred endpoints, emit deterministic fallback + operator-visible compatibility status.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T19:22:16.970682+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T08:48:26.431853+01:00","closed_at":"2026-02-13T08:48:26.431853+01:00","close_reason":"Implemented startup capability negotiation against /v1/agent/capabilities with preferred endpoint routing, deterministic legacy fallback on unsupported/mismatch states, operator-visible negotiation status, and regression tests for preferred/fallback/mismatch paths.","dependencies":[{"issue_id":"kura-training-pdc.16","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T19:22:16.971527+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.16","depends_on_id":"kura-training-pdc.13","type":"blocks","created_at":"2026-02-11T19:22:16.972365+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.16","depends_on_id":"kura-training-pdc.15","type":"blocks","created_at":"2026-02-11T19:22:16.972962+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.16","depends_on_id":"kura-training-lsu","type":"blocks","created_at":"2026-02-13T08:36:21.543289+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":2,"issue_id":"kura-training-pdc.16","author":"jonzim-cmd","text":"Undeferred and reprioritized because ChatGPT App integration requires robust MCP behavior under contract evolution. Implement startup capability negotiation + automatic endpoint routing + deterministic fallback/health signaling.","created_at":"2026-02-13T07:36:42Z"}]}
{"id":"kura-training-pdc.17","title":"Workflow Gate E2E Coverage for write-with-proof","description":"Add DB-backed API integration tests for onboarding workflow gate flows in /v1/agent/write-with-proof, including blocked drift, explicit close, explicit override, and legacy auto-close compatibility path.","acceptance_criteria":"1) Tests verify blocked response payload + docs_hint for drift before close. 2) Tests verify explicit close allows planning and emits workflow_gate transition onboarding_closed. 3) Tests verify explicit override allows planning and emits transition override. 4) Legacy planning history path auto-writes workflow.onboarding.closed and returns compatibility warning.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:49:36.2833+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T22:15:51.958643+01:00","closed_at":"2026-02-11T22:15:51.958643+01:00","close_reason":"4 DB-backed E2E integration tests added and passing: drift detection, explicit close, explicit override, legacy planning path","dependencies":[{"issue_id":"kura-training-pdc.17","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T21:49:36.284539+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.18","title":"Visualization Resolve Endpoint E2E Integration Coverage","description":"Add DB-backed API integration tests for /v1/agent/visualization/resolve covering source binding against real projections, policy-triggered visualize/skipped paths, telemetry emission, and deterministic fallback responses.","acceptance_criteria":"1) Integration test verifies visualize trigger with resolvable projection refs returns resolved_sources and optional rich output. 2) Invalid source reference/json_path returns validation error with docs_hint. 3) allow_rich_rendering=false returns ASCII fallback with equivalent meaning and telemetry includes viz_fallback_used. 4) Policy skip path emits viz_skipped telemetry.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T22:09:05.196434+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T22:34:49.154222+01:00","closed_at":"2026-02-11T22:34:49.154222+01:00","close_reason":"Added DB-backed E2E integration coverage for /v1/agent/visualization/resolve: visualize+resolved sources, invalid json_path validation docs_hint, deterministic ASCII fallback with viz_fallback_used telemetry, and policy-skip viz_skipped telemetry.","dependencies":[{"issue_id":"kura-training-pdc.18","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T22:09:05.197903+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.19","title":"Evidence Layer V1: Utterance-\u003eClaim-\u003eEvent lineage","description":"Introduce a first-class evidence layer so agent writes remain reconstructable under open-world user input. Problem: important facts currently live in free text and can drift when summarized. Outcome: each persisted training fact can be traced to raw utterance evidence and confidence metadata.","design":"Create deterministic claim objects from raw utterances with fields: claim_type, value, unit, scope(session/exercise/set), confidence, provenance(source_text_span, parser_version). Store lineage links from claim to emitted events and corrections. Do not replace event store; augment it with evidence metadata and query surfaces for audits. Keep repairs reversible via set.corrected/event.retracted.","acceptance_criteria":"1) Claim schema and storage path documented and implemented. 2) Each auto-extracted write includes lineage to source utterance span. 3) API/worker can explain why a value exists (raw text + parser/provenance). 4) Integration tests cover deterministic replay from transcript snippets. 5) No regression in existing write-with-proof flow.","notes":"Implemented artifacts\n- docs/design/029-evidence-layer-v1-utterance-claim-event-lineage.md (claim schema, storage path, replay and explain surface)\n- api/src/routes/agent.rs:\n  - Added deterministic mention-\u003eclaim extraction with source_text_span + parser_version\n  - Added additive sidecar writes: `evidence.claim.logged` in `write_with_proof`\n  - Added explain endpoint: `GET /v1/agent/evidence/event/{event_id}`\n  - Added deterministic replay tests for transcript snippets and endpoint e2e test\n- api/src/main.rs: OpenAPI path/schema registration for evidence endpoint/response\n- workers/src/kura_workers/event_conventions.py: added `evidence.claim.logged` contract\n- workers/src/kura_workers/system_config.py: added `evidence_layer_v1` conventions section\n- workers/tests/test_system_config.py + workers/tests/test_interview_guide.py: updated/added convention coverage\n\nTests and exact commands\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nResidual risks / non-goals\n- V1 parser currently covers mention-bound set-context claims (rest_seconds, rir, tempo, set_type); broader claim families are intentionally deferred.\n- Evidence writes are additive sidecar writes; no backfill for historical events without lineage in this issue.\n\nFollow-up issues\n- kura-training-pdc.20 (cross-event coherence + scale guards)\n- kura-training-pdc.21 (open observation contract extension)\n- kura-training-2zc.5 (calibration/drift on new claim stream)\n\nRollback / disable path\n- Remove/disable sidecar `evidence.claim.logged` emission in `write_with_proof`.\n- Keep endpoint route disabled/removed if needed; primary write-with-proof flow remains functional.\n- Revert commit touching agent route/main + convention docs/tests to restore pre-evidence behavior.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T13:37:18.207254+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T14:14:52.995743+01:00","closed_at":"2026-02-12T14:14:52.995743+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-pdc.19","depends_on_id":"kura-training-pdc.11","type":"blocks","created_at":"2026-02-12T13:37:18.209864+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.19","depends_on_id":"kura-training-pdc.8","type":"blocks","created_at":"2026-02-12T13:37:18.210588+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.19","depends_on_id":"kura-training-ct3.6","type":"blocks","created_at":"2026-02-12T13:37:18.211302+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.19","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-12T13:39:50.591036+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.2","title":"Onboarding State Machine: No Coaching Drift before Phase Close","description":"Enforce hard onboarding phase transitions. Problem: agent naturally drifts into planning/coaching before onboarding closure, creating incomplete profiles and inconsistent persistence. Implement explicit state gating between onboarding and planning modes.","design":"Introduce conversation workflow state with transition conditions and override behavior. Planning/coaching actions require onboarding_closed or explicit user override event. Emit workflow violation signals for learning loop when drift attempts occur.","acceptance_criteria":"1) State machine prevents planning payload generation before onboarding phase close unless explicit override exists. 2) Transition events are auditable. 3) User-visible messaging handles phase switch clearly. 4) Tests cover drift attempt, valid close, and explicit override path.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:03:52.582636+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T21:49:17.647902+01:00","closed_at":"2026-02-11T21:49:17.647902+01:00","close_reason":"Implemented onboarding phase gate (INV-004) with auditable close/override transitions, legacy-safe auto-close compatibility, workflow telemetry, and tests for drift/close/override.","dependencies":[{"issue_id":"kura-training-pdc.2","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T17:03:52.583657+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.2","depends_on_id":"kura-training-pdc.1","type":"blocks","created_at":"2026-02-11T17:05:52.293622+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.20","title":"Session Audit V2: Cross-event coherence + scale guards","description":"Extend session audit beyond mention-bound set fields to session-level coherence checks. Problem: transcript-level inconsistencies (scale drift, contradictory summaries, inferred numbers without evidence) still pass. Outcome: automatic consistency validation and safe correction/clarification for session.completed and session summaries.","design":"Add post-write audit pass that evaluates: (a) scale consistency (1..5 vs 1..10), (b) contradiction checks between structured fields and narrative, (c) unsupported inferred values. Auto-repair only on high-confidence deterministic transforms; otherwise emit clarification question and mark unresolved mismatch. Expose machine-readable audit results in write-with-proof response.","acceptance_criteria":"1) Deterministic guards for enjoyment/quality/exertion scales implemented. 2) Contradiction detection between narrative and structured session feedback implemented. 3) Auto-repair path emits correction events with provenance; uncertain cases emit clarification prompts. 4) E2E tests cover clean, repaired, and needs_clarification states. 5) Telemetry includes mismatch classes for learning loop.","notes":"Implemented artifacts\n- docs/design/030-session-audit-v2-cross-event-coherence-and-scale-guards.md (scope, mismatch classes, repair/clarification split)\n- api/src/routes/agent.rs:\n  - Extended session audit with session.completed coherence checks:\n    - deterministic scale guards (1..10 -\u003e 1..5 normalization for enjoyment/perceived_quality)\n    - narrative vs structured contradiction detection\n    - unsupported inferred value detection (missing evidence id)\n  - Added `session_audit.mismatch_classes` to write-with-proof response and telemetry payloads\n  - Added deterministic auto-repair for high-confidence session feedback scale normalization via event.retracted + replacement session.completed with repair_provenance\n  - Clarification path for unresolved contradictions/out-of-bounds/unsupported inferred values\n  - Updated undo template to use retracted_event_id contract\n  - Added tests for clean, repaired, needs_clarification states for session feedback checks\n\nTests and exact commands\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nResidual risks / non-goals\n- Narrative contradiction heuristics are rule-based/token-based in V2; no semantic model scoring yet.\n- Auto-repair currently covers deterministic scale normalization only; contradiction cases remain clarification-first.\n\nFollow-up issues\n- kura-training-pdc.21 (open observation contract for additional non-schema session signals)\n- kura-training-m3k.1 (reliability UX surfacing mismatch classes and saved/inferred/unresolved semantics)\n- kura-training-2zc.5 (calibration/drift over mismatch classes + contradiction heuristics)\n\nRollback / disable path\n- Disable session.completed scale normalization branch inside session audit while retaining mention-bound set-field checks.\n- Revert commit touching session-audit logic/docs to restore prior Audit V1 behavior.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T13:37:23.437991+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T14:24:46.557806+01:00","closed_at":"2026-02-12T14:24:46.557806+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-pdc.20","depends_on_id":"kura-training-pdc.11","type":"blocks","created_at":"2026-02-12T13:37:23.440834+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.20","depends_on_id":"kura-training-pdc.8","type":"blocks","created_at":"2026-02-12T13:37:23.441615+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.20","depends_on_id":"kura-training-pdc.19","type":"blocks","created_at":"2026-02-12T13:37:23.442364+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.20","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-12T13:39:55.793401+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.21","title":"Open Observation Contract V1 for non-schema session signals","description":"Add an open-world observation contract for valuable session facts that do not fit fixed event schemas. Problem: insights like motivation pre-session, technical cues, and jump baseline are currently preserved only as opaque text. Outcome: structured but extensible observations with confidence and context, without exploding event types.","design":"Define observation payload: dimension, value, unit(optional), scale(optional), context_text, tags, confidence, provenance, scope(session/exercise). Support high-confidence dimensions first: motivation_pre, discomfort_signal, jump_baseline. Keep contract extensible through dimension registry + validation tiers (known, provisional, unknown).","acceptance_criteria":"1) Observation contract and validation tiers documented. 2) At least three dimensions implemented with tests (motivation_pre, discomfort_signal, jump_baseline). 3) Observations are queryable in projections without custom per-dimension schema work. 4) Unknown dimensions remain storable with safe defaults and quality flags. 5) No loss of raw context text/provenance.","notes":"Implemented artifacts:\n- workers/src/kura_workers/handlers/open_observations.py (open-world observation projection with known/provisional/unknown tiers)\n- workers/src/kura_workers/handlers/__init__.py (handler registration)\n- workers/src/kura_workers/event_conventions.py (observation.logged contract)\n- workers/src/kura_workers/system_config.py (open_observation_v1 conventions)\n- api/src/routes/events.rs (simulation target mapping: open_observations/\u003cdimension\u003e)\n- workers/tests/test_open_observations.py (unit tests)\n- workers/tests/test_integration.py (integration tests for known/unknown/retraction)\n- workers/tests/test_interview_guide.py + workers/tests/test_system_config.py (contract/system assertions)\n- docs/design/031-open-observation-contract-v1.md\n\nTests + exact commands:\n- ruff check workers/src/ workers/tests/\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- cargo test --workspace\n\nResidual risks / non-goals:\n- No automated dimension-promotion workflow in this issue (handled by learning-loop chain).\n- Unknown dimensions are stored safely but not yet auto-ranked for promotion.\n\nFollow-up issues:\n- kura-training-2zc.6 (unknown-dimension mining + proposal loop)\n- kura-training-2zc.3 (promotion policy bridge)\n\nRollback / disable path:\n- Stop emitting observation.logged events at writer level.\n- Remove open_observations registration from workers/src/kura_workers/handlers/__init__.py to disable projection updates while keeping immutable events.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T13:37:28.667296+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T14:34:52.074925+01:00","closed_at":"2026-02-12T14:34:52.074925+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-pdc.21","depends_on_id":"kura-training-pdc.19","type":"blocks","created_at":"2026-02-12T13:37:28.670131+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.21","depends_on_id":"kura-training-pdc.20","type":"blocks","created_at":"2026-02-12T13:37:28.670914+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.21","depends_on_id":"kura-training-pdc.7","type":"blocks","created_at":"2026-02-12T13:37:28.671701+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.21","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-12T13:40:00.99337+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.22","title":"Global Invariant Enforcement Parity on Legacy Event Writes","description":"Enforce Decision 13 core invariants on /v1/events and /v1/events/batch so legacy paths cannot bypass onboarding/timezone/save-contract safety.","design":"Apply server-side gate checks before insert for legacy endpoints: (1) block planning/coaching writes before onboarding close unless explicit override/close transition is present in the same batch, (2) require timezone preference before timeline-affecting writes unless event carries explicit timezone context, (3) protect INV-007 by routing plan writes to write-with-proof semantics (hard fail with docs_hint on legacy path).","acceptance_criteria":"1) POST /v1/events and /v1/events/batch reject planning/coaching events when onboarding not closed (unless explicit close/override in same request). 2) Legacy plan writes return machine-readable policy violation with migration hint to /v1/agent/write-with-proof. 3) Timeline-affecting writes without timezone preference fail with actionable docs_hint. 4) Tests cover allowed/blocked cases for single + batch.","notes":"Implemented global legacy-path enforcement in api/src/routes/events.rs: onboarding phase gate + plan-write contract gate + timezone requirement gate before /v1/events and /v1/events/batch writes. Added evaluate_legacy_domain_invariants(), fetch_user_profile_projection_data(), and regression tests for blocked/allowed flows.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:22:04.821666+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:31:26.815177+01:00","closed_at":"2026-02-13T09:31:26.815177+01:00","close_reason":"Implemented and tested","dependencies":[{"issue_id":"kura-training-pdc.22","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-13T09:22:04.823232+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.23","title":"Intensity Semantics V1: RIR/RPE Ingress Contract and Consistency Guards","description":"Define and enforce a deterministic intensity contract at write ingress for set.logged and training plan payloads.","design":"Add hard validation for numeric type + range (RPE 1..10, RIR 0..10) and deterministic consistency guard when both values are present. Keep consistency mismatch as warning for now; reject malformed/out-of-range payloads with invariant-specific policy codes.","acceptance_criteria":"1) Non-numeric or out-of-range RIR/RPE fails with machine-readable policy violation. 2) RIR+RPE contradiction emits warning metadata. 3) Event conventions/docs explicitly define precedence and inference semantics. 4) Unit tests cover pass/fail/warn cases.","notes":"Implemented deterministic intensity ingress contract: RPE/RIR type+range validation for set.logged and training_plan.* payloads, locale-decimal parsing (comma/dot), and consistency warning in plausibility checks. Updated event conventions and added unit tests.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:22:10.03943+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:31:42.440428+01:00","closed_at":"2026-02-13T09:31:42.440428+01:00","close_reason":"Implemented and tested","dependencies":[{"issue_id":"kura-training-pdc.23","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-13T09:22:10.040327+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.23","depends_on_id":"kura-training-pdc.22","type":"blocks","created_at":"2026-02-13T09:22:40.631234+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.24","title":"Observation Lifecycle Governance V1: unknown-\u003eprovisional-\u003eknown","description":"Make open-observation lifecycle promotion explicit and machine-readable with deterministic thresholds.","design":"Add lifecycle policy metadata to open_observation conventions + projection summaries: promotion status, confidence/support thresholds, and guardrails for auto-promotion eligibility. No automatic schema mutation in V1.","acceptance_criteria":"1) Projection summary exposes lifecycle status and promotion readiness fields. 2) System conventions declare thresholds/criteria and non-goals. 3) Tests cover lifecycle status calculation for known/provisional/unknown dimensions.","notes":"Added observation lifecycle governance in open_observations projection: lifecycle status + promotion readiness summary (support/confidence thresholds). Added lifecycle policy contract in system_config conventions and test coverage for known/unknown/provisional statuses.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:22:20.479119+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:32:13.672355+01:00","closed_at":"2026-02-13T09:32:13.672355+01:00","close_reason":"Implemented and tested","dependencies":[{"issue_id":"kura-training-pdc.24","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-13T09:22:20.479977+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.24","depends_on_id":"kura-training-pdc.21","type":"blocks","created_at":"2026-02-13T09:22:51.044778+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.25","title":"Locale-Aware Ingestion Baseline V1","description":"Prepare multilingual robustness by declaring locale/terminology ingestion contracts for number/unit/date parsing and confidence fallback.","design":"Introduce system-level ingestion locale contract: explicit locale hints, decimal/date normalization rules, and terminology mapping expectations with uncertainty discipline. Implement low-risk parser normalization for decimal comma in intensity fields.","acceptance_criteria":"1) System conventions expose locale ingestion contract + examples. 2) Ingress normalization accepts decimal-comma intensity values safely. 3) Tests cover locale-format normalization and fallback behavior.","notes":"Implemented locale-aware ingestion baseline: ingestion_locale_v1 conventions in system_config and decimal-comma normalization for intensity fields at API ingress. Added tests for locale normalization behavior and convention presence.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:22:25.700053+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:32:29.316108+01:00","closed_at":"2026-02-13T09:32:29.316108+01:00","close_reason":"Implemented and tested","dependencies":[{"issue_id":"kura-training-pdc.25","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-13T09:22:25.701298+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.25","depends_on_id":"kura-training-pdc.23","type":"blocks","created_at":"2026-02-13T09:22:45.840555+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.3","title":"Timezone-First Temporal Safety Flow","description":"Make timezone explicit before user-facing date math. Problem: schedule windows and week/day statements are error-prone without user timezone and lead to immediate trust loss. Add mandatory/default timezone handling path with clear assumption disclosure.","design":"Reference Decision 13 INV-003. Persist timezone preference early (or ask once with durable memory). All timeline/scheduling outputs must compute in user timezone; fallback assumptions must be explicit and logged as quality signal.","acceptance_criteria":"1) Timezone is captured or explicitly assumed before schedule/date claims. 2) Scheduling/timeline computations use user timezone consistently. 3) Missing-timezone quality issue drops after capture. 4) Tests cover DST boundary and mismatch regression case.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:04:08.36716+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T21:30:52.0575+01:00","closed_at":"2026-02-11T21:30:52.0575+01:00","close_reason":"Implemented timezone-first day/week grouping in training_timeline with explicit UTC fallback disclosure, updated onboarding/conventions, and added DST + mismatch regression tests.","dependencies":[{"issue_id":"kura-training-pdc.3","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T17:04:08.3687+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.4","title":"RIR as First-Class Data in Events and Plans","description":"Model Reps-In-Reserve explicitly instead of only narrative guidance. Problem: intensity prescriptions are inconsistent and hard to analyze when RIR is only implicit or text-based. Add structured RIR fields to set logging and planning conventions/projections.","design":"Extend event conventions and handlers to accept/store RIR consistently (and map with existing RPE where needed). Ensure training plans can prescribe target RIR and downstream analytics can query adherence.","acceptance_criteria":"1) set logging supports structured RIR field. 2) planning conventions support target RIR prescriptions. 3) projections expose RIR where relevant without breaking backward compatibility. 4) migration/backfill strategy documented. 5) tests cover parse, persistence, and projection output.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:04:27.87112+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:11:25.97273+01:00","closed_at":"2026-02-11T19:11:25.97273+01:00","close_reason":"Implemented RIR as first-class data in conventions and projections with backward-compatible normalization and documented backfill strategy.","dependencies":[{"issue_id":"kura-training-pdc.4","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T17:04:27.872345+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.4","depends_on_id":"kura-training-pdc.1","type":"blocks","created_at":"2026-02-11T17:06:02.567325+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.5","title":"Save Handshake Enforcement (write receipt + read-after-write)","description":"Enforce verifiable persistence before agent claims data/plan is saved. Problem: users currently need to ask manually whether a plan was persisted, creating trust risk and potential data loss. Add mandatory save handshake protocol.","design":"Reference Decision 13 INV-002 and INV-007. Agent must obtain event write receipt and projection read-back confirmation before success claim. Failures must return explicit pending/failed state and emit quality signals.","acceptance_criteria":"1) 'Saved' response is blocked unless receipt + read-back pass. 2) Protocol states visible: pending, saved_verified, failed. 3) quality signal emitted on claim mismatch attempts. 4) tests cover happy path, write success/read fail, and idempotent retry path.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:04:48.190089+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:08:38.406116+01:00","closed_at":"2026-02-11T19:08:38.406116+01:00","close_reason":"Enforced save handshake states (saved_verified|pending|failed), added idempotent retry receipt recovery, and extended handshake telemetry/quality signals with tests.","dependencies":[{"issue_id":"kura-training-pdc.5","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T17:04:48.191429+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.6","title":"Intent-aware Visualization Policy + Data-bound Specs","description":"Enable visualizations only when they improve clarity (not by default). Problem: purely textual explanations can hide misunderstandings in timeline/progression/planning topics, but always-on visualization creates noise. Goal: add policy-driven, data-bound visualization support with safe fallbacks.","design":"Add visualization decision policy based on user intent, complexity, and preference. Require a structured visualization_spec before rendering (chart/table/timeline/ascii/mermaid), bound to projection data and timezone context. Enforce explicit uncertainty labels when data quality is low. Include deterministic fallback path (ASCII/text) when rich rendering is unavailable.","acceptance_criteria":"1) Policy decides visualize vs no-visualize using explicit triggers (trend/compare/plan-vs-actual/multi-week scheduling) and supports user preference override. 2) Agent emits structured visualization_spec with declared data sources and purpose before rendering. 3) Renderer rejects specs without resolvable projection references. 4) Fallback output exists (ASCII or plain structured summary) with equivalent meaning. 5) Telemetry events added: viz_shown, viz_skipped, viz_source_bound, viz_fallback_used, viz_confusion_signal. 6) Tests cover positive trigger, negative trigger, invalid spec rejection, and fallback behavior.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:10:42.101286+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T22:09:09.235388+01:00","closed_at":"2026-02-11T22:09:09.235388+01:00","close_reason":"Implemented intent-aware visualization policy with structured visualization_spec validation, strict projection source binding, deterministic ASCII fallback, viz telemetry signals, and unit/contract tests.","dependencies":[{"issue_id":"kura-training-pdc.6","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T17:10:42.102275+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.6","depends_on_id":"kura-training-pdc.3","type":"blocks","created_at":"2026-02-11T17:12:16.009893+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.6","depends_on_id":"kura-training-2zc.1","type":"blocks","created_at":"2026-02-11T17:12:26.285834+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.7","title":"Training Core Fields V1: rest_seconds + modality-aware set context","description":"Ensure core training fields are captured from day 1 across relevant modalities. Field test showed that rest time was explicitly mentioned but not logged because it was not treated as baseline schema guidance, causing avoidable data loss and user correction loops. Goal: define and enforce a core field profile for set logging (including rest_seconds) with mention-to-field capture rules.","design":"Reference Decision 13 domain gap closure. Introduce modality-aware core field matrix (e.g., strength/oly/hypertrophy) with default fields such as reps, load/time/distance, RPE/RIR, rest_seconds, set_type/warmup-context where applicable. Add extraction rules so explicit user mentions (e.g., 'Pause 90 sec') are mapped proactively. Surface missing-core-field hints via quality checks instead of relying on ad-hoc agent memory.","acceptance_criteria":"1) Define a modality-aware core-field registry with field classes: required, optional, and mention-bound.\n2) `rest_seconds` is optional by default, but becomes mandatory to persist when the user explicitly mentions a pause/rest value.\n3) Session-default rule is enforced: a mentioned set-context value (e.g., rest, effort, tempo) applies to subsequent relevant sets in the same exercise until overridden.\n4) Mention→field extraction is deterministic (synonyms/units covered) and does not require an extra user reminder.\n5) Agent must not fabricate optional values; absent mention keeps the field unset/null.\n6) Quality/invariant checks flag mention-present/field-missing cases and provide remediation hints.\n7) Tests cover mention→field mapping, session-default propagation, and `rest_seconds` regression.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:28:10.188947+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:16:28.157933+01:00","closed_at":"2026-02-11T19:16:28.157933+01:00","close_reason":"Added modality-aware core-field registry, deterministic mention→field extraction, session-default propagation for mention-bound context, and quality invariant detection for mention-field mismatches.","dependencies":[{"issue_id":"kura-training-pdc.7","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T18:28:10.189956+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.7","depends_on_id":"kura-training-pdc.4","type":"blocks","created_at":"2026-02-11T18:28:41.295961+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.8","title":"Session Feedback Standardization: session.completed convention + projection","description":"Standardize post-session subjective feedback as first-class data instead of orphaned event types. Field test showed 'training felt good/fun' was logged as session.completed but remained orphaned, limiting longitudinal analysis and recommendation quality. Goal: define a canonical session feedback event convention and projection support.","design":"Add documented event convention for session completion/feedback with fields for enjoyment, perceived quality, perceived exertion summary, pain/discomfort signal, and free-text context. Implement a projection that aggregates these signals over time and exposes coach-relevant patterns (e.g., enjoyment trend, load-to-enjoyment alignment). Keep flexible text while ensuring baseline structured fields.","acceptance_criteria":"1) session feedback event type is documented in event conventions (no orphan status in normal flow). 2) Handler/projection surfaces session feedback trends over time. 3) Agent can reference this projection for planning adaptations. 4) Existing orphaned session.completed events can be mapped/handled without data loss where feasible. 5) Tests cover ingestion, projection output, and trend aggregation.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:28:27.408323+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:49:17.894205+01:00","closed_at":"2026-02-11T19:49:17.894205+01:00","close_reason":"Added session.completed convention + session_feedback projection (trend and load alignment), API context/simulation integration, legacy payload normalization, and ingestion/output/trend tests.","dependencies":[{"issue_id":"kura-training-pdc.8","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T18:28:27.409243+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.8","depends_on_id":"kura-training-pdc.7","type":"blocks","created_at":"2026-02-11T18:28:51.583428+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.9","title":"Repair Provenance Contract: source confidence and scope","description":"Repairs currently flatten certainty into final values and hide whether fields were explicit, inferred, or estimated. This reduces auditability and can silently overstate data quality. Add a repair provenance contract so every corrected field keeps origin and confidence metadata.","design":"Introduce structured repair metadata for corrected events/fields: source_type (explicit|inferred|estimated|user_confirmed), confidence (0..1 or band), repair_reason, and applies_scope (single_set|exercise_session|session). Ensure projection surfaces both effective value and provenance state for downstream policy and UI decisions.","acceptance_criteria":"1) Event conventions define provenance fields for repaired values.\n2) Any repair operation persists provenance metadata per corrected field or correction bundle.\n3) Projections expose provenance in machine-readable form without breaking old consumers.\n4) Quality checks can filter high-confidence vs low-confidence repairs.\n5) Tests cover explicit, inferred, and user-confirmed repair paths.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:45:05.03608+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:20:48.708949+01:00","closed_at":"2026-02-11T19:20:48.708949+01:00","close_reason":"Implemented repair provenance contract (source_type/confidence/scope/reason), exposed provenance in repair proposals/events, and added confidence-based repair filtering with tests.","dependencies":[{"issue_id":"kura-training-pdc.9","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T18:45:05.0371+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.9","depends_on_id":"kura-training-pdc.7","type":"blocks","created_at":"2026-02-11T18:45:05.037971+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pef","title":"Onboarding: Kommunikationsstil und Erfahrungslevel als Profilfelder","description":"context_seeds in Decision 8 sehen Felder wie communication_style, experience_level, language vor, aber sie existieren noch nicht konkret. profile.updated muss diese Felder verstehen. Agent soll Stil anpassen können basierend auf Nutzerpräferenz. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:36:14.139981+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:30:01.851196+01:00","closed_at":"2026-02-10T07:30:01.851196+01:00","close_reason":"communication_style als Freitext-Feld in profile.updated + coverage_area communication_preferences im interview_guide. Sprache nicht nötig (ergibt sich aus Kontext)."}
{"id":"kura-training-pke","title":"Legal: Finale Auftragsverarbeiter- und Drittlandtransfer-Liste verankern","description":"Erstelle eine verbindliche, versionierte Liste aller Auftragsverarbeiter inkl. Zweck, Datenkategorien, Hosting-Region, Drittlandstatus, Rechtsgrundlage fuer Transfer (z. B. SCC/Adequacy) und Link zur DPA/TOM-Dokumentation. Integriere die Liste in die Datenschutzhinweise und fuehre einen Review-Workflow ein, damit Aenderungen vor Go-Live verpflichtend geprueft werden.","acceptance_criteria":"- Verbindliche Verarbeiterliste im Repo vorhanden\\n- Jeder Anbieter mit Drittlandstatus + Transfergrundlage dokumentiert\\n- Datenschutzhinweise verweisen konsistent auf die Liste\\n- Verantwortliche Person fuer Pflege benannt","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T18:22:44.12011+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T18:49:35.733487+01:00","closed_at":"2026-02-16T18:49:35.733487+01:00","close_reason":"Implemented versioned processor/third-country list and wired concrete disclosures into DE/EN privacy notice."}
{"id":"kura-training-pl5","title":"Convention: empty projections vs early return","description":"Handlers return early when no events exist, so dimensions never appear in manifest for new users. Need convention: should handlers create empty projections with zero/null values so the agent can discover that the dimension exists but has no data? Affects training_timeline and exercise_progression.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-08T15:18:34.984294+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:17:21.712622+01:00","closed_at":"2026-02-09T08:17:21.712622+01:00","close_reason":"Convention established: no empty projections. System layer declares existence (dimension_meta), user layer shows 'no_data'. Already implemented in _build_user_dimensions()."}
{"id":"kura-training-pp5m","title":"Phase 3 sprint: protocol-aware MSS/sprint capability estimator with uncertainty","description":"WHY:\nSprint estimates based on ad-hoc best times are protocol-sensitive (distance, timing method, surface) and can produce non-comparable trends.\n\nHOW:\nBuild a sprint capability estimator that models max sprint speed/MSS with explicit protocol context and uncertainty:\n- derive observation candidates from split times and distance/time combinations\n- encode timing_method and surface in comparability boundaries\n- fit latent sprint capability state with credible intervals\n- expose freshness and insufficiency diagnostics.\n\nIMPLEMENTATION TASKS:\n1) Define sprint observation extraction + measurement error model.\n2) Add protocol-aware comparability grouping for sprint.\n3) Implement state update + forecast layer.\n4) Add eval metrics (coverage, MAE, direction accuracy) and gating hooks.\n\nACCEPTANCE:\n- Sprint projection includes mean + interval + status + caveats.\n- Non-comparable protocols are explicitly flagged, not silently merged.\n- Eval harness can score sprint forecasts over replay windows.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:37:38.991614+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:35.044759+01:00","closed_at":"2026-02-20T19:28:35.044759+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo).","dependencies":[{"issue_id":"kura-training-pp5m","depends_on_id":"kura-training-31yb","type":"blocks","created_at":"2026-02-20T18:40:32.421919+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-prz","title":"Web: Request Access Seite + Early Access Messaging","description":"## Was\n/request-access Seite im Web-Frontend. Ersetzt \"Konto erstellen\" als primären CTA.\n\n## Seite: /request-access\n- Route: web/src/app/[locale]/(inner)/request-access/\n- i18n: de + en (ja optional)\n\n### Inhalt\n- Headline: \"Early Access\" / \"Früher Zugang\"\n- Subtext (klar und ehrlich):\n  \"Kura ist in aktiver Entwicklung. Als Early-Access-Nutzer bekommst du kostenlosen, vollständigen Zugang — und hilfst dabei, das System besser zu machen. Deine Trainingsdaten fließen anonymisiert in die Verbesserung der Algorithmen ein.\"\n- Formular:\n  - Email (required)\n  - Name (optional)\n  - \"Was trainierst du?\" / \"What do you train?\" (optional, textarea)\n  - Submit: \"Zugang anfragen\" / \"Request Access\"\n- Erfolgs-State: \"Wir melden uns bei dir.\" / \"We'll be in touch.\"\n\n### Tonalität\n- Ehrlich, nicht Marketing-speak\n- Klar machen: kostenlos, vollständig, man hilft mit\n- Nicht: \"exklusiv\", \"limitiert\", künstliche Verknappung\n\n## Landing Page Anpassung\n- CTA Button: \"Request Access\" statt \"Konto erstellen\"\n- Signup-Links in Header/Footer → /request-access\n- /signup bleibt erreichbar (für Invite-Links), ist aber nicht direkt verlinkt\n\n## Design\n- Gleiche Ästhetik wie Auth-Seiten (butter yellow auf schwarz)\n- auth.module.css Patterns wiederverwenden\n- Einfach, focused, kein Overdesign","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:45:44.986664+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:12:55.802355+01:00","closed_at":"2026-02-13T13:12:55.802355+01:00","close_reason":"Request Access page created, landing/header/start CTAs updated, i18n de+en","dependencies":[{"issue_id":"kura-training-prz","depends_on_id":"kura-training-87v","type":"blocks","created_at":"2026-02-13T12:47:05.984336+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-prz","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:47.437584+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qa5","title":"Go-Live: Storage Bucket Security Policy verhaerten","description":"Storage-Buckets vor Launch final absichern (Public-Flags, MIME-Allowlist, File-Size-Limits, Zugriffspolicies).","acceptance_criteria":"- Nicht-oeffentliche Buckets auf public=false\n- allowed_mime_types und file_size_limit fuer Upload-Buckets gesetzt\n- object access policies (nur owner/tenant) dokumentiert und aktiv\n- Testzugriffe auf fremde/ungueltige Pfade liefern 401/403\n- Scanner meldet keine Content-Type-Sniffing- oder Bucket-Exposure-Funde mehr","status":"open","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T10:23:12.436201+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T10:24:03.866043+01:00"}
{"id":"kura-training-qlc","title":"Privacy-by-Default Auth v1: Identitaet entkoppeln, Daten nutzbar halten","description":"Kura verarbeitet sensible Trainings- und Gesundheitsdaten. Aktuell sind Konto-Identitaet und Fachdaten nur teilweise entkoppelt: users enthaelt email/password_hash, Auth-Flows sind email+password + PKCE loopback, es gibt keine provider identities fuer Google/Apple, keinen Device-Code-Flow fuer CLI/MCP und keinen kontrollierten Break-Glass Re-Identifikationspfad. Ziel: Plain Trainingsdaten fuer Modellverbesserung behalten, Personenbezug im Alltag minimieren.","design":"Ausgangslage im Code: migrations/20260209000001_auth_tables.sql, api/src/routes/auth.rs, api/src/auth.rs, cli/src/commands/auth.rs, migrations/20260207000001_create_events.sql, migrations/20260225000001_provider_connections.sql. Umsetzung in 6 Teilpaketen: (1) Identity-Datenmodell entkoppeln, (2) Auth API refactor auf identities, (3) Device Authorization Flow, (4) OIDC Google/Apple, (5) Break-Glass + Audit, (6) pseudonymisierte Analytics/Debug-Pfade. Sicherheitsprinzip: pseudonymized-by-default, re-identification nur kontrolliert und auditiert.","acceptance_criteria":"1) Child-Tasks mit klaren Dependencies sind angelegt. 2) Jede Aufgabe hat Why/How und konkrete Einstiegspunkte. 3) Zielbild deckt Email+Apple+Google sowie Code-basierte Auth fuer CLI/MCP ab. 4) Personenbezug ist standardmaessig von Trainingsdaten getrennt.","notes":"COMPACTION-SAFE BRIEF\nGoal: Privacy-by-default Auth/Identity ohne Verlust der trainingsbezogenen Datenqualität.\n\nInvarianten (muessen immer gelten):\n1) Events/Projections bleiben primär datenorientiert (keine Namens-/Email-Abhaengigkeit).\n2) Identitaetsmapping ist separiert und kontrolliert.\n3) Re-Identifikation ist Ausnahmefluss mit Audit.\n\nNicht-Ziele:\n- Kein Data-Obfuscation-Produkt, kein Entfernen wertvoller Trainingssignale.\n- Keine breite UI-Neuimplementierung; API/CLI zuerst.\n\nEmpfohlene Umsetzungsreihenfolge:\nqlc.1 -\u003e qlc.2 -\u003e (qlc.3 + qlc.4) -\u003e qlc.5 -\u003e qlc.6\n\nKritische Touchpoints:\nmigrations/20260209000001_auth_tables.sql, api/src/routes/auth.rs, api/src/auth.rs, cli/src/commands/auth.rs, cli/src/util.rs, api/src/routes/events.rs, api/src/routes/projections.rs\n\nAbbruchkriterien:\n- Wenn auth token issuance oder RLS scope regressions auftreten, sofort stoppen und zuerst qlc.2 stabilisieren.\n- Keine stillen schema changes ohne migration/test/backfill-plan.\n\nDefinition of Done (Programm-Ebene):\n- Email+Google+Apple login flows funktionieren und sind sicher verknuepft.\n- CLI/MCP koennen via Device Code authentifizieren.\n- Standard-Debug/Analytics bleibt pseudonymisiert; re-identification nur via audited break-glass.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:51:34.312746+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:23:23.812142+01:00","closed_at":"2026-02-12T21:23:23.812142+01:00","close_reason":"Completed Privacy-by-Default Auth v1 program end-to-end (schema split, identity-based auth, device flow, OIDC google/apple linking, break-glass audit path, pseudonymous debug surfaces). Validation: cargo test --workspace, ruff check, workers unit tests, workers integration tests all green."}
{"id":"kura-training-qlc.1","title":"Schema v1: user_identities, analysis_subjects und support_access_audit","description":"Baue das Datenmodell fuer Identity-Entkopplung und privacy-by-default Debugging. Problem heute: users traegt Identitaet direkt, es gibt kein dediziertes Identity-Register, keine stabile pseudonyme Analyse-ID und keinen Audit-Container fuer kontrollierte Re-Identifikation.","design":"Migrationen fuer: user_identities (user_id, provider, provider_subject, email_norm, email_verified_at, created_at, updated_at, constraints auf provider+subject), analysis_subjects (user_id, analysis_subject_id, rotation_version), support_access_audit (actor, target_user_id, reason, ticket_id, requested_mode, ttl, created_at). Backfill fuer bestehenden email/password Bestand aus users -\u003e provider=email_password. Keine PII-Erweiterung in events/projections.","acceptance_criteria":"1) Tabellen + Constraints + Grants + Indizes sind implementiert. 2) Backfill-Migration laeuft idempotent auf bestehender DB. 3) events/projections bleiben frei von Name/Email-Feldern. 4) Tests decken uniqueness, collision und backfill korrekt ab.","notes":"COMPACTION-SAFE EXECUTION NOTES\nPrimary objective: Introduce identity and pseudonym mapping tables without breaking existing auth/event flows.\n\nSchema scope (required):\n- user_identities(user_id, provider, provider_subject, email_norm, email_verified_at, created_at, updated_at)\n- analysis_subjects(user_id, analysis_subject_id, rotation_version, timestamps)\n- support_access_audit(actor, target_user_id, reason, ticket_id, requested_mode, ttl/expires_at, created_at, immutable)\n\nBackfill rules:\n- Existing users -\u003e user_identities provider=email_password, provider_subject=normalized email\n- Existing users -\u003e analysis_subjects deterministic/stable generated id\n\nMust not break:\n- users table compatibility for current code path\n- event/projection schemas and RLS policies\n\nVerification:\n- migration up on existing DB\n- unique constraints and duplicates tested\n- backfill idempotent rerun tested\n\nCommon pitfall:\n- adding constraints before backfill causes migration failure; backfill first, then tighten.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:51:50.995588+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:22:52.609457+01:00","closed_at":"2026-02-12T21:22:52.609457+01:00","close_reason":"Implemented identity/privacy schema foundation: added migrations 20260228000001_identity_privacy_foundation.sql and 20260228000002_oauth_device_codes.sql; created user_identities, analysis_subjects, support_access_audit, oauth_device_codes with indexes/grants and idempotent backfill for existing users.","dependencies":[{"issue_id":"kura-training-qlc.1","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T20:51:50.996602+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc.2","title":"Auth API Refactor: Email-Login ueber user_identities + sichere Linking-Regeln","description":"Stelle Register/Authorize auf identity-basierte Aufloesung um. Problem heute: Login bindet direkt an users.email. Das verhindert sauberes Multi-Provider-Linking und erschwert datenschutzfreundliche Trennung von Konto und Identitaet.","design":"api/src/routes/auth.rs refactoren: register erzeugt user + user_identities(provider=email_password). authorize_submit sucht Identitaet ueber provider/email_norm und validiert password_hash am zugeordneten user. Token-Issuance/Scopes in api/src/auth.rs bleiben kompatibel. Fuehre maschinenlesbare Fehler fuer identity collision, inactive account und linking conflict ein.","acceptance_criteria":"1) /v1/auth/register und /v1/auth/authorize funktionieren ueber user_identities. 2) Bestehende CLI- und OAuth-Code-Flow Funktionalitaet bleibt kompatibel. 3) Kollisionen/Conflict-Faelle geben strukturierte API-Errors zurueck. 4) DB- und Handler-Tests decken success + edge cases ab.","notes":"COMPACTION-SAFE EXECUTION NOTES\nPrimary objective: Move register/authorize lookup to user_identities while keeping token issuance compatible.\n\nImplementation contract:\n- register: create user + insert email_password identity atomically\n- authorize_submit: resolve via user_identities(email_norm, provider=email_password), then verify password hash\n- return machine-readable collisions/errors for identity conflicts\n\nMust preserve:\n- existing token format prefixes kura_at_/kura_rt_\n- existing scope enforcement in api/src/auth.rs\n- CLI login compatibility\n\nPitfalls:\n- dual source of truth between users.email and user_identities.email_norm\n- missing transaction around user + identity insert\n\nVerification:\n- register duplicate email conflict\n- authorize invalid email/password\n- authorize success + token exchange remains functional.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:52:05.946281+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:22:57.82299+01:00","closed_at":"2026-02-12T21:22:57.82299+01:00","close_reason":"Refactored auth to identity-based resolution: api/src/routes/auth.rs register now writes users+user_identities atomically and authorize resolves via user_identities(email_norm). Updated cli/src/commands/admin.rs create-user to also create email_password identity.","dependencies":[{"issue_id":"kura-training-qlc.2","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T20:52:05.947325+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.2","depends_on_id":"kura-training-qlc.1","type":"blocks","created_at":"2026-02-12T20:53:16.531717+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc.3","title":"OAuth Device Authorization Flow fuer CLI/MCP (user_code in Web-UI)","description":"Implementiere den Code-basierten Login fuer Umgebungen ohne Browser-Callback. Problem heute: cli/src/commands/auth.rs nutzt nur Loopback-Callback. Fuer MCP/headless Nutzung wird ein Device-Flow mit user_code benoetigt.","design":"Fuege Endpunkte fuer Device Flow hinzu (device authorize, device verify, device token polling) inkl. DB-Tabelle fuer device codes, Expiry, Polling-Interval, approved/denied Status und one-time use. CLI erweitert um den Modus kura login --device (zeigt verification_uri + user_code, pollt token endpoint). Web-UI Verification Screen in /auth Bereich zum Eingeben und Bestaetigen des Codes.","acceptance_criteria":"1) End-to-end Device Flow funktioniert fuer CLI und MCP-Token-Beschaffung. 2) Codes sind kurzlebig, rate-limited, brute-force-resistent. 3) Polling liefert RFC-konforme Pending/SlowDown/Denied/Expired Antworten. 4) Integrationstests decken Happy Path + expiry + deny + replay ab.","notes":"CLOSED IMPLEMENTATION DETAILS\n- API: /v1/auth/device/authorize, /v1/auth/device/verify (GET/POST), /v1/auth/device/token in api/src/routes/auth.rs\n- Schema: oauth_device_codes table in migration 20260228000002_oauth_device_codes.sql\n- CLI: new device flow path via `kura login --device` in cli/src/commands/auth.rs and cli/src/main.rs\n- Behavior: browser code entry + polling + pending/slow_down/expired/denied handling.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:52:18.814648+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:23:38.146805+01:00","closed_at":"2026-02-12T21:23:03.021607+01:00","close_reason":"Implemented OAuth device flow end-to-end: API routes /v1/auth/device/authorize, /v1/auth/device/verify (GET/POST), /v1/auth/device/token; CLI supports  polling flow in cli/src/commands/auth.rs and flag wiring in cli/src/main.rs.","dependencies":[{"issue_id":"kura-training-qlc.3","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T20:52:18.815498+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.3","depends_on_id":"kura-training-qlc.2","type":"blocks","created_at":"2026-02-12T20:53:21.734094+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc.4","title":"OIDC Login und Linking fuer Google + Apple (subject-basiert)","description":"Ergaenze federierte Anmeldung fuer Google und Apple mit sicherem Account-Linking. Problem heute: es gibt nur email/password Login, kein provider-subject Mapping und keine robuste Collision-Policy fuer bestehende Konten.","design":"Implementiere OIDC Code-Flow fuer Google/Apple inkl. Discovery/JWKS Validation serverseitig. Speichere provider_subject (sub claim) in user_identities; nutze email nur als UX-Hinweis, nicht als primaeren Schluessel. Definiere klare Linking-Regeln: verified-email Pflicht fuer Auto-Linking, sonst explizite Nutzerbestaetigung; niemals Blind-Linking nur auf unverified email.","acceptance_criteria":"1) Google und Apple Login funktionieren Ende-zu-Ende mit sicherer Token-Verifikation. 2) Neue und bestehende Konten werden korrekt erstellt/verknuepft. 3) Collision/Takeover-Faelle sind fail-closed und auditierbar. 4) Tests decken valid/invalid token, key rotation, link conflicts ab.","notes":"COMPACTION-SAFE EXECUTION NOTES\nPrimary objective: Implement secure Google/Apple sign-in linked by provider subject (sub), not by mutable email.\n\nRequired behavior:\n- verify OIDC token integrity and claims (iss/aud/exp + signature or equivalent trusted verification path)\n- identity key = (provider, provider_subject)\n- email used for UX and optional linking only when verified\n\nLinking policy:\n- if provider+subject exists -\u003e login existing user\n- if not exists and verified email maps exactly one user -\u003e link identity to that user\n- otherwise create account or fail-closed on ambiguity\n\nPitfalls:\n- account takeover via unverified email linking\n- accepting tokens with wrong audience or issuer\n\nVerification:\n- valid/invalid tokens\n- existing account linking\n- ambiguity conflict path with structured error.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:52:34.415752+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:23:08.21744+01:00","closed_at":"2026-02-12T21:23:08.21744+01:00","close_reason":"Implemented OIDC Google/Apple login+linking endpoint /v1/auth/oidc/{provider}/login with JWT verification via provider JWKS, issuer/audience checks, provider_subject linking in user_identities, and conflict-safe linking behavior. Added oauth web client seed migration 20260228000003_oauth_web_client.sql.","dependencies":[{"issue_id":"kura-training-qlc.4","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T20:52:34.416722+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.4","depends_on_id":"kura-training-qlc.1","type":"blocks","created_at":"2026-02-12T20:53:26.933442+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.4","depends_on_id":"kura-training-qlc.2","type":"blocks","created_at":"2026-02-12T20:53:32.129536+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc.5","title":"Break-Glass Re-Identifikation: Pflichtgrund, Ticket und unveraenderbares Audit","description":"Ermoegliche gezielte Rueckverfolgung user_id -\u003e PII nur fuer Incident/Support und nur kontrolliert. Problem heute: Es gibt keinen dedizierten Prozess, der notwendige Ausnahmezugriffe begruendet, begrenzt und revisionssicher protokolliert.","design":"Implementiere eingeschraenkten Admin-Support-Path (Endpoint oder CLI-Command) mit verpflichtenden Feldern reason, ticket_id, access_scope, expires_at. Jeder Zugriff schreibt einen immutable support_access_audit Eintrag. Standard-Debug- und Analysepfade bleiben pseudonymisiert und geben keine Email/Namen zurueck. Optional: feature flag fuer dual-control/approval in spaeteren Ausbaustufen.","acceptance_criteria":"1) Ohne reason/ticket kein Re-Identifikationszugriff. 2) Jeder Zugriff wird manipulationssicher auditiert. 3) Rueckgabe ist minimal (nur benoetigte PII). 4) Runbook fuer Incident/Support dokumentiert und testbar.","notes":"COMPACTION-SAFE EXECUTION NOTES\nPrimary objective: Controlled exceptional re-identification path (user_id -\u003e PII) with immutable auditing.\n\nRequired contract:\n- request must include reason + ticket_id + scope + expiry\n- every call writes immutable support_access_audit row\n- default operational endpoints remain pseudonymized\n\nSecurity model:\n- minimal data return\n- deny when required metadata missing\n- explicit admin capability check\n\nPitfalls:\n- hidden backdoor endpoints returning email directly\n- mutable/deletable audit rows\n\nVerification:\n- request rejected without reason/ticket\n- successful flow leaves audit trail\n- returned payload is minimal and scoped.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:52:47.686119+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:23:13.415432+01:00","closed_at":"2026-02-12T21:23:13.415432+01:00","close_reason":"Implemented audited break-glass re-identification: POST /v1/admin/support/reidentify in api/src/routes/account.rs with admin check, required reason/ticket/mode validation, immutable support_access_audit insert, and minimal identity response payload.","dependencies":[{"issue_id":"kura-training-qlc.5","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T20:52:47.687333+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.5","depends_on_id":"kura-training-qlc.1","type":"blocks","created_at":"2026-02-12T20:53:37.331252+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc.6","title":"Pseudonymisierte Lern- und Debug-Views fuer Systemverbesserung","description":"Sorge dafuer, dass Modellverbesserung und Debugging ohne Namensbezug funktionieren. Problem heute: Es gibt keine explizite analytics_subject_id Schicht, dadurch ist privacy-by-default fuer Lern-Workflows nicht sauber erzwungen.","design":"Fuehre analysis_subject_id als stabile pseudonyme Referenz ein (mapping zu user_id im separaten Bereich). Passe Analytics/Support-Queries und relevante Projektionen so an, dass standardmaessig nur analysis_subject_id ausgegeben wird. Definiere Redaction-Regeln fuer Freitextfelder in Debug-Exports.","acceptance_criteria":"1) Standard-Analysepfade funktionieren ohne direkte PII. 2) Trainingsdaten bleiben inhaltlich voll nutzbar (kein Informationsverlust fuer Modellverbesserung). 3) Exporte/Views enthalten keine Email/Namen. 4) Dokumentierte Query-Patterns fuer pseudonymisierte Auswertung vorhanden.","notes":"COMPACTION-SAFE EXECUTION NOTES\nPrimary objective: Keep learning/debug value while removing default person-linkability.\n\nRequired behavior:\n- standard analytics/debug outputs use analysis_subject_id\n- no plain email/name in default query/export paths\n- preserve raw training signal fidelity (no loss in reps/weight/timestamps etc.)\n\nImplementation hints:\n- add helper/mapping layer user_id -\u003e analysis_subject_id\n- update selected read endpoints or dedicated debug endpoints to emit pseudonymous subject\n- redact high-risk free-text fields in debug export mode\n\nPitfalls:\n- accidental exposure via nested JSON or legacy endpoints\n- unstable pseudonym ids breaking longitudinal analysis\n\nVerification:\n- before/after output diff: signal preserved, PII removed\n- deterministic/stable subject mapping across sessions.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:53:00.657812+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:23:18.614069+01:00","closed_at":"2026-02-12T21:23:18.614069+01:00","close_reason":"Implemented pseudonymized analysis/debug surfaces: added api/src/privacy.rs helper for stable analysis_subject_id, exposed GET /v1/account/analysis-subject, and added x-kura-analysis-subject header to events/projections read responses for default pseudonymous debugging.","dependencies":[{"issue_id":"kura-training-qlc.6","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T20:53:00.658656+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.6","depends_on_id":"kura-training-qlc.1","type":"blocks","created_at":"2026-02-12T20:53:42.527609+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.6","depends_on_id":"kura-training-qlc.5","type":"blocks","created_at":"2026-02-12T20:53:47.722285+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc.7","title":"Privacy/Auth v1 Hardening: OIDC re-login, device deny, deletion safety","description":"Harte Kanten in Privacy/Auth v1 schließen: OIDC-Re-Login ohne email-claim (Apple), echter Device-deny-Pfad, stabile analysis_subject-Erzeugung bei neuen Accounts, und DB-Deletion-Haertung fuer oauth_device_codes/support_access_audit.","design":"Gezielte Hardening-Aenderungen in API/CLI/Migrationen ohne Breaking Changes: oidc_login fail-closed fuer first-linking ohne verified email; bestehende provider-subject Links funktionieren auch ohne erneuten email-claim. Device verify erlaubt approve/deny mit poll-seitigem access_denied. Neue Migration entfernt support_access_audit FK-Cascade, setzt oauth_device_codes approved_user FK auf ON DELETE SET NULL und aktualisiert delete_user_account().","acceptance_criteria":"1) Existing OIDC subject links funktionieren ohne email claim; first-time linking verlangt verified email. 2) Device flow erzeugt realen denied-Status und CLI bekommt access_denied. 3) Neue Accounts erhalten analysis_subject deterministisch via insert-on-conflict path. 4) Account deletion blockiert nicht wegen oauth_device_codes; support_access_audit bleibt append-only ueber user deletion hinweg. 5) Alle verpflichtenden Quality-Gates gruen.","notes":"COMPACTION-SAFE NOTES\n\nZiel\n- Privacy-by-default Auth Identity v1 auf production-grade Robustheit haerten, ohne Verlust von Trainingssignal-Qualitaet.\n\nInvarianten\n- Identity-Key bleibt provider+subject; kein unsicheres Linking ueber unverified email.\n- Token und Scope Mechanik bleibt kompatibel zu bestehenden CLI/API Flows.\n- Break-glass Audit Historie bleibt append-only und ueberlebt Account-Loeschungen.\n\nNon-Goals\n- Kein kompletter Login Signup UI-Neubau.\n- Keine Aenderung am Event oder Projection Datenmodell fuer Trainingsinhalte.\n\nKonkrete Touchpoints\n- migrations/20260228000004_identity_privacy_hardening.sql\n- api/src/routes/auth.rs\n- api/src/privacy.rs\n- cli/src/commands/admin.rs\n\nTypische Pitfalls\n- Apple Re-Login kann ohne email claim kommen; bestehender subject-link darf nicht fehlschlagen.\n- Device denied nur im CLI zu behandeln reicht nicht; API muss status denied wirklich setzen.\n- FK Cascade auf Audit Tabellen kann Historie implizit loeschen.\n\nVerifikationsschritte\n- cargo fmt --all\n- cargo test --workspace\n- ruff check workers/src/ workers/tests/\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n\nReihenfolge Abhaengigkeiten\n- Migration Hardening zuerst, dann API Hardening OIDC Device, dann analysis_subject on-create Pfade, danach komplette Quality Gates.\n- Depends on kura-training-qlc.1 kura-training-qlc.3 kura-training-qlc.4 kura-training-qlc.5\n\nCOMPLETION NOTES\n\nGeaenderte Dateien\n- api/src/privacy.rs\n- api/src/routes/auth.rs\n- cli/src/commands/admin.rs\n- migrations/20260228000004_identity_privacy_hardening.sql\n\nTests und Ergebnisse\n- cargo fmt --all -\u003e OK\n- cargo test --workspace -\u003e OK (171 api + 19 cli + 10 core tests passed)\n- ruff check workers/src/ workers/tests/ -\u003e OK\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py -\u003e OK (570 passed)\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q -\u003e OK (80 passed)\n\nErgebnis\n- OIDC subject-linked accounts koennen ohne erneuten email claim einloggen; first-linking bleibt fail-closed auf verified email.\n- Device verify unterstuetzt approve und deny, und token polling liefert access_denied bei denied status.\n- Analysis subject IDs werden bei Register Admin-Create und OIDC-Login via insert-on-conflict abgesichert.\n- Account deletion wird nicht von oauth_device_codes blockiert; support_access_audit bleibt ohne FK-Cascade erhalten.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T21:47:42.016537+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:48:47.767976+01:00","closed_at":"2026-02-12T21:48:47.767976+01:00","close_reason":"Implemented hardening pass for OIDC re-login, device deny flow, analysis_subject on-create, and deletion/audit schema safety; all required quality gates passed.","dependencies":[{"issue_id":"kura-training-qlc.7","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T21:47:42.017829+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.7","depends_on_id":"kura-training-qlc.1","type":"blocks","created_at":"2026-02-12T21:47:42.018767+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.7","depends_on_id":"kura-training-qlc.3","type":"blocks","created_at":"2026-02-12T21:47:42.019461+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.7","depends_on_id":"kura-training-qlc.4","type":"blocks","created_at":"2026-02-12T21:47:42.020062+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.7","depends_on_id":"kura-training-qlc.5","type":"blocks","created_at":"2026-02-12T21:47:42.020663+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qll","title":"Go-Live: Realtime Surface Hardening (Token-Exposure)","description":"Realtime-Token-in-URL Risiko minimieren: Realtime deaktivieren falls ungenutzt oder Logging/Monitoring so haerten, dass Query-Strings und Tokens nie persistiert werden.","acceptance_criteria":"- Entscheidung dokumentiert: Realtime aus ODER aktiv mit abgesichertem Logging\n- Access-Logs, APM und Proxy-Logs maskieren URL-Querystrings/Authorization\n- Stichprobe in Logs zeigt keine Realtime/JWT-Token im Klartext\n- Scanner-Fund zu Realtime Token in URL ist behoben oder als akzeptiertes Restrisiko dokumentiert","status":"open","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T10:23:18.682869+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T10:24:03.98077+01:00"}
{"id":"kura-training-qqxh","title":"Fix kura-proxy healthcheck target port inside container","description":"Why: docker/compose.production.yml healthcheck probes http://127.0.0.1:8320/health inside the kura-proxy container, but nginx listens on container port 80. Result: proxy remains in health:starting/unhealthy despite serving traffic.\\n\\nWhat: update healthcheck to probe localhost on the actual container listen port and verify status transitions to healthy after deploy.\\n\\nAcceptance:\\n- proxy container reaches healthy state after deploy\\n- no false negatives from healthcheck","status":"closed","priority":2,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-21T12:21:00.068961+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T12:32:34.700955+01:00","closed_at":"2026-02-21T12:32:34.700955+01:00","close_reason":"No reproducible defect: proxy healthcheck on 127.0.0.1:8320 matches nginx listen port and container is healthy.","labels":["deploy","healthcheck","proxy"],"dependencies":[{"issue_id":"kura-training-qqxh","depends_on_id":"kura-training-21cw.1","type":"discovered-from","created_at":"2026-02-21T12:21:00.073649+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-r3jc","title":"Guard training_plan writes against empty name/sessions payloads","description":"Observed in prod user 019c4b87-1fc2-70d1-a4d3-ead28d47cd53: training_plan.created/updated events are persisted with empty plan_id/name and sessions=[], while notes imply concrete weekly prescription. Projection correctly falls back to name=unnamed and sessions_per_week=0, but this degrades downstream coaching quality and can be misread as frequency regression. Add validation/preflight (or advisory hard warning) in write-with-proof/event intake so training_plan writes require minimally coherent payload (plan_id stability, non-empty sessions for created, explicit naming or generated deterministic name). Keep backwards compatibility by warning + telemetry before hard reject if needed.","acceptance_criteria":"1) Invalid plan payloads are detected and surfaced with actionable message. 2) Existing valid plan writes unchanged. 3) Telemetry added for rejected/warned plan payloads. 4) Tests cover empty-name/empty-sessions cases.","status":"closed","priority":1,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-20T23:17:06.311727+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T23:34:02.403196+01:00","closed_at":"2026-02-20T23:34:02.403196+01:00","close_reason":"Implemented training_plan payload invariants, warning telemetry, deterministic naming fallback, and tests for empty name/sessions.","labels":["agent","training-plan","write-validation"]}
{"id":"kura-training-r7z","title":"Model Eval Harness: Replay, Calibration, und Shadow-Mode für Inference","description":"Create an evaluation harness for semantic resolution and Bayesian projections with offline replay, interval calibration metrics, error taxonomy, and shadow-mode rollout checks before enabling autonomous behavior changes.","notes":"Required for high-confidence innovation velocity without regressions.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T08:36:55.196745+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T12:43:51.514049+01:00","closed_at":"2026-02-11T12:43:51.514049+01:00","close_reason":"Implemented replay harness (projection_history + event_store), semantic + calibration metrics, inference telemetry taxonomy, shadow-mode rollout checks, and persistent eval run/artifact versioning with tests.","labels":["mlops","quality","testing"]}
{"id":"kura-training-rhp","title":"Web: Datenschutzhinweise und Nutzungsbedingungen (DE/EN) umgesetzt","description":"Analyse der realen Datenfluesse im Web/API und Ersetzung der Platzhaltertexte durch strukturierte, DSGVO-orientierte Datenschutzhinweise sowie Nutzungsbedingungen in Deutsch und Englisch.","acceptance_criteria":"- /datenschutz und /nutzungsbedingungen sind vollstaendig\\n- Inhalte DE+EN vorhanden\\n- Build und Quality-Gates erfolgreich","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T18:22:51.984923+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T18:22:52.113788+01:00","closed_at":"2026-02-16T18:22:52.113788+01:00","close_reason":"Closed"}
{"id":"kura-training-rod","title":"Plan-vs-Ist Vergleich ermöglichen","description":"Agent muss wissen: Welches Training steht als nächstes an? Was wurde diese Woche schon gemacht? Aktuell muss er Plan + training_timeline manuell abgleichen. Mögliche Lösungen: (1) training_timeline bekommt sessions_this_week Feld mit Plan-Matching, (2) Agent-seitige Komposition aus Plan + Timeline (dann braucht es den Snapshot-Endpoint). Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:58.427759+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:41:04.547731+01:00","closed_at":"2026-02-10T07:41:04.547731+01:00","close_reason":"By design gelöst: Snapshot-Endpoint + recent_sessions mit Top-Sets + training_plan geben dem Agent alle Daten für Plan-vs-Ist. Agent-seitige Komposition ist hier die bessere Architektur als Cross-Dimension-Coupling.","dependencies":[{"issue_id":"kura-training-rod","depends_on_id":"kura-training-7an","type":"blocks","created_at":"2026-02-09T21:43:06.797537+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-s6ya","title":"Seed objective surfaces for users without events","notes":"Ensure users without any events still get objective_state/objective_advisory defaults via objective_backfill + synthetic profile.updated and handler default seeding.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T22:43:12.350676+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T22:57:58.177695+01:00","closed_at":"2026-02-20T22:57:58.177695+01:00","close_reason":"Closed","labels":["migration","objective","projection"]}
{"id":"kura-training-s9z","title":"Rate Limiting on auth endpoints","description":"Add rate limiting to /v1/auth/register, /v1/auth/authorize, and /v1/auth/token to prevent brute-force attacks. Production security requirement.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T11:00:00.753215+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T11:16:10.39203+01:00","closed_at":"2026-02-08T11:16:10.39203+01:00","close_reason":"Closed"}
{"id":"kura-training-si42","title":"Cleanup Impl: Eval semantic event set in zentrale Registry","description":"Kontext: eval_harness nutzt für Semantic-Label-Fetch noch einen lokalen hardcodierten Event-Typ-Satz. Warum: Event-Drift-Risiko und inkonsistente Wartung gegenüber der zentralen Inference-Registry. Wie: EVAL_SEMANTIC_EVENT_TYPES in inference_event_registry ergänzen und alle eval_harness-Semantic-Selektoren auf diese Konstante umstellen; Architektur-/Unit-Tests anpassen.","acceptance_criteria":"Kein hardcodierter Semantic-Event-Satz in eval_harness; zentrale Konstante wird verwendet; Tests und Gates grün.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T16:49:01.293476+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:51:44.007113+01:00","closed_at":"2026-02-19T16:51:44.007113+01:00","close_reason":"Closed"}
{"id":"kura-training-siq","title":"Antifragile Reliability V1: Root-Cause Defenses against User/Model Variance","description":"Address reliability as a systems problem (not case-by-case patching). Goal: make Kura robust under 1000 users x 1000 communication styles via executable contracts, adversarial testing, and runtime degradation strategies.","design":"Use proven software engineering patterns together: (1) property-based/fuzz testing for conversation-\u003eevent contracts, (2) schema capability gates + fail-fast/fail-soft runtime controls, (3) typed certainty state machine (confirmed/inferred/unresolved) enforced by server contracts, (4) semantic comparability model for load/equipment context, (5) incident-\u003etest auto-promotion to continuously harden unknown unknowns.","acceptance_criteria":"1) Reliability strategy documented as executable architecture work-items, not prose only. 2) Core failure classes (certainty inflation, semantic comparability drift, projection/schema mismatch, pending-verification ambiguity) each have implementation tracks with measurable outcomes. 3) Rollout order and dependency graph defined. 4) At least one transcript-derived scenario is mapped into regression assets. 5) Work remains compatible with wvp/m3k roadmap and does not bypass existing safety invariants.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:41:01.071917+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T07:21:48.058267+01:00","closed_at":"2026-02-14T07:21:48.058267+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-siq","depends_on_id":"kura-training-2zc","type":"blocks","created_at":"2026-02-13T12:41:01.073445+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq","depends_on_id":"kura-training-wvp.3","type":"blocks","created_at":"2026-02-13T12:41:01.074483+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1","title":"Adversarial Conversation Fuzzing Harness for Agent Write Contracts","description":"Build a generator-driven test harness that produces diverse user utterances, ambiguity, contradictions, locale variants, and correction patterns, then validates conversation-to-event behavior against invariants.","design":"Adopt property-based testing and metamorphic testing principles. Generate multilingual and noisy utterance variants, execute write-with-proof flows, and assert invariant properties (no false saved claim, bounded clarification count, deterministic correction behavior, no silent certainty escalation). Store failing seeds as permanent regression fixtures.","acceptance_criteria":"1) Harness generates randomized scenarios with reproducible seeds. 2) Core invariants are codified as machine assertions. 3) CI runs deterministic seed sets and fails on invariant violations. 4) Failing seeds auto-export into scenario fixtures for m3k.3. 5) Coverage report includes ambiguity, contradiction, and correction classes.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:41:32.598862+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:11:52.090922+01:00","closed_at":"2026-02-13T14:11:52.090922+01:00","close_reason":"All 6 sub-tasks complete. 80 fuzzing tests across 3 layers.","dependencies":[{"issue_id":"kura-training-siq.1","depends_on_id":"kura-training-siq","type":"parent-child","created_at":"2026-02-13T12:41:32.599715+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1","depends_on_id":"kura-training-m3k.3","type":"blocks","created_at":"2026-02-13T12:41:32.600859+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1","depends_on_id":"kura-training-veh","type":"blocks","created_at":"2026-02-13T12:41:32.601736+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1.1","title":"Foundation: contracts, strategies, assertions, conftest, deps","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:57:58.990625+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:02:52.68907+01:00","closed_at":"2026-02-13T14:02:52.68907+01:00","close_reason":"Foundation: contracts.py, strategies.py, assertions.py, conftest.py, hypothesis+httpx deps","dependencies":[{"issue_id":"kura-training-siq.1.1","depends_on_id":"kura-training-siq.1","type":"parent-child","created_at":"2026-02-13T13:57:58.991848+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1.2","title":"Layer 1 Core Invariants: set, retraction, correction, rules","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:58:04.2575+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:06:19.705881+01:00","closed_at":"2026-02-13T14:06:19.705881+01:00","close_reason":"31 property tests: set, retraction, correction, rules, plausibility","dependencies":[{"issue_id":"kura-training-siq.1.2","depends_on_id":"kura-training-siq.1","type":"parent-child","created_at":"2026-02-13T13:58:04.258897+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.2","depends_on_id":"kura-training-siq.1.1","type":"blocks","created_at":"2026-02-13T13:58:35.613467+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1.3","title":"Layer 1 Advanced Invariants: certainty, workflow, cross-field","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:58:09.522177+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:06:24.884832+01:00","closed_at":"2026-02-13T14:06:24.884832+01:00","close_reason":"9 property tests: certainty matrix, workflow gate, timezone, RPE+RIR, similarity, free-form","dependencies":[{"issue_id":"kura-training-siq.1.3","depends_on_id":"kura-training-siq.1","type":"parent-child","created_at":"2026-02-13T13:58:09.524277+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.3","depends_on_id":"kura-training-siq.1.1","type":"blocks","created_at":"2026-02-13T13:58:40.792066+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1.4","title":"Layer 2 LLM Adversarial: scenarios, generator, runner","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:58:14.764744+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:10:38.512331+01:00","closed_at":"2026-02-13T14:10:38.512331+01:00","close_reason":"21 built-in scenarios + LLM generator + runner, category tests","dependencies":[{"issue_id":"kura-training-siq.1.4","depends_on_id":"kura-training-siq.1","type":"parent-child","created_at":"2026-02-13T13:58:14.765675+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.4","depends_on_id":"kura-training-siq.1.2","type":"blocks","created_at":"2026-02-13T13:58:45.985876+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1.5","title":"Layer 3 Transcript Pipeline: fixtures, replay, promotion","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:58:20.000697+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:10:43.675573+01:00","closed_at":"2026-02-13T14:10:43.675573+01:00","close_reason":"13 fixture tests + replay pipeline + promotion mechanism","dependencies":[{"issue_id":"kura-training-siq.1.5","depends_on_id":"kura-training-siq.1","type":"parent-child","created_at":"2026-02-13T13:58:20.001776+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.5","depends_on_id":"kura-training-siq.1.1","type":"blocks","created_at":"2026-02-13T13:58:51.170852+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1.6","title":"CI Integration + Documentation","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:58:25.249234+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:11:32.955649+01:00","closed_at":"2026-02-13T14:11:32.955649+01:00","close_reason":"pytest markers, run-fuzzing.sh script, CI-ready","dependencies":[{"issue_id":"kura-training-siq.1.6","depends_on_id":"kura-training-siq.1","type":"parent-child","created_at":"2026-02-13T13:58:25.250651+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.6","depends_on_id":"kura-training-siq.1.2","type":"blocks","created_at":"2026-02-13T13:58:56.358007+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.6","depends_on_id":"kura-training-siq.1.3","type":"blocks","created_at":"2026-02-13T13:59:01.536439+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.6","depends_on_id":"kura-training-siq.1.4","type":"blocks","created_at":"2026-02-13T13:59:06.732621+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.6","depends_on_id":"kura-training-siq.1.5","type":"blocks","created_at":"2026-02-13T13:59:11.953662+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.2","title":"Certainty State Machine Contract V1 (confirmed/inferred/unresolved)","description":"Enforce certainty as a typed state machine across ingestion, write-with-proof response, and projection consumers so subjective fields cannot be presented as confirmed without explicit evidence.","design":"Introduce contract-level certainty states with allowed transitions and required evidence metadata per transition. Make inferred subjective values fail-closed unless backed by explicit provenance and evidence references. Add server-side rejection paths and machine-readable reason codes for invalid transitions.","acceptance_criteria":"1) Certainty states and transitions are specified and enforced server-side. 2) session.completed subjective fields cannot be persisted as confirmed without explicit user-confirmed provenance. 3) Invalid certainty transitions return machine-readable policy errors. 4) Regression tests cover guessed-feedback and contradiction cases. 5) Reliability UX output is generated from state machine outputs, not ad-hoc phrasing.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:41:37.827525+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:14:23.94324+01:00","closed_at":"2026-02-13T13:14:23.94324+01:00","close_reason":"Implemented in d126707","dependencies":[{"issue_id":"kura-training-siq.2","depends_on_id":"kura-training-siq","type":"parent-child","created_at":"2026-02-13T12:41:37.829228+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.2","depends_on_id":"kura-training-wvp.1","type":"blocks","created_at":"2026-02-13T12:41:37.830484+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.2","depends_on_id":"kura-training-wvp.3","type":"blocks","created_at":"2026-02-13T12:41:37.831391+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.3","title":"Schema Capability Gate + Migration Parity Guardrails","description":"Prevent projection/runtime failures caused by partial schema rollout (for example missing external_import_jobs) by introducing schema capability checks and deployment parity gates.","design":"At startup and in health endpoints, validate required table/index capabilities per enabled handler. Add deployment preflight that blocks rollout when migration version and runtime handler requirements diverge. Define fail behavior per criticality: fail-fast for core handlers, explicit degrade mode with telemetry for optional capabilities.","acceptance_criteria":"1) Worker/API expose schema capability report with machine-readable missing requirements. 2) Deployment preflight blocks mismatch between required and applied migrations. 3) Dead-job flood from missing schema dependencies is prevented. 4) quality_health and training_timeline behavior is deterministic under missing optional tables. 5) Runbook documents recovery and replay path.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:41:43.038284+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:14:23.945228+01:00","closed_at":"2026-02-13T13:14:23.945228+01:00","close_reason":"Implemented in d126707","dependencies":[{"issue_id":"kura-training-siq.3","depends_on_id":"kura-training-siq","type":"parent-child","created_at":"2026-02-13T12:41:43.039161+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.3","depends_on_id":"kura-training-4sv","type":"blocks","created_at":"2026-02-13T12:41:43.040263+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.4","title":"Load Context Contract V1: Equipment and Comparability Semantics","description":"Model load comparability explicitly so machine-based and free-weight sets are not silently merged into the same progression stream.","design":"Add structured load context dimensions (implements_type, movement_constraint, equipment_profile, location_class, comparability_group). Define comparability rules and confidence semantics for aggregation boundaries. Expose machine-readable reason codes when comparisons are down-scoped or blocked.","acceptance_criteria":"1) set logging contract includes structured load context with conservative defaults. 2) exercise progression aggregation honors comparability boundaries. 3) System emits explicit uncertainty when cross-context comparison is weak or invalid. 4) Tests cover smith vs barbell and cross-location machine variance. 5) UX guidance prompts minimal extra user burden while preserving data integrity.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:41:48.266478+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:14:23.946425+01:00","closed_at":"2026-02-13T13:14:23.946425+01:00","close_reason":"Implemented in d126707","dependencies":[{"issue_id":"kura-training-siq.4","depends_on_id":"kura-training-siq","type":"parent-child","created_at":"2026-02-13T12:41:48.26735+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.4","depends_on_id":"kura-training-m3k.3","type":"blocks","created_at":"2026-02-13T12:41:48.268721+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.5","title":"exercise_progression Re-key on set.corrected exercise_id Changes","description":"Fix projection key consistency when set.corrected changes exercise_id. Current behavior can keep corrected sets under the old projection key, which defeats semantic separation and pollutes progression trends.","design":"When correction modifies exercise identity, recompute and reconcile both source and target canonical keys. Ensure projection key equals effective post-correction exercise_id. Add migration-safe backfill path for already polluted projections and deterministic conflict handling.","acceptance_criteria":"1) Corrected exercise_id causes data to move to the correct projection key. 2) Old key projection is cleaned or recomputed consistently. 3) No duplicate counting across old/new keys. 4) Regression tests cover multi-set corrections in one session. 5) Existing unaffected projections remain unchanged.","status":"closed","priority":1,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:41:53.489991+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:14:23.947492+01:00","closed_at":"2026-02-13T13:14:23.947492+01:00","close_reason":"Implemented in d126707","dependencies":[{"issue_id":"kura-training-siq.5","depends_on_id":"kura-training-siq","type":"parent-child","created_at":"2026-02-13T12:41:53.490802+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.5","depends_on_id":"kura-training-siq.4","type":"blocks","created_at":"2026-02-13T12:41:53.492051+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.6","title":"Proof-in-Production V1: Stakeholder-Entscheidungsartefakte aus Eval/Gates","description":"Warum:\nMaschinenlesbare Eval-Reports existieren, aber es fehlt ein konsistentes Stakeholder-Artefakt („proof in production“), das Rollout-Entscheidungen transparent macht.\n\nScope:\n- Aus Shadow-Eval, Reliability- und Gate-Daten ein standardisiertes Entscheidungsartefakt erzeugen.\n- Artefakt in maschinenlesbarer Form und stakeholder-lesbarer Kurzform bereitstellen.\n- Klare Pflichtsektionen: Entscheidung, Risiken, fehlende Daten, nächste Schutzmaßnahmen.\n\nWas muss gelten:\n- Report lässt sich automatisiert erzeugen und diffen.\n- Rollout-Entscheidung ist anhand klarer Felder auditierbar.\n\nNicht-Ziele:\n- Kein neues Dashboard-Frontend in diesem Task.\n\nImplementierungsanker:\n- workers/src/kura_workers/eval_harness.py\n- docs/reports/\n- scripts/ (Report-Entry)\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst Report-Schema und Generator-Entrypoint lesen, danach mit Sample-Daten einen vollständigen Report bauen und gegen Erwartungen prüfen.\n","design":"Build for agents + humans + stakeholders: gleiche Datenbasis, unterschiedliche Darstellungen.","acceptance_criteria":"1) Standardisiertes Entscheidungsartefakt wird automatisiert erzeugt (maschinenlesbar + stakeholder-lesbare Kurzform). 2) Artefakt enthält mindestens: Gate-Status, Hauptgründe, fehlende Daten, empfohlene nächste Schritte. 3) Generator ist testbar und reproduzierbar.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:12:50.315661+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T06:33:33.657987+01:00","closed_at":"2026-02-14T06:33:33.657987+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-siq.6","depends_on_id":"kura-training-siq","type":"parent-child","created_at":"2026-02-13T20:12:50.316687+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.6","depends_on_id":"kura-training-wvp.4","type":"blocks","created_at":"2026-02-13T20:12:55.518873+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-sn6","title":"Email: Invite-Benachrichtigung bei Approval","description":"## Was\nAutomatische Email an User wenn Access Request approved wird. Vom ersten Tag an funktionsfähig.\n\n## Technologie\nResend (resend.com) — einfachste Integration, gute Free Tier (100 emails/day), Rust SDK verfügbar.\nAlternative: Postmark oder direkt SMTP.\n\n## Trigger\nBei POST /v1/admin/access-requests/{id}/approve:\n- Nach Token-Generierung → Email an Request-Email senden\n- Async (nicht blockierend für die API-Response)\n\n## Email-Inhalt\nSubject DE: \"Dein Zugang zu Kura\"\nSubject EN: \"Your access to Kura\"\n\nBody (schlicht, persönlich, kein Marketing):\n---\nHallo {name},\n\ndu hast Zugang zu Kura.\n\nErstelle dein Konto hier: {invite_url}\n\nDer Link ist 7 Tage gültig.\n\nKura ist in aktiver Entwicklung. Als Early-Access-Nutzer hilfst du dabei,\ndas System besser zu machen. Deine Trainingsdaten fließen anonymisiert\nin die Verbesserung der Algorithmen ein.\n\nFragen? Antworte einfach auf diese Email.\n\n— Kura\n---\n\n## Config\n- RESEND_API_KEY (oder SMTP_HOST + SMTP_USER + SMTP_PASS als Fallback)\n- EMAIL_FROM: \"Kura \u003ckura@domain.tld\u003e\"\n- FRONTEND_URL: für invite_url Konstruktion\n\n## Fehlerbehandlung\n- Email-Versand schlägt fehl → loggen, aber Approval NICHT rückgängig machen\n- Admin sieht in Response ob Email erfolgreich war\n- Response: { \"status\": \"approved\", \"invite_token\": \"...\", \"email_sent\": true|false }\n\n## Kein Overdesign\n- Plain text Email, kein HTML-Template\n- Kein Tracking, keine Pixel\n- Reply-to auf eine echte Adresse","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:46:18.539887+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:03:48.62917+01:00","closed_at":"2026-02-13T13:03:48.62917+01:00","close_reason":"Resend email on approval, plain text, async","dependencies":[{"issue_id":"kura-training-sn6","depends_on_id":"kura-training-0yc","type":"blocks","created_at":"2026-02-13T12:47:16.340324+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-sn6","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:57.773217+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-sq5","title":"Post-Go-Live: Security Re-Scan + Befundreport","description":"Nach Umsetzung aller Hardening-Massnahmen den Security-Scan erneut ausfuehren und Findings in einem Report gegenueberstellen (vorher/nachher).","acceptance_criteria":"- Re-Scan mit identischem Tooling/Scope ausgefuehrt\n- Ergebnisreport in docs/reports/ mit Datum erstellt\n- Fuer verbleibende Findings: Root Cause + Entscheidung (fix/accept/defer) dokumentiert\n- Kritische und hohe Findings sind 0 oder mit begruendeter Ausnahme freigegeben","status":"open","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-16T10:23:30.140524+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-16T10:24:04.099864+01:00"}
{"id":"kura-training-svc","title":"Extend eval harness to causal_inference","description":"Add causal_inference support to offline evaluation pipeline: extend projection type allow-lists in workers/src/kura_workers/eval_harness.py and workers/src/kura_workers/eval_cli.py, add causal artifact persistence support in migrations (inference_eval_artifacts projection_type check), and define causal calibration/quality metrics with thresholds for shadow-mode gating.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T14:42:55.196987+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T15:11:01.594114+01:00","closed_at":"2026-02-11T15:11:01.594114+01:00","close_reason":"Closed","labels":["causal","mlops","testing"]}
{"id":"kura-training-syn","title":"Semantic Resolve API Endpoint","description":"Add dedicated semantic resolution endpoint(s) so agents can submit free-text terms and receive ranked canonical candidates (exercise/food) with confidence bands and provenance. Use semantic_memory + embeddings backend.","notes":"Foundation exists; API contract missing.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T09:04:52.382559+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T09:31:10.425371+01:00","closed_at":"2026-02-11T09:31:10.425371+01:00","close_reason":"Semantic Resolve endpoint mit Tests und Doku umgesetzt","labels":["agent-interface","api","semantic"]}
{"id":"kura-training-tct","title":"Projection-Output-Schemas in system_config","description":"Handler deklarieren ihre Projection-Output-Felder in dimension_meta (output_schema). build_system_config() sammelt sie ein und liefert sie über GET /v1/system/config aus. Damit weiß der Agent sofort welche Felder eine Projection hat, ohne raten zu müssen. Beispiel: exercise_progression hat estimated_1rm, total_sets, weekly_history[].estimated_1rm, etc.","notes":"Entstanden aus Agent-Walkthrough (2026-02-10): Agent konnte Projection-Daten nicht lesen weil Feldnamen unbekannt (estimated_1rm vs personal_records.best_estimated_1rm.value). Jeder Handler hat bereits dimension_meta in handlers/*.py. Erweitern um output_schema dict. build_system_config() in system_config.py sammelt es ein. Dann in GET /v1/system/config sichtbar. Kein API-Change nötig, nur Worker-seitig.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T19:47:37.322685+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T20:16:13.947751+01:00","closed_at":"2026-02-10T20:16:13.947751+01:00","close_reason":"Closed"}
{"id":"kura-training-tf1z","title":"Morning Readiness Check-in v1: schnell, optional vertieft, robust","description":"Warum: Der aktuelle Morning-Flow soll schnell bleiben (niedrige Reibung), aber bei Bedarf mehr Kontext erlauben (HRV/Lifestyle/Condition), ohne die UX zu verschlechtern. Zusätzlich soll Yesterday-Load nicht manuell doppelt abgefragt werden, wenn Trainingsdaten bereits vorliegen.\\n\\nWas: Einführung eines klaren Morning-Check-in-Vertrags mit Pflichtkern (Bodyweight, Sleep, Soreness, Motivation), optionalen Feldern und deterministischer Parsing-/Fallback-Logik. Session-RPE soll als Post-Session-Follow-up systematisch eingefordert werden, falls nach Logging noch offen.\\n\\nWie: (1) formaler Contract + registrierte Event-Types, (2) deterministischer Compact-Input-Parser mit Safety-Validierung, (3) automatische Yesterday-Load-Ableitung aus vorhandenen Events, (4) Agenda/Follow-up-Regeln für fehlendes Session-Feedback, (5) Architektur- und Runtime-Tests als dauerhafte Invarianten.","acceptance_criteria":"Morning-Check-in-Contract ist systemweit maschinenlesbar; Compact-Input wird deterministisch geparst und validiert; Yesterday-Load wird bei vorhandenen Logs automatisch abgeleitet; fehlendes Session-RPE erzeugt gezieltes Follow-up statt stiller Lücke; alle relevanten Architektur- und Runtime-Tests sind grün","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T08:09:10.40816+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T18:08:32.367286+01:00","closed_at":"2026-02-20T18:08:32.367286+01:00","close_reason":"Closed"}
{"id":"kura-training-tf1z.1","title":"Contract \u0026 Registry: Morning-Check-in formalisieren","description":"Warum: Ohne formalen Contract entstehen Drift, unklare Feldbedeutungen und fragile Agent-Implementierungen.\\n\\nWie: Event-/Conventions-Vertrag für Morning-Check-in und optionale Tags ergänzen; formale Event-Type-Registrierung für write-with-proof sicherstellen; Health-Consent-/Projection-Impact-Pfade konsistent halten; Architekturtests für Contract-Pinning ergänzen.","acceptance_criteria":"Event-Conventions enthalten Morning-Check-in-Contract inkl. Pflicht/Optional-Feldern; write-with-proof akzeptiert registrierte Morning-Events; Contract ist über Architekturtests gepinnt","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T08:09:10.521237+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T18:07:51.218659+01:00","closed_at":"2026-02-20T18:07:51.218659+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-tf1z.1","depends_on_id":"kura-training-tf1z","type":"parent-child","created_at":"2026-02-20T08:09:10.524957+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tf1z.2","title":"Deterministischer Daily-Parser für schnelle Chat-Eingaben","description":"Warum: Reine freie Extraktion ist langsam/fragil bei kompakten Antworten. Deterministische Parser senken Fehlerquote und verbessern UX.\\n\\nWie: Compact-Eingaben (z. B. positional + label-basierte Kurzform) deterministisch normalisieren, validieren, eindeutig auf Event-Payloads mappen, bei Ambiguität auf gezielte Single-Question-Fallbacks gehen.","acceptance_criteria":"Parser verarbeitet kompakte Eingaben robust; Grenzfälle sind durch Tests abgedeckt; invalid/ambiguous Inputs führen zu klaren Fallbacks statt stiller Fehlzuordnung","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T08:09:10.63238+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T18:08:01.519985+01:00","closed_at":"2026-02-20T18:08:01.519985+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-tf1z.2","depends_on_id":"kura-training-tf1z","type":"parent-child","created_at":"2026-02-20T08:09:10.63353+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tf1z.2","depends_on_id":"kura-training-tf1z.1","type":"blocks","created_at":"2026-02-20T08:09:10.945288+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tf1z.3","title":"Automatische Yesterday-Load-Ableitung + Session-RPE-Follow-up","description":"Warum: Der User soll Trainingshärte von gestern nicht doppelt eingeben müssen. Fehlendes Session-RPE soll systematisch geschlossen werden.\\n\\nWie: Yesterday-Load aus vorhandenen session/set-Daten ableiten (inkl. Rest-Fall bei keiner Session); Session-RPE-Lücke als Agenda/Follow-up-Signal modellieren; kein morgendlicher Pflichtblocker bei fehlendem optionalem Kontext.","acceptance_criteria":"Yesterday-Load wird aus Logs korrekt als Rest/Easy/Average/Hard abgeleitet; fehlendes Session-RPE erscheint als Follow-up-Signal; bestehende Flows regressionsfrei","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T08:09:10.744055+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T18:08:11.821047+01:00","closed_at":"2026-02-20T18:08:11.821047+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-tf1z.3","depends_on_id":"kura-training-tf1z","type":"parent-child","created_at":"2026-02-20T08:09:10.747008+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tf1z.3","depends_on_id":"kura-training-tf1z.1","type":"blocks","created_at":"2026-02-20T08:09:11.031509+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tf1z.4","title":"Readiness-Integration \u0026 Testhärtung (Architecture + Runtime)","description":"Warum: Neue Morning-Signale müssen konsistent in Readiness-/Observation-Pfade einlaufen und dauerhaft durch CI abgesichert sein.\\n\\nWie: Signal-Normalisierung/Readiness-Pfade um neue Morning-Signale ergänzen, optionale Felder sauber als optional behandeln, Architekturtests (Was muss gelten) und Runtime-Tests (Wie es läuft) ergänzen.","acceptance_criteria":"Readiness/Open-Observation-Verhalten für Morning-Signale ist testbar und stabil; Architecture-Tests dokumentieren Invarianten; Runtime-Tests validieren End-to-End-Verhalten","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-20T08:09:10.859273+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T18:08:22.093055+01:00","closed_at":"2026-02-20T18:08:22.093055+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-tf1z.4","depends_on_id":"kura-training-tf1z","type":"parent-child","created_at":"2026-02-20T08:09:10.862249+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tf1z.4","depends_on_id":"kura-training-tf1z.1","type":"blocks","created_at":"2026-02-20T08:09:11.116159+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tf1z.4","depends_on_id":"kura-training-tf1z.2","type":"blocks","created_at":"2026-02-20T08:09:11.193838+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tf1z.4","depends_on_id":"kura-training-tf1z.3","type":"blocks","created_at":"2026-02-20T08:09:11.273716+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5","title":"External Connector Readiness: Garmin/Strava/TrainingPeaks","description":"Bereite Kura backend-seitig so vor, dass externe Trainingsdatenquellen (zuerst Datei-Import, später API-Connectors) sauber, nützlich und ohne Datenchaos integriert werden können. Fokus: canonical data model, source-aware ingestion, idempotente Verarbeitung, verlässliche Projektionen.","design":"Launch-Strategie: Phase 1 file-based import (FIT/TCX/GPX) + provider-agnostic backend contract. Phase 2 offizielle API-Connector (Strava/Garmin/TrainingPeaks) auf denselben Ingestion-Kern. Alle provider-spezifischen Unterschiede werden in Mappern gekapselt, nicht in Core-Projektionen.","acceptance_criteria":"1) Epic enthält vollständige Task-Kette von Datenmodell bis Rollout. 2) Backend kann externe Daten source-aware und idempotent verarbeiten. 3) Provider-spezifische Implementierungen können später ohne Core-Bruch ergänzt werden. 4) Qualitätssignale und Invarianten verhindern stilles Datenchaos.","notes":"Session handoff 2026-02-13: Connector-readiness child chain is complete. Operational production cutover dependencies are tracked in kura-training-4sv. Keep this epic closed once rollout-hardening validates deployment environment.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:10.628877+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:56:33.851588+01:00","closed_at":"2026-02-13T09:56:33.851588+01:00","close_reason":"Connector-readiness chain complete; rollout execution tracked in kura-training-4sv"}
{"id":"kura-training-tm5.1","title":"Canonical External Activity Contract v1","description":"Definiere ein provider-unabhängiges Canonical Contract für externe Trainingsaktivitäten inkl. Pflicht-/Optional-Feldern, Source-Metadaten und Provenance.","design":"Contract mit stabilen Feldern für session/set/workout + source layer (provider, provider_user_id, external_activity_id, external_event_version, ingestion_method).","acceptance_criteria":"1) Contract v1 dokumentiert und versioniert. 2) Pflicht-/Optional-Felder klar. 3) Provenance-Felder vorhanden. 4) Tests für Contract-Validierung implementiert.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:10.748901+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:11:24.960146+01:00","closed_at":"2026-02-12T08:11:24.960146+01:00","close_reason":"Implemented canonical external activity contract v1 with required/optional source/session/set/workout/provenance fields, design doc, and validation tests.","dependencies":[{"issue_id":"kura-training-tm5.1","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:10.749781+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.2","title":"Provider Adapter Interface + Ingestion Envelope","description":"Baue ein einheitliches Adapter-Interface, über das Garmin/Strava/TrainingPeaks später andocken können, ohne Core-Logik zu duplizieren.","design":"Adapter liefern normalisierte Envelope-Events (raw payload refs + canonical draft + mapping metadata + validation report).","acceptance_criteria":"1) Adapter-Interface stabil definiert. 2) Envelope-Format implementiert. 3) Dummy-Adapter-Tests vorhanden. 4) Core-Ingestion ist provider-agnostic.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:10.867477+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:16:32.250654+01:00","closed_at":"2026-02-12T08:16:32.250654+01:00","close_reason":"Implemented stable provider adapter interface, ingestion envelope v1, dummy adapters, validation-report handling, and provider-agnostic ingestion preparation with tests.","dependencies":[{"issue_id":"kura-training-tm5.2","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:10.868353+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.2","depends_on_id":"kura-training-tm5.1","type":"blocks","created_at":"2026-02-11T21:56:11.798505+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.3","title":"Source Identity, Idempotency und Dedup Engine","description":"Verhindere doppelte oder widersprüchliche Imports durch source-aware Identity und idempotente Write-Pfade.","design":"Composite identity keys, replay-safe ingestion, duplicate policy (exact duplicate, partial overlap, update version).","acceptance_criteria":"1) Idempotency-Key-Strategie implementiert. 2) Duplicate-Erkennung mit klaren Outcomes. 3) Update-vs-new Regeln definiert. 4) Regressionstests für Mehrfachimporte vorhanden.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:10.987878+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:14:17.376847+01:00","closed_at":"2026-02-12T08:14:17.376847+01:00","close_reason":"Implemented source identity keying, replay-safe external idempotency keys, duplicate policy outcomes (exact/partial/update/stale/conflict), plus regression tests for repeated imports.","dependencies":[{"issue_id":"kura-training-tm5.3","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:10.988848+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.4","title":"Temporal Normalization: Timezone, Device Drift, Session Boundaries","description":"Normalisiere externe Zeitdaten robust, damit Sessions/Trends korrekt bleiben (Zeitzonenwechsel, Uhrdrift, Tagesgrenzen).","design":"Canonical timestamp policy + timezone fallback + boundary rules für overnight/long sessions.","acceptance_criteria":"1) Zeit-Normalisierungsregeln dokumentiert. 2) Device-/Provider-Zeitkonflikte behandelt. 3) Session-Boundary-Tests vorhanden. 4) Keine Datumsdrift in Projektionen.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:11.105277+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T07:51:51.734622+01:00","closed_at":"2026-02-12T07:51:51.734622+01:00","close_reason":"Implemented canonical temporal normalization (timezone fallback, drift/conflict handling, overnight/long-session fallback boundaries), integrated into timezone-based projections, added design doc + unit/integration coverage.","dependencies":[{"issue_id":"kura-training-tm5.4","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:11.106251+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.5","title":"Garmin/Strava/TrainingPeaks Field Mapping Matrix","description":"Erstelle eine gepflegte Mapping-Matrix je Provider auf das Canonical Contract, inklusive Verlust-/Unsicherheitskennzeichnung.","design":"Mapping-Tabelle pro Feld: source path, transform, unit conversion, confidence/provenance, unsupported behavior.","acceptance_criteria":"1) Mapping-Matrix für Garmin/Strava/TrainingPeaks v1 vorhanden. 2) Unit-Konvertierungen definiert. 3) Unsupported-Felder explizit markiert. 4) Mapping-Tests mit Beispielpayloads implementiert.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:11.221081+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:18:53.985713+01:00","closed_at":"2026-02-12T08:18:53.985713+01:00","close_reason":"Added v1 provider mapping matrices for Garmin/Strava/TrainingPeaks with explicit unit conversions, unsupported field handling, provenance wiring, and example payload tests.","dependencies":[{"issue_id":"kura-training-tm5.5","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:11.221959+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.5","depends_on_id":"kura-training-tm5.1","type":"blocks","created_at":"2026-02-11T21:56:11.890439+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.6","title":"Import Pipeline V1 (FIT/TCX/GPX) mit Async Jobs","description":"Implementiere file-based Import als Launch-fähigen Einstieg, der denselben Core wie spätere API-Connector nutzt.","design":"Upload -\u003e parse -\u003e map -\u003e validate -\u003e write-with-proof -\u003e projection refresh; mit retry/backoff und Job-Receipts.","acceptance_criteria":"1) FIT/TCX/GPX Import-End-to-End läuft. 2) Job-Status/Receipts verfügbar. 3) Fehlertypen klar klassifiziert. 4) Idempotenter Re-Import möglich.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:11.337655+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:27:25.532056+01:00","closed_at":"2026-02-12T08:27:25.532056+01:00","close_reason":"Implemented FIT/TCX/GPX async import pipeline with external_import job table, queue/status API endpoints, parser/mapping/validation/dedup/write flow, classified errors, receipts, and idempotent re-import handling.","dependencies":[{"issue_id":"kura-training-tm5.6","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:11.338713+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.6","depends_on_id":"kura-training-tm5.2","type":"blocks","created_at":"2026-02-11T21:56:12.079072+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.6","depends_on_id":"kura-training-tm5.3","type":"blocks","created_at":"2026-02-11T21:56:12.267779+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.6","depends_on_id":"kura-training-tm5.4","type":"blocks","created_at":"2026-02-11T21:56:12.45961+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.7","title":"Projection Integration + Quality Signals für External Data","description":"Sorge dafür, dass externe Daten nützlich in bestehende Kura-Projektionen einfließen und Qualitätsprobleme sichtbar werden.","design":"Projection hooks + quality signals (missing core fields, unit mismatch, temporal uncertainty, dedup actions).","acceptance_criteria":"1) Externe Daten erscheinen konsistent in Kernprojektionen. 2) Qualitäts-Signale werden emittiert. 3) Unsichere Felder werden nicht stillschweigend als sicher behandelt. 4) Tests für Misch-Szenarien (manuell + extern) vorhanden.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:11.458323+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:35:22.439005+01:00","closed_at":"2026-02-12T08:35:22.439005+01:00","close_reason":"Integrated external.activity_imported into training_timeline core projection and added external quality signals (unsupported/low-confidence/temporal/dedup) in training_timeline + quality_health, including mixed manual+external tests.","dependencies":[{"issue_id":"kura-training-tm5.7","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:11.45969+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.7","depends_on_id":"kura-training-tm5.1","type":"blocks","created_at":"2026-02-11T21:56:11.983868+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.7","depends_on_id":"kura-training-tm5.3","type":"blocks","created_at":"2026-02-11T21:56:12.364054+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.7","depends_on_id":"kura-training-tm5.4","type":"blocks","created_at":"2026-02-11T21:56:12.556674+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.7","depends_on_id":"kura-training-tm5.5","type":"blocks","created_at":"2026-02-11T21:56:12.649863+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.8","title":"Provider OAuth/Connection Domain Model (Post-Launch Ready)","description":"Lege Domain-Modell für Account-Linking, Token-Lifecycle, Scopes und Revoke vor, damit offizielle Provider-Connectors später schnell integrierbar sind.","design":"ProviderConnection aggregate: auth state, scopes, token metadata, sync cursors, consent timestamps, revocation handling.","acceptance_criteria":"1) ProviderConnection Modell + API contract definiert. 2) Scope/Consent/Revocation-Fälle modelliert. 3) Security-Audit-Felder vorhanden. 4) Integration mit Adapter-Pipeline vorbereitet.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:11.575161+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:39:51.062286+01:00","closed_at":"2026-02-12T08:39:51.062286+01:00","close_reason":"Added provider_connections domain model + migration, provider connection API contract (list/upsert/revoke), scope/consent/revocation modeling, security/audit metadata fields, and adapter-context integration contract.","dependencies":[{"issue_id":"kura-training-tm5.8","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:11.576055+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.8","depends_on_id":"kura-training-tm5.2","type":"blocks","created_at":"2026-02-11T21:56:12.171589+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.9","title":"Rollout Plan: Launch-Import -\u003e Post-Launch Connectors","description":"Definiere den kontrollierten Rolloutpfad inkl. Feature Flags, Migrationsstrategie und Success-Metriken für externe Datenquellen.","design":"Stufen: internal alpha, user opt-in import, connector beta, GA. Jede Stufe mit Go/No-Go Kriterien.","acceptance_criteria":"1) Rollout-Stufen dokumentiert. 2) Feature-Flag-Plan vorhanden. 3) KPI-Set für Datenqualität/UX definiert. 4) Rückfallstrategie bei Connector-Problemen klar.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:11.70537+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:39:55.795732+01:00","closed_at":"2026-02-12T08:39:55.795732+01:00","close_reason":"Documented staged rollout plan from launch file-import to connector beta/GA with feature flags, KPI gates, migration path, and fallback strategy.","dependencies":[{"issue_id":"kura-training-tm5.9","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:11.706365+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.9","depends_on_id":"kura-training-tm5.6","type":"blocks","created_at":"2026-02-11T21:56:12.776041+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.9","depends_on_id":"kura-training-tm5.7","type":"blocks","created_at":"2026-02-11T21:56:12.87962+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.9","depends_on_id":"kura-training-tm5.8","type":"blocks","created_at":"2026-02-11T21:56:12.969897+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-u1h","title":"Footer + Legal-Pflichtseiten (Impressum, Datenschutz, Nutzungsbedingungen)","description":"## Warum\nDeutsche Anbieterkennzeichnungspflicht (TMG §5) + DSGVO-Pflichtinformationen.\nOhne Impressum und Datenschutzerklärung ist die Seite rechtlich angreifbar.\n\n## Was\n### Footer-Komponente\n- Auf allen Seiten sichtbar (im Layout einbinden)\n- Links: Impressum | Datenschutz | Nutzungsbedingungen\n- Copyright-Zeile\n- Dezent, passend zum Kura-Design\n\n### Impressum (/impressum)\n- Platzhalter-Seite mit Struktur:\n  - Angaben gemäß §5 TMG\n  - Name, Adresse, Kontakt\n  - Verantwortlich für den Inhalt\n  - TODO-Hinweis: \"Inhalte werden ergänzt\"\n\n### Datenschutzerklärung (/datenschutz)\n- Platzhalter-Seite mit Struktur:\n  - Verantwortlicher\n  - Erhobene Daten (Events, Projections, Account-Daten)\n  - Zweck der Verarbeitung\n  - Rechte der betroffenen Person (Auskunft, Löschung, Export)\n  - TODO-Hinweis: \"Vollständige Datenschutzerklärung wird ergänzt\"\n\n### Nutzungsbedingungen (/nutzungsbedingungen)\n- Platzhalter-Seite mit Struktur:\n  - Early Access Bedingungen\n  - Zustimmung zur anonymisierten Datenanalyse als Teilnahmevoraussetzung\n  - Haftungsausschluss (Beta-Software)\n  - TODO-Hinweis: \"Vollständige Nutzungsbedingungen werden ergänzt\"\n\n## Abhängigkeit\n- KEINE — kann parallel zu allem anderen gebaut werden\n\n## Akzeptanzkriterien\n- Footer auf allen Seiten sichtbar\n- Alle drei Seiten erreichbar und mit sinnvoller Platzhalter-Struktur\n- i18n: Mindestens Deutsch, Englisch als Fallback","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:35:53.282376+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T15:00:58.442378+01:00","closed_at":"2026-02-13T15:00:58.442378+01:00","close_reason":"Footer component with legal links on all pages. Impressum, Datenschutz, Nutzungsbedingungen pages with placeholder structure. All 3 languages (en/de/ja)."}
{"id":"kura-training-u3dz","title":"Harden strength_inference lookups with user_id scoping on event id queries","description":"strength_inference resolves event rows (current event and set.corrected target event) by id without user_id filter. This can cause cross-user contamination under malformed payloads or queue mismatch. Add user_id scoping and graceful fallback when target not owned by user.","status":"closed","priority":2,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-19T23:02:14.757362+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T23:14:35.271446+01:00","closed_at":"2026-02-19T23:14:35.271446+01:00","close_reason":"Closed","comments":[{"id":49,"issue_id":"kura-training-u3dz","author":"jonzim-cmd","text":"Fix umgesetzt: strength_inference Event-Lookups sind user-scoped. Beide Queries wurden auf (id + user_id) eingeschränkt: initiale Event-Resolution und set.corrected target_event_id lookup. Ergebnis: keine cross-user Key-Resolution bei fehlerhaften Payloads/Queue-Mismatch. Integrationstests ergänzt: test_integration.py::test_strength_inference_event_lookup_is_user_scoped und ::test_strength_inference_set_correction_target_lookup_is_user_scoped.","created_at":"2026-02-19T22:14:30Z"}]}
{"id":"kura-training-v2e","title":"Web: Signup invite gate + consent checkbox","description":"## Was\nSignup-Seite um Invite-Token-Validierung und Consent-Checkbox erweitern.\n\n## Logik\n- /signup?invite=TOKEN → Token aus URL lesen, im Signup-Request mitsenden\n- /signup ohne Token → Redirect zu /request-access (wenn SIGNUP_GATE=invite)\n- Token-Validierung passiert serverseitig (API gibt Fehler zurück)\n\n## Consent Checkbox\n- Unter dem Signup-Formular, vor dem Submit-Button\n- Text: \"Ich stimme zu, dass meine anonymisierten Trainingsdaten zur Verbesserung von Kura verwendet werden.\"\n- EN: \"I agree that my anonymized training data may be used to improve Kura.\"\n- Required: muss angehakt sein für Submit\n- Wird als consent_anonymized_learning: true im Register-Request mitgesendet\n\n## Fehlerbehandlung\n- invite_required → Redirect zu /request-access\n- invite_invalid → Meldung: \"Dieser Einladungslink ist ungültig oder abgelaufen.\"\n- invite_email_mismatch → Meldung: \"Dieser Link ist für eine andere E-Mail-Adresse.\"\n- consent_required → Checkbox highlighten\n\n## Hinweise\n- Invite-Token wird als hidden field oder im State gehalten, nicht im Formular angezeigt\n- Social Login (OAuth) muss Token auch mitsenden können (als state param oder Cookie)","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:46:01.244207+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:14:20.09621+01:00","closed_at":"2026-02-13T13:14:20.09621+01:00","close_reason":"Signup page: invite token redirect, consent checkbox, error handling, i18n de+en","dependencies":[{"issue_id":"kura-training-v2e","depends_on_id":"kura-training-zv3","type":"blocks","created_at":"2026-02-13T12:47:11.173069+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v2e","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:52.602291+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-v56","title":"Agent-first User Language Guard (fail-open, 1 rewrite, hidden developer raw mode)","description":"## Warum\nKura ist agent-first: Die maschinenlesbare Sprache (Event-Typen, Invariants, interne Contracts) muss vollständig erhalten bleiben, damit Agents präzise und leistungsfähig arbeiten können. Gleichzeitig sollen Endnutzer im Chat möglichst keine interne API-Sprache sehen. Eine rein manuelle Vocabulary-Allowlist skaliert nicht mit wachsender Anwendung und erzeugt doppelte Pflege. Deshalb brauchen wir einen robusten, fail-open Sprach-Guard, der den Agent nicht beschneidet.\n\n## Wie\nWir führen eine serverseitige Audience-Policy ein: `user_safe` als Default und `developer_raw` nur für privilegierte Developer-Clients. Im `user_safe`-Pfad bleibt die Agent-Antwort autoritativ, aber ein Leak-Detector prüft auf Maschinenmuster; bei Treffer gibt es genau einen Rewrite-Versuch in Alltagssprache. Danach wird immer ausgeliefert (fail-open), damit der Agent nie stumm wird. Die Leakerkennung soll weitgehend aus bestehenden Contract-Quellen gespeist werden, um doppelte Listenpflege zu vermeiden.\n\n## Ergebnisbild\n- Endnutzer sehen überwiegend Alltagssprache.\n- Agent-Contract und technische Präzision bleiben vollständig erhalten.\n- Kein Hard-Block bei verbleibenden Leaks.\n- Developer können Rohausgaben gezielt für Tests aktivieren, Endnutzer nicht.\n\n## Akzeptanzkriterien\n- `user_safe` ist Default für normale User-Clients.\n- `developer_raw` ist nur serverseitig per Scope + Allowlist aktivierbar.\n- `user_safe` nutzt Leak-Check + max. 1 Rewrite + fail-open Auslieferung.\n- Metriken und Tests decken Leak-Rate, Rewrite-Rate und Fallback-Pfade ab.\n","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:47:02.388804+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:04:05.242721+01:00","closed_at":"2026-02-13T21:04:05.242721+01:00","close_reason":"Closed"}
{"id":"kura-training-v56.1","title":"Audience-Control-Plane: user_safe default + hidden developer_raw authorization","description":"## Warum\nOhne harte Audience-Steuerung landet interne Sprache unkontrolliert im User-Chat. Der Agent soll nicht eingeschränkt werden, aber der Ausgabekanal für Endnutzer braucht klare Defaults und Rechteprüfung.\n\n## Wie\n- Serverseitige Audience-Resolution einführen: `user_safe` (default) und `developer_raw`.\n- `developer_raw` nur erlauben, wenn beide Bedingungen erfüllt sind:\n  - privilegierter Scope (z. B. `agent:debug`)\n  - serverseitige Client-Allowlist (z. B. via `client_id` Mapping)\n- Chat-Textkommandos dürfen den Modus nicht umschalten.\n- Entscheidungspfad als klaren Utility-Entry-Point kapseln, damit spätere Features zentral andocken.\n\n## Akzeptanzkriterien\n- Normale User-Clients landen immer in `user_safe`.\n- Nicht-privilegierte Clients können `developer_raw` nicht aktivieren.\n- Umschaltung ist nur serverseitig kontrolliert und auditierbar.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:47:39.216776+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:03:08.401812+01:00","closed_at":"2026-02-13T21:03:08.401812+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-v56.1","depends_on_id":"kura-training-v56","type":"parent-child","created_at":"2026-02-13T20:47:39.218185+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-v56.2","title":"Leak-Detector aus bestehenden Contracts ableiten (ohne zweite Vokabelliste)","description":"## Warum\nManuelle Doppelpflege von Maschinenbegriffen und User-Vokabular skaliert schlecht. Wir brauchen automatische Erkennung aus bestehenden Contracts, nicht aus einer zweiten Handliste.\n\n## Wie\n- Leak-Detector implementieren, der Maschinenmuster erkennt (z. B. `event.type`-Formen, `INV-###`, `inv_*`, endpoint-/command-artige Tokens).\n- Erkennungsquellen so weit wie möglich aus bestehenden Contract-Quellen speisen (Event-Conventions, bekannte Invariant-Formate, technische Namenskonventionen).\n- Detector liefert strukturierte Funde (Typ, Treffer, Position), damit Rewrite gezielt instruierbar ist.\n- Detector ist rein diagnostisch und blockiert nichts selbst.\n\n## Akzeptanzkriterien\n- Detector erkennt die bekannten Leak-Muster zuverlässig in repräsentativen Beispieltexten.\n- Neue Contracts können ohne zweite manuelle Vokabelliste in die Erkennung einfließen.\n- Detector-Output ist für Telemetrie und Rewrite-Prompting nutzbar.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:47:44.446806+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:03:33.694941+01:00","closed_at":"2026-02-13T21:03:33.694941+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-v56.2","depends_on_id":"kura-training-v56","type":"parent-child","created_at":"2026-02-13T20:47:44.447747+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.2","depends_on_id":"kura-training-v56.1","type":"blocks","created_at":"2026-02-13T20:48:05.364851+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-v56.3","title":"User-safe Pipeline: Leak-Check + genau 1 Rewrite + fail-open Auslieferung","description":"## Warum\nDer Agent soll weiter frei schreiben können, aber Leaks im Endnutzerkanal sollen minimiert werden. Gleichzeitig darf der Agent nie stumm werden.\n\n## Wie\n- `user_safe`-Pipeline:\n  1. Agent-Antwort erzeugen.\n  2. Leak-Check.\n  3. Bei Leak: genau ein Rewrite-Aufruf mit Instruktion „gleicher Inhalt, gleiche Persönlichkeit, ohne erkannte Maschinenbegriffe“.\n  4. Ergebnis direkt ausliefern (`fail-open`).\n- Rewrite mit kurzem Latenzbudget (Timeout), bei Fehler/Timeout Originalantwort senden.\n- Kein zweiter Rewrite und kein Hard-Block.\n\n## Akzeptanzkriterien\n- Ohne Leaks entsteht kein Zusatzaufruf.\n- Bei Leaks erfolgt maximal ein Rewrite.\n- Bei Rewrite-Fehler oder verbleibenden Leaks wird trotzdem sinnvoll ausgeliefert.\n- Persönlichkeitsstil bleibt erkennbar agentisch.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:47:49.687041+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:03:49.63752+01:00","closed_at":"2026-02-13T21:03:49.63752+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-v56.3","depends_on_id":"kura-training-v56","type":"parent-child","created_at":"2026-02-13T20:47:49.68853+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.3","depends_on_id":"kura-training-v56.1","type":"blocks","created_at":"2026-02-13T20:48:10.558097+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.3","depends_on_id":"kura-training-v56.2","type":"blocks","created_at":"2026-02-13T20:48:15.768498+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-v56.4","title":"Developer-Raw-Diagnostikpfad mit Audit und ohne User-Discoverability","description":"## Warum\nFür Debugging, QA und Prompt-Arbeit brauchen Developer Zugriff auf technische Begriffe. Endnutzer dürfen diesen Schalter nicht entdecken oder steuern.\n\n## Wie\n- `developer_raw`-Pfad implementieren, der Leak-Guard/Rewrite bewusst umgeht.\n- Zugriff nur über serverseitige AuthZ (Scope + Client-Allowlist), nicht über Chat-Befehle.\n- Jede Nutzung als Security/Debug-Ereignis telemetrieren (wer, wann, welcher Client).\n- UI/Agent-Prompts für Endnutzer enthalten keinen Hinweis auf diesen Modus.\n\n## Akzeptanzkriterien\n- Developer können reproduzierbar Rohbegriffe sehen.\n- Normale User können den Modus weder auslösen noch entdecken.\n- Audit-Trail für jede `developer_raw`-Ausführung vorhanden.\n","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:47:54.928563+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:03:54.84131+01:00","closed_at":"2026-02-13T21:03:54.84131+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-v56.4","depends_on_id":"kura-training-v56","type":"parent-child","created_at":"2026-02-13T20:47:54.929512+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.4","depends_on_id":"kura-training-v56.1","type":"blocks","created_at":"2026-02-13T20:48:20.970411+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-v56.5","title":"Executable Specs, Telemetrie und Rollout-Guardrails für Sprach-Guard","description":"## Warum\nOhne messbare Qualität und CI-Schutz droht Regression: entweder zu viele Leaks oder zu aggressive Umschreibungen, die Inhalt verlieren.\n\n## Wie\n- Tests:\n  - Architektur-/Contract-Tests für Audience-Policy und fail-open Verhalten.\n  - Pipeline-Tests für \"Leak erkannt -\u003e 1 Rewrite -\u003e Auslieferung\".\n  - Negative Tests: Rewrite-Timeout/Fehler liefert weiterhin Antwort.\n- Telemetrie:\n  - `leak_detected_total`\n  - `rewrite_applied_total`\n  - `rewrite_failed_or_timeout_total`\n  - `leak_passed_through_total`\n  - `developer_raw_uses_total`\n- Rollout:\n  - Start mit Monitoring, dann schrittweise Aktivierung, Grenzwerte/Alerts dokumentieren.\n\n## Akzeptanzkriterien\n- CI schützt Kerninvarianten (`agent-first`, `fail-open`, max. 1 Rewrite).\n- Dashboards/Logs zeigen Leak- und Rewrite-Qualität nachvollziehbar.\n- Rollout- und Rückfallplan ist dokumentiert.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:48:00.159717+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:04:00.040357+01:00","closed_at":"2026-02-13T21:04:00.040357+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-v56.5","depends_on_id":"kura-training-v56","type":"parent-child","created_at":"2026-02-13T20:48:00.160898+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.5","depends_on_id":"kura-training-v56.2","type":"blocks","created_at":"2026-02-13T20:48:26.16992+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.5","depends_on_id":"kura-training-v56.3","type":"blocks","created_at":"2026-02-13T20:48:31.367694+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.5","depends_on_id":"kura-training-v56.4","type":"blocks","created_at":"2026-02-13T20:48:36.568243+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-vcf","title":"Save-Echo als tier-unabhängige Always-On Policy extrahieren","description":"## Entscheidungszusammenfassung (Warum)\n\nSave-Echo (Werte nach dem Write sichtbar spiegeln) ist eine Datenintegritaets-Kontrolle und darf nicht von der Autonomie-Stufe abhaengen. Der aktuelle Zustand koppelt indirekt Integritaets-Nachweis und Intent-Handshake, obwohl das zwei verschiedene Problemklassen sind: \"darf ich schreiben\" vs. \"was wurde geschrieben\". Dadurch entsteht in `moderate`/`advanced` ein stilles Drift-Risiko bei plausiblen Fehluebersetzungen. Diese Aufgabe trennt die Konzepte sauber: Intent-Handshake bleibt Tier-abhhaengig, Save-Echo wird Always-On. Die Implementierung muss rueckwaertskompatibel sein und ohne UI-Annahme funktionieren.\n\n## Problem im Ist-Zustand (Code-Referenz)\n\n- Tier-Politik kennt aktuell nur `high_impact_write_policy` und `intent_handshake_required`, aber keine explizite Save-Echo-Pflicht:\n  - `workers/src/kura_workers/system_config.py` (`model_tier_registry_v1`, Zeilenbereich ~296-351)\n  - `api/src/routes/agent/policy.rs` (`model_tier_policy_from_name`, Zeilenbereich ~681-708)\n- Intent-Handshake ist nur strict+high-impact verpflichtend (korrekt), aber Save-Echo wird nicht als separater, tier-unabhaengiger Contract modelliert:\n  - `api/src/routes/agent.rs` (Zeilenbereich ~3321-3461)\n- `quality.save_claim.checked` setzt `mismatch_detected` derzeit nur aus `allow_saved_claim` ab (Proof-Ebene), nicht aus Echo-Vollstaendigkeit:\n  - `api/src/routes/agent/write_verification.rs` (Zeilenbereich ~864-929)\n\n## Zielzustand (Invarianten)\n\n1. Save-Echo ist **immer verpflichtend**, unabhaengig von `strict|moderate|advanced`.\n2. Intent-Handshake bleibt **unveraendert**: nur `strict` + `high_impact_write`.\n3. Save-Echo ist **natuerlich formuliert** (kein technischer Dump), muss aber die geschriebenen Nutzwerte spiegeln.\n4. Bei Batch-Writes ist ein kompakter Sammel-Echo erlaubt, solange alle geschriebenen Werte abgedeckt sind.\n5. Fehlende Event-ID darf nie als \"kein Echo\" klassifiziert werden (wird in `kura-training-znc` gewichtet, nicht hier).\n\n## Implementierungs-Scope (Wie)\n\n### A) Contract/Policy trennen\n\n- `workers/src/kura_workers/system_config.py`\n  - `agent_behavior.operational` um `save_echo_policy_v1` erweitern (schema-pinned):\n    - `always_on: true`\n    - `tier_independent: true`\n    - `required_after_claim_status: [\"saved_verified\"]`\n    - `message_style: \"natural_compact\"`\n    - `batch_mode: \"compact_summary_allowed\"`\n  - `model_tier_registry_v1.rules` klarstellen:\n    - Tier steuert Autonomie/Confirmation, **nicht** Save-Echo-Pflicht.\n\n### B) Runtime-Verhalten explizit machen\n\n- `api/src/routes/agent/write_verification.rs`\n  - Save-Echo-Contract als eigene Bewertungsstufe einfuehren (nicht von `intent_handshake` ableiten).\n  - Payload von `quality.save_claim.checked` um Echo-Metadaten erweitern (zunaechst nur Praesenz/Vollstaendigkeit, detaillierte Severity folgt in `kura-training-znc`).\n- `api/src/routes/agent.rs`\n  - Sicherstellen, dass user-facing Antwortfelder bei `claim_status=saved_verified` ein Echo enthalten (einzeln oder Batch-Zusammenfassung).\n\n### C) Telemetrie vorbereiten (ohne Severity-Reweighting vorwegzunehmen)\n\n- `quality.save_claim.checked` Datenmodell mindestens um folgende Felder erweitern:\n  - `save_echo_required: true`\n  - `save_echo_present: bool`\n  - `save_echo_completeness: \"complete\"|\"partial\"|\"missing\"`\n- Rueckwaertskompatibilitaet:\n  - Fehlende neue Felder in Alt-Events duerfen keine Crashes verursachen.\n  - Default-Fallback fuer Alt-Events ist explizit zu dokumentieren und zu testen.\n\n## Architecture-Spec-Tests (Pflicht laut AGENTS.md)\n\nNeue/angepasste Tests in `tests/architecture/` (keine neue Design-Doc):\n\n1. `tests/architecture/test_11_save_echo_policy_contract.py`\n   - Contract aus `system_config` pruefen:\n     - `save_echo_policy_v1.always_on == True`\n     - `save_echo_policy_v1.tier_independent == True`\n   - Runtime-Referenztests via `assert_kura_api_test_passes(...)`:\n     - `routes::agent::tests::save_echo_contract_enforced_in_advanced_tier`\n     - `routes::agent::tests::save_echo_contract_enforced_in_moderate_tier`\n\n2. `tests/architecture/test_60_agent_contract_coverage_matrix.py`\n   - Matrix um Contract-Key `save_echo_policy` erweitern (schema_pin + positive + negative).\n\n3. Rust-Tests in `api/src/routes/agent.rs` (oder naheliegende Route-Module)\n   - Intent-Handshake-Verpflichtung bleibt strict-only.\n   - Save-Echo bleibt in allen Tiers aktiv.\n\n## Nicht-Ziele\n\n- Keine finale Severity-Gewichtung in dieser Aufgabe (separat `kura-training-znc`).\n- Keine UI-Einfuehrung.\n- Keine Migration alter Events im Nachhinein.\n\n## Akzeptanzkriterien\n\n- Save-Echo als eigener, tier-unabhaengiger Contract ist in System-Config und Runtime vorhanden.\n- Strict-only Intent-Handshake-Verhalten bleibt unveraendert und explizit getestet.\n- Architecture-Spec-Tests in `tests/architecture/` sind hinzugefuegt/angepasst und gruene Referenz.\n- Alt-Events ohne neue Echo-Felder werden robust verarbeitet.\n- Natuerliche Echo-Formulierungen sind moeglich, aber Werteabdeckung ist verpflichtend.\n\n## Hinweise fuer KI-Umsetzung mit wenig Kontext (compaction-resistent)\n\n- Diese Aufgabe darf nicht \"heuristisch\" ueber Prompt-Stil geloest werden; es ist ein **Contract-Problem**.\n- Wenn bei Implementierung ein Trade-off noetig ist, gilt Prioritaet: Integritaets-Nachweis \u003e Formulierungskomfort.\n- Bei Unsicherheit ueber Feldnamen zuerst vorhandene Payloads in `quality.save_claim.checked` erweitern statt neue Event-Typen einzufuehren.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T11:29:31.658256+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T13:03:12.473391+01:00","closed_at":"2026-02-14T13:03:12.473391+01:00","close_reason":"Implemented: save_echo_policy_v1 in system_config, telemetry fields in write_verification.rs, 4 Rust tests, 9 Python arch tests, coverage matrix updated. All 252 Rust + 80 arch + 77 system_config tests green."}
{"id":"kura-training-veh","title":"Executable Specs: Architektur-Invarianten als CI-Tests","description":"Design Docs (Decision 7, 10, 13) enthalten architektonische Zusagen, die heute nur als Prosa existieren. Diese in ausführbare Tests übersetzen, die in CI laufen.\n\nBeispiele:\n- Jeder Handler deklariert dimension_meta + output_schema (Decision 7)\n- Alle Handler reichen unknown fields durch (Decision 10 Phase 1)\n- system_config listet alle registrierten Dimensionen\n- Jeder API-Error hat error + field + docs_hint\n- Event Conventions (21 Typen) matchen tatsächliche Handler-Subscriptions\n- Invarianten INV-001 bis INV-009 aus Self-Healing Doc (013)\n\nZiel: Agents und Menschen können Code ändern, ohne stille architektonische Regression. CI fängt ab, was Code Review übersieht.\n\nInspiration: Ramin Hasani (Liquid AI) — 'Turn every tech spec into code. CI fails if invariant violated.'","notes":"Compaction-safe execution order: veh.1 -\u003e veh.2 -\u003e amg.1 -\u003e amg.2 -\u003e wvp.5 -\u003e wvp.6 -\u003e wvp.4 -\u003e siq.6 -\u003e 5ur.1. Architekturvorgaben aus AGENTS.md strikt anwenden: neue Zusagen als ausführbare Specs in tests/architecture, keine neuen docs/design-Entscheidungsdokumente.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T15:34:25.905532+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T07:33:11.768785+01:00","closed_at":"2026-02-14T07:33:11.768785+01:00","close_reason":"Closed"}
{"id":"kura-training-veh.1","title":"Executable Specs V2.1: Marker-Checks auf Verhaltens-Contracts umstellen","description":"Warum:\nDie aktuellen Architektur-Specs in tests/architecture sichern zentrale Agent-Contracts teils nur über String-Marker ab. Das schützt nicht zuverlässig gegen Laufzeit-Regressionen.\n\nScope:\n- Marker-basierte Specs für Intent Handshake, Trace Digest, Memory Tier, Post-Task Reflection auf Verhaltens- und Strukturtests anheben.\n- Positive + negative Fälle pro Contract ergänzen.\n- Assertions so formulieren, dass sie auf API-Verhalten/Contract-Struktur prüfen, nicht auf Quelltext-Substring-Matches.\n\nWas muss gelten (Executable Specs, AGENTS.md-konform):\n- Invarianten werden in tests/architecture und/oder bestehenden Runtime-Tests in Code gegossen.\n- Keine neuen Design-Dokumente unter docs/design für diese Entscheidung.\n\nNicht-Ziele:\n- Keine Produktlogik-Änderung an Policy-Verhalten.\n- Kein Rewrite von agent.rs in diesem Task.\n\nImplementierungsanker:\n- tests/architecture/test_10_intent_handshake_contract.py\n- tests/architecture/test_20_trace_digest_contract.py\n- tests/architecture/test_40_memory_tier_contract.py\n- tests/architecture/test_50_post_task_reflection_contract.py\n- api/src/routes/agent.rs (nur falls für testbare Grenzflächen nötig)\n\nHandoff (compaction-safe):\nBeim Wiederaufsetzen zuerst tests/architecture und die oben genannten Contract-Bereiche in api/src/routes/agent.rs lesen. Dann nur Tests auf Verhaltensassertions umbauen und alle Quality Gates laufen lassen.\n","design":"AGENTS.md beachten: Warum in Bead, Was-muss-gelten als ausführbare Tests in tests/architecture; keine neuen docs/design-Artefakte.","acceptance_criteria":"1) Für Handshake/Trace/Memory/Reflection gibt es keine reinen Quelltext-Substring-Checks als primäre Absicherung mehr. 2) Pro Contract existiert mindestens ein positiver und ein negativer Testfall. 3) scripts/run-architecture-tests.sh, PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py und cargo test --workspace sind grün.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:11:52.925713+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T20:38:10.327212+01:00","closed_at":"2026-02-13T20:38:10.327212+01:00","close_reason":"Implemented executable behavior contracts for intent handshake, trace digest, memory tier, and post-task reflection; replaced marker-only architecture checks with Rust contract tests; full quality gates green.","dependencies":[{"issue_id":"kura-training-veh.1","depends_on_id":"kura-training-veh","type":"parent-child","created_at":"2026-02-13T20:11:52.92711+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-veh.2","title":"Executable Specs V2.2: Coverage-Matrix und Gate-Bindung","description":"Warum:\nNach der Umstellung auf Verhaltens-Contracts braucht es eine dauerhafte Abdeckungsklammer, damit neue Agent-Contract-Flächen nicht ungetestet bleiben.\n\nScope:\n- Coverage-Matrix als ausführbare Prüfung ergänzen: welche Agent-Contracts architekturell verpflichtend sind.\n- Architektur-Spec-Gate so verankern, dass es in den normalen Worker-/Repo-Qualitätslauf integriert bleibt.\n- Sicherstellen, dass neue Contract-Versionen nicht still eingeführt werden können ohne Spec-Update.\n\nWas muss gelten (Executable Specs, AGENTS.md-konform):\n- Der Testkorpus schlägt fehl, wenn ein verpflichtender Contract entfernt oder ohne Spec-Anpassung geändert wird.\n- Keine neuen Prosa-Designentscheidungen; Invarianten als Tests.\n\nNicht-Ziele:\n- Kein Performance-Benchmarking.\n- Keine Produkt-UI-Änderungen.\n\nImplementierungsanker:\n- workers/tests/test_architecture_specs.py\n- scripts/run-architecture-tests.sh\n- tests/architecture/*\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst workers/tests/test_architecture_specs.py öffnen und prüfen, welche Contract-Flächen bereits durchgesetzt sind; danach fehlende Coverage als Test ergänzen.\n","design":"AGENTS.md Workflow: neue Architekturzusagen ausschließlich als ausführbare Specs, keine neuen Design-Docs.","acceptance_criteria":"1) Architektur-Specs prüfen verpflichtende Contract-Flächen explizit (nicht implizit über Dateitext). 2) Das bestehende Gate bleibt im regulären Testlauf verankert und failt bei Contract-Drift. 3) Voller Gate-Lauf ist grün.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:11:58.158843+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T23:20:15.585023+01:00","closed_at":"2026-02-13T23:20:15.585023+01:00","close_reason":"Added explicit agent contract coverage matrix with schema-pin/positive/negative runtime checks, wired through architecture spec suite, and kept full quality gates green.","dependencies":[{"issue_id":"kura-training-veh.2","depends_on_id":"kura-training-veh","type":"parent-child","created_at":"2026-02-13T20:11:58.159821+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-veh.2","depends_on_id":"kura-training-veh.1","type":"blocks","created_at":"2026-02-13T20:12:03.356509+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-w61v","title":"Phase 6 cross-capability eval gates + rollout criteria for capability_estimation.v1","description":"WHY:\nWithout shared eval gates, model upgrades can look better qualitatively but regress in calibration, interval coverage, or decision reliability.\n\nHOW:\nCreate cross-capability release gates that all capability estimators must pass before rollout:\n- replay metrics per capability (coverage, MAE/RMSE, direction accuracy)\n- uncertainty quality checks (interval width vs error, insufficiency correctness)\n- comparability integrity checks (protocol mismatch handling)\n- thresholded pass/fail/insufficient_data decisions for autonomous rollout control.\n\nIMPLEMENTATION TASKS:\n1) Extend eval_harness for sprint/jump/endurance capability metrics.\n2) Add aggregated cross-capability gate builder.\n3) Wire gate result into rollout decision artifact.\n4) Add architecture tests for required gate fields and statuses.\n\nACCEPTANCE:\n- Rollout artifacts include cross-capability gate status.\n- Gate blocks rollout on fail and marks insufficient_data explicitly.\n- Metrics are versioned and reproducible from replay inputs.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-20T18:37:44.743694+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-20T19:28:35.456207+01:00","closed_at":"2026-02-20T19:28:35.456207+01:00","close_reason":"Implemented end-to-end with executable contracts/tests, runtime wiring, and passing quality gates (ruff + workers unit/integration + cargo).","dependencies":[{"issue_id":"kura-training-w61v","depends_on_id":"kura-training-95ck","type":"blocks","created_at":"2026-02-20T18:40:32.922891+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-w9p","title":"training_timeline: Top-Sets pro Übung pro Tag in recent_days","description":"recent_days in training_timeline zeigt aktuell nur Übungsliste + Aggregate (total_sets, total_volume). Für einen schnellen Tagesüberblick fehlen die konkreten Top-Sets (schwerster Satz, bester 1RM) pro Übung. Mit dieser Anreicherung reicht EIN API-Call für 'Was hab ich heute gemacht?' statt 1+N Calls. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:54.492323+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:36:29.088661+01:00","closed_at":"2026-02-10T07:36:29.088661+01:00","close_reason":"Top-sets per exercise in recent_days + recent_sessions. epley_1rm moved to shared utils. Best estimated 1RM wins per exercise per day/session.","dependencies":[{"issue_id":"kura-training-w9p","depends_on_id":"kura-training-alk","type":"blocks","created_at":"2026-02-09T21:43:06.717554+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wbt","title":"[hardening] API session_audit Hint-Matching auf robuste Parität bringen","description":"Warum:\n- API session_audit nutzt aktuell substring-basierte Hint-Erkennung fuer narrative Widerspruchschecks.\n- Dadurch bestehen dieselben Randfallrisiken wie zuvor im Worker (Negation, Teilworttreffer, Umlaut-Varianten).\n- Zur Konsistenz zwischen Worker-Inferenz und API-Audit soll die Hint-Logik robust und semantisch ausgerichtet sein.\n\nWie:\n- contains_any_hint auf tokenbasierte Wortgrenzen + normalisierte Textform umstellen.\n- Negierte Negativphrasen (\"nicht schlecht\", \"not bad\") vor der Negativbewertung neutralisieren.\n- Hint-Listen so pflegen, dass Umlaute/ASCII-Varianten robust funktionieren.\n- Regression-Tests im API-Testmodul fuer diese Randfaelle ergaenzen.\n\nAkzeptanz:\n- Neue session_audit Randfalltests sind gruen.\n- Bestehende API-Vertrags-/Routentests bleiben gruen.\n- Vollstaendige Quality Gates laufen ohne neue Fehler.\n","notes":"Abschlussprotokoll (2026-02-15):\n- API session_audit Hint-Erkennung auf robuste Parität gehärtet:\n  1) tokenbasierte Wortgrenzen statt Substring-Matching\n  2) Textnormalisierung für Umlaute (ä/ö/ü/ß -\u003e ae/oe/ue/ss)\n  3) Negationsphrasen \"nicht schlecht\"/\"not bad\" werden vor Negativ-Hint-Bewertung neutralisiert\n- Positive Hint-Liste auf \"spass\" (statt \"spa\") präzisiert, um Teilwort-Fehltreffer zu vermeiden.\n- Narrative-Widerspruchscheck nutzt für negatives Sentiment jetzt contains_any_negative_hint().\n- Neue API-Regressionstests ergänzt:\n  1) negated negative phrase stays clean\n  2) partial-word negative hint stays clean\n  3) ascii umlaut variant (muede) triggers contradiction\n- Quality Gates:\n  - ruff check workers/src/ workers/tests/ -\u003e PASS\n  - PYTHONPATH=workers/src workers/.venv/bin/python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py -\u003e PASS (729 passed, 135 skipped)\n  - PYTHONPATH=workers/src workers/.venv/bin/python -m pytest workers/tests/test_integration.py -q -\u003e PASS (85 passed)\n  - cargo test --workspace -\u003e PASS\n  - cargo test --workspace session_audit_session_feedback_ -\u003e PASS\n- Akzeptanz erfüllt: Randfall-Regressionen grün, bestehende Suites bleiben grün.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T20:47:52.052174+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T20:53:55.706046+01:00","closed_at":"2026-02-15T20:53:55.706046+01:00","close_reason":"API session_audit Hint-Matching gehärtet; Paritäts-Regressionen und Quality Gates grün."}
{"id":"kura-training-wid","title":"E2E Validation via CLI vor MCP Server","description":"Manueller E2E Happy Path durch den CLI gegen laufende Instanz. User anlegen, Events posten (alle Event-Types), Projections lesen, Daten validieren. Lücken fixen bevor MCP Server gebaut wird.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T13:46:39.098108+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T14:12:54.632062+01:00","closed_at":"2026-02-09T14:12:54.632062+01:00","close_reason":"E2E validation complete. All 7 dimensions validated, 3 discoverability gaps found and fixed (projection_key, 18 event_conventions, bed_time naming)."}
{"id":"kura-training-wke","title":"Deployment: RESEND_API_KEY + KURA_BASE_URL konfigurieren","description":"Für den Email-Versand bei Access-Request-Approval müssen zwei Environment-Variablen auf dem VPS gesetzt werden:\n\n- RESEND_API_KEY: API-Key von Resend (resend.com) für transaktionale Emails\n- KURA_BASE_URL: Öffentliche URL der Web-App (für Signup-Links in Invite-Emails, z.B. https://kura.training)\n\nOhne RESEND_API_KEY funktioniert alles außer automatischem Email-Versand — Token wird dann im CLI-Output angezeigt und kann manuell weitergegeben werden.\n\nIn docker/.env.production eintragen und compose neu starten.","notes":"Blocked until launch infra exists: (1) public web URL/domain is decided and live, (2) Resend is provisioned with production API key and sender setup, (3) env naming for invite links is aligned (currently code reads FRONTEND_URL while ticket mentions KURA_BASE_URL).","status":"blocked","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:52:28.83822+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:38:17.756716+01:00"}
{"id":"kura-training-wvp","title":"Model-Aware Agent Runtime V1: Self-Model, Capability Tiers, and Adaptive Autonomy","description":"Bridge completed Continuous Learning Loop outputs into runtime behavior so agents with different model quality operate safely and transparently. Problem: model quality variance can cause inconsistent reliability if runtime autonomy is static. Goal: model-aware, calibration-aware autonomy that keeps UX trustworthy across agent implementations.","design":"Combine 2zc learning signals (calibration, clustering, shadow-eval) with runtime policy. Introduce explicit self-model contract, model-tier registry, and policy gates that adjust write autonomy and confirmation requirements by model quality + calibration status. Keep behavior explainable via machine-readable reason codes.","acceptance_criteria":"1) Runtime resolves model capability tier for each agent execution path. 2) High-risk writes are gated by model tier + calibration status. 3) Agent surfaces transparent policy reason codes when autonomy is reduced. 4) Shadow-eval includes model-tier matrix before policy promotion. 5) Documentation and tests define deterministic fallback behavior when model identity is unknown.","notes":"Session handoff 2026-02-13: This epic operationalizes model-quality variance in runtime policy. WHY: different agent/model quality must not yield unsafe behavior divergence. HOW: execute in order wvp.1 -\u003e wvp.2 -\u003e wvp.3 -\u003e wvp.4, then wire m3k.3/m3k.4 UX scenarios and overrides on top. Safety rule: global hard invariants stay non-bypassable; overrides only tune behavior above safety floor. Execution artifact for context recovery: docs/design/042-model-aware-agent-runtime-v1-execution-plan.md. Child chain IDs: wvp.1 =\u003e kura-training-wvp.1.3 + kura-training-wvp.1.2 -\u003e kura-training-wvp.1.1; wvp.2 =\u003e kura-training-wvp.2.1 -\u003e kura-training-wvp.2.2 -\u003e kura-training-wvp.2.3; wvp.3 =\u003e kura-training-wvp.3.2 -\u003e kura-training-wvp.3.1 -\u003e kura-training-wvp.3.3.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:09.00809+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T07:21:48.064213+01:00","closed_at":"2026-02-14T07:21:48.064213+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp","depends_on_id":"kura-training-2zc","type":"blocks","created_at":"2026-02-13T09:54:02.150752+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp","depends_on_id":"kura-training-pdc","type":"blocks","created_at":"2026-02-13T09:54:07.358602+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.1","title":"Self-Model Contract V1 in Agent Context","description":"Expose a machine-readable agent self-model in /v1/agent/context and capabilities resources so agents know their runtime contract, constraints, and available repair paths.","design":"Add self_model payload: model_identity, capability_tier, known_limitations, preferred_contracts, fallback_behavior, docs pointers. Keep deny-by-default for unknown fields and include schema_version for compatibility.","acceptance_criteria":"1) Agent context returns self_model block with stable schema version. 2) Unknown/legacy clients receive conservative defaults. 3) Tests validate redaction and schema stability.","notes":"Execution source-of-truth: docs/design/042-model-aware-agent-runtime-v1-execution-plan.md. Implement child chain in order: (kura-training-wvp.1.3 + kura-training-wvp.1.2) -\u003e kura-training-wvp.1.1. Safety invariant: unknown/malformed identity must never elevate autonomy and must map to conservative fallback.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:14.236568+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.689337+01:00","closed_at":"2026-02-13T18:25:19.689337+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.1","depends_on_id":"kura-training-wvp","type":"parent-child","created_at":"2026-02-13T09:53:14.237889+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.1.1","title":"[wvp.1c] Self-model contract tests","description":"Add API tests for self_model schema stability, redaction compatibility, and conservative defaults for unknown/legacy resolution.","acceptance_criteria":"1) tests fail on schema drift. 2) redaction contract remains intact. 3) unknown/legacy path remains conservative.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:02:53.695224+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.678767+01:00","closed_at":"2026-02-13T18:25:19.678767+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.1.1","depends_on_id":"kura-training-wvp.1","type":"parent-child","created_at":"2026-02-13T18:03:51.435439+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.1.1","depends_on_id":"kura-training-wvp.1.3","type":"blocks","created_at":"2026-02-13T18:04:18.861113+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.1.1","depends_on_id":"kura-training-wvp.1.2","type":"blocks","created_at":"2026-02-13T18:04:24.072369+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.1.2","title":"[wvp.1b] Trusted model identity resolver","description":"Implement server-side model identity resolution from trusted runtime sources (client_id mapping, runtime default, unknown fallback).","acceptance_criteria":"1) deterministic resolution order implemented. 2) unknown/malformed identity falls back to strict-safe path. 3) no client-supplied privilege elevation.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:02:53.695337+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.677322+01:00","closed_at":"2026-02-13T18:25:19.677322+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.1.2","depends_on_id":"kura-training-wvp.1","type":"parent-child","created_at":"2026-02-13T18:02:53.697602+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.1.3","title":"[wvp.1a] Self-model schema in context + capabilities","description":"Add self_model contract block to /v1/agent/context and /v1/agent/capabilities with explicit schema_version and deny-by-default fallback metadata.","acceptance_criteria":"1) self_model exists in both endpoints. 2) schema_version is explicit and stable. 3) fallback behavior is conservative.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:02:53.714568+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.675428+01:00","closed_at":"2026-02-13T18:25:19.675428+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.1.3","depends_on_id":"kura-training-wvp.1","type":"parent-child","created_at":"2026-02-13T18:03:56.652371+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.2","title":"Model Tier Registry + Policy Mapping","description":"Define deterministic mapping from runtime model identity to capability tier and policy constraints.","design":"Implement registry with explicit tiers (strict, moderate, advanced), required confidence floors, and allowed action scopes. Integrate with autonomy policy extraction so write behavior is deterministic per tier.","acceptance_criteria":"1) Model identity resolves to a tier or conservative fallback. 2) Tier policy is machine-readable in system conventions. 3) Tests cover known, unknown, and malformed identity inputs.","notes":"Execution source-of-truth: docs/design/042-model-aware-agent-runtime-v1-execution-plan.md. Implement child chain in order: kura-training-wvp.2.1 -\u003e kura-training-wvp.2.2 -\u003e kura-training-wvp.2.3. Safety invariant: model_identity -\u003e tier mapping is deterministic; unknown/malformed identities resolve to strict fallback.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:19.465337+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.690587+01:00","closed_at":"2026-02-13T18:25:19.690587+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.2","depends_on_id":"kura-training-wvp","type":"parent-child","created_at":"2026-02-13T09:53:19.466257+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.2","depends_on_id":"kura-training-2zc.5","type":"blocks","created_at":"2026-02-13T09:54:12.553224+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.2","depends_on_id":"kura-training-wvp.1","type":"blocks","created_at":"2026-02-13T09:56:28.620514+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.2.1","title":"[wvp.2a] Model tier registry contract surface","description":"Expose machine-readable model_tier_registry_v1 policy contract in system conventions and ensure agent-facing visibility through redaction allowlist rules.","acceptance_criteria":"1) registry contract exists in conventions. 2) tier policy is machine-readable. 3) agent-facing redaction behavior is explicit.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:02:53.707065+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.680268+01:00","closed_at":"2026-02-13T18:25:19.680268+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.2.1","depends_on_id":"kura-training-wvp.2","type":"parent-child","created_at":"2026-02-13T18:02:53.707853+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.2.1","depends_on_id":"kura-training-wvp.1.3","type":"blocks","created_at":"2026-02-13T18:04:29.287159+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.2.2","title":"[wvp.2b] Deterministic tier resolver + policy mapping","description":"Implement deterministic mapping model_identity -\u003e capability_tier (strict/moderate/advanced) and map tier to confidence floors and allowed action scopes.","acceptance_criteria":"1) known identities resolve deterministically. 2) unknown/malformed resolve to strict fallback. 3) tier policy output is consumable by runtime gates.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:02:53.714794+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.681942+01:00","closed_at":"2026-02-13T18:25:19.681942+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.2.2","depends_on_id":"kura-training-wvp.2","type":"parent-child","created_at":"2026-02-13T18:02:53.716279+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.2.2","depends_on_id":"kura-training-wvp.1.2","type":"blocks","created_at":"2026-02-13T18:04:34.502752+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.2.2","depends_on_id":"kura-training-wvp.2.1","type":"blocks","created_at":"2026-02-13T18:04:39.710724+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.2.3","title":"[wvp.2c] Tier mapping tests (known/unknown/malformed)","description":"Add unit/integration tests for known model identities, unknown identities, malformed identities, and deterministic conservative fallback behavior.","acceptance_criteria":"1) known/unknown/malformed paths covered. 2) fallback is strict and deterministic. 3) tests assert machine-readable policy outputs.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:03:06.758285+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.683741+01:00","closed_at":"2026-02-13T18:25:19.683741+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.2.3","depends_on_id":"kura-training-wvp.2","type":"parent-child","created_at":"2026-02-13T18:03:06.759487+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.2.3","depends_on_id":"kura-training-wvp.2.2","type":"blocks","created_at":"2026-02-13T18:04:44.923508+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.3","title":"Adaptive Autonomy Gate: Model Tier x Calibration","description":"Gate high-impact actions using combined model tier and extraction calibration status.","design":"Extend claim/save/workflow gates to include model-tier policy and calibration status. Low-tier or degraded-calibration paths force confirm-first or block unsafe actions with explicit reason codes.","acceptance_criteria":"1) High-impact writes respect combined gate decisions. 2) Responses include deterministic reason codes. 3) Tests cover strict/moderate/advanced tiers with healthy/monitor/degraded calibration states.","notes":"Execution source-of-truth: docs/design/042-model-aware-agent-runtime-v1-execution-plan.md. Implement child chain in order: kura-training-wvp.3.2 -\u003e kura-training-wvp.3.1 -\u003e kura-training-wvp.3.3. Safety invariant: high-impact writes must follow gate decision allow|confirm_first|block with deterministic reason_codes.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:24.692843+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.691782+01:00","closed_at":"2026-02-13T18:25:19.691782+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.3","depends_on_id":"kura-training-wvp","type":"parent-child","created_at":"2026-02-13T09:53:24.6941+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.3","depends_on_id":"kura-training-wvp.1","type":"blocks","created_at":"2026-02-13T09:54:17.737498+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.3","depends_on_id":"kura-training-wvp.2","type":"blocks","created_at":"2026-02-13T09:54:22.9569+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.3.1","title":"[wvp.3b] Reason-code contract + payload wiring","description":"Add stable machine-readable reason_codes for autonomy reductions/blocks and include them in API response and quality signal event payloads.","acceptance_criteria":"1) stable reason_code catalog implemented. 2) confirm/block decisions always emit reason_codes. 3) response + event payloads are updated.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:03:22.552828+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.686474+01:00","closed_at":"2026-02-13T18:25:19.686474+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.3.1","depends_on_id":"kura-training-wvp.3","type":"parent-child","created_at":"2026-02-13T18:03:22.553682+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.3.1","depends_on_id":"kura-training-wvp.3.2","type":"blocks","created_at":"2026-02-13T18:04:55.346156+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.3.2","title":"[wvp.3a] Adaptive autonomy decision engine (tier x calibration)","description":"Implement deterministic gate decision from model tier, calibration status, integrity status, and action class (allow|confirm_first|block).","acceptance_criteria":"1) decision matrix implemented deterministically. 2) conservative behavior on ambiguity/errors. 3) high-impact writes follow gate decision.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:03:22.559083+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.685143+01:00","closed_at":"2026-02-13T18:25:19.685143+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.3.2","depends_on_id":"kura-training-wvp.3","type":"parent-child","created_at":"2026-02-13T18:03:22.560651+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.3.2","depends_on_id":"kura-training-wvp.2.2","type":"blocks","created_at":"2026-02-13T18:04:50.13818+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.3.3","title":"[wvp.3c] Gate matrix tests + integration scenarios","description":"Add tests for strict/moderate/advanced tiers across healthy/monitor/degraded statuses, including high-impact write behavior and deterministic reason codes.","acceptance_criteria":"1) full tier x status matrix covered. 2) high-impact block/confirm behavior asserted. 3) reason_codes determinism tested.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:03:22.558828+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.687892+01:00","closed_at":"2026-02-13T18:25:19.687892+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.3.3","depends_on_id":"kura-training-wvp.3","type":"parent-child","created_at":"2026-02-13T18:04:01.86878+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.3.3","depends_on_id":"kura-training-wvp.3.1","type":"blocks","created_at":"2026-02-13T18:05:00.55575+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.3.3","depends_on_id":"kura-training-wvp.2.3","type":"blocks","created_at":"2026-02-13T18:05:05.762793+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.4","title":"Shadow Eval Matrix by Model Tier","description":"Extend shadow evaluation to compare policy behavior across model tiers before rollout.","design":"Add per-tier replay matrix and release criteria deltas (quality, clarification rate, blocked unsafe attempts). Promotion requires no regression for protected metrics on weakest supported tier.","acceptance_criteria":"1) Shadow report includes tier-stratified metrics and pass/fail. 2) Release gate blocks rollout on weakest-tier regressions. 3) Sample report documented.","notes":"Sequenced after runtime modularization/decoupling for safer tier-matrix rollout. Dependency chain: wvp.5 -\u003e wvp.6 -\u003e wvp.4. Keep release-gate output machine-readable for siq.6 stakeholder proof artifacts.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:29.920157+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T06:28:44.288187+01:00","closed_at":"2026-02-14T06:28:44.288187+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.4","depends_on_id":"kura-training-wvp","type":"parent-child","created_at":"2026-02-13T09:53:29.921242+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.4","depends_on_id":"kura-training-wvp.3","type":"blocks","created_at":"2026-02-13T09:54:28.158903+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.4","depends_on_id":"kura-training-2zc.4","type":"blocks","created_at":"2026-02-13T09:54:33.361117+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.4","depends_on_id":"kura-training-wvp.6","type":"blocks","created_at":"2026-02-13T20:13:21.594471+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.5","title":"Agent Runtime Modularisierung V1: agent.rs in Domänenmodule ohne Verhaltensdrift","description":"Warum:\napi/src/routes/agent.rs ist ein zentraler Hotspot mit sehr hoher Größe und hoher Änderungsdichte. Das erhöht Review-Risiko und erschwert sichere Agent-gestützte Änderungen.\n\nScope:\n- Inkrementeller Refactor in Domänenmodule ohne Verhaltensänderung.\n- Klare Grenzflächen für Contracts, Policy, Write/Verify, Context, Visualization, Audit.\n- Tests mitziehen/neu ordnen, damit Ownership pro Modul klar bleibt.\n\nWas muss gelten:\n- Verhalten bleibt stabil (keine API-Contract-Regression).\n- Alle bestehenden Tests und Gates bleiben grün.\n- Modulgrenzen sind so gesetzt, dass Folgearbeit (z.B. wvp.4) gezielt auf Teilbereiche zugreifen kann.\n\nNicht-Ziele:\n- Keine neue Produktfunktion in diesem Task.\n- Kein „Big Bang“-Rewrite.\n\nImplementierungsanker:\n- api/src/routes/agent.rs\n- api/src/routes/agent/* (neue Module)\n- zugehörige Rust-Tests\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst Modul-Schnittstellen und Migrationsschritte (Commit-für-Commit) nachvollziehen. Refactor nur in kleinen, verifizierten Schritten mit vollem Gate-Lauf nach jedem Schritt.\n","design":"Refactor-first, behavior-preserving. Ziel ist niedrigere Änderungsrisiken bei gleicher Semantik.","acceptance_criteria":"1) Zentrale Verantwortungen sind in separaten Modulen organisiert; agent.rs dient primär als dünner Routing-/Orchestrierungs-Layer. 2) API-Contracts bleiben kompatibel (bestehende Tests grün). 3) Voller Qualitätslauf (ruff, worker tests, integration tests, cargo test) ist grün.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:12:29.446131+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T06:15:26.243144+01:00","closed_at":"2026-02-14T06:15:26.243144+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.5","depends_on_id":"kura-training-wvp","type":"parent-child","created_at":"2026-02-13T20:12:29.447477+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.5","depends_on_id":"kura-training-amg.2","type":"blocks","created_at":"2026-02-13T20:12:34.644978+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.6","title":"MCP/CLI Entkopplung V1: Shared Runtime statt Path-Include","description":"Warum:\nDer MCP-Runtime-Entry bindet aktuell CLI-Code per Pfad-Include ein. Das erhöht Kopplung und erschwert unabhängige Evolution von CLI und MCP.\n\nScope:\n- Shared Runtime/Contract-Schicht extrahieren (z.B. gemeinsames Crate/Modul), die von CLI und MCP genutzt wird.\n- mcp/src/lib.rs auf sauberen Import umstellen; path-include entfernen.\n- Kompatibilität der MCP-Tools und CLI-Verhalten sicherstellen.\n\nWas muss gelten:\n- Keine direkte Pfad-Include-Kopplung mehr zwischen mcp und cli.\n- Gemeinsame Funktionalität ist explizit versionierbar und testbar.\n\nNicht-Ziele:\n- Keine Änderung an externen API-Semantiken.\n- Keine UI-Arbeit.\n\nImplementierungsanker:\n- mcp/src/lib.rs\n- cli/src/commands/mcp.rs\n- ggf. neues shared crate/modul\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst Dependency-Graph (Cargo.toml) und neue shared Schicht lesen; danach Importpfade und MCP-Tests prüfen.\n","design":"Vision-konform: CLI und MCP als getrennte Interfaces mit minimierter technischer Kopplung.","acceptance_criteria":"1) mcp/src/lib.rs nutzt kein #[path = \"../../cli/...\"] mehr. 2) CLI- und MCP-Tests bleiben grün. 3) Gemeinsame Runtime/Contract-Schicht ist explizit und wartbar.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:12:39.882825+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T06:18:57.196329+01:00","closed_at":"2026-02-14T06:18:57.196329+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.6","depends_on_id":"kura-training-wvp","type":"parent-child","created_at":"2026-02-13T20:12:39.883696+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.6","depends_on_id":"kura-training-wvp.5","type":"blocks","created_at":"2026-02-13T20:12:45.085236+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-x6o","title":"[impl] Policy Kernel Modul extrahieren (pure decision core)","description":"Warum:\n- Entscheidungslogik liegt aktuell verteilt in api/src/routes/agent.rs; Wartbarkeit und Nachvollziehbarkeit leiden.\n\nWie:\n- Pure-Function Kernel einfuehren (keine DB/HTTP-Seiteneffekte), der aus einem normierten Input-Snapshot die Policy-Outputs berechnet.\n- Scope: response_mode_policy, personal_failure_profile, retrieval_regret/laaj sidecar, counterfactual recommendation.\n- Konfiguration/Werte als klar versionierte Inputs statt magic scattering.\n\nCompaction-Recovery:\n- Referenzstellen: api/src/routes/agent.rs:3274-3872 und workers/src/kura_workers/system_config.py:424-583.\n- Kernel API so designen, dass Route nur Adapter bleibt.\n\nAkzeptanz:\n- Kernel-Unit-Tests decken Hauptpfade und Grenzfaelle ab.\n- Keine Aenderung an externen Response-Schema-Feldern.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-15T17:14:41.832363+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-15T17:31:01.89321+01:00","closed_at":"2026-02-15T17:31:01.89321+01:00","close_reason":"Policy-Kern extrahiert nach api/src/routes/agent/policy_kernel.rs; pure Entscheidungslogik für response_mode, personal_failure_profile, sidecar/retrieval_regret und counterfactual zentralisiert.","dependencies":[{"issue_id":"kura-training-x6o","depends_on_id":"kura-training-14e","type":"blocks","created_at":"2026-02-15T17:15:13.961811+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-xmju","title":"Replay/Golden workflow tests for retrieval safety","description":"Warum: Guardrails sind nur wertvoll, wenn reale Tool-Sequenzen reproduzierbar geprüft werden.\\n\\nWie: Baue Replay-/Golden-Tests für typische Agent-Workflows (gesundes Nachladen vs Loop-Fall), sodass Stop-Reasons, Reset-Verhalten und Observability deterministisch verifiziert sind.","design":"Tests in mcp-runtime decken mindestens zwei Sequenzen ab: (a) budget overflow + progressive reload ohne Abort, (b) cursor-loop mit erwarteter Guard-Blockade. Assertions auf reason_code, reload_depth und abort counters.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T10:56:25.570754+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T11:03:46.475195+01:00","closed_at":"2026-02-19T11:03:46.475195+01:00","close_reason":"Added replay/golden-style runtime tests for progressive reload success and cursor-loop termination with deterministic reason codes.","dependencies":[{"issue_id":"kura-training-xmju","depends_on_id":"kura-training-5lkb","type":"blocks","created_at":"2026-02-19T10:56:35.609285+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-xmju","depends_on_id":"kura-training-3q00","type":"blocks","created_at":"2026-02-19T10:56:36.082208+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-xmju","depends_on_id":"kura-training-fknf","type":"blocks","created_at":"2026-02-19T10:56:36.238241+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-y0t","title":"Nightly Refit Scheduler Hardening","description":"Replace bootstrap-based recurring inference scheduling with a dedicated durable scheduler mechanism (single-flight, dedup, recovery after failed run). Add explicit telemetry for next_run_at and missed-run catch-up behavior.","notes":"Follow-up from semantic/bayesian foundation implementation.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T09:04:52.382683+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T11:21:38.334534+01:00","closed_at":"2026-02-11T11:21:38.334534+01:00","close_reason":"Durable Nightly Scheduler mit single-flight, dedup, failed-run recovery und Telemetrie (next_run_at/missed_runs) implementiert; lokal mit DB-Integrationstests verifiziert","labels":["bayesian","scheduler","workers"]}
{"id":"kura-training-y4hv","title":"Architecture spec + refactor boundaries for retrieval control","description":"Warum: Neue Retrieval-Invarianten müssen Compacting überstehen und dürfen nicht nur implizit im Code leben.\\n\\nWie: Ergänze executable architecture specs in tests/architecture und halte FSM/Observability-Logik in klaren Hilfsfunktionen für wartbare Refactors.","design":"Spec pinnt Schlüsseltests und Vertragsstrings (loop_guard, stop_reason, observability fields). Refactor fokussiert auf klare Funktionsgrenzen (preflight/update/outcome), ohne Verhalten zu verschleiern.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T10:56:25.5707+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T11:03:46.625837+01:00","closed_at":"2026-02-19T11:03:46.625837+01:00","close_reason":"Added executable architecture spec for retrieval FSM/observability contracts and kept control logic split into testable helper boundaries.","dependencies":[{"issue_id":"kura-training-y4hv","depends_on_id":"kura-training-5lkb","type":"blocks","created_at":"2026-02-19T10:56:35.756287+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-y4hv","depends_on_id":"kura-training-3q00","type":"blocks","created_at":"2026-02-19T10:56:36.398701+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-y4hv","depends_on_id":"kura-training-fknf","type":"blocks","created_at":"2026-02-19T10:56:36.553471+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-y4hv","depends_on_id":"kura-training-xmju","type":"blocks","created_at":"2026-02-19T10:56:36.704732+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-y9sy","title":"Fix RIR=0 handling in internal response resolver (max effort sets)","description":"_rpe_internal_response currently ignores rir=0 because it checks rir \u003e 0.0. For max-effort sets this causes fallback to modality prior and underestimates load/intensity. Repro: same set with rir=0 yields lower load and source=modality_prior, while rir=1 uses rir_inverse with higher load.","status":"closed","priority":1,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-19T23:02:06.799926+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T23:11:29.894693+01:00","closed_at":"2026-02-19T23:11:29.894693+01:00","close_reason":"Closed","comments":[{"id":47,"issue_id":"kura-training-y9sy","author":"jonzim-cmd","text":"Fix umgesetzt: RIR-Pfad akzeptiert jetzt rir=0 als valides Max-Effort-Signal (vorher fallback auf modality_prior). Dazu wurde finite-float parsing ergänzt, sodass ungültige Werte weiterhin sauber verworfen werden. Test: test_training_load_calibration_v1.py::test_rir_zero_is_treated_as_max_effort_signal.","created_at":"2026-02-19T22:11:27Z"}]}
{"id":"kura-training-yep","title":"Observability: Access Pattern Logging Middleware","description":"Strukturiertes Access-Log auf API-Ebene. Erfasst Agent-Zugriffsmuster unabhängig davon, ob CLI oder MCP Server der Client ist.\n\nLogged wird:\n(timestamp, user_id, method, endpoint, projection_type, key, status_code, batch_size, response_time_ms)\n\nKeine User-Daten, nur Zugriffsmuster.\n\nDaraus lesen wir:\n- Welche Projections zusammen gelesen werden (→ Kandidaten für Graduation zu Domain-Tools)\n- Welche Event-Sequenzen häufig sind (→ Batch-Optimierungen)\n- Ob Batch oder Einzel überwiegt\n- Welche Endpoints nie genutzt werden (→ tote API-Fläche)\n- Response-Zeiten pro Endpoint (→ Performance-Monitoring)\n\nImplementierung: axum Middleware/Layer, eigene Tabelle (api_access_log), kein RLS nötig (Infra-Daten, nicht User-Daten).\n\nMuss VOR dem ersten echten Agent-Einsatz stehen — sonst fehlen die Daten von Anfang an.\n\nUnabhängig von den Data Integrity Tickets — kann parallel gebaut werden.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:58.20729+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T16:47:55.092723+01:00","closed_at":"2026-02-09T16:47:55.092723+01:00","close_reason":"Auth refactored to Tower Layer (InjectAuthLayer), AccessLogLayer captures all /v1/* access patterns, api_access_log table with analytics indexes. 26 Rust + 233 Python tests passing."}
{"id":"kura-training-yi1","title":"Decision 13 Phase 0: Self-Healing Instrumentation","description":"Implement the first production slice from docs/design/013-self-healing-agentic-data-plane.md (Phase 0). Add read-only invariant evaluation over events/projections and a quality_health/overview projection so system quality becomes measurable before autonomous repair.","design":"Reference: docs/design/013-self-healing-agentic-data-plane.md (Decision 13), sections Decision 13.2, 13.3, 13.4, Rollout Phase 0. Keep append-only and non-mutating behavior; no auto-fixes in this phase.","acceptance_criteria":"1) Invariant evaluator runs in read-only mode and emits typed issues without mutating canonical events. 2) New projection quality_health/overview is computed and queryable. 3) Projection includes score/status/open-issue counts by severity and top issue summaries. 4) At least one integration-style test proves issue detection from real event data. 5) Documentation/comments reference Decision 13 explicitly.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T16:13:13.624513+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T16:17:33.185633+01:00","closed_at":"2026-02-11T16:17:33.185633+01:00","close_reason":"Implemented Decision 13 Phase 0 slice: read-only invariant evaluator (INV-001/003/005/006), new quality_health/overview projection with score/status/issue summaries, unit tests, and integration-style quality health test (DB-backed)."}
{"id":"kura-training-zgow","title":"Reduce token-like MCP session_id exposure in ChatGPT consent flow","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-21T07:17:34.707018+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-21T07:19:39.201951+01:00","closed_at":"2026-02-21T07:19:39.201951+01:00","close_reason":"Closed"}
{"id":"kura-training-zhr","title":"Split system layer: system_config table + endpoint","description":"Extract deployment-static system layer from user_profile monolith into separate system_config table and API endpoint. system_config written at worker startup, user_profile slimmed to user+agenda only.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T14:45:26.846565+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T14:51:28.948653+01:00","closed_at":"2026-02-09T14:51:28.948653+01:00","close_reason":"Implemented: system_config table + GET /v1/system/config endpoint. user_profile slimmed to {user, agenda}. 204 Python tests passing, Rust compiles clean."}
{"id":"kura-training-zjm3","title":"Load-Methodik: Intensitätsgewichtung für Endurance/Intervall ergänzen","description":"## Kontext\n`kura-training-zjm3` ist der Umbrella für die methodische Aufrüstung von Training-Load zu Goldstandard-Niveau über alle relevanten Sportarten. Aktuell ist Last primär dosisbasiert (Volumen/Dauer/Distanz/Kontakte), während Intensität, Korrekturen und mehrere Signalpfade unvollständig abgedeckt sind.\n\n## Warum\nOhne Intensitätsdimension, durchgängige Pfad-Parität und faire Modality-Abdeckung drohen systematische Verzerrungen: falsche Last-Äquivalenzen, sportartspezifische Benachteiligung, und instabile Confounder in Causal/Readiness. Das gefährdet Agent-First-Qualität und User-UX (falsche Sicherheit, unklare Empfehlungen).\n\n## Zielbild\n- Duale Last: `external_dose` + `internal_response` + Unsicherheit.\n- Einheitliche Lastfunktion in Readiness/Causal/Eval.\n- `session.logged`, `set.corrected`, `external.activity_imported` konsistent in allen relevanten Pfaden.\n- Modality-faire Abdeckung inkl. nicht-Strength-zentrierter Sportarten.\n- Architektur-Invarianten dauerhaft in `tests/architecture/` abgesichert.\n\n## Delivery-Prinzip\nSpec-first in separaten Beads, danach Implementierungs-Beads mit harten Dependencies. Jede Sub-Task enthält `Wie` und konkrete Dateipfade, damit Kontextverlust nach Compacting die Umsetzung nicht gefährdet.","acceptance_criteria":"Alle abhängigen zjm3-Subtasks sind geschlossen; Quality Gates laufen grün; Änderungen sind gepusht und dokumentiert.","status":"closed","priority":2,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-19T15:12:52.205522+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:17:58.291019+01:00","closed_at":"2026-02-19T16:17:58.291019+01:00","close_reason":"Closed"}
{"id":"kura-training-zjm3.1","title":"zjm3 Spec: Duale Last (Dose+Intensität+Unsicherheit) als Architektur-Invariante","description":"Kontext: Load ist aktuell dosisdominiert. Warum: Goldstandard verlangt interne+externe Last plus Unsicherheit. Wie: Ergänze/aktualisiere Architecture-Tests in tests/architecture/ für 1) gleiche Dosis + höhere Intensität =\u003e höherer Load, 2) Fallback-Hierarchie für Intensität (Power/HR/Pace/RPE/Heuristik), 3) Unsicherheit steigt bei schwächeren Intensitätssignalen, 4) keine ACWR-only Entscheidungslogik.","acceptance_criteria":"Architecture-Tests in tests/architecture/ beschreiben die Invariante vollständig und failen gegen altes Verhalten.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T15:58:19.212612+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:17:53.488236+01:00","closed_at":"2026-02-19T16:17:53.488236+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-zjm3.1","depends_on_id":"kura-training-zjm3","type":"parent-child","created_at":"2026-02-19T15:58:19.213406+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-zjm3.2","title":"zjm3 Spec: Signalpfad-Parität (session.logged, set.corrected, external import, eval/nightly)","description":"Kontext: Relevante Eventtypen sind inkonsistent zwischen Readiness/Causal/Eval/Nightly. Warum: Inkonsistente Signalpfade führen zu methodischen Drift und UX-Verwirrung. Wie: Architektur-Tests für verpflichtende Eventabdeckung und gemeinsame Logik erstellen: session.logged + set.corrected müssen in Readiness/Causal genutzt werden; eval_harness muss external.activity_imported/session.logged replayen; nightly muss bei diesen Eventtypen refit triggern.","acceptance_criteria":"Architektur-Contracts erzwingen Signalpfad-Parität über die genannten Module; fehlende Eventtypen brechen Tests.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T15:58:19.377419+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:17:53.518634+01:00","closed_at":"2026-02-19T16:17:53.518634+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-zjm3.2","depends_on_id":"kura-training-zjm3","type":"parent-child","created_at":"2026-02-19T15:58:19.378032+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-zjm3.3","title":"zjm3 Impl: compute_row_load_components_v2 zentral implementieren","description":"Kontext: trainings_load_calibration_v1.py bildet Last aktuell ohne Intensitätsfaktor. Warum: Dosis allein benachteiligt/verschleiert sportartspezifische Belastung. Wie: In workers/src/kura_workers/training_load_calibration_v1.py eine v2-Komposition ergänzen (external_dose, internal_response, uncertainty, fallback hierarchy). Feature-flagged aktivieren und von readiness_signals.py zentral konsumieren.","acceptance_criteria":"Load v2 liefert bei gleicher Dosis unterschiedliche Scores gemäß Intensität und gibt Unsicherheitskomponente aus; Unit-Tests vorhanden.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-19T15:58:19.532065+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:17:53.550576+01:00","closed_at":"2026-02-19T16:17:53.550576+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-zjm3.3","depends_on_id":"kura-training-zjm3","type":"parent-child","created_at":"2026-02-19T15:58:19.532963+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zjm3.3","depends_on_id":"kura-training-zjm3.1","type":"blocks","created_at":"2026-02-19T15:58:32.140138+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-zjm3.4","title":"zjm3 Impl: session.logged + set.corrected in Readiness/Causal/Strength integrieren","description":"Kontext: Readiness/Causal (und Strength) sind gegenüber session.logged/set.corrected lückenhaft. Warum: Korrigierte und session-level Daten müssen Priorität haben, sonst bleibt Empfehlung fehleranfällig. Wie: Queries/Preprocessing in workers/src/kura_workers/handlers/readiness_inference.py, workers/src/kura_workers/handlers/causal_inference.py, workers/src/kura_workers/handlers/strength_inference.py auf session.logged und set.corrected erweitern; Korrekturen vor Scoring mergen.","acceptance_criteria":"Readiness/Causal/Strength berücksichtigen session.logged und set.corrected deterministisch; Regression-Tests decken Merge-/Prioritätsregeln ab.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-19T15:58:19.686735+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:17:53.580067+01:00","closed_at":"2026-02-19T16:17:53.580067+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-zjm3.4","depends_on_id":"kura-training-zjm3","type":"parent-child","created_at":"2026-02-19T15:58:19.687468+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zjm3.4","depends_on_id":"kura-training-zjm3.2","type":"blocks","created_at":"2026-02-19T15:58:32.298267+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zjm3.4","depends_on_id":"kura-training-zjm3.3","type":"blocks","created_at":"2026-02-19T15:58:32.445786+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-zjm3.5","title":"zjm3 Impl: External-Import Contract/Pipeline für Intensität und Provenance erweitern","description":"Kontext: Import-Pipeline verliert HR/Power/Pace/RPE-Informationen früh. Warum: Ohne kanonische Intensitätsfelder kann Load v2 nicht sportgerecht arbeiten. Wie: external_activity_contract.py, external_import_pipeline.py, external_import_mapping_v2.py um workout-/set-level Intensitätsfelder + measurement_state/provenance erweitern; Parser für FIT/TCX/GPX entsprechend mappen.","acceptance_criteria":"Canonical Payload enthält Intensitätsfelder mit Herkunft und Measurement-State; Parser-/Mapping-Tests sind grün.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-19T15:58:19.853197+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:17:53.608536+01:00","closed_at":"2026-02-19T16:17:53.608536+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-zjm3.5","depends_on_id":"kura-training-zjm3","type":"parent-child","created_at":"2026-02-19T15:58:19.854165+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zjm3.5","depends_on_id":"kura-training-zjm3.1","type":"blocks","created_at":"2026-02-19T15:58:32.597401+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-zjm3.6","title":"zjm3 Impl: Eval-Harness und Nightly-Recalibration auf neue Signalpfade ausrichten","description":"Kontext: Eval/Nightly nutzen aktuell nicht alle produktiven Eventpfade. Warum: Ohne Parität entstehen falsche Offline-Schlüsse und verzögerte Modellanpassung. Wie: workers/src/kura_workers/eval_harness.py und workers/src/kura_workers/handlers/inference_nightly.py so erweitern, dass external.activity_imported und session.logged konsistent einfließen und dieselbe Load-Logik verwenden.","acceptance_criteria":"Eval-Replay und Nightly-Trigger decken die neuen Eventtypen ab; Architektur- und Unit-Tests bestätigen Parität.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T15:58:20.019771+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:17:53.640317+01:00","closed_at":"2026-02-19T16:17:53.640317+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-zjm3.6","depends_on_id":"kura-training-zjm3","type":"parent-child","created_at":"2026-02-19T15:58:20.020611+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zjm3.6","depends_on_id":"kura-training-zjm3.2","type":"blocks","created_at":"2026-02-19T15:58:32.757557+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zjm3.6","depends_on_id":"kura-training-zjm3.3","type":"blocks","created_at":"2026-02-19T15:58:32.912551+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zjm3.6","depends_on_id":"kura-training-zjm3.5","type":"blocks","created_at":"2026-02-19T15:58:33.069047+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-zjm3.7","title":"zjm3 Impl: Modality-Fairness für weitere Sportarten (swim/rowing/team/jumps)","description":"Kontext: Modality-Mapping ist noch eng (running/cycling/strength/hybrid). Warum: Sportarten ohne eigene Pfade werden systematisch falsch approximiert. Wie: external_import_mapping_v2.py und Load-Profile um swim/rowing/team-sport/jump-spezifische externe/intensive Lastkomponenten inkl. Fallbacks erweitern; faire Defaults mit Unsicherheitsaufschlag definieren.","acceptance_criteria":"Neue Modality-Profile sind aktiv, testabgedeckt und liefern plausible Lastdifferenzierung statt Strength-Bias.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-19T15:58:20.183651+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:17:53.667823+01:00","closed_at":"2026-02-19T16:17:53.667823+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-zjm3.7","depends_on_id":"kura-training-zjm3","type":"parent-child","created_at":"2026-02-19T15:58:20.184434+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zjm3.7","depends_on_id":"kura-training-zjm3.1","type":"blocks","created_at":"2026-02-19T15:58:33.218636+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zjm3.7","depends_on_id":"kura-training-zjm3.5","type":"blocks","created_at":"2026-02-19T15:58:33.373313+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-zjm3.8","title":"zjm3 Impl: Agent-first UX absichern (Timeline/Profile/Fairness-Signale)","description":"Kontext: User-facing Ableitungen sind teils strength-zentriert und können Unsicherheit nicht klar transportieren. Warum: Agent-first verlangt nachvollziehbare, faire, nicht-irreführende Outputs. Wie: workers/src/kura_workers/handlers/training_timeline.py und workers/src/kura_workers/handlers/user_profile.py um modality-neutrale KPI-Priorisierung und Unsicherheits-/Coverage-Hinweise ergänzen; bestehende UX nicht verschlechtern.","acceptance_criteria":"Timeline/Profile zeigen modality-fairere Kennzahlen und Unsicherheitskontext; bestehende Response-Contracts bleiben kompatibel.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-19T15:58:20.333346+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-19T16:17:53.694763+01:00","closed_at":"2026-02-19T16:17:53.694763+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-zjm3.8","depends_on_id":"kura-training-zjm3","type":"parent-child","created_at":"2026-02-19T15:58:20.334019+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zjm3.8","depends_on_id":"kura-training-zjm3.2","type":"blocks","created_at":"2026-02-19T15:58:33.526484+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zjm3.8","depends_on_id":"kura-training-zjm3.4","type":"blocks","created_at":"2026-02-19T15:58:33.675033+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zjm3.8","depends_on_id":"kura-training-zjm3.7","type":"blocks","created_at":"2026-02-19T15:58:33.829481+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-znc","title":"Mismatch-Severity nach Datenintegritäts-Risiko gewichten","description":"## Entscheidungszusammenfassung (Warum)\n\nDie aktuelle Mismatch-Metrik ist binaer und vermischt unterschiedliche Risiken zu einem einzigen Zaehler. Damit kann ein rein protokollarischer Mangel (z. B. Event-ID im Echo fehlt) dieselbe Degradierung ausloesen wie ein echter Integritaets-Bruch (Echo fehlt komplett). Das fuehrt zu False Positives in Auto-Tiering und verschlechtert UX ohne realen Sicherheitsgewinn. Diese Aufgabe fuehrt eine risikobasierte Gewichtung (`critical/warning/info`) ein, ohne Alt-Daten zu brechen. Ergebnis: Tiering und Lernsignale spiegeln Datenmull-Risiko statt Format-Pedanterie.\n\n## Harte Vorbedingung\n\n- Abhaengig von `kura-training-vcf` (Save-Echo Always-On).\n- Erst nach expliziter Save-Echo-Policy macht die Severity-Gewichtung semantisch konsistent Sinn.\n\n## Problem im Ist-Zustand (Code-Referenz)\n\n- Worker berechnet Mismatch aktuell binaer:\n  - `workers/src/kura_workers/handlers/quality_health.py` (`_compute_save_claim_slo`, Zeilenbereich ~1242-1280)\n- Auto-Tiering SQL zaehlt binaer `mismatch_detected`:\n  - `api/src/routes/agent/policy.rs` (`resolve_auto_tier_policy`, SQL im Zeilenbereich ~783-810)\n- Learning-Clustering kennt nur statisches Signalgewicht ohne differenzierte Save-Mismatch-Severity:\n  - `workers/src/kura_workers/issue_clustering.py` (`_SEVERITY_WEIGHT_BY_SIGNAL`, Zeilenbereich ~27-41)\n- API schreibt aktuell `mismatch_detected = !allow_saved_claim` (Proof-Mismatch), nicht Echo-Detail-Risiko:\n  - `api/src/routes/agent/write_verification.rs` (Zeilenbereich ~872-883)\n\n## Zielzustand (Invarianten)\n\n1. Save-Mismatch wird in `critical|warning|info|none` klassifiziert.\n2. Auto-Tiering nutzt **gewichtete** Mismatch-Last statt roher Count-Bits.\n3. Alt-Events ohne Severity-Felder bleiben verarbeitbar (deterministischer Fallback).\n4. Proof-Mismatch (`allow_saved_claim=false`) und Echo-Mismatch bleiben unterscheidbar, aber aggregierbar.\n5. Metriken liefern Breakdowns pro Severity fuer Auditierbarkeit.\n\n## Datenvertrag (verbindlich)\n\n`quality.save_claim.checked.data` wird erweitert um:\n\n- `mismatch_severity`: `\"critical\"|\"warning\"|\"info\"|\"none\"`\n- `mismatch_weight`: `1.0|0.5|0.1|0.0`\n- `mismatch_domain`: `\"save_echo\"|\"proof_verification\"|\"protocol\"`\n- `mismatch_reason_codes`: `string[]`\n\nKompatibilitaetsregeln fuer Alt-Events (wenn Felder fehlen):\n\n- Wenn `mismatch_detected=true` -\u003e Fallback `critical` + Gewicht `1.0`\n- Wenn `mismatch_detected=false` -\u003e Fallback `none` + Gewicht `0.0`\n\nHinweis: Diese Fallback-Regel ist hart zu testen; keine impliziten Defaults in mehreren Modulen verstreuen.\n\n## Implementierungs-Scope (Wie)\n\n### A) API: Severity erzeugen und persistieren\n\n- `api/src/routes/agent/write_verification.rs`\n  - Klassifikationsfunktion einfuehren, die aus Echo-/Proof-Check eine Severity ableitet.\n  - `build_save_claim_checked_event(...)` erweitert Payload um `mismatch_severity`, `mismatch_weight`, `mismatch_domain`, `mismatch_reason_codes`.\n  - `learning.signal.logged` Attribute fuer `save_claim_mismatch_attempt` um gleiche Kernfelder erweitern.\n\n### B) Worker: gewichtete Integrity-SLOs\n\n- `workers/src/kura_workers/handlers/quality_health.py`\n  - `_compute_save_claim_slo(...)` auf gewichtete Summen erweitern.\n  - Neue Ausgabe-Felder:\n    - `weighted_mismatch_sum`\n    - `weighted_mismatch_rate_pct`\n    - `severity_breakdown` (`critical/warning/info/none`)\n  - Legacy-Output nur wenn noetig beibehalten; konsumierende Pfade klar auf weighted umstellen.\n\n### C) Auto-Tiering SQL auf gewichtete Mismatch-Last\n\n- `api/src/routes/agent/policy.rs`\n  - SQL in `resolve_auto_tier_policy(...)` von binaerem `SUM(CASE mismatch_detected ...)` auf gewichtete Summe umstellen:\n    - Primar: `mismatch_weight`\n    - Fallback: binaere Ableitung wie oben\n  - Prozentberechnung bleibt `weighted_sum / sample_count * 100`.\n  - Schwellenwerte dokumentieren und bei Bedarf minimal nachziehen (keine stillen Aenderungen).\n\n### D) Cross-user Clustering\n\n- `workers/src/kura_workers/issue_clustering.py`\n  - Save-Mismatch-Severity aus Signal-Attributen einlesen und in Severity-Faktor einfliessen lassen.\n  - Falls Attribut fehlt: bestehendes Verhalten als Fallback.\n\n## Architecture-Spec-Tests (Pflicht laut AGENTS.md)\n\nNeue/angepasste Tests in `tests/architecture/`:\n\n1. `tests/architecture/test_12_save_claim_mismatch_severity_contract.py`\n   - Runtime-Kontrakte via `assert_kura_api_test_passes(...)`:\n     - `routes::agent::tests::save_claim_mismatch_severity_contract_critical_when_echo_missing`\n     - `routes::agent::tests::save_claim_mismatch_severity_contract_info_when_only_protocol_detail_missing`\n     - `routes::agent::tests::save_claim_mismatch_severity_contract_backcompat_defaults_for_legacy_payload`\n\n2. `tests/architecture/test_60_agent_contract_coverage_matrix.py`\n   - Contract-Key fuer `save_claim_mismatch_severity` aufnehmen.\n\n3. Worker-Architektur-Absicherung (pythonseitig, deterministic)\n   - Test auf gewichtete SLO-Berechnung inkl. Alt-Event-Fallback.\n\n## Nicht-Ziele\n\n- Keine Aenderung am strict-only Intent-Handshake.\n- Keine neue UI.\n- Keine manuelle Datenmigration historischer Events.\n\n## Akzeptanzkriterien\n\n- `quality.save_claim.checked` schreibt Severity + Weight + Domain + Reason-Codes.\n- Auto-Tiering verwendet gewichtete Mismatch-Last mit dokumentiertem Legacy-Fallback.\n- `quality_health` liefert Severity-Breakdown und gewichtete Rate.\n- Clustering priorisiert Save-Mismatch-Faelle nach Severity statt pauschal 1.0.\n- Alle neuen Architecture-Spec-Tests sind gruen.\n\n## Hinweise fuer KI-Umsetzung mit wenig Kontext (compaction-resistent)\n\n- Niemals `mismatch_detected` umdeuten, ohne Fallback explizit zu codieren und zu testen.\n- Bei Konflikt zwischen Datenreinheit und Rueckwaertskompatibilitaet: kompatibel ausrollen, dann Konsumenten schrittweise umstellen.\n- Gewichtung ist ein **Policy-Contract**, kein stilles Refactoring; Schwellen und Formel muessen im Code erkennbar bleiben.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T11:29:49.436705+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T13:09:29.082697+01:00","closed_at":"2026-02-14T13:09:29.082697+01:00","close_reason":"Implemented: classify_mismatch_severity (critical/warning/info/none), weighted SLO in quality_health, auto-tiering SQL with weight threshold, issue_clustering severity modifiers. 5 Rust tests, 6 Python arch tests. 257 Rust + 86 arch + 29 quality_health + 4 clustering tests green.","dependencies":[{"issue_id":"kura-training-znc","depends_on_id":"kura-training-vcf","type":"blocks","created_at":"2026-02-14T11:29:55.142577+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-zv3","title":"API: Signup invite gate (SIGNUP_GATE config)","description":"## Was\nRegistration-Endpoint um Invite-Token-Validierung erweitern. Config-Switch für Gate-Modus.\n\n## Config\n- Env-Variable: SIGNUP_GATE=invite|open|payment (default: open)\n- Bei invite: Registration erfordert gültiges invite_token\n- Bei open: keine Prüfung (aktuelles Verhalten)\n- Bei payment: Platzhalter, gibt 403 mit Hinweis zurück (für später)\n\n## Änderungen an POST /v1/auth/register\n- Neues optionales Feld: invite_token\n- Wenn SIGNUP_GATE=invite:\n  - invite_token required, sonst 403 { error: \"invite_required\", message: \"...\", docs_hint: \"Request access at /request-access\" }\n  - Token validieren: existiert, nicht abgelaufen, nicht benutzt, Email-Match wenn gebunden\n  - Bei Erfolg: used_at=now(), used_by=new_user_id setzen\n- Neues Feld: consent_anonymized_learning (bool, required wenn SIGNUP_GATE=invite)\n  - Muss true sein für Registrierung im invite-Modus\n  - Wird am User gespeichert\n\n## Fehler\n- 403 invite_required: kein Token bei SIGNUP_GATE=invite\n- 403 invite_invalid: Token ungültig, abgelaufen, oder bereits benutzt\n- 403 invite_email_mismatch: Token an andere Email gebunden\n- 400 consent_required: consent_anonymized_learning fehlt oder false\n\n## Hinweise\n- Abwärtskompatibel: SIGNUP_GATE=open → alles wie bisher\n- invite_token Feld wird einfach ignoriert bei open-Modus","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:45:12.223285+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:03:43.459357+01:00","closed_at":"2026-02-13T13:03:43.459357+01:00","close_reason":"SIGNUP_GATE config + invite validation in register","dependencies":[{"issue_id":"kura-training-zv3","depends_on_id":"kura-training-33v","type":"blocks","created_at":"2026-02-13T12:46:55.533685+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zv3","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:37.11362+01:00","created_by":"jonzim-cmd"}]}
