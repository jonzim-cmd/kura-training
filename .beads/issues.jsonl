{"id":"kura-training-0hf","title":"Write Path: POST /v1/events + POST /v1/events/batch mit Idempotency","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:05.490369+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T07:26:40.287064+01:00","closed_at":"2026-02-08T07:26:40.287064+01:00","close_reason":"Closed"}
{"id":"kura-training-0hg","title":"Add causal inference telemetry + API parity","description":"Support causal_inference in inference_runs telemetry (schema + writer paths) and expose the projection consistently in API projection metadata/routing summaries where inference projections are enumerated.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T13:54:58.309524+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T14:26:25.543557+01:00","closed_at":"2026-02-11T14:26:25.543557+01:00","close_reason":"Closed","labels":["agent-first","causal","observability"]}
{"id":"kura-training-0yc","title":"API: Admin invite management endpoints","description":"## Was\nAdmin-Endpoints für Invite-Verwaltung und Access-Request-Review.\n\n## Endpoints\n\n### GET /v1/admin/access-requests?status=pending\n- Listet Access Requests, filterbar nach status\n- Response: { \"requests\": [{ id, email, name, context, status, created_at }] }\n\n### POST /v1/admin/access-requests/{id}/approve\n- Setzt status=approved, reviewed_at=now(), reviewed_by=admin\n- Generiert invite_token (kura_inv_ + 32 hex, 7 Tage gültig, an Request-Email gebunden)\n- Verlinkt invite_token_id am access_request\n- Response: { \"status\": \"approved\", \"invite_token\": \"kura_inv_...\", \"invite_url\": \"https://...?invite=TOKEN\" }\n\n### POST /v1/admin/access-requests/{id}/reject\n- Setzt status=rejected\n- Response: { \"status\": \"rejected\" }\n\n### POST /v1/admin/invites\n- Erstellt manuellen Invite (ohne Access Request)\n- Body: { \"email\": \"...\" (optional), \"expires_in_days\": 7 (optional, default 7) }\n- Response: { \"token\": \"kura_inv_...\", \"invite_url\": \"...\", \"expires_at\": \"...\" }\n\n### GET /v1/admin/invites?status=unused|used|expired\n- Listet Invites mit Status\n\n## Auth\n- Alle Endpoints: Admin-only (bestehende Admin-Auth-Middleware)\n\n## Hinweise\n- Token-Generierung: kura_inv_ + 32 random hex (wie kura_sk_ Pattern)\n- invite_url: {FRONTEND_URL}/signup?invite={token}\n- FRONTEND_URL aus Config/Env","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:44:54.108201+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:03:38.296159+01:00","closed_at":"2026-02-13T13:03:38.296159+01:00","close_reason":"Admin invite endpoints implemented + Resend email","dependencies":[{"issue_id":"kura-training-0yc","depends_on_id":"kura-training-33v","type":"blocks","created_at":"2026-02-13T12:46:50.341411+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-0yc","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:31.9047+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-15g","title":"Decision 13: Explicit autonomy confirmation templates by SLO status","description":"Translate integrity SLO/autonomy-throttle signals into explicit agent prompt policy with fixed confirmation templates for healthy/monitor/degraded states, exposed via system_config and claim_guard guidance.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:28:52.469907+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T18:33:38.77841+01:00","closed_at":"2026-02-11T18:33:38.77841+01:00","close_reason":"Closed"}
{"id":"kura-training-1ac","title":"Add population priors support for causal_inference","description":"Extend population prior resolution to support causal_inference in workers/src/kura_workers/population_priors.py (currently limited to strength_inference/readiness_inference). Define prior payload schema for causal estimands, privacy gates, and blend policy; wire into causal handler and add tests for opt-in/privacy constraints and fallback behavior.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T14:42:50.116024+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T15:28:58.37727+01:00","closed_at":"2026-02-11T15:28:58.37727+01:00","close_reason":"Closed","labels":["bayesian","causal","privacy"]}
{"id":"kura-training-1e8","title":"Causal Inference Layer: Intervention-Effekte statt nur Korrelationen","description":"Build a dedicated causal inference layer that estimates intervention effects (program changes, nutrition shifts, sleep interventions) using observational data with explicit assumptions. Include propensity-style adjustment, uncertainty intervals, and machine-readable caveats for agents.","notes":"Out-of-scope for current Semantic/Bayesian delivery; follow-up innovation track.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T08:36:55.196912+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T13:55:25.247826+01:00","closed_at":"2026-02-11T13:55:25.247826+01:00","close_reason":"Closed","labels":["agent-first","causal","statistics"]}
{"id":"kura-training-1ls","title":"Decision 13 F6: Integrity SLOs + autonomy throttling","description":"Measure integrity SLOs from quality_health (unresolved set ratio, save-claim mismatch rate, repair latency), define healthy/monitor/degraded thresholds, and expose policy-gated autonomy throttling (max scope + confirmation strictness) so agent behavior is automatically constrained on regressions.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:19:32.704343+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T18:25:02.076658+01:00","closed_at":"2026-02-11T18:25:02.076658+01:00","close_reason":"Closed"}
{"id":"kura-training-2kb","title":"Agent-Verhaltens-Conventions in system_config","description":"Neue Sektion in system_config für Agent-Verhalten (nicht Daten-Conventions): Bei Mehrdeutigkeit nachfragen statt annehmen, nicht mehr erstellen als explizit gewünscht, Follow-up-Fragen bei fehlenden Daten. System-Defaults in system_config, User-Overrides in user_profile. Quasi eine soul.md als Datenstruktur. Entdeckt im Kura-Playtest 2026-02-09 (über-eifriger Agent hat 3-Tage-Plan statt nur Tag A erstellt).","notes":"Grundgerüst implementiert: vision (Bach-Prinzipien) + operational (scope levels, rules). Follow-up: konkrete Szenarien, Beispiele, User-Override-Mechanismus in user_profile.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:50.376579+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:25:44.812262+01:00","closed_at":"2026-02-10T07:25:44.812262+01:00","close_reason":"Grundgerüst implementiert. Detailausbau als Follow-up."}
{"id":"kura-training-2zc","title":"Continuous Learning Loop: Learn from all users without explicit reports","description":"Build a production learning loop so Kura learns from implicit user behavior and agent failures, not only from manual feedback. Problem: most users never report issues, and many failure modes are invisible unless instrumented. Goal: turn repeated runtime friction into prioritized engineering work automatically.","design":"Context: Decision 13 enables self-healing operations, but platform evolution still needs cross-user pattern learning. Implement privacy-aware telemetry -\u003e issue clustering -\u003e prioritized backlog generation -\u003e regression promotion. This closes the gap between observed field behavior and roadmap execution even when users do not actively contribute to product development.","acceptance_criteria":"1) Define telemetry taxonomy for quality/friction/outcome events. 2) Aggregate and cluster recurring issue signatures across users (pseudonymized). 3) Compute priority score from frequency x severity x outcome impact x reproducibility. 4) Produce a machine-readable weekly learning report and candidate issue list. 5) Define promotion path from recurring cluster -\u003e invariant/policy/test. 6) Document privacy boundaries and retention policy.","notes":"Session handoff 2026-02-13: Learning-loop foundation is complete (taxonomy, clustering, calibration, backlog bridge, unknown mining, shadow eval). Next-phase consumer is kura-training-wvp (model-aware runtime policy), which turns these signals into deterministic runtime autonomy gates.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:01:42.463218+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:55:29.605466+01:00","closed_at":"2026-02-13T09:55:29.605466+01:00","close_reason":"Foundation complete; handed off to model-aware runtime phase"}
{"id":"kura-training-2zc.1","title":"Learning Telemetry Taxonomy + Event Emission","description":"Implement a canonical telemetry schema for implicit learning signals. Problem: failures and friction are currently under-observed and hard to compare across users/sessions/agents. Build structured events for quality defects, user corrections, retries, retractions, and conversational friction.","design":"Create explicit event categories (quality_signal, friction_signal, outcome_signal, correction_signal). Include stable signature fields for clustering (issue_type, invariant_id, agent_version, workflow_phase, modality, confidence_band). Emit telemetry from relevant API/worker/agent touchpoints with pseudonymized user identifiers.","acceptance_criteria":"1) Telemetry schema versioned and documented. 2) At least 10 core signal types emitted with stable payload contracts. 3) Events include clustering keys and timestamps. 4) Pseudonymization enforced for cross-user aggregation. 5) Unit/integration tests verify emission and schema validity.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:02:20.077097+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:05:14.961708+01:00","closed_at":"2026-02-11T19:05:14.961708+01:00","close_reason":"Added canonical learning telemetry schema (v1), pseudonymized signal emission in quality health + save handshake, docs, and validation tests.","dependencies":[{"issue_id":"kura-training-2zc.1","depends_on_id":"kura-training-2zc","type":"parent-child","created_at":"2026-02-11T17:02:20.079603+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2zc.2","title":"Cross-user Issue Clustering + Priority Scoring","description":"Cluster recurring failures from telemetry and rank them automatically. Problem: teams miss systemic issues because incidents appear as isolated anecdotes. Build a clustering and scoring pipeline that produces actionable recurring-problem groups.","design":"Use stable issue signatures from telemetry. Cluster by invariant/failure type plus context facets (workflow phase, modality, agent model/version). Compute priority = frequency x severity x outcome-impact x reproducibility. Keep explainable scoring outputs for auditability.","acceptance_criteria":"1) Daily/weekly batch produces clustered issue groups with human-readable summaries. 2) Each cluster has score and factor breakdown. 3) Cluster output includes representative examples and affected workflow phases. 4) False-positive controls documented (minimum support, confidence thresholds). 5) Tests cover clustering determinism and score calculation.","notes":"Implemented artifacts\n- docs/design/033-cross-user-issue-clustering-and-priority-scoring.md (deterministic clustering/scoring model + controls)\n- migrations/20260226000001_learning_issue_clusters.sql\n  - new cross-user tables: learning_issue_clusters, learning_issue_cluster_runs\n  - indexes + grants for app_worker/app_writer\n- workers/src/kura_workers/issue_clustering.py\n  - deterministic clustering from learning.signal.logged by cluster_signature\n  - dual period outputs (day/week)\n  - explainable score factors: frequency * severity * impact * reproducibility\n  - false-positive controls (min support, min unique users, low-confidence filter)\n  - run telemetry persistence\n- workers/src/kura_workers/handlers/inference_nightly.py\n  - integrated issue-cluster refresh into nightly batch\n- workers/src/kura_workers/system_config.py\n  - added learning_clustering_v1 convention contract\n- workers/tests/test_issue_clustering.py (new deterministic + scoring unit coverage)\n- workers/tests/test_integration.py (nightly batch integration test for cluster refresh)\n- workers/tests/test_system_config.py (learning_clustering_v1 convention assertions)\n\nTests and exact commands\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- DB migration applied locally for integration gate:\n  - set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python - \u003c\u003c'PY' ... execute migrations/20260226000001_learning_issue_clusters.sql ... PY\n\nResidual risks / non-goals\n- V1 clustering is signature-based deterministic grouping only (no semantic merge across different signatures).\n- Score weights are heuristic defaults; calibration/threshold tuning is deferred to 2zc.5.\n- No automatic backlog ticket creation in this issue (handled by 2zc.3).\n\nFollow-up issues\n- kura-training-2zc.5 (confidence calibration + drift over clustering outputs)\n- kura-training-2zc.3 (cluster-to-backlog promotion bridge)\n- kura-training-2zc.6 (unknown-dimension mining integration)\n- kura-training-2zc.4 (shadow-eval gate using cluster deltas)\n\nRollback / disable path\n- Remove/disable refresh_issue_clusters(...) call in inference_nightly handler.\n- Keep tables inert (no writer path dependency) or revert migration if full rollback is required.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:02:38.073892+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T15:24:53.330128+01:00","closed_at":"2026-02-12T15:24:53.330128+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2zc.2","depends_on_id":"kura-training-2zc","type":"parent-child","created_at":"2026-02-11T17:02:38.07516+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.2","depends_on_id":"kura-training-2zc.1","type":"blocks","created_at":"2026-02-11T17:05:05.747185+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2zc.3","title":"Learning-to-Backlog Bridge + Regression Promotion","description":"Automatically convert recurring high-impact clusters into engineering artifacts. Problem: even detected patterns are lost if they are not operationalized into backlog items, invariants, and tests. Build a controlled bridge from clustered learnings to bd issues and regression assets.","design":"Define policy thresholds for auto-suggested issue creation. Generate candidate bd payloads with context, reproduction, and expected mitigation. Add promotion workflow: cluster -\u003e issue -\u003e invariant/policy/test update -\u003e shadow re-evaluation. Keep human approval gate for creation in initial rollout.","acceptance_criteria":"1) Pipeline outputs candidate bd issues in machine-readable form. 2) Candidates include root-cause hypothesis, impacted metrics, and suggested invariant/policy updates. 3) Promotion checklist documented and automated where possible. 4) At least one end-to-end demo from synthetic cluster to generated issue payload. 5) Guardrails prevent noisy/duplicate suggestions.","notes":"compact-safe:\n- artifacts: migrations/20260226000003_learning_backlog_bridge.sql; workers/src/kura_workers/learning_backlog_bridge.py; workers/src/kura_workers/handlers/inference_nightly.py; workers/src/kura_workers/system_config.py; workers/tests/test_learning_backlog_bridge.py; workers/tests/test_integration.py; workers/tests/test_system_config.py; docs/design/035-learning-to-backlog-bridge-and-regression-promotion-v1.md\n- tests:\n  1) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n  2) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n  3) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n  4) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- residual-risks/non-goals: v1 remains approval-gated and does not auto-create bd issues; candidate payload quality depends on upstream cluster/calibration signal quality and may still need human triage\n- follow-up-issues: kura-training-2zc.6 (use unknown-dimension mining signals as additional bridge source), kura-training-2zc.4 (consume promotion checklist + candidate priors in shadow eval gating)\n- rollback/disable: remove refresh_learning_backlog_candidates() from inference.nightly_refit and ignore learning_backlog_candidates outputs downstream","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:02:55.639134+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T15:48:59.804206+01:00","closed_at":"2026-02-12T15:48:59.804206+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2zc.3","depends_on_id":"kura-training-2zc","type":"parent-child","created_at":"2026-02-11T17:02:55.64011+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.3","depends_on_id":"kura-training-2zc.2","type":"blocks","created_at":"2026-02-11T17:05:16.031982+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2zc.4","title":"Shadow Evaluation for Policy/Agent Changes","description":"Run replay/shadow evaluations on historical sessions before broad rollout of new policies or agent behavior. Problem: fixes can regress unseen scenarios if not evaluated against diverse conversation histories. Build repeatable shadow runs with before/after metrics.","design":"Define representative replay corpus from pseudonymized traces and synthetic stress cases. Compare baseline vs candidate on quality and friction metrics. Gate rollouts on explicit pass criteria.","acceptance_criteria":"1) Shadow harness can run baseline and candidate configs side-by-side. 2) Report includes deltas for key quality metrics and failure classes. 3) Release gate criteria defined and enforced for selected changes. 4) One sample evaluation report committed/documented.","notes":"compact-safe completion notes\n\nimplemented artifacts\n- workers/src/kura_workers/eval_harness.py: added baseline-vs-candidate shadow execution, metric/source aggregation, delta evaluation, and release-gate report builder (`run_shadow_evaluation`, `build_shadow_evaluation_report`, deterministic pseudonymization helper)\n- workers/src/kura_workers/eval_cli.py: added `--shadow` mode + candidate override flags and dispatch to shadow harness\n- workers/src/kura_workers/system_config.py: added `shadow_evaluation_gate_v1` conventions (rules, entrypoint, inputs, delta thresholds, report sections)\n- workers/tests/test_eval_harness.py: added shadow delta/gate tests and combined-source reporting assertions\n- workers/tests/test_integration.py: added end-to-end shadow comparison integration test\n- workers/tests/test_system_config.py: validated new shadow-evaluation convention contract\n- docs/design/037-shadow-evaluation-release-gate-v1.md: design contract + rollout policy\n- docs/reports/shadow-eval-sample-report.json: committed sample output for downstream consumers\n\nvalidation commands (exact)\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nresidual risks / non-goals\n- non-goal: auto-promoting candidate configs from report output; this remains a separate release decision\n- residual risk: metric quality depends on representativeness of replay corpus and pseudonymized source labels\n- residual risk: defaults focus on evaluator metrics; teams may still tune thresholds for domain-specific rollout gates\n\nfollow-up issues\n- none required for AC scope; optional future work is corpus expansion + richer evaluator metrics\n\nrollback / disable path\n- CLI runtime rollback: stop using `--shadow` and continue with baseline single-run harness path\n- config rollback: remove/disable `shadow_evaluation_gate_v1` usage in policy rollout process\n- code rollback: revert eval-harness shadow functions and CLI flags in a single commit if needed","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:03:12.797507+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T16:07:50.606131+01:00","closed_at":"2026-02-12T16:07:50.606131+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2zc.4","depends_on_id":"kura-training-2zc","type":"parent-child","created_at":"2026-02-11T17:03:12.798457+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.4","depends_on_id":"kura-training-2zc.2","type":"blocks","created_at":"2026-02-11T17:05:26.316853+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2zc.5","title":"Extraction Calibration Pipeline: confidence scoring and drift monitoring","description":"Measure and continuously calibrate extraction quality for free-text-derived claims across users. Problem: confidence values are currently not closed-loop against observed correctness, so auto-repair risk can drift silently. Outcome: calibrated confidence and drift alarms for extraction/audit modules.","design":"Build evaluation dataset generation from resolved clarifications and correction outcomes. Compute calibration metrics (Brier score, reliability curves), precision/recall per dimension, and drift by model/parser version. Feed quality health with calibration status to gate auto-repair aggressiveness.","acceptance_criteria":"1) Calibration metrics computed per claim class/dimension. 2) Drift detection alerts when calibration degrades beyond threshold. 3) Quality-health policy can throttle/enable auto-repair based on calibration status. 4) Weekly report includes top underperforming extraction classes. 5) Tests validate metric computations deterministically.","notes":"compact-safe:\n- artifacts: migrations/20260226000002_extraction_calibration_metrics.sql; workers/src/kura_workers/extraction_calibration.py; workers/src/kura_workers/handlers/inference_nightly.py; workers/src/kura_workers/handlers/quality_health.py; workers/src/kura_workers/system_config.py; workers/tests/test_extraction_calibration.py; workers/tests/test_quality_health.py; workers/tests/test_system_config.py; workers/tests/test_integration.py; docs/design/034-extraction-calibration-and-drift-pipeline-v1.md; api/src/routes/agent.rs\n- tests:\n  1) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n  2) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n  3) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n  4) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- residual-risks/non-goals: v1 calibration labels are derived deterministically from correction/retraction signals only; no probabilistic relabeling and no per-user adaptive thresholds yet\n- follow-up-issues: kura-training-2zc.3 (backlog bridge consumes underperforming classes), kura-training-2zc.6 (unknown-dimension loop can reuse calibration confidence bands), kura-training-2zc.4 (shadow-eval should monitor calibration deltas pre/post policy changes)\n- rollback/disable: remove refresh_extraction_calibration() call from nightly inference handler and ignore calibration_status in autonomy policy gate to restore previous behavior","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T13:37:39.122993+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T15:40:17.692259+01:00","closed_at":"2026-02-12T15:40:17.692259+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2zc.5","depends_on_id":"kura-training-2zc.2","type":"blocks","created_at":"2026-02-12T13:37:39.126657+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.5","depends_on_id":"kura-training-pdc.19","type":"blocks","created_at":"2026-02-12T13:37:39.127506+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.5","depends_on_id":"kura-training-pdc.20","type":"blocks","created_at":"2026-02-12T13:37:39.12836+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.5","depends_on_id":"kura-training-2zc","type":"parent-child","created_at":"2026-02-12T13:40:11.427353+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-2zc.6","title":"Unknown-Dimension Mining + Suggestion Loop","description":"Mine recurring high-value unknown observations from transcripts and propose new dimensions/contracts. Problem: we cannot predefine all user inputs; unknowns must become a managed discovery stream. Outcome: ranked suggestions for new dimensions with evidence and estimated product impact.","design":"Aggregate unresolved/unknown observation patterns, cluster by semantic similarity + workflow context, and generate candidate dimension proposals (name, type, expected unit/scale, sample utterances, risk notes). Route accepted proposals into backlog generation bridge with duplicate controls.","acceptance_criteria":"1) Pipeline surfaces ranked unknown-dimension candidates with evidence bundles. 2) Candidate proposals include suggested schema and confidence. 3) Integration with learning-to-backlog bridge prevents duplicate noisy tickets. 4) Human approval workflow documented. 5) At least one end-to-end demo from unknown cluster to accepted dimension.","notes":"compact-safe:\n- artifacts: migrations/20260226000004_unknown_dimension_mining.sql; workers/src/kura_workers/unknown_dimension_mining.py; workers/src/kura_workers/learning_backlog_bridge.py; workers/src/kura_workers/handlers/inference_nightly.py; workers/src/kura_workers/system_config.py; workers/tests/test_unknown_dimension_mining.py; workers/tests/test_learning_backlog_bridge.py; workers/tests/test_integration.py; workers/tests/test_system_config.py; docs/design/036-unknown-dimension-mining-and-suggestion-loop-v1.md\n- tests:\n  1) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n  2) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n  3) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n  4) set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- residual-risks/non-goals: clustering is deterministic lexical+scope mining (no embedding model in v1); accepted-proposal promotion still requires explicit human status transition and no automatic schema mutation is performed\n- follow-up-issues: kura-training-2zc.4 (shadow-eval should compare unknown-dimension promotion effects before rollout)\n- rollback/disable: remove refresh_unknown_dimension_proposals() from nightly handler and stop routing accepted unknown proposals into learning_backlog_candidates (source_type=unknown_dimension)","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T13:37:44.353866+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T15:58:17.815522+01:00","closed_at":"2026-02-12T15:58:17.815522+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-2zc.6","depends_on_id":"kura-training-2zc.2","type":"blocks","created_at":"2026-02-12T13:37:44.357032+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.6","depends_on_id":"kura-training-2zc.3","type":"blocks","created_at":"2026-02-12T13:37:44.357829+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.6","depends_on_id":"kura-training-pdc.21","type":"blocks","created_at":"2026-02-12T13:37:44.358645+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-2zc.6","depends_on_id":"kura-training-2zc","type":"parent-child","created_at":"2026-02-12T13:40:16.628972+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316","title":"Unified Training Core Model v1 (Kraft + Ausdauer + Sprint + Plyo)","description":"Warum:\nDas aktuelle Modell ist fuer Kraft stark, aber fuer hybride Athleten (Kraft + Ausdauer + Sprint + Plyo) noch nicht semantisch einheitlich genug. Ohne gemeinsames Kernmodell entstehen Sonderfaelle, unklare Analysen und falsche Rueckfragen (z. B. HR-Zwang bei Kraft).\n\nWie:\nWir bauen ein sportartenuebergreifendes Session/Block-Modell mit block-spezifischen Pflichtfeldern, gestufter Vollstaendigkeit und klarer Provenance. Umsetzung erfolgt als issue chain: Spezifikation -\u003e executable specs -\u003e Implementierung -\u003e Migration -\u003e Rollout.\n\nErfolgskriterien:\nEine gemischte Session (z. B. Kraft + Intervalle + Plyo) kann in einem Modell gespeichert und analysiert werden. Fehlende Daten werden als not_measured/not_applicable behandelt, nicht als harter Validierungsfehler.","status":"open","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:23.648871+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T10:20:23.648871+01:00","labels":["architecture","domain-model","training"],"comments":[{"id":7,"issue_id":"kura-training-316","author":"jonzim-cmd","text":"Kontextanker fuer Session-Recovery:\n- Ziel ist EIN Kernmodell fuer Kraft, Ausdauer, Sprint, Plyo und Hybrid-Sessions (kein Nebenmodell fuer Ausdauer).\n- Modellprinzip: block-spezifische Pflichtfelder statt globaler Pflichtfelder.\n- Harte Regel: Keine globale HR-Pflicht. Fehlende Sensorik -\u003e measurement_state = not_measured/not_applicable.\n- Vollstaendigkeitsstufen: log_valid, analysis_basic, analysis_advanced.\n- Intensitaet: mindestens ein Anchor pro leistungsrelevantem Block (z. B. pace, power, HR, Borg/RPE, %Referenz).\n- Bot-Rueckfragen: nur fehlende Pflichtdaten des erkannten Blocktyps.\n- Analyse: modality-spezifisch + vereinheitlichte Gesamtlast mit Confidence.\n\nRecovery-Start fuer neue Session:\n1) scripts/bd-safe.sh prime\n2) scripts/bd-safe.sh show kura-training-316\n3) scripts/bd-safe.sh show kura-training-316.1\n4) Danach Umsetzung strikt entlang Dependency-Chain.","created_at":"2026-02-14T09:24:03Z"}]}
{"id":"kura-training-316.1","title":"Spec: session.logged v1 + Block-Taxonomie + Pflichtlogik","description":"Warum:\nVor Code braucht es eine eindeutige Domain-Spezifikation, sonst entstehen inkonsistente Feldnutzung und fragile Sonderregeln.\n\nWie:\nDefiniere `session.logged v1` mit `blocks[]` und den Kernbausteinen: session_meta, block_type, dose(work/recovery/repeats), intensity_anchors, metrics, capability_target, subjective_response, measurement_state, provenance. Lege block families fest (strength, sprint, interval, continuous, plyo, circuit, technique, recovery) inkl. Minimalanforderungen je Blocktyp.\n\nDeliverables:\n1) Kanonische Feldliste + Typen\n2) Pflicht/optional je Blocktyp\n3) Beispiele fuer Kraft, Intervall, Sprint, Plyo, Hybrid-Session\n4) Regel: keine globale HR-Pflicht","acceptance_criteria":"Kernschema, Blocktypen, Pflicht/Optional-Regeln und Beispiele sind eindeutig dokumentiert.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:23.794372+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:23:30.733311+01:00","closed_at":"2026-02-14T11:23:30.733311+01:00","close_reason":"Closed","labels":["architecture","spec"],"dependencies":[{"issue_id":"kura-training-316.1","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:23.796209+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":8,"issue_id":"kura-training-316.1","author":"jonzim-cmd","text":"Spec-Zusammenfassung (session.logged v1): Das Kernmodell ist block-basiert und modality-neutral mit session_meta + blocks[] als Pflicht. Jeder Block hat dose (work/recovery/repeats), intensity_anchors, optionale metrics/subjective_response und provenance. Fuer Performance-Bloecke gilt: mindestens ein Intensitaetsanker oder explizit intensity_anchors_status=not_applicable. Es gibt keine globale HR-Pflicht; fehlende Sensorik wird ueber measurement_state (not_measured/not_applicable) explizit modelliert.","created_at":"2026-02-14T10:23:30Z"}]}
{"id":"kura-training-316.10","title":"Structured Error Taxonomy v1 fuer session.logged Completeness","description":"Warum:\nDie Missing-Anchor-Erkennung darf nicht von Fehlermeldungstexten abhängen, sonst brechen Monitoring und QA bei harmlosen Textänderungen.\n\nWie:\nDefiniere eine strukturierte Fehler-Taxonomie v1 für session.logged Completeness mit stabilen error_code-Werten, block_scope und field_path.\n\nImplementierungsplan (deterministisch):\n1) Error-Code-Katalog und Return-Contract in training_session_completeness festlegen.\n2) Mapping von ValidationError -\u003e strukturierte Fehlerobjekte ohne String-Parsing.\n3) Architecture-Test + Unit-Tests für stabile Codes bei Missing-Anchor/Measurement-State-Verletzungen.\n4) System-Convention ergänzen (öffentliches Contract-Surface für Agent/Monitoring).\n\nAkzeptanz:\n- evaluate_session_completeness liefert strukturierte Fehler mit stabilem error_code.\n- Missing-Anchor ist über error_code eindeutig identifizierbar.\n- Keine produktive Abhängigkeit mehr von frei formulierten Fehltexten.\n","acceptance_criteria":"Completeness-Fehler sind code-basiert, stabil und block-spezifisch auswertbar.","status":"open","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:57.427769+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:19:57.427769+01:00","labels":["contract","validation"],"dependencies":[{"issue_id":"kura-training-316.10","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:57.429635+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.11","title":"Quality Health auf strukturierte Completeness-Codes umstellen","description":"Warum:\nQuality Health muss robuste Signale liefern; textbasierte Klassifikation erzeugt False-Negatives bei Refactors.\n\nWie:\nStelle quality_health vollständig auf strukturierte Completeness-Codes um und härte Missing-Anchor-/Parse-Metriken.\n\nImplementierungsplan (deterministisch):\n1) INV-010 auf error_code-basierte Auswertung umstellen.\n2) Metriken harmonisieren: session_missing_anchor_total/rate, parse_fail_rate, confidence_distribution.\n3) Regressionstests für alte und neue Fehlerpfade (inkl. sparse user).\n4) Shadow-Monitoring-Contract in Architekturtests absichern.\n\nAkzeptanz:\n- quality_health nutzt keine Fehltextsuche mehr für Missing-Anchor.\n- Monitoring-Metriken bleiben bei Text-/Lokalisierungsänderungen stabil.\n- Architekturtest erzwingt code-basierten Pfad.\n","acceptance_criteria":"Missing-Anchor-/Parse-Monitoring laeuft robust ueber error_codes statt Fehltexte.","status":"open","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:57.567331+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:19:57.567331+01:00","labels":["observability","quality"],"dependencies":[{"issue_id":"kura-training-316.11","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:57.569278+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.11","depends_on_id":"kura-training-316.10","type":"blocks","created_at":"2026-02-14T12:19:58.361499+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.12","title":"Calibration Protocol v1 fuer training_load_v2 festlegen","description":"Warum:\nDie aktuelle Load/Confidence-Heuristik ist brauchbar, aber nicht empirisch kalibriert; damit fehlt belastbare Interpretierbarkeit.\n\nWie:\nSpezifiziere ein Calibration-Protocol v1 für training_load_v2 (Datenbasis, Zielmetriken, Tuning-Grenzen, Versionierung der Parameter).\n\nImplementierungsplan (deterministisch):\n1) Definiere Calibration-Inputs (repräsentative Kohorten + Label-Proxy).\n2) Definiere Zielmetriken (Brier/Calibration-Error/Ranking-Stabilität) und Akzeptanzschwellen.\n3) Parameter-Registry mit schema_version für reproduzierbare Tuning-Läufe.\n4) Architecture-Tests für Mindestinvarianten (keine globale HR-Pflicht, monotone Sensor-Verbesserung).\n\nAkzeptanz:\n- Kalibrierungsprotokoll ist als Contract und Tests codifiziert.\n- Tuning-Läufe sind reproduzierbar und versioniert.\n","acceptance_criteria":"Kalibrierungsprotokoll inkl. Metriken, Parameter-Versionierung und Invarianten ist testbar codifiziert.","status":"open","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:57.708807+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:19:57.708807+01:00","labels":["analytics","calibration"],"dependencies":[{"issue_id":"kura-training-316.12","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:57.710396+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.13","title":"training_load_v2 datengetrieben kalibrieren und versionieren","description":"Warum:\nOhne praktische Kalibrierung bleibt das Protokoll Theorie und die Confidence-Werte potenziell fehlskaliert.\n\nWie:\nImplementiere datengetriebene Kalibrierung für training_load_v2 mit versionierten Parametern und sicherem Rollout.\n\nImplementierungsplan (deterministisch):\n1) Calibration-Runner implementieren (offline replay / deterministic seeds).\n2) Optimierte Parameter in versionierte Registry schreiben und im Runtime-Pfad laden.\n3) A/B-Shadow-Vergleich alt vs. kalibriert mit Guardrails.\n4) Fallback auf vorige Parameter-Version via Feature-Flag.\n\nAkzeptanz:\n- training_load_v2 nutzt versionierte, kalibrierte Parameter.\n- Rollback auf vorherige Parameter ist ohne Schemaänderung möglich.\n- Vergleichsreport zeigt verbesserte Kalibrierungsmetriken.\n","acceptance_criteria":"Kalibrierte Parameter sind produktiv nutzbar, versioniert und rollback-faehig.","status":"open","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:57.845208+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:19:57.845208+01:00","labels":["analytics","calibration"],"dependencies":[{"issue_id":"kura-training-316.13","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:57.84761+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.13","depends_on_id":"kura-training-316.12","type":"blocks","created_at":"2026-02-14T12:19:58.462292+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.14","title":"Import-Mapping v2 Spezifikation auf Modalitaeten vertiefen","description":"Warum:\nImport-Mapping v2 ist aktuell Grundgerüst; vor breiter Nutzung fehlt sportartspezifische Abdeckung und Präzision.\n\nWie:\nErweitere die Mapping-Spezifikation auf Sport-/Modalitätsprofile (Kraft, Running, Cycling, Hybrid) mit Provider/Format-Matrix und Measurement-State-Regeln.\n\nImplementierungsplan (deterministisch):\n1) Feldkatalog je Modalität definieren (core vs optional vs provider-spezifisch).\n2) Matrix je Provider/Format auf supported/partial/not_available aktualisieren.\n3) Mapping-Regeln auf Blocktypen + intensity anchors + provenance-Confidence konkretisieren.\n4) Architekturtests auf \"keine provider-spezifischen Pflichtfelder\" und Blockmodell-Kompatibilität erweitern.\n\nAkzeptanz:\n- Matrix deckt die Zielmodalitäten explizit ab.\n- Core-Contract bleibt provider-agnostisch.\n- Regeln sind testbar und versioniert.\n","acceptance_criteria":"Provider/Format-Matrix deckt Running/Cycling/Strength/Hybrid explizit und provider-agnostisch ab.","status":"open","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:57.984652+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:19:57.984652+01:00","labels":["contract","imports"],"dependencies":[{"issue_id":"kura-training-316.14","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:57.986847+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.15","title":"Import-Mapping v2 Ausbau implementieren inkl. Golden-Fixtures","description":"Warum:\nSpezifikation ohne Implementierung schützt nicht vor realen Import-Regressionen.\n\nWie:\nSetze die erweiterte Import-Mapping-v2-Spezifikation um, inkl. Golden-Fixtures und End-to-End-Contract-Checks.\n\nImplementierungsplan (deterministisch):\n1) Mapper je Provider/Format gemäß 316.14 erweitern.\n2) Golden-Fixtures pro Modalität (running/cycling/strength/hybrid) hinzufügen.\n3) Contract- und Integrationstests auf block_type/intensity_anchors/measurement_state/provenance erweitern.\n4) Fehlerklassifikation vereinheitlichen (parse/mapping/validation) für Monitoring.\n\nAkzeptanz:\n- Imports erzeugen konsistente session.logged-kompatible Blöcke über Zielmodalitäten.\n- Golden-Fixtures schützen gegen Mapping-Regressionen.\n- Monitoring kann Fehlertypen stabil unterscheiden.\n","acceptance_criteria":"Erweiterte Mapping-Regeln laufen stabil durch Golden-Fixtures und E2E-Tests.","status":"open","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:58.120275+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:19:58.120275+01:00","labels":["implementation","imports"],"dependencies":[{"issue_id":"kura-training-316.15","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:58.12186+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.15","depends_on_id":"kura-training-316.14","type":"blocks","created_at":"2026-02-14T12:19:58.56398+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.16","title":"Hardening Gate fuer 316.10-316.15","description":"Warum:\nDie drei Follow-up-Stränge müssen als gemeinsamer Hardening-Release abgesichert werden, sonst entstehen Teiloptimierungen ohne belastbaren Rollout.\n\nWie:\nBaue einen gemeinsamen Rollout-Gate-Task für 316.10-316.15 (QA-Matrix, Shadow-Ergebnisse, Flag-Plan, Exit-Kriterien).\n\nImplementierungsplan (deterministisch):\n1) Gate-Checklist als executable spec (Pflichtmetriken + Schwellen).\n2) Freigabe nur bei grünem Status für Error-Codes, Calibration und Import-Mapping.\n3) Rollback-Runbook (Flags/Parameter-Versionen) verifizieren.\n4) Abschlussbericht mit absoluten Metriken und Rest-Risiken.\n\nAkzeptanz:\n- Ein einzelner Gate-Status entscheidet über produktiven Ramp-up.\n- Rollback ist getestet und dokumentiert.\n- Rest-Risiken und next actions sind explizit erfasst.\n","acceptance_criteria":"Gemeinsamer Rollout-Gate mit klaren Exit-Kriterien und getestetem Rollback liegt vor.","status":"open","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T12:19:58.259629+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:19:58.259629+01:00","labels":["qa","rollout"],"dependencies":[{"issue_id":"kura-training-316.16","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T12:19:58.261392+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.16","depends_on_id":"kura-training-316.11","type":"blocks","created_at":"2026-02-14T12:19:58.664844+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.16","depends_on_id":"kura-training-316.13","type":"blocks","created_at":"2026-02-14T12:19:58.765036+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.16","depends_on_id":"kura-training-316.15","type":"blocks","created_at":"2026-02-14T12:19:58.868082+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.2","title":"Executable Architecture Specs fuer Kerninvarianten","description":"Warum:\nArchitekturentscheidungen sollen dauerhaft durch CI erzwungen werden, nicht durch vergessene Doku.\n\nWie:\nUebersetze die Invarianten aus der Spezifikation in `tests/architecture/`.\n\nAkzeptanz:\n- Test: Keine globale Pflicht fuer HR/Power/GPS.\n- Test: Jeder leistungsrelevante Block braucht mind. einen Intensitaetsanker (oder explizit not_applicable).\n- Test: `measurement_state` ist verpflichtend fuer optionale Messgroessen.\n- Test: Gemischte Sessions mit mehreren Blocktypen sind gueltig.","acceptance_criteria":"Invarianten werden in tests/architecture/ per CI erzwungen.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:23.926558+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:23:31.061898+01:00","closed_at":"2026-02-14T11:23:31.061898+01:00","close_reason":"Closed","labels":["architecture","tests"],"dependencies":[{"issue_id":"kura-training-316.2","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:23.928531+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.2","depends_on_id":"kura-training-316.1","type":"blocks","created_at":"2026-02-14T10:20:24.96704+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":9,"issue_id":"kura-training-316.2","author":"jonzim-cmd","text":"Architecture-Contracts umgesetzt in tests/architecture/test_93_unified_training_session_contract.py inkl. Runtime-Guards auf Rust-Tests. Abgedeckt: keine globale HR-Pflicht, Anchor-Regel fuer Performance-Bloecke, measurement_state-Pflicht fuer Metrics, Hybrid-Session-Validitaet.","created_at":"2026-02-14T10:23:30Z"}]}
{"id":"kura-training-316.3","title":"Implementiere Event-Contract + Persistenz fuer session.logged v1","description":"Warum:\nOhne persistentes Zielschema bleibt das Modell nur Theorie und kann nicht stabil weiterentwickelt werden.\n\nWie:\nImplementiere Event-Contract und Persistenz fuer `session.logged v1` (inkl. blocks[]), plus Provenance-Felder (manual/imported/inferred/corrected). Halte Rueckwaertskompatibilitaet fuer bestehende Logs sicher.\n\nAkzeptanz:\n- Session mit mehreren Blocktypen kann geschrieben und gelesen werden.\n- Contract-Validierung greift serverseitig.\n- Datenverlustfreie Speicherung der Intensitaetsanker und measurement_state.","acceptance_criteria":"Session-Blocks werden robust gespeichert/gelesen, inkl. Provenance und measurement_state.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.057225+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:35:54.748673+01:00","closed_at":"2026-02-14T11:35:54.748673+01:00","close_reason":"Closed","labels":["backend","events","persistence"],"dependencies":[{"issue_id":"kura-training-316.3","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.05869+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.3","depends_on_id":"kura-training-316.2","type":"blocks","created_at":"2026-02-14T10:20:25.069401+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":10,"issue_id":"kura-training-316.3","author":"jonzim-cmd","text":"Umsetzung gestartet: Event-Contract fuer session.logged v1 ist in API-Validierung aktiv (inkl. block_type, dose/work, intensity anchor policy, metrics measurement_state, contract_version). Event-Conventions + system config wurden erweitert (training_session_block_model_v1), inklusive Agent-Redaction-Whitelist. user_profile handler verarbeitet session.logged bereits grundlegend; naechster Schritt in 316.3 ist Persistenz-/Read-Path-Vertiefung fuer weitere Projektionen.","created_at":"2026-02-14T10:23:37Z"},{"id":11,"issue_id":"kura-training-316.3","author":"jonzim-cmd","text":"Implementierung erweitert: session.logged ist jetzt end-to-end im Contract + Read-Pfad verankert. Neben API-Validierung wurde die Projection-Routing-Logik ergänzt (training_timeline + session_feedback), inklusive session block expansion (repeat-level) fuer set-orientierte Aggregationen. user_profile/quality_health reagieren auf session.logged. Akzeptanz erfuellt: gemischte Sessions werden gespeichert, gelesen und in zentrale Projektionen uebernommen.","created_at":"2026-02-14T10:35:54Z"}]}
{"id":"kura-training-316.4","title":"Vollstaendigkeitsstufen und block-spezifische Validierung","description":"Warum:\nDas Hauptdilemma ist \"vollstaendig loggen\" ohne Nutzer mit unmoeglichen Pflichten zu blockieren.\n\nWie:\nBaue einen Vollstaendigkeits- und Validierungsdienst mit Stufen:\n- log_valid\n- analysis_basic\n- analysis_advanced\nRegeln sind block-spezifisch statt global.\n\nAkzeptanz:\n- Kraft-Set ohne HR ist log_valid, sofern Block-Pflichtfelder vorhanden sind.\n- Intervall (z. B. 8x2'/1' + pace oder Borg) ist ohne HR gueltig.\n- Fehlende optionale Daten werden als not_measured/not_applicable markiert.","acceptance_criteria":"log_valid/analysis_basic/analysis_advanced funktionieren ohne globale HR-Pflicht.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.189557+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:35:55.160351+01:00","closed_at":"2026-02-14T11:35:55.160351+01:00","close_reason":"Closed","labels":["domain-model","validation"],"dependencies":[{"issue_id":"kura-training-316.4","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.19092+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.4","depends_on_id":"kura-training-316.3","type":"blocks","created_at":"2026-02-14T10:20:25.167975+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":12,"issue_id":"kura-training-316.4","author":"jonzim-cmd","text":"Vollstaendigkeitsstufen umgesetzt: workers/src/kura_workers/training_session_completeness.py liefert log_valid / analysis_basic / analysis_advanced inkl. Confidence. Regeln sind block-spezifisch, ohne globale HR-Pflicht. Tests decken Kraft ohne HR, Intervall mit Pace/Borg ohne HR und explicit not_measured/not_applicable ab (workers + tests/architecture).","created_at":"2026-02-14T10:35:55Z"}]}
{"id":"kura-training-316.5","title":"Bot-Parser und Rueckfragenstrategie auf Blockmodell umstellen","description":"Warum:\nDer Bot ist die zentrale Eingabeoberflaeche; falsche Rueckfragen zerstoeren Vertrauen und Datenqualitaet.\n\nWie:\nPasse Parsing und Nachfragen an das neue Modell an. Der Bot identifiziert zuerst Blocktypen und fragt nur fehlende Pflichtfelder dieses Blocktyps nach.\n\nAkzeptanz:\n- Bei Kraft-Logs keine HR-Zwangsfrage.\n- Bei Intervallen werden nur fehlende Strukturdaten/Anker nachgefragt.\n- Rueckfragen sind priorisiert und minimal (nur was fuer log_valid fehlt).","acceptance_criteria":"Bot fragt nur blockrelevante Pflichtdaten nach und erzwingt keine irrelevanten Metriken.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.323899+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:49:28.192818+01:00","closed_at":"2026-02-14T11:49:28.192818+01:00","close_reason":"Closed","labels":["bot","logging","ux"],"dependencies":[{"issue_id":"kura-training-316.5","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.325822+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.5","depends_on_id":"kura-training-316.4","type":"blocks","created_at":"2026-02-14T10:20:25.266945+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":13,"issue_id":"kura-training-316.5","author":"jonzim-cmd","text":"Implemented block-relevant session.logged clarification strategy in agent session audit. Added session.logged gap detection for block-required fields (dose.work + intensity anchor policy), clarification prompts for missing fields, and explicit no-HR-coercion anchor messaging (anchors can be pace/power/Borg/RPE/%reference/HR or not_applicable). Added runtime tests in routes::agent::tests and architecture contract test test_95_block_relevant_clarification_contract.py. Full quality gates passed: ruff, workers unit, workers integration, cargo test --workspace.","created_at":"2026-02-14T10:49:28Z"}]}
{"id":"kura-training-316.6","title":"Projection v2: modality-spezifisch + globale Last mit Confidence","description":"Warum:\nEin einheitliches Datenmodell braucht auch ein einheitliches Analysemodell, sonst bleibt die Plattform fachlich fragmentiert.\n\nWie:\nImplementiere Projection v2 mit zwei Ebenen:\n1) modality-spezifische Last/Qualitaet (Kraft, Sprint, Endurance, Plyo)\n2) vereinheitlichte Gesamtlast mit Confidence anhand verfuegbarer Daten\n\nAkzeptanz:\n- Fehlende Sensorik reduziert Confidence statt Session-Invalidierung.\n- Basisanalyse funktioniert mit manual-only Daten.\n- Zusatzzsensorik (HR/Power/GPS) verbessert Analysegrad ohne Schemawechsel.","acceptance_criteria":"Analysen laufen mit Sparse-Daten und skalieren mit Sensorqualitaet.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.463189+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:09:46.067341+01:00","closed_at":"2026-02-14T12:09:46.067341+01:00","close_reason":"Closed","labels":["analytics","projections"],"dependencies":[{"issue_id":"kura-training-316.6","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.465475+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.6","depends_on_id":"kura-training-316.4","type":"blocks","created_at":"2026-02-14T10:20:25.367038+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.7","title":"Legacy-Kompatibilitaet und Migrationspfad (set.logged \u003c-\u003e session.logged)","description":"Warum:\nBestehende Daten und Features duerfen beim Umbau nicht brechen.\n\nWie:\nErstelle Kompatibilitaetsadapter zwischen `set.logged` und `session.logged v1`, inkl. Replay-/Backfill-Strategie fuer bestehende Historie.\n\nAkzeptanz:\n- Alte Kraftdaten bleiben in Timelines/Insights konsistent.\n- Neue Sessions koennen parallel mit Legacy-Views koexistieren.\n- Migrationsweg ist idempotent und testbar.","acceptance_criteria":"Migration ist idempotent und bricht bestehende Views nicht.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.596121+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:09:46.063642+01:00","closed_at":"2026-02-14T12:09:46.063642+01:00","close_reason":"Closed","labels":["compatibility","migration"],"dependencies":[{"issue_id":"kura-training-316.7","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.598369+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.7","depends_on_id":"kura-training-316.3","type":"blocks","created_at":"2026-02-14T10:20:25.466143+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.7","depends_on_id":"kura-training-316.4","type":"blocks","created_at":"2026-02-14T10:24:11.711437+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.8","title":"QA-Matrix, Feature-Flag-Rollout und Monitoring","description":"Warum:\nBei tiefen Modellumbauten entstehen Risiken erst in realen Nutzungsprofilen.\n\nWie:\nDefiniere QA-Matrix (Kraft, Sprint, Endurance, Hybrid, Low-Data-User), Feature-Flag-Rollout, Shadow-Mode-Vergleich und Monitoring fuer Validierungs-/Parser-Fehler.\n\nAkzeptanz:\n- Vergleich Alt-vs-Neu fuer repraesentative Sessions dokumentiert.\n- Rollback/Disable-Pfad ueber Feature-Flag vorhanden.\n- Monitoring zeigt Parse-Fail-Rate, Missing-Anchor-Rate, Confidence-Verteilung.","acceptance_criteria":"Risiken sind ueber Shadow-Mode und Metriken kontrolliert.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.730174+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:09:46.105522+01:00","closed_at":"2026-02-14T12:09:46.105522+01:00","close_reason":"Closed","labels":["observability","qa","rollout"],"dependencies":[{"issue_id":"kura-training-316.8","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.732319+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.8","depends_on_id":"kura-training-316.5","type":"blocks","created_at":"2026-02-14T10:20:25.568389+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.8","depends_on_id":"kura-training-316.6","type":"blocks","created_at":"2026-02-14T10:20:25.675639+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.8","depends_on_id":"kura-training-316.7","type":"blocks","created_at":"2026-02-14T10:20:25.784794+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-316.9","title":"Import-Mapping v2 Spezifikation (Garmin/Strava/TP/FIT/TCX/GPX)","description":"Warum:\nExterne Imports sind geplant; ohne fruehes Mapping drohen spaet teure Contract-Breaks.\n\nWie:\nDefiniere Import-Mapping v2 (Garmin/Strava/TrainingPeaks; FIT/TCX/GPX) auf das gleiche Kernmodell inkl. measurement_state/provenance. Fokus ist Spezifikation, nicht finaler Vollausbau.\n\nAkzeptanz:\n- Feld-Matrix pro Quelle (supported/partial/not_available) liegt vor.\n- Mapping erzeugt dieselben Blocktypen wie manuelles Logging.\n- Keine provider-spezifischen Felder als harte Kernpflicht.","acceptance_criteria":"Mapping-Matrix v2 liegt vor und passt ins Kernmodell ohne harte Provider-Pflichten.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T10:20:24.864173+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T12:09:46.069062+01:00","closed_at":"2026-02-14T12:09:46.069062+01:00","close_reason":"Closed","labels":["contract","imports"],"dependencies":[{"issue_id":"kura-training-316.9","depends_on_id":"kura-training-316","type":"parent-child","created_at":"2026-02-14T10:20:24.866409+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.9","depends_on_id":"kura-training-316.1","type":"blocks","created_at":"2026-02-14T10:20:25.903241+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.9","depends_on_id":"kura-training-316.3","type":"blocks","created_at":"2026-02-14T10:20:26.021432+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-316.9","depends_on_id":"kura-training-316.4","type":"blocks","created_at":"2026-02-14T10:24:11.860834+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-33v","title":"DB Migration: invite_tokens + access_requests + consent","description":"## Was\nSQL-Migration für das Access Gate System.\n\n## Tabellen\n\n### invite_tokens\n- id: UUID PK (gen_random_uuid)\n- token: TEXT UNIQUE NOT NULL — der eigentliche Token-String (kura_inv_ Prefix, 32 Zeichen random)\n- email: TEXT NULLABLE — optional an Email gebunden (wenn aus approve-request generiert)\n- created_by: UUID REFERENCES users(id) — Admin der den Token erstellt hat\n- created_at: TIMESTAMPTZ DEFAULT now()\n- expires_at: TIMESTAMPTZ — z.B. 7 Tage nach Erstellung\n- used_at: TIMESTAMPTZ NULLABLE — wann eingelöst\n- used_by: UUID REFERENCES users(id) NULLABLE — wer eingelöst hat\n\n### access_requests\n- id: UUID PK (gen_random_uuid)\n- email: TEXT NOT NULL\n- name: TEXT NULLABLE\n- context: TEXT NULLABLE — \"Was trainierst du?\"\n- status: TEXT DEFAULT 'pending' — pending|approved|rejected\n- created_at: TIMESTAMPTZ DEFAULT now()\n- reviewed_at: TIMESTAMPTZ NULLABLE\n- reviewed_by: UUID REFERENCES users(id) NULLABLE\n- invite_token_id: UUID REFERENCES invite_tokens(id) NULLABLE — nach Approval verlinkt\n\n### users Tabelle erweitern\n- consent_anonymized_learning: BOOLEAN DEFAULT false\n- invited_by_token: UUID REFERENCES invite_tokens(id) NULLABLE\n\n## RLS\n- invite_tokens: nur admin lesen/schreiben\n- access_requests: INSERT public (kein Auth nötig), SELECT/UPDATE nur admin\n- consent_anonymized_learning: User kann eigenen Wert lesen/updaten\n\n## Hinweise\n- Token-Format: kura_inv_ + 32 hex chars (wie API keys)\n- Index auf invite_tokens.token (Lookup bei Signup)\n- Index auf access_requests.email + status (Admin-Queries)","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:44:22.436846+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:03:27.972639+01:00","closed_at":"2026-02-13T13:03:27.972639+01:00","close_reason":"Migration 20260229000001 implemented","dependencies":[{"issue_id":"kura-training-33v","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:21.520248+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-3e6","title":"Integration Tests for Semantic and Inference Handlers","description":"Add database-backed integration tests for semantic_memory, strength_inference, readiness_inference, and inference.nightly_refit job behavior (including retractions and edge cases).","notes":"Initiale Integrationstests ergänzt: Semantic Memory Projection, Strength/Readiness Inference, inference.nightly_refit job enqueue","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T09:04:47.444995+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T11:06:47.414576+01:00","closed_at":"2026-02-11T11:06:47.414576+01:00","close_reason":"DB-backed Integrationstests für semantic_memory, strength_inference, readiness_inference und inference.nightly_refit inkl. Retraktions-/Edge-Cases ergänzt; lokal gegen Postgres verifiziert","labels":["integration","testing","workers"]}
{"id":"kura-training-3ii","title":"Read Path: GET /v1/events mit Cursor-Pagination","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:06.26606+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T07:33:04.862031+01:00","closed_at":"2026-02-08T07:33:04.862031+01:00","close_reason":"GET /v1/events with cursor pagination, filtering (event_type, since, until), RLS enforcement. Tested and working."}
{"id":"kura-training-3kh","title":"Browser Auth: OAuth PKCE im Frontend verdrahten","description":"## Warum\nOhne funktionierende Browser-Sessions sind Settings und Setup tote Mockups.\nDas ist das Fundament für ALLES was nach Login passiert.\n\n## Was\n- Login-Page (/login) an POST /v1/auth/token anbinden (OAuth PKCE flow)\n- Signup-Page (/signup) an POST /v1/auth/register anbinden (mit invite_token + consent)\n- Token Management: Access Token in Memory, Refresh via POST /v1/auth/token (grant_type=refresh_token)\n- React Auth Context Provider: User-Info (email, display_name, is_admin, member_since), loading state, login/logout actions\n- Route Guards: /settings und /setup redirecten zu /login wenn nicht authentifiziert\n- Logout: Tokens invalidieren, Context clearen, redirect zu /\n\n## Bestehende Backend-Endpoints\n- POST /v1/auth/register (invite-gated, braucht invite_token + consent_anonymized_learning)\n- GET /v1/auth/authorize (HTML form, aber wir machen SPA-Flow)\n- POST /v1/auth/token (code exchange + refresh)\n- OAuth Client: kura-cli (loopback redirect)\n  → Braucht ggf. einen neuen OAuth Client \"kura-web\" mit Web-Redirect\n\n## Akzeptanzkriterien\n- User kann sich mit Invite-Link registrieren und ist danach eingeloggt\n- User kann sich einloggen und sieht seine echten Daten in Settings\n- Token refresht automatisch vor Ablauf (30 min access token)\n- Logout funktioniert sauber\n- Nicht-eingeloggte User werden von /settings und /setup zu /login redirected","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:33:06.33927+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T15:00:53.249421+01:00","closed_at":"2026-02-13T15:00:53.249421+01:00","close_reason":"Backend: POST /v1/auth/email/login + GET /v1/auth/me + self-service API key endpoints. Frontend: AuthProvider context, login/signup pages wired to API, settings page with real data, token refresh. Route guards on /settings."}
{"id":"kura-training-3n4","title":"exercise_progression alias fragmentation","description":"exercise_progression queries events by exercise_key, but does not resolve aliases. If user logs 'Kniebeuge' then creates alias Kniebeuge-\u003ebarbell_back_squat, the progression for barbell_back_squat misses the old Kniebeuge events. Data is fragmented until agent consistently uses exercise_id. Options: (a) resolve aliases at query time, (b) re-index on alias creation, (c) document as known limitation.","status":"closed","priority":2,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-08T15:18:42.59717+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:17:19.575344+01:00","closed_at":"2026-02-09T08:17:19.575344+01:00","close_reason":"Alias-aware handlers implemented: exercise_progression resolves through aliases and DELETEs stale projections, training_timeline resolves exercise keys through aliases. Plus conventions in system layer to prevent fragmentation at source."}
{"id":"kura-training-3pw","title":"CLI: Admin invite commands","description":"## Was\nCLI-Commands für Invite-Verwaltung. Thin client über Admin-API.\n\n## Commands\n\n### kura admin list-requests [--status pending|approved|rejected]\n- GET /v1/admin/access-requests?status=...\n- JSON output: Array of requests\n\n### kura admin approve-request \u003cid\u003e\n- POST /v1/admin/access-requests/{id}/approve\n- Output: { token, invite_url, expires_at }\n\n### kura admin reject-request \u003cid\u003e\n- POST /v1/admin/access-requests/{id}/reject\n\n### kura admin create-invite [--email foo@bar.com] [--expires-days 7]\n- POST /v1/admin/invites\n- Output: { token, invite_url, expires_at }\n\n### kura admin list-invites [--status unused|used|expired]\n- GET /v1/admin/invites?status=...\n\n## Hinweise\n- Pattern wie bestehende admin commands (create-user, create-key)\n- JSON-only output (Agent-first)\n- Alle erfordern Admin-Token","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:45:24.699032+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:05:00.532777+01:00","closed_at":"2026-02-13T13:05:00.532777+01:00","close_reason":"5 CLI commands: list-requests, approve-request, reject-request, create-invite, list-invites","dependencies":[{"issue_id":"kura-training-3pw","depends_on_id":"kura-training-0yc","type":"blocks","created_at":"2026-02-13T12:47:00.742547+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-3pw","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:42.278082+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-40k","title":"Agent context bundle endpoint (/v1/agent/context)","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T07:42:56.578755+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T07:56:43.080659+01:00","closed_at":"2026-02-11T07:56:43.080659+01:00","close_reason":"Implemented /v1/agent/context bundle endpoint with limits, OpenAPI docs, and CLI context command"}
{"id":"kura-training-4sv","title":"Rollout-Hardening: Supabase Pro Cutover (DB + Auth) vor Public Launch","description":"Migrating from local Docker Postgres to Supabase Pro for production reliability and security. Scope: production DB + auth migration with minimal downtime, explicit rollback path, and go/no-go gates before opening public signup. Docker remains for API/worker runtime on VPS.","acceptance_criteria":"1) Supabase Pro project provisioned with required regions, TLS, backups, and spend guardrails. 2) Kura schema/migrations applied and validated against Supabase Postgres (including worker paths and idempotency behavior). 3) Auth flow switched to Supabase JWT/OAuth and server-side token verification integrated. 4) Rehearsed dry-run migration from current VPS DB snapshot to Supabase with measured downtime and documented rollback. 5) Production cutover runbook written (pre-checks, freeze window, DNS/env switch, validation checklist, rollback trigger). 6) Post-cutover monitoring dashboard and alerts defined for auth failures, DB latency, and error-rate spikes.","notes":"Session handoff 2026-02-13: Keep as independent launch-critical track. Can run in parallel with wvp, but production go-live should require both security/reliability policy and Supabase cutover readiness.","status":"open","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T08:20:41.498765+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:56:48.924406+01:00","comments":[{"id":4,"issue_id":"kura-training-4sv","author":"jonzim-cmd","text":"Observed on production DB for user 019c4b87-1fc2-70d1-a4d3-ead28d47cd53: projection jobs for update_quality_health and update_training_timeline repeatedly dead with error relation external_import_jobs does not exist. Root cause: migration parity drift (DB applied up to 20260223000001 while code/handlers expect 20260224000001+). This needs rollout hardening gate before launch.","created_at":"2026-02-13T11:42:19Z"}]}
{"id":"kura-training-4u6","title":"Semantic Layer: pgvector + pre-trained embeddings","description":"Exercise and food resolution via embedding similarity. Pre-trained sentence transformer, pgvector for storage/query. Cross-language matching (Kniebeuge ~ barbell back squat). Background worker computes embeddings on new exercises. Enhances but doesn't replace per-user alias system.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:27.62076+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T09:05:13.785525+01:00","closed_at":"2026-02-11T09:05:13.785525+01:00","close_reason":"Closed"}
{"id":"kura-training-4uv","title":"Settings: Privacy \u0026 Datenexport","description":"## Warum\nDSGVO Art. 15/20 (Auskunftsrecht + Datenportabilität). User muss seine Daten exportieren können.\nConsent-Transparenz zeigt dem User was er zugestimmt hat.\n\n## Was\n### Consent-Toggle\n- Toggle-UI für \"Anonymisierte Nutzungsdaten\" — visuell sichtbar aber DISABLED\n- Darunter Hinweis: \"Während der Early-Access-Phase ist die Zustimmung zur anonymisierten\n  Datenanalyse Teilnahmebedingung. Du kannst diese Einstellung nach dem öffentlichen Launch ändern.\"\n- Kein Backend-Call nötig, rein informativer UI-State\n\n### Datenexport\n- Button \"Meine Daten herunterladen\"\n- Synchroner Download (Kura-Datenvolumen ist klein genug)\n- Ruft ab: GET /v1/events (alle eigenen Events) + GET /v1/projections (alle eigenen Projections)\n- Packt beides in eine JSON-Datei: { events: [...], projections: [...], exported_at: \"...\" }\n- WICHTIG: Kein system_config, kein agent_behavior — NUR User-eigene Daten\n- Dateiname: kura-export-{date}.json\n\n## Abhängigkeit\n- Blocked by: Browser Auth (kura-training-3kh)\n\n## Akzeptanzkriterien\n- Consent-Toggle sichtbar, disabled, mit EA-Hinweis\n- Export-Button lädt JSON mit allen eigenen Events + Projections herunter\n- Export enthält KEINE System-Daten (system_config, agent_behavior, etc.)","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:34:34.170601+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T15:01:37.479097+01:00","closed_at":"2026-02-13T15:01:37.479097+01:00","close_reason":"Implemented in settings page: Consent toggle (disabled during EA with hint text), data export button downloads events + projections as JSON.","dependencies":[{"issue_id":"kura-training-4uv","depends_on_id":"kura-training-3kh","type":"blocks","created_at":"2026-02-13T14:34:42.140742+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-4z2","title":"Setup-Seite: Echte Agent-Connection Guides","description":"## Warum\nDie Setup-Seite ist der zentrale Ort wo User ihren AI-Agent mit Kura verbinden.\nAktuell zeigt sie generische CLI-Commands. Sie braucht echte, kopierbare Werte.\n\n## Was\n### CLI-Tab (existiert, erweitern)\n- Schritt 1: cargo install kura-cli (oder Download-Link)\n- Schritt 2: kura login (öffnet Browser → OAuth Flow)\n- Schritt 3: \"Erstelle einen API Key\" → Link zu /settings#api-keys\n- Schritt 4: Agent-spezifische Config (CLAUDE.md snippet, ChatGPT tool config, etc.)\n- Alle Werte mit Copy-Button\n\n### MCP-Tab (aktuell \"Coming Soon\", vorbereiten)\n- Wenn MCP Server noch nicht live: \"Coming Soon\" mit Erklärung was MCP ist\n- Wenn MCP Server live: Kopierbare Felder:\n  - Server Name: \"Kura\"\n  - Server URL: https://mcp.kura.dev/mcp (oder was auch immer die URL wird)\n  - Auth: \"API Key verwenden\" → Link zu /settings#api-keys\n  - Pro-Agent Config-Snippet (Claude Desktop JSON, etc.)\n\n### Per-Agent Tabs\n- Claude (Code + Desktop): CLAUDE.md snippet + Desktop MCP config\n- ChatGPT: Custom GPT tool configuration\n- Other: Generische REST API docs\n\n## Abhängigkeit\n- Blocked by: API Key Management (kura-training-cj0) — User muss Keys erstellen können\n  bevor die Setup-Seite sinnvoll ist\n\n## Akzeptanzkriterien\n- Jeder Config-Wert hat einen Copy-Button\n- CLI-Guide verweist auf Settings für Key-Erstellung\n- MCP-Guide zeigt entweder \"Coming Soon\" oder echte Config\n- Agent-spezifische Snippets sind korrekt und vollständig","notes":"Completed 2026-02-13: setup now enforces auth, first-login routing sends users to setup, CLI API-key step links to /settings#api-keys (no admin command), all CLI/MCP values include copy buttons, and MCP section is prepped with generated per-agent snippets plus coming-soon vs live endpoint mode via NEXT_PUBLIC_KURA_MCP_URL.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:35:27.005775+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:30:40.056417+01:00","closed_at":"2026-02-13T19:30:20.788266+01:00","close_reason":"Setup flow hardened: auth-gated /setup, first-login routing to setup, CLI key creation path now points to /settings#api-keys, copy buttons added across CLI + MCP setup values, and MCP UI now supports coming-soon vs configured endpoint with generated per-agent snippets (NEXT_PUBLIC_KURA_MCP_URL).","dependencies":[{"issue_id":"kura-training-4z2","depends_on_id":"kura-training-cj0","type":"blocks","created_at":"2026-02-13T14:35:35.219332+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-57d","title":"Data Integrity: Event Conventions für Korrekturen","description":"Event Conventions für event.retracted und Null-Semantik in profile.updated definieren und in event_conventions.py aufnehmen.\n\nevent.retracted: Universelles Retraction-Pattern — ein Event-Typ für alle Korrekturen. Felder: retracted_event_id (required), reason (optional). Retraction ist bewusst getrennt von Correction, weil es handler-agnostisch funktioniert.\n\nprofile.updated Null-Semantik: Explizit dokumentieren, dass null-Werte 'Feld entfernen' bedeuten. Ist implizit schon so, muss aber in den Conventions stehen damit der Agent es weiß.\n\nDesignentscheidung: Nur event.retracted, KEIN *.corrected Pattern. Retraction + neues Event ist sauberer als Delta-Corrections, weil: (a) kein Handler typ-spezifische Correction-Logik braucht, (b) idempotent, (c) auditierbar. Correction wäre Overengineering.\n\nLiefert: Erweiterte event_conventions in system_config, die der Agent beim Session-Start liest.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:23.33533+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T15:49:56.795669+01:00","closed_at":"2026-02-09T15:49:56.795669+01:00","close_reason":"event.retracted convention + profile.updated null_semantics + data_correction convention in system_config. 6 new tests (210 total). No handler changes — those are dru + k71."}
{"id":"kura-training-5g4","title":"OAuth hardening: add DB-backed tests for unknown/inactive clients","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T07:42:56.57877+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T07:52:30.964615+01:00","closed_at":"2026-02-11T07:52:30.964615+01:00","close_reason":"DB-backed OAuth client validation tests added (unknown + inactive client) in api auth route; cargo test passes"}
{"id":"kura-training-5hc","title":"Collaboration UX V1: Intent Handshake, Challenge Mode, Trace Digest, Memory Tiers","description":"Warum:\nKura ist bereits stark bei Safety, Verification und Agent-Contracts. Für die Zusammenarbeit Mensch\u003c-\u003eAgent fehlen aber drei Dinge: expliziter Zielabgleich vor riskanten Aktionen, transparent nachvollziehbare Vertrauensspur pro Aktion, und ein klarer anti-sycophancy Modus.\n\nProduktrealität (wichtig):\n- Kura ist agent-first und hat keine User-UI für Settings.\n- Alles Nutzerverhalten wird im Chat gesteuert.\n- Backend liefert die maschinenlesbare Wahrheit, der Agent macht sie im Chat sichtbar.\n\nWas:\nDieses Epic liefert eine chat-first Collaboration-Schicht über dem bestehenden write-with-proof/autonomy/reliability Fundament:\n1) Intent Handshake\n2) Trace Digest\n3) Challenge Mode (default=auto, chat-toggle)\n4) Memory Tier Contract\n5) Post-Task Reflection\n\nArchitekturregel laut AGENTS.md:\nNeue Entscheidungen nicht als neue docs/design/*.md dokumentieren. Das \"Warum\" bleibt in Beads, das \"Was muss gelten\" wird als ausführbare Spezifikation in tests/architecture/ umgesetzt.","design":"Autorisierte Implementierungsreihenfolge (verbindlich):\n0. kura-training-5hc.6 -\u003e tests/architecture Harness bootstrap\n1. kura-training-5hc.1 -\u003e Intent Handshake Contract\n2. kura-training-5hc.2 -\u003e Trace Digest Contract\n3. kura-training-5hc.3 -\u003e Challenge Mode Contract (chat-only activation)\n4. kura-training-5hc.4 -\u003e Memory Tier Contract\n5. kura-training-5hc.5 -\u003e Post-Task Reflection + learning integration\n\nLeitplanken:\n- Keine UI-Annahmen in den Contracts.\n- Challenge-Mode Steuerung ausschließlich über Chat + persistierte Preference-Events.\n- Trace Digest wird im Backend erzeugt; Agent muss ihn im Chat kompakt/explainable darstellen.\n- Alle Contracts versioniert, deterministisch, maschinenlesbar.","acceptance_criteria":"1) Für alle Teilbereiche existieren ausführbare Invarianten in tests/architecture/.\n2) Kein neues Design-Dokument unter docs/design/ für diese Entscheidungen.\n3) Runtime-Verhalten ist via API/Worker-Tests abgesichert und deterministisch.\n4) Bestehende Sicherheitsgrenzen (workflow_gate, claim_guard, autonomy_gate) bleiben unverletzt.\n5) Challenge Mode ist chat-only steuerbar und standardmäßig auto.\n6) Trace Digest ist backendseitig erzeugt und vom Agenten im Chat nutzbar/explainable.\n7) Jeder Subtask enthält kompaktionssichere Recovery-Notizen (Start/Resume/Verify).","notes":"Epic completed. Subtasks closed: kura-training-5hc.6, kura-training-5hc.1, kura-training-5hc.2, kura-training-5hc.3, kura-training-5hc.4, kura-training-5hc.5.\n\nImplemented contracts end-to-end:\n- intent_handshake.v1 (high-impact pre-execution alignment)\n- trace_digest.v1 (compact provenance)\n- challenge_mode.v1 (chat-first default auto + discoverability)\n- memory_tier_contract.v1 (tier/freshness + high-impact confirm-first guard)\n- post_task_reflection.v1 (delivery certainty + next-step loop)\n\nExecutable architecture specs are in tests/architecture and wired into existing quality gates via workers/tests/test_architecture_specs.py.\n\nVerification summary:\n- ruff check workers/src/ workers/tests/ -\u003e passed\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py -\u003e 585 passed, 135 skipped\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q -\u003e 84 passed\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- cargo test --workspace -\u003e passed\n\nNo new docs/design/*.md created.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:48:11.571397+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:40:29.35021+01:00","closed_at":"2026-02-13T19:40:29.350214+01:00","labels":["agent-first","collaboration","reliability"]}
{"id":"kura-training-5hc.1","title":"Intent Handshake Contract V1 (pre-execution alignment)","description":"Warum:\nVor nicht-trivialen Agent-Aktionen fehlt ein verbindlicher Zielabgleich. Das führt zu unnötigen Rückfragen, riskanten Fehlwrites oder stillen Annahmen.\n\nWas:\nEin Intent-Handshake vor high-impact Aktionen. Der Agent muss vor Ausführung maschinenlesbar festhalten:\n- Ziel\n- geplante Aktion\n- Annahmen\n- Nicht-Ziele\n- Risiko-/Impact-Klasse\n- Erfolgskriterium\n\nChat-Realität:\nDer Handshake wird im Backend als Contract geführt, aber vom Agenten im Chat kurz angezeigt/bestätigt. Keine UI-Abhängigkeit.","design":"Contract V1:\n- versioniertes Handshake-Objekt\n- deterministische required fields\n- referenzierbar pro Write-Operation (high-impact)\n\nRuntime-Verhalten:\n- high-impact write ohne gültigen Handshake -\u003e block oder confirm-first\n- bestehende Sicherheitskette (workflow_gate/claim_guard/autonomy_gate) bleibt führend\n\nSpec-first:\n- Invarianten zuerst in tests/architecture/\n- danach API/CLI/MCP-Anpassung\n- kein neues docs/design/*.md","acceptance_criteria":"1) Handshake-Contract ist versioniert und maschinenlesbar.\n2) High-impact writes ohne Handshake werden deterministisch geblockt oder confirm-first.\n3) tests/architecture/ enthält Invarianten zu required fields, versioning und gate behavior.\n4) API-Tests: happy path, missing-field, stale/invalid handshake, mismatch.\n5) Chat-Ausgabe des Agents enthält eine kompakte Handshake-Bestätigung vor der Ausführung.","notes":"Implemented Intent Handshake Contract V1 end-to-end for high-impact writes.\n\nContract/runtime changes:\n- api/src/routes/agent.rs:\n  - Added AgentIntentHandshake + INTENT_HANDSHAKE_SCHEMA_VERSION (`intent_handshake.v1`)\n  - Added strict validation: required fields, schema version, impact_class match, staleness window\n  - Enforced handshake requirement for high-impact writes in `/v1/agent/write-with-proof`\n  - Added AgentIntentHandshakeConfirmation to response\n- cli/src/commands/mcp.rs:\n  - Added `intent_handshake` + `intent_goal` tool args\n  - Auto-generates default handshake for high-impact write_with_proof calls when omitted\n\nArchitecture/spec tests:\n- tests/architecture/test_10_intent_handshake_contract.py\n\nRuntime test coverage:\n- api/src/routes/agent.rs tests include stale handshake rejection and contract coverage\n- cargo test --workspace passed\n\nExample handshake confirmation (chat-facing):\n- \"Intent bestätigt: Ziel='...', Aktion='...', Erfolg='...'\"\n\nVerification run:\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- cargo test --workspace -\u003e passed\n- full worker/rust quality gates passed\n\nNo new docs/design/*.md created.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:48:16.806396+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:38:58.06393+01:00","closed_at":"2026-02-13T19:38:58.063934+01:00","labels":["agent-contract","collaboration"],"dependencies":[{"issue_id":"kura-training-5hc.1","depends_on_id":"kura-training-5hc","type":"parent-child","created_at":"2026-02-13T18:48:16.80728+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.1","depends_on_id":"kura-training-5hc.6","type":"blocks","created_at":"2026-02-13T19:01:45.159052+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5hc.2","title":"Trace Digest V1 (compact provenance for each agent action)","description":"Warum:\nKura liefert bei write-with-proof bereits starke Vertrauensbausteine (Receipts, Verification, Claim Guard, Workflow/Autonomy Gates), aber sie sind verteilt über mehrere Felder. Für Menschen im Chat fehlt dadurch eine einheitliche, sofort lesbare Spur pro Aktion. Das macht es unnötig schwer, schnell zu verstehen, ob ein Ergebnis wirklich gespeichert, noch pending oder nur teilweise abgesichert ist. Ein versionierter Trace Digest löst genau diese Lücke, ohne neue UI und ohne zweite Wahrheit.\n\nWas:\nFühre `trace_digest.v1` als backend-generierten, maschinenlesbaren Contract pro Agent-Aktion ein. Der Agent muss den Digest im Chat in zwei Modi verwenden: kompakte Standard-Zusammenfassung und detaillierte Belegansicht auf Nachfrage (\"warum\", \"beleg\", \"details\").\n","design":"Contract V1 (backend-generated, deterministisch):\n- schema_version\n- action_id + correlation_id\n- receipt_event_ids (stabil sortiert) + write_path\n- verification: status, required_checks, verified_checks\n- claim_guard: allow_saved_claim, claim_status, uncertainty_markers, deferred_markers\n- workflow_gate: phase, status, transition\n- autonomy_gate: decision, action_class, reason_codes\n- session_audit: status, mismatch_detected, mismatch_repaired, mismatch_unresolved\n- repair_feedback: status\n- warnings: count + normalized warning_codes\n- chat_summary_template_id (deterministische Render-Regel)\n\nChat-Contract (kein UI-Panel):\n- Nach jeder relevanten Write-Aktion muss der Agent eine kurze Digest-Zeile ausgeben.\n- Bei \"warum/beleg/details\" muss der Agent denselben Digest in detaillierter Form aufklappen.\n- Keine zweite Wahrheit: Chat-Ausgabe ist ausschließlich aus Digest-Feldern ableitbar.\n\nSpec-first Ablauf:\n1) tests/architecture/*trace_digest* zuerst (Pflichtfelder + Cross-Field-Invarianten)\n2) API-Response /v1/agent/write-with-proof um digest erweitern\n3) CLI/MCP-Parsing + Chat-Render-Regeln\n4) Optional: Digest-Event/Signal für spätere Audits\n5) Kein neues docs/design/*.md","acceptance_criteria":"1) `trace_digest.v1` ist versioniert, maschinenlesbar und Teil des write-with-proof Contracts.\n2) Pflichtfelder sind vorhanden: event_ids, verification status, claim_guard, workflow/autonomy Entscheidungen, repair/session audit Status.\n3) tests/architecture/ erzwingt Feldpflichten und Cross-Field-Invarianten (z. B. pending verification =\u003e kein saved-claim).\n4) API-Tests decken Statusmatrix ab: verified|pending|failed x clean|repaired|needs_clarification.\n5) Chat-Kurzfassung und Detailmodus sind deterministisch aus demselben Digest ableitbar und getestet.\n6) Keine UI-Annahme: Sichtbarkeit erfolgt ausschließlich über Agent-Antworten im Chat.","notes":"Implemented Trace Digest V1 as backend-generated provenance contract for each write-with-proof action.\n\nContract/runtime changes:\n- api/src/routes/agent.rs:\n  - Added AgentTraceDigest + TRACE_DIGEST_SCHEMA_VERSION (`trace_digest.v1`)\n  - Built digest deterministically from receipts/verification/claim_guard/workflow/audit/repair\n  - Added `trace_digest` to AgentWriteWithProofResponse\n  - Added chat fields: `chat_summary_template_id=trace_digest.chat.short.v1` + `chat_summary`\n\nArchitecture/spec tests:\n- tests/architecture/test_20_trace_digest_contract.py\n\nExample trace_digest.v1 payload (redacted):\n{\n  \"schema_version\": \"trace_digest.v1\",\n  \"action_id\": \"action_...\",\n  \"correlation_id\": \"corr_...\",\n  \"receipt_event_ids\": [\"...\"],\n  \"verification_status\": \"verified\",\n  \"claim_status\": \"verified\",\n  \"workflow_status\": \"allowed\",\n  \"autonomy_decision\": \"allow\",\n  \"repair_status\": \"none\",\n  \"warning_count\": 0,\n  \"chat_summary_template_id\": \"trace_digest.chat.short.v1\"\n}\n\nChat short/detail derivation:\n- short: uses `trace_digest.chat_summary`\n- detail: full `trace_digest` object fields from same source of truth (no second truth)\n\nVerification run:\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- cargo test --workspace -\u003e passed\n- full worker/rust quality gates passed\n\nNo new docs/design/*.md created.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:48:22.049456+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:39:12.506638+01:00","closed_at":"2026-02-13T19:39:12.506643+01:00","labels":["agent-contract","provenance","trust"],"dependencies":[{"issue_id":"kura-training-5hc.2","depends_on_id":"kura-training-5hc","type":"parent-child","created_at":"2026-02-13T18:48:22.050857+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.2","depends_on_id":"kura-training-5hc.1","type":"blocks","created_at":"2026-02-13T18:48:42.951833+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.2","depends_on_id":"kura-training-5hc.6","type":"blocks","created_at":"2026-02-13T19:01:50.370165+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5hc.3","title":"Challenge Mode V1 (anti-sycophancy collaboration contract)","description":"Warum:\nGute Zusammenarbeit braucht konstruktiven Widerspruch, aber nur dann, wenn er echten Mehrwert hat. Ohne klaren Modus entsteht entweder zu viel Zustimmung (Sycophancy) oder unnötige Reibung. In Kura gibt es keine UI für Settings, daher muss diese Steuerung vollständig im Chat und über persistierte Präferenzen funktionieren. Ein klarer Default (`auto`) plus expliziter Onboarding-Hinweis macht den Modus sichtbar und kontrollierbar.\n\nWas:\nImplementiere `challenge_mode.v1` als chat-gesteuerten Contract mit drei Zuständen: `auto` (Default), `on`, `off`. Der Agent muss im Onboarding/Primer aktiv erwähnen, dass `auto` an ist und per Chat deaktiviert werden kann.\n","design":"Preference-Contract (Source of Truth):\n- Persistenz über `preference.set` mit key=`challenge_mode`\n- Zulässige Werte: `auto | on | off`\n- Default bei fehlender Präferenz: `auto` (kein silent fallback auf off)\n- Optionaler Intro-Marker: `challenge_mode_intro_seen=true` (oder gleichwertiger deterministischer Marker), damit die Pflicht-Erklärung nicht in jedem Turn wiederholt wird\n\nVerhaltensmatrix:\n- auto:\n  - challenge nur bei Triggern (high-impact, niedrige Sicherheit, widersprüchliche Evidenz, relevante Alternativen)\n- on:\n  - bei jeder nicht-trivialen Empfehlung mindestens 1 Risiko + 1 Alternative\n- off:\n  - keine proaktive Challenge im Normalfall; Sicherheits-/Integritätsgrenzen (workflow_gate, claim_guard, autonomy_gate) bleiben immer verpflichtend\n\nChat-only Aktivierung und Discoverability:\n- Benutzer kann im Chat umschalten, z. B.:\n  - \"challenge mode aus/off/deaktivieren\" =\u003e `off`\n  - \"challenge mode an/on\" =\u003e `on`\n  - \"challenge mode auto\" =\u003e `auto`\n- Verpflichtender Onboarding-Hinweis (einmalig pro Nutzerkontext):\n  - \"Challenge Mode ist standardmäßig auf auto aktiv. Sag 'Challenge Mode aus', wenn ich weniger challengen soll.\"\n- Keine UI-Annahme, keine UI-Settings\n\nSpec-first Ablauf:\n1) tests/architecture/*challenge_mode* (Default + Trigger + Sicherheitsgrenzen)\n2) Preference/Persistenz-Contract + Parser-Mapping\n3) Onboarding/Primer-Text + Capability/Context-Hinweis\n4) Kein neues docs/design/*.md","acceptance_criteria":"1) Wenn keine Nutzerpräferenz gesetzt ist, gilt deterministisch `challenge_mode=auto`.\n2) Onboarding/Primer enthält den Pflicht-Hinweis, dass auto aktiv ist und per Chat deaktiviert werden kann.\n3) Chat-Umschaltungen (`auto|on|off`) werden deterministisch auf persistierte Präferenzen gemappt und getestet.\n4) Tests decken Verhaltensmatrix ab: auto (trigger-basiert), on (proaktiv), off (nur sicherheitskritische Einwände).\n5) tests/architecture/ erzwingt Contract-Invarianten inklusive Default-Verhalten und Trigger-Determinismus.\n6) Keine UI-Abhängigkeit: komplette Aktivierung/Steuerung läuft im Chat.","notes":"Implemented Challenge Mode V1 as chat-first, backend contract with default `auto`.\n\nContract/runtime changes:\n- workers/src/kura_workers/system_config.py:\n  - Added `operational.challenge_mode` contract (`challenge_mode.v1`)\n  - default: auto, allowed: auto|on|off\n  - storage contract: preference.set key `challenge_mode`\n  - discoverability includes onboarding hint + intro marker key\n- workers/src/kura_workers/event_conventions.py:\n  - Added preference keys: `challenge_mode`, `challenge_mode_intro_seen`\n- workers/src/kura_workers/interview_guide.py:\n  - Added mandatory onboarding hint in collaboration primer\n- api/src/routes/agent.rs:\n  - Added challenge_mode resolution in agent context meta\n  - deterministic normalization for mode values + source tracking\n\nArchitecture/spec tests:\n- tests/architecture/test_30_challenge_mode_contract.py\n\nWorker tests:\n- workers/tests/test_system_config.py\n- workers/tests/test_interview_guide.py\n\nOnboarding hint proof:\n- \"Challenge Mode ist standardmäßig auf auto aktiv. ... 'Challenge Mode aus' ...\"\n\nChat examples (contract-level behavior):\n- auto (default): trigger-based challenge on risk/conflict/high-impact\n- on: proactive risk + alternative for non-trivial recommendations\n- off: no proactive challenge by default, safety boundaries stay active\n\nVerification run:\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- worker/rust quality gates passed\n\nNo new docs/design/*.md created.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:48:27.283974+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:39:26.995458+01:00","closed_at":"2026-02-13T19:39:26.995462+01:00","labels":["collaboration","preferences","ux"],"dependencies":[{"issue_id":"kura-training-5hc.3","depends_on_id":"kura-training-5hc","type":"parent-child","created_at":"2026-02-13T18:48:27.284893+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.3","depends_on_id":"kura-training-5hc.1","type":"blocks","created_at":"2026-02-13T18:48:48.150806+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.3","depends_on_id":"kura-training-5hc.6","type":"blocks","created_at":"2026-02-13T19:01:55.571709+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.3","depends_on_id":"kura-training-5hc.2","type":"blocks","created_at":"2026-02-13T19:10:08.653945+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5hc.4","title":"Memory Tier Contract V1 (working/project/principles + freshness rules)","description":"Warum:\nKura hat mehrere Kontextquellen (u. a. user_profile, semantic_memory, open_observations), aber derzeit keinen einheitlichen Tier-Vertrag mit klaren Freshness-Regeln. Dadurch können alte oder unsichere Annahmen zu still als verlässlich behandelt werden. Besonders bei high-impact Entscheidungen muss eindeutig sein, wie frisch und belastbar eine Gedächtnisgrundlage ist. Ein Memory-Tier-Contract macht diese Grenze maschinenlesbar und im Chat erklärbar.\n\nWas:\nDefiniere `memory_tier_contract.v1` mit den Tiers `working | project | principles` inklusive Freshness-/Confidence-Semantik und Gate-Regeln für high-impact Aktionen. Keine UI-Settings: Steuerung und Transparenz erfolgen über Contract-Felder und Chat-Erklärungen.\n","design":"Tier-Semantik (v1):\n- working: kurzlebiger, sessionsnaher Kontext\n- project: mittelfristige Ziele/Pläne und laufende Vorhaben\n- principles: langfristige Präferenzen/Leitplanken/Constraints\n\nPro Memory-Eintrag (maschinenlesbar):\n- tier\n- source (projection/event lineage)\n- confidence (0..1 oder Band)\n- observed_at / last_verified_at\n- freshness_state (`fresh|aging|stale`)\n- stale_reason (optional)\n- expires_at (optional, falls tier-abhängig)\n\nGate-Regeln:\n- High-impact write auf Basis `stale` oder unklarer Memory-Einträge =\u003e confirm_first oder block (deterministisch)\n- Widerspruch zwischen neuer expliziter User-Aussage und altem Memory =\u003e alte Grundlage als conflicted/stale markieren, nicht still weiterverwenden\n- Prinzipien-/Präferenzregeln dürfen frische explizite User-Statements nicht überschreiben\n\nChat-Contract (kein UI):\n- Agent muss auf Nachfrage Entscheidung + Memory-Herkunft in einer kurzen Form erklären können (tier + freshness + confidence)\n- Erklärtext darf nur aus den Contract-Feldern abgeleitet werden\n\nSpec-first Ablauf:\n1) tests/architecture/*memory_tier* zuerst\n2) system/agent contract Felder implementieren\n3) Runtime-Gates + fallback Verhalten\n4) Kein neues docs/design/*.md","acceptance_criteria":"1) Tier-Semantik und Freshness-Regeln sind versioniert, maschinenlesbar und im Agent-/System-Contract verfügbar.\n2) High-impact Entscheidungen dürfen stale Memory nicht still als sichere Grundlage verwenden.\n3) tests/architecture/ erzwingt Tier-Pflichten, Prioritätsregeln und Freshness-Gates.\n4) Worker/API-Tests decken expiry/demotion, conflict handling und fallback behavior ab.\n5) Agent kann Herkunft/Freshness einer Entscheidung im Chat deterministisch aus Contract-Feldern erklären.\n6) Keine UI-Abhängigkeit: Verhalten ist vollständig backend-/chat-getrieben.","notes":"Implemented Memory Tier Contract V1 with freshness semantics and high-impact stale guard.\n\nContract/runtime changes:\n- api/src/routes/agent.rs:\n  - Added AgentMemoryTierContract (`memory_tier_contract.v1`) + tier snapshots\n  - tiers: working/project/principles with freshness_state + confidence_band + source\n  - added memory_tier_contract to agent context meta\n  - added confirm-first reason codes:\n    - memory_principles_missing_confirm_first\n    - memory_principles_stale_confirm_first\n  - merged memory stale guard into autonomy gate for high-impact writes\n\nArchitecture/spec tests:\n- tests/architecture/test_40_memory_tier_contract.py\n\nRuntime tests:\n- api/src/routes/agent.rs test:\n  - memory_guard_escalates_high_impact_allow_to_confirm_first_when_preferences_missing\n\nExample memory tier snapshot (redacted):\n{\n  \"tier\": \"principles\",\n  \"freshness_state\": \"aging\",\n  \"confidence_band\": \"medium\",\n  \"source\": \"projection:user_profile/me.preferences\"\n}\n\nHigh-impact stale gating behavior:\n- high-impact + missing/stale principles context =\u003e autonomy decision escalates to `confirm_first`\n\nVerification run:\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- cargo test --workspace -\u003e passed\n- worker/rust quality gates passed\n\nNo new docs/design/*.md created.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:48:32.513862+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:39:40.609548+01:00","closed_at":"2026-02-13T19:39:40.609551+01:00","labels":["agent-contract","memory","reliability"],"dependencies":[{"issue_id":"kura-training-5hc.4","depends_on_id":"kura-training-5hc","type":"parent-child","created_at":"2026-02-13T18:48:32.514785+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.4","depends_on_id":"kura-training-5hc.1","type":"blocks","created_at":"2026-02-13T18:48:53.368336+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.4","depends_on_id":"kura-training-5hc.6","type":"blocks","created_at":"2026-02-13T19:02:00.772964+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.4","depends_on_id":"kura-training-5hc.3","type":"blocks","created_at":"2026-02-13T19:10:13.893088+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5hc.5","title":"Post-Task Reflection Contract V1 (delivery quality loop)","description":"Warum:\nNach einer Agent-Aktion fehlt heute ein verpflichtender Abschlussvertrag, der klar trennt zwischen \"gesichert\", \"unsicher\" und \"als nächstes zu prüfen\". Dadurch gehen Restrisiken leicht unter und der Mensch muss nachfragen, obwohl die Informationen intern schon vorhanden sind. Das bremst die Zusammenarbeit und schwächt den Learning-Loop. Ein Post-Task Reflection Contract macht den Abschluss jeder relevanten Aktion konsistent, prüfbar und im Chat sofort nutzbar.\n\nWas:\nFühre `post_task_reflection.v1` als maschinenlesbaren, chat-first Abschluss-Contract ein: Was wurde geändert, was bleibt riskant/offen, was ist der nächste Verifikationsschritt. Reflection-Signale sollen in die bestehende Learning-Telemetrie integriert werden.\n","design":"Contract V1 (deterministisch):\n- schema_version\n- action_id / related_trace_digest_id\n- change_summary (was wurde geschrieben/geändert, inkl. event_id Referenzen)\n- certainty_state (`confirmed|partial|unresolved`)\n- residual_risks[] (klar benannt)\n- next_verification_step (konkret + ausführbar)\n- clarification_question (optional, wenn unresolved)\n- follow_up_recommended (bool + reason)\n- emitted_learning_signal_types[]\n\nChat-Contract (kein UI):\n- Nach jeder relevanten Task-Ausführung liefert der Agent eine kurze Reflection-Zeile.\n- Wenn certainty_state != confirmed, muss die Antwort einen konkreten nächsten Verifikationsschritt (oder eine fokussierte Klärungsfrage) enthalten.\n- Reflection-Text darf nur aus Reflection/Digest-Contractfeldern abgeleitet werden.\n\nLearning-Integration:\n- Reflection erzeugt/erweitert standardisierte Lernsignale für Qualität und Friktion.\n- Signal-Mapping bleibt deterministisch und testbar (kein freies Heuristik-Logging).\n\nSpec-first Ablauf:\n1) tests/architecture/*post_task_reflection* zuerst\n2) API/Runtime Contract + Response Felder\n3) Learning-Telemetrie + Backlog-Bridge Mapping\n4) Kein neues docs/design/*.md","acceptance_criteria":"1) `post_task_reflection.v1` ist versioniert, maschinenlesbar und pro relevanter Agent-Aktion verfügbar.\n2) Reflection enthält immer change_summary + certainty_state + residual_risk/next_verification (oder klare Begründung, warum nicht nötig).\n3) Wenn certainty_state `partial` oder `unresolved` ist, ist ein konkreter nächster Verifikationsschritt oder eine gezielte Klärungsfrage verpflichtend.\n4) tests/architecture/ erzwingt Pflichtfelder und Invarianten, inklusive Konsistenz zum Trace-Digest.\n5) Learning-Telemetrie- und Backlog-Bridge-Tests decken Reflection-Signal-Mapping ab.\n6) Chat-Ausgabe ist deterministisch aus Reflection-Contract ableitbar und UI-unabhängig.","notes":"Implemented Post-Task Reflection Contract V1 and integrated deterministic reflection learning signals.\n\nContract/runtime changes:\n- api/src/routes/agent.rs:\n  - Added AgentPostTaskReflection (`post_task_reflection.v1`)\n  - Added `post_task_reflection` to write-with-proof response\n  - Deterministic certainty mapping: confirmed|partial|unresolved from verification + session/repair status\n  - Enforced next step generation for non-confirmed states\n  - Added reflection signal emission (`post_task_reflection_*`)\n- workers/src/kura_workers/learning_telemetry.py:\n  - Added taxonomy entries:\n    - post_task_reflection_confirmed -\u003e outcome_signal\n    - post_task_reflection_partial -\u003e friction_signal\n    - post_task_reflection_unresolved -\u003e friction_signal\n\nArchitecture/spec tests:\n- tests/architecture/test_50_post_task_reflection_contract.py\n\nWorker/API tests:\n- workers/tests/test_learning_telemetry.py\n- api/src/routes/agent.rs reflection/trace tests\n\nExample reflection object (redacted):\n{\n  \"schema_version\": \"post_task_reflection.v1\",\n  \"action_id\": \"action_...\",\n  \"related_trace_digest_id\": \"action_...\",\n  \"certainty_state\": \"partial\",\n  \"residual_risks\": [\"read_after_write_not_fully_verified\"],\n  \"next_verification_step\": \"retry_read_after_write_with_same_idempotency_keys\"\n}\n\nChat reflection examples:\n- confirmed: \"Reflection: certainty=confirmed, next_step=none\"\n- unresolved: \"Reflection: certainty=unresolved, next_step=verification_or_clarification\"\n\nVerification run:\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- cargo test --workspace -\u003e passed\n- worker/rust quality gates passed\n\nNo new docs/design/*.md created.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:48:37.749404+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:39:59.014594+01:00","closed_at":"2026-02-13T19:39:59.014598+01:00","labels":["collaboration","learning-loop","quality"],"dependencies":[{"issue_id":"kura-training-5hc.5","depends_on_id":"kura-training-5hc","type":"parent-child","created_at":"2026-02-13T18:48:37.750516+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.5","depends_on_id":"kura-training-5hc.2","type":"blocks","created_at":"2026-02-13T18:48:58.573989+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.5","depends_on_id":"kura-training-5hc.3","type":"blocks","created_at":"2026-02-13T18:49:03.777865+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.5","depends_on_id":"kura-training-5hc.6","type":"blocks","created_at":"2026-02-13T19:02:05.971669+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5hc.5","depends_on_id":"kura-training-5hc.4","type":"blocks","created_at":"2026-02-13T19:10:19.120627+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5hc.6","title":"Architecture Spec Harness Bootstrap (tests/architecture as executable source of truth)","description":"Warum:\nGemäß AGENTS.md müssen neue Architekturentscheidungen als ausführbare Tests in tests/architecture/ abgesichert werden. Ohne Harness besteht Risiko, dass 5hc.1-5hc.5 inkonsistent oder nicht CI-verbindlich werden.\n\nWas:\nBaue den minimalen, CI-fähigen Architekturtest-Harness für tests/architecture/ als verbindliche Grundlage für alle weiteren Collaboration-Contracts.","design":"Scope:\n- tests/architecture/ Struktur + Naming-Konvention\n- ausführbarer Runner lokal + in CI\n- ein erster Smoke-Spec-Test als Referenzmuster\n- keine neue docs/design/*.md\n\nHinweis zur Polyglot-Repo-Struktur:\nHarness darf Rust/API- und Worker-seitige Invarianten integrieren, solange Ausführung reproduzierbar und deterministisch bleibt.","acceptance_criteria":"1) tests/architecture/ existiert mit lauffähigem Test-Entry.\n2) Runner ist in CI/Quality-Gate integriert.\n3) Ein Smoke-Architecture-Test beweist End-to-End-Ausführung.\n4) Bead-Notes enthalten genaue lokalen Befehle für den Architekturtest-Lauf.","notes":"Implemented executable architecture-spec harness and CI gate wiring.\n\nNew architecture test paths:\n- tests/architecture/conftest.py\n- tests/architecture/test_00_harness_smoke.py\n- tests/architecture/test_10_intent_handshake_contract.py\n- tests/architecture/test_20_trace_digest_contract.py\n- tests/architecture/test_30_challenge_mode_contract.py\n- tests/architecture/test_40_memory_tier_contract.py\n- tests/architecture/test_50_post_task_reflection_contract.py\n\nGate/CI hook:\n- workers/tests/test_architecture_specs.py (executes `pytest -q tests/architecture` inside existing worker pytest gate)\n- scripts/run-architecture-tests.sh for direct local run\n\nVerification run:\n- ./scripts/run-architecture-tests.sh -\u003e 12 passed\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_architecture_specs.py -q -\u003e pass (included in full worker suite)\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py -\u003e 585 passed, 135 skipped\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q -\u003e 84 passed\n- cargo test --workspace -\u003e passed\n- ruff check workers/src/ workers/tests/ -\u003e passed\n\nNo new docs/design/*.md created.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T19:01:39.960019+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T19:38:42.482385+01:00","closed_at":"2026-02-13T19:38:42.482388+01:00","labels":["architecture-tests","ci","collaboration"],"dependencies":[{"issue_id":"kura-training-5hc.6","depends_on_id":"kura-training-5hc","type":"parent-child","created_at":"2026-02-13T19:01:39.961233+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5ur","title":"Web Profile \u0026 Settings: Seriöse Anwendung für Early Access","description":"## Warum\nRequest-Access-Feature ist live, aber das Frontend dahinter ist ein statischer Mockup.\nLogin/Signup sind UI-Shells ohne Auth. Settings zeigt hardcoded Daten.\nFür eine seriöse Early-Access-Anwendung braucht es funktionierende Auth,\nechte Settings, Legal-Pflichtseiten und einen sauberen Agent-Connection-Flow.\n\n## Scope\n1. Browser-Auth verdrahten (OAuth PKCE) — Fundament für alles\n2. Settings-Seite lebendig machen (Profil, API Keys, Privacy, Sicherheit, Support, Danger Zone)\n3. Setup-Seite mit echten kopierbaren Werten für Agent-Connection\n4. Legal-Pflichtseiten (Impressum, Datenschutz, Nutzungsbedingungen) als Platzhalter\n5. Passwort-Reset-Flow\n\n## Designprinzipien\n- Platzhalter wo Content fehlt, aber die Struktur muss vollständig sein\n- Datenexport: NUR User-Events + Projections, KEIN system_config/agent_behavior\n- Consent-Toggle: Sichtbar aber disabled während Early Access (ist Teilnahmebedingung)\n- API Key One-Time-Display Pattern (wie Sum): Key wird genau einmal gezeigt\n- Fundament vor Feature: Auth MUSS zuerst funktionieren","status":"open","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:32:47.691454+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:32:47.691454+01:00","dependencies":[{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-3kh","type":"blocks","created_at":"2026-02-13T14:45:08.045756+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-bd1","type":"blocks","created_at":"2026-02-13T14:45:13.194926+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-cj0","type":"blocks","created_at":"2026-02-13T14:45:18.386631+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-4uv","type":"blocks","created_at":"2026-02-13T14:45:23.576576+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-a6r","type":"blocks","created_at":"2026-02-13T14:45:28.763304+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-4z2","type":"blocks","created_at":"2026-02-13T14:45:33.954567+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-u1h","type":"blocks","created_at":"2026-02-13T14:45:39.138238+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur","depends_on_id":"kura-training-f0l","type":"blocks","created_at":"2026-02-13T14:45:44.342381+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5ur.1","title":"Web Confidence Surface V1: Setup/Security Zustände + Browser-Smoketests","description":"Warum:\nWeb-Oberflächen für Setup/Security sollen den realen Systemzustand widerspiegeln und durch Tests abgesichert sein, damit Operatoren und Stakeholder konsistente Signale sehen.\n\nScope:\n- Setup/Security-Flows auf reale Verfügbarkeits-/Policy-Signale ausrichten (statt statischer Platzhalter, wo technisch verfügbar).\n- Browser-Smoketests für kritische Flows (Login, Setup, Settings-Bereiche) ergänzen.\n- Fehler-/Leerzustände explizit und testbar machen.\n\nWas muss gelten:\n- Kritische Web-Flows sind automatisiert testbar.\n- Zustände im UI sind konsistent mit Backend-Contracts.\n\nNicht-Ziele:\n- Kein visuelles Redesign.\n\nImplementierungsanker:\n- web/src/app/[locale]/(inner)/setup/page.tsx\n- web/src/app/[locale]/(inner)/settings/page.tsx\n- web/ (Test-Setup)\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst Test-Entrypoint und die gemappten UI-Zustände prüfen; dann gegen Backend-Signale (Env/Endpoints) verifizieren.\n","design":"Operator-/Stakeholder-UX als verifizierbare Oberfläche statt rein statischer Hinweise.","acceptance_criteria":"1) Mindestens Login, Setup und zentrale Settings-States sind per Browser-Test abgedeckt. 2) UI-Zustände für MCP/Security sind backend-konsistent oder klar als nicht verfügbar markiert. 3) Testlauf ist lokal reproduzierbar und dokumentiert.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:13:00.76081+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T06:40:26.305104+01:00","closed_at":"2026-02-14T06:40:26.305104+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-5ur.1","depends_on_id":"kura-training-5ur","type":"parent-child","created_at":"2026-02-13T20:13:00.761843+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-5ur.1","depends_on_id":"kura-training-siq.6","type":"blocks","created_at":"2026-02-13T20:13:05.962518+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-5xk","title":"Proaktive Konsistenzfunde im Chat surfacen und explizite Fix-Freigabe einholen","description":"## Entscheidungszusammenfassung (Warum)\n\nEs gibt in diesem Produkt keine separate UI fuer Backlog-Approval; der Mensch interagiert ueber den KI-Chat. Deshalb muessen proaktive Konsistenzfunde aus dem Nachtlauf im Chat sichtbar werden und eine explizite Nutzerentscheidung einholen, bevor Fixes ausgefuehrt werden. \"Intern gespeichert\" reicht nicht, wenn der Mensch keinen Trigger bekommt. Diese Aufgabe ersetzt den impliziten Backlog-Gedanken durch einen chat-zentrierten Approval-Flow. V1 bleibt sicher: kein stilles Auto-Fixing ohne Zustimmung.\n\n## Abhaengigkeit\n\n- Haengt von `kura-training-znc` ab (Severity vorhanden), damit Chat-Priorisierung (`critical/warning/info`) sinnvoll ist.\n\n## Zielbild (Produktverhalten)\n\nBeim naechsten normalen Chatkontakt soll der Agent bei offenen Konsistenzfunden proaktiv sagen:\n\n- was gefunden wurde (kurz, priorisiert)\n- warum es relevant ist (z. B. Datenintegritaetsrisiko)\n- und genau **eine** Entscheidungsfrage stellen:\n  - \"Soll ich den vorgeschlagenen Fix ausfuehren?\"\n\nOhne explizite Zustimmung darf kein Fix ausgefuehrt werden.\n\n## Muss-Invarianten\n\n1. **No silent fixes**: Kein Konsistenzfix ohne vorherige User-Entscheidung im Chat.\n2. **Chat-first surfacing**: Offene Findings muessen in den Agent-Kontext eingebunden sein, nicht nur in interne Tabellen.\n3. **Single-question discipline**: Pro Turn maximal eine Approval-Frage.\n4. **Decision traceability**: Zustimmung/Ablehnung/Snooze werden als Events protokolliert.\n5. **Nagging-Schutz**: Nach Ablehnung/Snooze keine sofortige Wiederholung derselben Frage.\n\n## Implementierungs-Scope (Wie)\n\n### A) Proaktive Findings erzeugen (nightly)\n\n- `workers/src/kura_workers/handlers/inference_nightly.py`\n  - Nightly-Pipeline um Konsistenz-Audit-Refresh erweitern.\n- Neues Worker-Modul (z. B. `workers/src/kura_workers/consistency_inbox.py`):\n  - aggregiert pro User offene Findings aus relevanten Signalen (`quality.save_claim.checked`, `learning.signal.logged`, `quality_health`)\n  - priorisiert nach `critical \u003e warning \u003e info`\n  - schreibt Ergebnis in eine fuer Agent-Kontext lesbare Projection.\n\n### B) Chat-lesbare Projection bereitstellen\n\n- Neue Projection: `consistency_inbox/overview` (pro User genau ein Datensatz)\n- Mindestschema:\n  - `schema_version`\n  - `generated_at`\n  - `pending_items_total`\n  - `highest_severity`\n  - `requires_human_decision` (bool)\n  - `items[]` mit `item_id`, `severity`, `summary`, `recommended_action`, `evidence_ref`\n  - `prompt_control` mit `last_prompted_at`, `snooze_until`, `cooldown_active`\n\n### C) Agent-Kontext erweitern\n\n- `api/src/routes/agent.rs`\n  - `AgentContextResponse` um optionales Feld `consistency_inbox` erweitern.\n  - `get_agent_context` soll `consistency_inbox/overview` laden und zurueckgeben.\n\n### D) Operational Policy im Agent-Behavior\n\n- `workers/src/kura_workers/system_config.py`\n  - `agent_behavior.operational.consistency_inbox_protocol_v1` einfuehren:\n    - `approval_required_before_fix: true`\n    - `max_questions_per_turn: 1`\n    - `allowed_user_decisions: [\"approve\", \"decline\", \"snooze\"]`\n    - `default_snooze_hours`\n    - `critical_escalation_wording` (kurz, nicht alarmistisch)\n\n### E) User-Entscheidung eventen\n\n- Event-Vertrag erweitern (Event-Conventions + API Write-Path):\n  - `quality.consistency.review.decided`\n  - Pflichtfelder:\n    - `item_ids[]`\n    - `decision` (`approve|decline|snooze`)\n    - `decision_source` (`chat_explicit`)\n    - `snooze_until` (optional)\n- Bei `approve`:\n  - nur freigegebene, sichere Aktionen ausfuehren (V1: deterministische/sichere Reparaturen)\n  - wenn nicht sicher auto-ausfuehrbar: als pending lassen + transparent im Chat kommunizieren.\n\n### F) Dedup/Cooldown\n\n- Gleiches `item_id` darf nicht in jedem Turn erneut gepusht werden.\n- Cooldown/Snooze muss serverseitig wirksam sein (nicht nur Prompt-Text).\n\n## Architecture-Spec-Tests (Pflicht laut AGENTS.md)\n\nNeue/angepasste Tests in `tests/architecture/`:\n\n1. `tests/architecture/test_63_consistency_inbox_contract.py`\n   - Kontext-Contract:\n     - `AgentContextResponse` kann `consistency_inbox` liefern.\n   - Approval-Contract:\n     - bei `requires_human_decision=true` muss Approval-Frage-konformes Verhalten erzwingbar sein.\n     - ohne `approve` darf kein Fix-Apply-Pfad laufen.\n   - Runtime-Referenzen via `assert_kura_api_test_passes(...)`:\n     - `routes::agent::tests::consistency_inbox_contract_is_exposed_in_context`\n     - `routes::agent::tests::consistency_inbox_contract_requires_explicit_approval_before_fix`\n     - `routes::agent::tests::consistency_inbox_contract_respects_snooze_cooldown`\n\n2. `tests/architecture/test_61_scenario_library_contract.py`\n   - Szenario ergaenzen fuer \"proactive consistency prompt + one-question rule\".\n\n3. `tests/architecture/test_62_user_override_controls_contract.py`\n   - Sicherstellen, dass User-Overrides den Safety-Floor \"kein Fix ohne Approval\" nicht aufheben.\n\n## Nicht-Ziele (V1)\n\n- Keine separate UI/Inbox-Oberflaeche.\n- Kein vollautomatisches Self-Healing fuer semantisch riskante Fixes.\n- Kein unendliches Reminder-Spam-Verhalten.\n\n## Akzeptanzkriterien\n\n- Nightly erstellt/aktualisiert `consistency_inbox/overview` pro User.\n- `/v1/agent/context` liefert `consistency_inbox` im Bundle.\n- Agent kann anhand Kontext + Policy genau eine Approval-Frage formulieren.\n- Ohne `approve` kein Fix-Apply.\n- `approve|decline|snooze` wird evented und beeinflusst erneute Prompts.\n- Architecture-Spec-Tests fuer diesen Contract sind gruen.\n\n## Hinweise fuer KI-Umsetzung mit wenig Kontext (compaction-resistent)\n\n- \"Backlog\" in diesem System bedeutet hier **nicht UI-Liste**, sondern serverseitig persistierter Entscheidungsbedarf, der im Chat sichtbar sein muss.\n- Sicherheit geht vor Komfort: fehlende Entscheidung =\u003e kein Fix.\n- Bei Unsicherheit lieber als pending im Chat transparent machen als still ausfuehren.\n","status":"open","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T11:46:56.738778+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:46:56.738778+01:00","dependencies":[{"issue_id":"kura-training-5xk","depends_on_id":"kura-training-znc","type":"blocks","created_at":"2026-02-14T11:46:56.74061+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-6ei","title":"Population Priors Engine: Hierarchical Cross-User Learning mit Privacy-Gates","description":"Implement a privacy-safe population-prior engine so individual Bayesian models can borrow strength from anonymized cohorts. Include opt-in policy, aggregation thresholds, and strict separation between individual and population artifacts.","notes":"Future differentiation feature; depends on mature Bayesian projections and governance policy.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T08:36:55.192032+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T13:37:39.215678+01:00","closed_at":"2026-02-11T13:37:39.215678+01:00","close_reason":"Closed","labels":["bayesian","benchmarks","privacy"]}
{"id":"kura-training-6kf","title":"Design: Adaptives Projektionssystem (Attribute Passthrough, Raw Events, Deklarative Handler)","description":"Drei Ansätze für adaptives System statt starre Handler: (1) Attribute Passthrough — unbekannte Felder in Projektionen durchreichen statt wegwerfen, (2) Raw-Events-Projektion — letzte N Events pro User als Sicherheitsnetz, (3) Deklarative Handler — Handler-Verhalten als Config statt Code. Vor Implementierung: Vor-/Nachteile analysieren, weitere Optionen explorieren. Liquid-AI-Analogie: System reagiert auf User-Daten statt Blaupause. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:39.990394+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T22:11:01.693541+01:00","closed_at":"2026-02-09T22:11:01.693541+01:00","close_reason":"Phase 1 (Graceful Degradation) implemented. Phases 2-4 tracked separately."}
{"id":"kura-training-717","title":"Event dry-run simulation endpoint for projection deltas","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T07:42:51.683213+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T08:16:08.456609+01:00","closed_at":"2026-02-11T08:16:08.456609+01:00","close_reason":"Added POST /v1/events/simulate dry-run endpoint with validation, plausibility/similarity warnings, retraction-aware event-type resolution, active custom-rule matching, and predicted projection impact deltas"}
{"id":"kura-training-73i","title":"Agent Context Ranking Optimizer: Relevanz-Scoring für Projection-Auswahl","description":"Introduce a ranking layer for agent context assembly that scores candidate projections by recency, confidence, semantic relevance, and task intent. Goal: reduce prompt bloat and increase action quality under context limits.","notes":"Keep separate from current semantic resolver implementation; this is retrieval orchestration.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T08:37:00.278498+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T13:17:20.943102+01:00","closed_at":"2026-02-11T13:17:20.943102+01:00","close_reason":"Closed","labels":["agent-interface","optimization","retrieval"]}
{"id":"kura-training-7an","title":"GET /v1/projections Snapshot-Endpoint (alle Dimensionen in einem Call)","description":"Neuer Endpoint der ALLE Projektionen eines Users in einem Call zurückgibt. Aktuell braucht der Agent pro Dimension einen separaten Call — bei 7+ Dimensionen zu mühsam. Ein einzelner Snapshot löst 80% der Kompositions-Probleme. Leicht zu implementieren, hoher Impact. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:42.869178+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:04:00.586791+01:00","closed_at":"2026-02-10T07:04:00.586791+01:00","close_reason":"GET /v1/projections implemented, tested, 20 projections in one call"}
{"id":"kura-training-7cy","title":"session_summary projection","description":"Projection that answers 'what did I do this week/today?' Grouped by day, shows exercises, volume, set counts. Uses session_id from metadata to group sets into sessions.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:12.873326+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:07:45.333995+01:00","closed_at":"2026-02-09T08:07:45.333995+01:00","close_reason":"session_summary killed — violates Decision 5 (Dimensions, not Answers). Data already available via training_timeline + exercise_progression composition.","dependencies":[{"issue_id":"kura-training-7cy","depends_on_id":"kura-training-nv2","type":"blocks","created_at":"2026-02-08T13:39:32.433452+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-87v","title":"API: POST /v1/access/request (public, no auth)","description":"## Was\nÖffentlicher Endpoint für Access Requests. Kein Auth nötig.\n\n## Endpoint\nPOST /v1/access/request\nBody: { \"email\": \"...\", \"name\": \"...\" (optional), \"context\": \"...\" (optional) }\nResponse 201: { \"status\": \"received\", \"message\": \"We will be in touch.\" }\n\n## Logik\n- Email-Validierung (Format)\n- Duplikat-Check: wenn gleiche Email mit status=pending existiert → trotzdem 201 (kein Info-Leak)\n- Rate-Limiting: max 5 Requests pro IP pro Stunde (einfacher in-memory Counter reicht erstmal)\n- INSERT in access_requests Tabelle\n- Kein Auth-Header nötig, kein RLS — direkter INSERT mit service role\n\n## Fehler\n- 400: email fehlt oder ungültig\n- 429: Rate limit\n\n## Hinweis\n- Keine Bestätigungs-Email nötig (erstmal). Einfach speichern.\n- Später optional: Bestätigungs-Email mit Double-Opt-In","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:44:37.970211+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:03:33.138385+01:00","closed_at":"2026-02-13T13:03:33.138385+01:00","close_reason":"POST /v1/access/request implemented","dependencies":[{"issue_id":"kura-training-87v","depends_on_id":"kura-training-33v","type":"blocks","created_at":"2026-02-13T12:46:45.171183+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-87v","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:26.702011+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-880","title":"Docker Compose: PostgreSQL mit pgvector, RLS, DB-Rollen, Immutability-Constraints","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:01.964022+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-07T21:53:13.110532+01:00","closed_at":"2026-02-07T21:53:13.110532+01:00","close_reason":"Closed"}
{"id":"kura-training-9bz","title":"Projektstruktur + Rust Cargo Workspace anlegen (api, cli, core crates)","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:00.619292+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-07T21:53:09.542159+01:00","closed_at":"2026-02-07T21:53:09.542159+01:00","close_reason":"Closed"}
{"id":"kura-training-a6r","title":"Settings: Sicherheit + Support + Danger Zone","description":"## Warum\nSicherheit (2FA), Support-Zugang und Account-Löschung sind Pflicht-Sektionen\nfür eine seriöse Anwendung. 2FA und Support als Platzhalter, Deletion verdrahtet.\n\n## Was\n### Sicherheit (Platzhalter)\n- 2FA-Sektion mit \"Kommt bald\"-Badge\n- Kurzer Text: \"Zwei-Faktor-Authentifizierung wird in einer zukünftigen Version verfügbar sein.\"\n- Disabled Toggle oder Button\n\n### Support\n- Kontakt-Email (z.B. support@kura.dev oder persönliche Email)\n- Link zu Docs/GitHub (wenn vorhanden)\n- Platzhalter-Text: \"Bei Fragen oder Problemen erreichst du uns unter...\"\n\n### Danger Zone (verdrahtet)\n- Account-Löschung: Email-Bestätigung im Input, dann DELETE /v1/account\n- Klar kommunizieren: \"Alle Daten werden unwiderruflich gelöscht\" \n- Bestätigungs-Dialog vor dem finalen Delete\n- Nach Löschung: Logout + Redirect zu Landing Page\n\n## Abhängigkeit\n- Blocked by: Browser Auth (kura-training-3kh)\n\n## Akzeptanzkriterien\n- 2FA-Sektion existiert als Platzhalter\n- Support-Sektion mit Kontaktmöglichkeit\n- Account-Löschung funktioniert end-to-end (bestätigen → API call → logout → redirect)","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:34:58.524366+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T15:01:42.658317+01:00","closed_at":"2026-02-13T15:01:42.658317+01:00","close_reason":"Implemented in settings page: 2FA placeholder with Coming Soon badge, support section with email, danger zone with email-confirmed account deletion.","dependencies":[{"issue_id":"kura-training-a6r","depends_on_id":"kura-training-3kh","type":"blocks","created_at":"2026-02-13T14:35:06.677626+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-akn","title":"[ctv.2] Runtime model telemetry persistence","description":"Persist verified runtime model identity per request into quality/learning telemetry and write artifacts so downstream workers can score model performance automatically.","acceptance_criteria":"1) Runtime model identity stored in event/telemetry payloads for agent writes. 2) Existing analytics remains backward-compatible when field absent.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T21:19:45.191737+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:41:25.417782+01:00","closed_at":"2026-02-13T21:41:25.417782+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-akn","depends_on_id":"kura-training-d8o","type":"blocks","created_at":"2026-02-13T21:20:52.521023+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-alk","title":"session_id Konzept für set.logged Events","description":"Optionales session_id Feld in set.logged Events. Agent generiert eine ID pro Trainingseinheit, hängt sie an jeden Set. training_timeline gruppiert nach session_id statt nur Datum. Ermöglicht mehrere Sessions pro Tag. Rückwärtskompatibel: alte Events ohne session_id fallen auf Tages-Gruppierung zurück. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:46.371672+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:17:12.665462+01:00","closed_at":"2026-02-10T07:17:12.665462+01:00","close_reason":"session_id implemented: event conventions, training_timeline session grouping, exercise_progression session counting, datagen generation. Full backward compatibility."}
{"id":"kura-training-amg","title":"Performance-Baseline-Testing: Benchmark-Harness für API + Worker","description":"Keine Antwort auf: 'Wie schnell ist Snapshot für User mit 5000 Events?' oder 'Hat das Refactoring die Projection-Berechnung verlangsamt?'\n\nBenchmark-Harness bauen:\n- API-Latenz: GET /v1/projections (Snapshot), GET /v1/projections/{type}/{key}, POST /v1/events\n- Worker: Projection-Recompute-Zeit pro Handler (exercise_progression mit 500 Sets, training_timeline mit 90 Tagen)\n- Baselines definieren (z.B. Snapshot \u003c200ms, Recompute \u003c500ms)\n- Optional: In CI laufen lassen, fail bei Regression über Threshold\n\nBraucht Testdaten (Datagen existiert bereits mit 3 Profilen, 90 Tage, ~6600 Events).\n\nZiel: Stille Performance-Regression erkennen, bevor Production-User da sind.\n\nInspiration: Ramin Hasani (Liquid AI) — 'A benchmark harness runs on each target device. CI fails if p95 \u003e threshold.'","notes":"Execution anchor after spec-hardening: depends on kura-training-veh. Child order: amg.1 (baseline harness) -\u003e amg.2 (regression gate). Outputs must be machine-readable and suitable for downstream rollout gating.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T15:34:32.40621+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T07:33:11.913165+01:00","closed_at":"2026-02-14T07:33:11.913165+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-amg","depends_on_id":"kura-training-veh","type":"blocks","created_at":"2026-02-13T20:13:16.381406+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-amg.1","title":"Performance Baseline V2.1: Reproduzierbarer API+Worker Benchmark-Harness","description":"Warum:\nVor größeren Refactors fehlt ein harter Performance-Ausgangspunkt für API- und Worker-Latenzen.\n\nScope:\n- Reproduzierbaren Benchmark-Harness für API + Worker erstellen.\n- Fixes Datenset/Replay-Korpus definieren (z.B. via datagen) für vergleichbare Messungen.\n- Ergebnisartefakt maschinenlesbar persistieren (z.B. JSON-Report) inklusive p50/p95 und Messkontext.\n\nWas muss gelten:\n- Benchmarks sind reproduzierbar und scriptbar.\n- Output ist maschinenlesbar und für Folge-Gates wiederverwendbar.\n\nNicht-Ziele:\n- In diesem Schritt noch kein CI-Fail bei Regression.\n\nImplementierungsanker:\n- scripts/\n- datagen/\n- workers/src/kura_workers/eval_harness.py (nur falls nötig für standardisierte Messwerte)\n- docs/reports/ (nur für Artefakte, keine neue Designprosa)\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst das Benchmark-Entry-Script und das Baseline-Artifact prüfen; dann Messlauf lokal reproduzieren und Werte verifizieren.\n","design":"Vor Refactor zuerst messbare Baseline; Outputs maschinenlesbar für Agent-Auswertung.","acceptance_criteria":"1) Ein dokumentierter Befehl erzeugt reproduzierbar Baseline-Metriken (inkl. p50/p95) für definierte API- und Worker-Pfade. 2) Ergebnis wird als maschinenlesbares Artefakt gespeichert. 3) Messlauf ist lokal wiederholbar und deterministisch genug für Regression-Checks.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:12:08.583867+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T23:36:11.856584+01:00","closed_at":"2026-02-13T23:36:11.856584+01:00","close_reason":"Implemented reproducible API+worker baseline harness with machine-readable artifact, runbook, and executable artifact contract test.","dependencies":[{"issue_id":"kura-training-amg.1","depends_on_id":"kura-training-amg","type":"parent-child","created_at":"2026-02-13T20:12:08.585333+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-amg.1","depends_on_id":"kura-training-veh.2","type":"blocks","created_at":"2026-02-13T20:12:13.782867+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-amg.2","title":"Performance Baseline V2.2: Regression-Gate mit Thresholds","description":"Warum:\nBaseline ohne Gate schützt nicht gegen stille Performance-Regressions.\n\nScope:\n- Threshold-Policy (z.B. max allowed delta, absolute Limits) als ausführbare Gate-Logik implementieren.\n- Fail-Mechanik für Regressionen in den Qualitätslauf integrieren.\n- Override/Local-Mode klar trennen, damit CI streng bleibt.\n\nWas muss gelten:\n- Gate failt deterministisch bei Threshold-Verletzung.\n- Gate-Ergebnis ist maschinenlesbar und erklärt den Grund.\n\nNicht-Ziele:\n- Kein Tuning auf absolute Spitzenwerte; Fokus auf Regression-Schutz.\n\nImplementierungsanker:\n- scripts/\n- ggf. tests/performance/ oder workers/tests/\n- docs/reports/ für Gate-Ausgabe (Artefakt)\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst Threshold-Definition + Gate-Entrypoint lesen, dann absichtlich einen Fail simulieren, um die Gate-Wirksamkeit zu verifizieren.\n","design":"Benchmark-Werte werden zu CI-durchsetzbaren Invarianten; keine manuelle Interpretation als einziges Kontrollmittel.","acceptance_criteria":"1) Regression-Gate failt bei definierten Threshold-Verletzungen. 2) Gate liefert maschinenlesbare Failure-Reasons. 3) Erfolgs- und Fail-Szenario sind per Test/Script reproduzierbar.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:12:19.01576+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T23:40:12.808164+01:00","closed_at":"2026-02-13T23:40:12.808164+01:00","close_reason":"Implemented machine-readable performance regression gate with threshold policy, fail-on-regression exit code, wrapper script, reports, and reproducible pass/fail tests.","dependencies":[{"issue_id":"kura-training-amg.2","depends_on_id":"kura-training-amg","type":"parent-child","created_at":"2026-02-13T20:12:19.016702+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-amg.2","depends_on_id":"kura-training-amg.1","type":"blocks","created_at":"2026-02-13T20:12:24.215878+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-aok","title":"Agenda-Severity-Eskalation bei ignorierten Issues","description":"Agenda-Items eskalieren in der Priorität wenn sie über Zeit ignoriert werden. Mechanik: Item trackt seit wann es existiert und wie viele Daten betroffen sind. Eskalationsstufen z.B.: info (neu) → low (\u003e1 Woche oder \u003e20 Events) → medium (\u003e2 Wochen oder \u003e50 Events) → high (\u003e4 Wochen oder \u003e100 Events). Verhindert stille Datenkorruption über Wochen. Beispiel: 'unresolved exercises' mit 3 Sets bleibt info. Mit 300 Sets nach 4 Wochen wird es high. Zwingt den Agent hinzuschauen.","notes":"Entstanden aus Agent-Walkthrough (2026-02-10): Sorge dass stille Datenkorruption sich über Wochen aufbaut wenn Agent Agenda-Items ignoriert. Aktuell: alle observed_patterns und orphaned_event_types sind priority=info, egal wie alt oder wie viele Daten betroffen. Umsetzung in handlers/user_profile.py in _build_agenda(). Braucht: Tracking von 'first_seen' pro Agenda-Item (z.B. aus Projection-Daten oder Event-Timestamps). Eskalationslogik: Anzahl betroffener Events + Alter des Issues → höhere Priorität.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T19:47:41.887837+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T20:16:13.957055+01:00","closed_at":"2026-02-10T20:16:13.957055+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-aok","depends_on_id":"kura-training-tct","type":"blocks","created_at":"2026-02-10T19:48:42.43705+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-az0","title":"Access Gate System: Request Access → Invite → Signup","description":"## Kontext\nFür den ersten Launch: Kein offenes Signup. Stattdessen Request Access → Admin-Approval → Invite-Token → Signup. Klar kommuniziert: Early Access ist kostenlos + vollständig, User helfen durch Nutzung das System zu verbessern (anonymisierte Daten für Population Priors, Algorithmen).\n\n## Access Gate Pattern\nEin Config-Schalter (SIGNUP_GATE=invite|open|payment) steuert was zwischen \"will Signup\" und \"hat Account\" passiert:\n- invite: Gültiges Token nötig (Launch-Phase)\n- open: Jeder kann (Wachstum)\n- payment: Stripe-Checkout (Monetarisierung)\n\nInvite-Tokens können auch im Payment-Modus existieren (Promo-Codes, Free Trial).\n\n## Flow\n1. Landing → \"Request Access — Free Early Access\" → /request-access\n2. User: Email, Name, optional Kontext (\"Was trainierst du?\") → access_requests Tabelle\n3. Admin: kura admin list-requests → approve-request \u003cid\u003e → invite_token generiert → Email\n4. User: /signup?invite=TOKEN → Token validiert → normaler OAuth/Email-Signup + Consent-Checkbox\n5. /signup ohne Token → Redirect zu /request-access\n\n## DSGVO / Consent\n- Explizite Checkbox bei Signup: \"Daten anonymisiert zur Verbesserung\"\n- consent_anonymized_learning Boolean am User\n- Widerruf möglich, Account-Löschung löscht alles (haben wir schon)\n- \"Anonymisiert\" = aggregierte Muster, Population Priors, Event-Nutzung. Nie individuell nach außen.\n\n## Umstellung auf Paid (später)\n- SIGNUP_GATE=payment, Stripe-Checkout einfügen\n- Bestehende User: Grandfathering\n- invite_tokens werden Promo-Codes","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:44:04.856223+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:14:39.303879+01:00","closed_at":"2026-02-13T13:14:39.303879+01:00","close_reason":"All 8 subtasks complete: DB migration, API endpoints, CLI commands, email, web request-access page, signup invite gate"}
{"id":"kura-training-b3z","title":"Account-Löschung: Passwort-Bestätigung + 30-Tage Grace Period","description":"Zwei Hardening-Maßnahmen für Production: (1) DELETE /v1/account erfordert Passwort-Re-Entry im Request Body als Bestätigung. (2) Soft-Delete mit 30-Tage Grace Period — User wird sofort deaktiviert (is_active=false), Daten werden erst nach 30 Tagen endgültig gelöscht. Innerhalb der Frist kann der Account reaktiviert werden. Braucht: Cron-Job oder Worker-Task für verzögerte Hard-Deletes.","notes":"Session handoff 2026-02-13: Account-deletion flow remains orthogonal; schedule after P1 tracks unless compliance timeline requires earlier execution.","status":"open","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T18:17:09.084009+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:57:04.526409+01:00","dependencies":[{"issue_id":"kura-training-b3z","depends_on_id":"kura-training-lsu","type":"blocks","created_at":"2026-02-09T18:17:13.107188+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-b4z","title":"Event-Schema Migration: events Tabelle, Idempotency, Immutability auf DB-Level","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:04.537372+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-07T21:53:13.25639+01:00","closed_at":"2026-02-07T21:53:13.25639+01:00","close_reason":"Closed"}
{"id":"kura-training-bd1","title":"Settings: Account-Profil Sektion","description":"## Warum\nUser muss seine eigenen Account-Daten sehen und verwalten können.\n\n## Was\n- Email-Anzeige (aus Auth Context, echte Daten statt hardcoded \"user@example.com\")\n- Display Name Anzeige\n- Member Since Datum\n- Passwort ändern: Platzhalter-UI (Formular mit alt/neu/bestätigen), noch nicht verdrahtet\n- Email ändern: Platzhalter-UI, noch nicht verdrahtet\n\n## Abhängigkeit\n- Blocked by: Browser Auth (kura-training-3kh)\n- Ohne Auth Context keine echten User-Daten\n\n## Akzeptanzkriterien\n- Settings-Seite zeigt echte Email und Member-Since aus Auth Context\n- Passwort-ändern-Formular existiert als UI (submit disabled oder \"coming soon\")","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:33:21.07658+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T15:01:32.297009+01:00","closed_at":"2026-02-13T15:01:32.297009+01:00","close_reason":"Implemented in settings page: Shows real email, member since date, plan badge from auth context.","dependencies":[{"issue_id":"kura-training-bd1","depends_on_id":"kura-training-3kh","type":"blocks","created_at":"2026-02-13T14:33:35.072831+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-bdn","title":"Enrich manifest metadata per dimension","description":"Manifest currently only has last_updated and optional exercises list. Design doc 002 specifies coverage (date range from/to), freshness, and dimension-specific summaries (weeks_tracked, last_training). Decide: enrich manifest from projections table metadata? Or read and summarize each projection's data?","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T15:18:38.721601+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T16:14:02.592905+01:00","closed_at":"2026-02-08T16:14:02.592905+01:00","close_reason":"Decision 7 implemented: manifest_contribution functions, dimension coverage with freshness/status, summary extraction per dimension"}
{"id":"kura-training-br3","title":"Extend causal inference to strength and heterogeneous effects","description":"Build on initial causal_inference projection by adding strength-based outcomes (per exercise and aggregate) and subgroup/phase effect slices. Include minimum-sample guardrails per segment and caveat propagation.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T13:54:58.30949+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T14:47:00.003995+01:00","closed_at":"2026-02-11T14:47:00.003995+01:00","close_reason":"Closed","labels":["agent-first","causal","statistics"]}
{"id":"kura-training-cj0","title":"Settings: API Key Management","description":"## Warum\nAPI Keys sind der primäre Weg wie Agents (Claude, ChatGPT, CLI) sich authentifizieren.\nUser muss Keys selbst erstellen und verwalten können — ohne Admin-CLI.\n\n## Was\n- Create Key: Dialog mit Label-Eingabe + Scope-Auswahl (agent:read, agent:write, agent:resolve)\n- One-Time Display Pattern (wie Sum): Nach Erstellung wird der vollständige Key EINMAL gezeigt\n  mit Copy-Button und Warnung \"Wird nie wieder angezeigt\". Danach nur noch Prefix (kura_sk_...a3f8)\n- List Keys: Tabelle mit Label, Key-Prefix, Scopes, Created, Last-Used\n- Revoke Key: Confirmation Dialog, dann DELETE\n\n## Backend-Endpoints (existieren bereits)\n- POST /v1/admin/create-key braucht admin → NEUEN Endpoint für Self-Service:\n  POST /v1/account/api-keys (erstellt Key für eingeloggten User)\n  GET /v1/account/api-keys (listet eigene Keys)\n  DELETE /v1/account/api-keys/{id} (revoked eigenen Key)\n  → Backend-Änderung nötig! Admin-Endpoints sind für CLI, Self-Service braucht eigene Routes.\n\n## Abhängigkeit\n- Blocked by: Browser Auth (kura-training-3kh)\n\n## Akzeptanzkriterien\n- User kann Key erstellen und sieht ihn einmalig vollständig\n- User sieht Liste aller eigenen Keys (Prefix, Label, Created)\n- User kann Key revoken mit Bestätigung\n- Revoked Keys werden als durchgestrichen angezeigt (oder ausgeblendet)","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:33:53.556199+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T15:01:27.113+01:00","closed_at":"2026-02-13T15:01:27.113+01:00","close_reason":"Implemented in settings page: Create API key (one-time display), list keys with prefix, revoke keys. Backend: POST/GET/DELETE /v1/account/api-keys endpoints.","dependencies":[{"issue_id":"kura-training-cj0","depends_on_id":"kura-training-3kh","type":"blocks","created_at":"2026-02-13T14:34:01.643369+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-csy","title":"Exercise-ID Similarity Warnings bei POST /v1/events","description":"Wenn ein Event mit einer unbekannten exercise_id gepostet wird, soll die API ähnliche existierende exercise_ids als Warning zurückgeben. Erweitert das bestehende Plausibility Warnings System. Beispiel: POST mit exercise_id='lu_raise' → Warning: 'New exercise_id lu_raise. Similar existing: lateral_raise'. Verhindert stille Exercise-ID-Proliferation.","notes":"Entstanden aus Agent-Walkthrough (2026-02-10): Agent hat exercise_id='lu_raise' erstellt ohne zu wissen, dass 'lateral_raise' existiert. System akzeptiert alles ohne Feedback. Bestehende Plausibility Warnings: api/src/routes/events.rs (warn_unusual_values). Erweitern um exercise_id-Check gegen existierende IDs in der events-Tabelle. Ähnlichkeit z.B. über Levenshtein oder simple contains-Prüfung. Nur für exercise_id-Feld in set.logged und exercise.alias_created Events.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T19:47:34.648019+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T20:16:13.937477+01:00","closed_at":"2026-02-10T20:16:13.937477+01:00","close_reason":"Closed"}
{"id":"kura-training-ct3","title":"Agent Security Baseline V1: UX erhalten, Extraction erschweren","description":"Definiere eine Security-Baseline für agent-first Nutzung: normale Nutzer-UX bleibt schnell und intuitiv, gleichzeitig werden systematische Extraction-/Reverse-Engineering-Versuche wirtschaftlich unattraktiv gemacht.","design":"Adaptive Security statt harter Defaults: Low-friction Standardprofil, risikobasierte Eskalation bei Missbrauchssignalen, optionale strenge Profile für High-Security-Kontexte. Keine kritische Logik im Agenten, sondern serverseitig erzwingbare Invarianten und kontrollierte Kontextausgabe.","acceptance_criteria":"1) Security-Baseline-V1 dokumentiert (Default/Adaptive/Strict). 2) Konkrete Child-Issues mit messbaren Akzeptanzkriterien angelegt. 3) Abhängigkeiten spiegeln sinnvolle Implementierungsreihenfolge wider. 4) Erfolgsmessung über Security- und UX-Metriken definiert.","notes":"execution references\n- docs/design/014-autonomous-evidence-audit-roadmap.md\n- docs/design/038-ct3-security-baseline-execution-plan.md\n\nct3 final completion snapshot\n- closed: ct3.1, ct3.2, ct3.3, ct3.4, ct3.5, ct3.6, ct3.7\n\ndelivered baseline by objective\n1) Security baseline v1 documented:\n   - docs/design/027-agent-access-threat-model-and-security-tiering.md\n   - docs/design/039-adaptive-abuse-detection-and-rate-shaping-v1.md\n   - docs/design/040-security-telemetry-and-kill-switch-v1.md\n   - docs/design/041-security-profile-rollout-and-guardrail-dashboard-v1.md\n2) Child issues with measurable ACs: all ct3.x closed with compact-safe completion notes.\n3) Dependency order respected: 2 -\u003e 3 -\u003e 4 -\u003e 5 -\u003e 7 (with 6 completed in parallel track).\n4) Security+UX success metrics implemented:\n   - `security_abuse_telemetry` with action/risk/profile/ux fields\n   - guardrail dashboard endpoint `/v1/admin/security/guardrails/dashboard`\n   - rollout decision records in `security_profile_rollout_decisions`\n\nkey runtime controls now in place\n- context redaction boundary for untrusted agent access\n- scoped auth enforcement on agent APIs\n- adaptive abuse shaping with cooldown/recovery\n- operational kill switch + incident audit trail\n- staged profile rollout (default/adaptive/strict) + user overrides\n\nhandoff summary\n- ct3 execution plan remains authoritative in docs/design/038-ct3-security-baseline-execution-plan.md\n- all child issues include rollback and residual risk notes for safe operation","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:50.666662+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T19:53:44.727157+01:00","closed_at":"2026-02-12T19:53:44.727157+01:00","close_reason":"All CT3 security baseline children are complete: redaction, scoped auth, adaptive abuse shaping, telemetry+kill switch, and profile rollout with UX guardrail dashboard."}
{"id":"kura-training-ct3.1","title":"Threat Model + Security-Tiering für Agent-Zugriffe","description":"Erstelle ein technisches Threat Model für Agentzugriffe (Prompt-Exfiltration, API-Enumeration, Context-Scraping, Scope-Eskalation) und leite daraus drei Betriebsprofile ab: default, adaptive, strict.","design":"Lieferobjekt ist eine Risiko-Matrix mit Angreiferzielen, Angriffswegen, Erkennungsmerkmalen und Gegenmaßnahmen pro Profil.","acceptance_criteria":"1) Bedrohungsmodell mit priorisierten Angriffspfaden vorliegend. 2) Profilmatrix default/adaptive/strict mit klaren Schaltern dokumentiert. 3) Jede Maßnahme hat owner, Metrik und Rollout-Plan.","notes":"Implemented artifacts\n- docs/design/027-agent-access-threat-model-and-security-tiering.md (threat model + default/adaptive/strict matrix)\n- workers/src/kura_workers/system_config.py: added agent_behavior.operational.security_tiering (switch_catalog, profiles, threat_matrix)\n- workers/tests/test_system_config.py: added security_tiering coverage tests (profiles, switch catalog, threat matrix contract)\n- migrations/20260224000001_external_import_jobs.sql: made migration idempotent (CREATE INDEX IF NOT EXISTS + guarded CREATE POLICY)\n\nTests and exact commands\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nResidual risks / non-goals\n- No automatic runtime profile switching logic was added yet; this issue delivers the threat model + machine-readable contract.\n- No new telemetry emitters were added here; metrics are defined as contract fields.\n\nFollow-up issues\n- Continue with planned chain: kura-training-ct3.6 (server-side invariant enforcement review) and blocked ct3.* children.\n\nRollback / disable path\n- Remove/ignore agent_behavior.operational.security_tiering in system_config consumers to revert to prior behavior.\n- Revert commit touching system_config/tests/docs/migration if profile contract causes integration regressions.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:50.764126+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T13:58:37.448411+01:00","closed_at":"2026-02-12T13:58:37.448411+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-ct3.1","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:50.76494+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ct3.2","title":"Untrusted-Agent Boundary + Context-Redaction Contract","description":"Definiere und implementiere eine harte Vertrauensgrenze: Agenten gelten als untrusted; /v1/agent/context liefert nur benötigte, redigierte Daten ohne interne Heuristiken/Prompts/Architekturdetails.","design":"Contract-First für Context Payloads: erlaubte Felder, Redaction-Regeln, versionierte Response-Profile und Verifikation per Integrationstests.","acceptance_criteria":"1) Redaction-Policy pro Feldklasse implementiert. 2) Interne Strategiedaten werden nicht mehr ausgeliefert. 3) Contract-Versionierung + Tests für erlaubte/verbotene Felder vorhanden. 4) Keine Regression in Kern-UX-Flows.","notes":"compact-safe completion notes\n\nexecution anchor\n- docs/design/038-ct3-security-baseline-execution-plan.md\n\nimplemented artifacts\n- api/src/routes/agent.rs\n  - added contract metadata type `AgentContextSystemContract`\n  - added context contract version metadata in `AgentContextMeta`\n  - implemented field-class based system-config redaction for `/v1/agent/context`\n  - added allowlist policy for safe system contract fields and convention subsets\n  - added tests for allowed/forbidden system fields and contract version metadata\n- api/src/main.rs\n  - registered `AgentContextSystemContract` in OpenAPI schema components\n- docs/design/038-ct3-security-baseline-execution-plan.md\n  - authoritative compact-safe CT3 execution and resume protocol\n\nbehavior changes\n- `/v1/agent/context` now returns redacted `system` payload by default.\n- internal strategy/guidance classes (`agent_behavior`, `interview_guide`, unknown top-levels, and internal conventions) are excluded.\n- response meta now exposes machine-readable contract fields:\n  - `context_contract_version=agent_context.v2.redacted`\n  - `system_contract.profile=redacted_v1`\n  - `system_contract.default_unknown_field_action=deny`\n\ntests (exact commands)\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nresidual risks / non-goals\n- redaction policy currently targets `/v1/agent/context`; `/v1/system/config` remains full-fidelity by design.\n- convention allowlist is explicit and deny-by-default; newly added safe convention keys require deliberate allowlist updates.\n\nfollow-up issues\n- kura-training-ct3.3\n- kura-training-ct3.4\n- kura-training-ct3.5\n- kura-training-ct3.7\n\nrollback / disable path\n- revert `api/src/routes/agent.rs` redaction helpers + meta contract fields.\n- if needed for emergency compatibility, bypass `redact_system_config_for_agent(...)` call in `get_agent_context` and restore direct passthrough.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:50.869432+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T19:23:25.724666+01:00","closed_at":"2026-02-12T19:23:25.724666+01:00","close_reason":"Implemented untrusted-agent boundary for /v1/agent/context with field-class redaction policy, versioned contract metadata, and regression tests for allowed/forbidden fields.","dependencies":[{"issue_id":"kura-training-ct3.2","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:50.870202+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.2","depends_on_id":"kura-training-ct3.1","type":"blocks","created_at":"2026-02-11T20:59:51.429652+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ct3.3","title":"Least-Privilege Tokens + Scope Enforcement","description":"Führe kurzlebige, minimal-scope Tokens für Agent-Operationen ein und erzwinge Scope-Prüfung serverseitig pro Endpoint/Operation.","design":"Session-gebundene Berechtigungen, TTL, Token-Rotation, deny-by-default bei Scope-Missmatch; nachvollziehbar über Audit-Trail.","acceptance_criteria":"1) Kurzlebige Agent-Tokens mit Scope-Claims aktiv. 2) Scope-Verletzungen werden serverseitig blockiert. 3) Rotation/Expiry ohne UX-Brüche nachweisbar. 4) Audit-Events für AuthZ-Entscheidungen vorhanden.","notes":"compact-safe completion notes\n\nexecution anchor\n- docs/design/038-ct3-security-baseline-execution-plan.md\n\nimplemented artifacts\n- api/src/auth.rs\n  - extended `AuthenticatedUser` with persisted `scopes`\n  - auth DB reads now load scope claims for API keys and access tokens\n  - added `require_scopes(...)` deny-by-default scope enforcement helper\n  - added audit logging for authz decisions (allow/deny with operation + scopes)\n  - added scope matching tests (exact, wildcard, fail-closed behavior)\n- api/src/routes/agent.rs\n  - enforced per-endpoint scope checks:\n    - GET `/v1/agent/capabilities` -\u003e `agent:read`\n    - GET `/v1/agent/context` -\u003e `agent:read`\n    - GET `/v1/agent/evidence/event/{event_id}` -\u003e `agent:read`\n    - POST `/v1/agent/visualization/resolve` -\u003e `agent:resolve`\n    - POST `/v1/agent/write-with-proof` -\u003e `agent:write`\n- api/src/routes/auth.rs\n  - token issuing now writes scope claims into `oauth_access_tokens` and `oauth_refresh_tokens`\n  - access-token TTL reduced to 30 minutes for short-lived agent tokens\n  - refresh rotation preserves scopes and falls back to default agent scopes when legacy scope list is empty\n- cli/src/commands/admin.rs\n  - new API keys are created with default agent scopes (`agent:read`, `agent:write`, `agent:resolve`)\n\nbehavior changes\n- scoped tokens are now first-class in auth resolution and authorization checks.\n- `/v1/agent/*` operations are blocked server-side on missing scopes (403 forbidden).\n- OAuth-issued agent tokens are short-lived (1800s) and remain refresh-rotated.\n\ntests (exact commands)\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n\nresidual risks / non-goals\n- scope checks are currently enforced on `/v1/agent/*`; non-agent routes remain unchanged in this issue.\n- clients relying on legacy unscoped credentials for agent endpoints must rotate credentials or re-authenticate.\n\nfollow-up issues\n- kura-training-ct3.4\n- kura-training-ct3.5\n- kura-training-ct3.7\n\nrollback / disable path\n- remove/bypass `require_scopes(...)` calls in `api/src/routes/agent.rs` to restore pre-ct3.3 behavior.\n- revert scope-aware token insertion in `api/src/routes/auth.rs` and auth scope extraction in `api/src/auth.rs`.\n- revert CLI key-default scopes if emergency compatibility rollback is required.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:50.967046+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T19:28:43.713919+01:00","closed_at":"2026-02-12T19:28:43.713919+01:00","close_reason":"Implemented short-lived scoped agent tokens, server-side per-endpoint scope enforcement for /v1/agent/*, scope-aware refresh rotation, and authz audit logging.","dependencies":[{"issue_id":"kura-training-ct3.3","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:50.968139+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.3","depends_on_id":"kura-training-ct3.1","type":"blocks","created_at":"2026-02-11T20:59:51.509287+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ct3.4","title":"Adaptive Abuse Detection + Rate Shaping","description":"Erkenne Extraction-Muster (z. B. systematische Enumeration, atypische Query-Sequenzen) und schalte adaptiv auf strengere Limits, statt harte Global-Limits für alle Nutzer zu erzwingen.","design":"Signalpipeline mit Heuristiken/Thresholds, progressive Drosselung und Rückfall auf Normalprofil nach Cooldown.","acceptance_criteria":"1) Missbrauchssignale und Schwellenwerte definiert. 2) Adaptive Limits greifen nur bei Risk Signals. 3) False-Positive-Rate und UX-Impact werden gemessen. 4) Recovery-/Cooldown-Mechanik implementiert.","notes":"compact-safe completion notes\n\nexecution anchor\n- docs/design/038-ct3-security-baseline-execution-plan.md\n\nimplemented artifacts\n- api/src/middleware/adaptive_abuse.rs\n  - new adaptive abuse middleware for `/v1/agent/*`\n  - deterministic risk signal extraction from recent `api_access_log`\n  - weighted risk scoring + progressive actions (`allow` / `throttle` / `block`)\n  - cooldown policy with decay + recovery transition\n  - response headers for shaping observability (`x-kura-abuse-*`)\n  - block response contract with machine-readable context (`field=security_abuse` + `received` window)\n  - unit coverage for scoring, normalization, cooldown and recovery behavior\n- api/src/middleware/mod.rs\n  - registered `adaptive_abuse` middleware module\n- api/src/main.rs\n  - wired adaptive abuse middleware into agent route stack\n- migrations/20260227000001_security_abuse_telemetry.sql\n  - added telemetry table for abuse actions, risk metrics, cooldown state, false-positive hints, and UX-impact hints\n- docs/design/039-adaptive-abuse-detection-and-rate-shaping-v1.md\n  - signal taxonomy, thresholds, runtime behavior, cooldown model, measurement contract\n\nbehavior changes\n- adaptive shaping now applies only to `/v1/agent/*` and only when risk signals rise.\n- shaping is progressive:\n  - throttle -\u003e delay (150-500ms)\n  - block -\u003e HTTP 429 + retry-after\n- cooldown prevents immediate oscillation; recovery emits explicit telemetry transition.\n- telemetry persists signal/decision/outcome tuples in `security_abuse_telemetry` for false-positive and UX-impact analysis.\n\ntests (exact commands)\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n\nresidual risks / non-goals\n- cooldown state is process-local in v1 (no shared distributed state across multiple API instances).\n- v1 shaping scope is `/v1/agent/*`; non-agent endpoints are unchanged.\n- risk scoring is heuristic/deterministic (no model-based anomaly detection in this issue).\n\nfollow-up issues\n- kura-training-ct3.5\n- kura-training-ct3.7\n\nrollback / disable path\n- remove `.layer(middleware::adaptive_abuse::agent_layer(...))` from agent router in `api/src/main.rs`.\n- revert `api/src/middleware/adaptive_abuse.rs` and module export in `api/src/middleware/mod.rs`.\n- if schema rollback needed, revert migration `20260227000001_security_abuse_telemetry.sql`.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:51.060406+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T19:39:44.998085+01:00","closed_at":"2026-02-12T19:39:44.998085+01:00","close_reason":"Implemented adaptive abuse detection and progressive rate shaping for /v1/agent/* with risk signals, cooldown/recovery, and telemetry for false-positive/UX impact measurement.","dependencies":[{"issue_id":"kura-training-ct3.4","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:51.061221+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.4","depends_on_id":"kura-training-ct3.1","type":"blocks","created_at":"2026-02-11T20:59:51.590226+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.4","depends_on_id":"kura-training-ct3.3","type":"blocks","created_at":"2026-02-11T20:59:51.831855+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ct3.5","title":"Security Telemetry + Audit Trail + Kill Switch","description":"Baue vollständige Security-Telemetrie für Agentzugriffe auf und implementiere einen operativen Kill-Switch zum schnellen Entzug von Agent-Rechten/Tokens bei Auffälligkeiten.","design":"Event-Taxonomie für Zugriff, Scope-Denials, Redaction-Hits, Risk-Score-Überschreitungen; automatisierbare Response-Policies.","acceptance_criteria":"1) Security-Telemetrie-Endpunkte/Events standardisiert. 2) Kill-Switch kann Token/Agentzugriff sofort deaktivieren. 3) Alarmierung und Runbook dokumentiert. 4) Drill/Test eines Incident-Flows erfolgreich.","notes":"compact-safe completion notes\n\nexecution anchor\n- docs/design/038-ct3-security-baseline-execution-plan.md\n\nimplemented artifacts\n- migrations/20260227000002_security_kill_switch.sql\n  - singleton kill-switch state table (`security_kill_switch_state`)\n  - append-only incident audit table (`security_kill_switch_audit`)\n  - indexes + grants for writer/reader roles\n- api/src/middleware/kill_switch.rs\n  - runtime enforcement middleware on `/v1/agent/*`\n  - active kill switch returns structured 403 + `x-kura-kill-switch: active`\n  - blocked requests are audit-logged (`blocked_request`)\n  - DB-backed status lookup for fast operational deactivation of agent access\n- api/src/routes/security.rs\n  - admin-only kill-switch control endpoints:\n    - GET /v1/admin/security/kill-switch\n    - POST /v1/admin/security/kill-switch/activate\n    - POST /v1/admin/security/kill-switch/deactivate\n    - GET /v1/admin/security/kill-switch/audit\n  - admin-only telemetry endpoint:\n    - GET /v1/admin/security/telemetry/abuse\n  - normalized incident reason handling + explicit admin authorization checks\n- api/src/middleware/mod.rs\n  - registered kill-switch middleware module\n- api/src/routes/mod.rs\n  - registered security routes module\n- api/src/main.rs\n  - OpenAPI path/schema registration for security endpoints\n  - merged security admin router\n  - layered kill-switch middleware into agent route stack\n- docs/design/040-security-telemetry-and-kill-switch-v1.md\n  - v1 behavior, data contracts, runbook, and drill procedure documented\n\nbehavior changes\n- operators can now activate/deactivate a kill switch via admin API.\n- while active, all `/v1/agent/*` calls are denied with consistent machine-readable error payload.\n- activation/deactivation and blocked-request decisions are persisted in `security_kill_switch_audit`.\n- security telemetry is queryable via `/v1/admin/security/telemetry/abuse` (from CT3.4 telemetry table).\n\ntests (exact commands)\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n\nincident drill/test reference\n- documented in docs/design/040-security-telemetry-and-kill-switch-v1.md (section: Drill / Test Procedure)\n- includes activate -\u003e verify blocked request -\u003e verify audit trail -\u003e deactivate -\u003e verify recovery\n\nresidual risks / non-goals\n- v1 kill switch is scoped to `/v1/agent/*` only (not full-platform lock).\n- no auto-paging integration yet; operational alerting remains manual/on-call process.\n- stronger distributed invalidation/propagation can be added later for multi-instance high-throughput tuning.\n\nfollow-up issues\n- kura-training-ct3.7\n\nrollback / disable path\n- remove kill-switch layer from agent router wiring in `api/src/main.rs`.\n- remove `api/src/middleware/kill_switch.rs` + module registration.\n- remove security routes merge/module if API control endpoints should be disabled.\n- revert migration `20260227000002_security_kill_switch.sql` if schema rollback is required.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:51.156147+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T19:46:14.588655+01:00","closed_at":"2026-02-12T19:46:14.588655+01:00","close_reason":"Implemented security telemetry endpoints, persistent incident audit trail, and an operational kill switch that can disable agent access immediately on /v1/agent/*.","dependencies":[{"issue_id":"kura-training-ct3.5","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:51.156896+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.5","depends_on_id":"kura-training-ct3.1","type":"blocks","created_at":"2026-02-11T20:59:51.668029+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.5","depends_on_id":"kura-training-ct3.3","type":"blocks","created_at":"2026-02-11T20:59:51.9142+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ct3.6","title":"Server-Side Invariant Enforcement Review","description":"Prüfe und härte kritische Domain-Invarianten, damit kein Agent durch Prompting/Tool-Missbrauch kritische Regeln umgehen kann.","design":"Inventory aller kritischen Invarianten mit Zuordnung zu serverseitigen Checks, inkl. Lückenanalyse und Schließungsplan.","acceptance_criteria":"1) Invariant-Inventar vollständig und priorisiert. 2) Kritische Lücken mit serverseitigen Guards geschlossen. 3) Regressionstests für Bypass-Szenarien vorhanden. 4) Policy-Verletzungen erzeugen maschinenlesbare Fehlercodes.","notes":"Implemented artifacts\n- docs/design/028-server-side-invariant-enforcement-review.md (prioritized invariant inventory + gap closure mapping)\n- api/src/error.rs: added AppError::PolicyViolation (HTTP 422, machine-readable policy/invariant error codes)\n- api/src/routes/events.rs:\n  - added validate_critical_invariants() and event-specific guards for event.retracted, set.corrected, projection_rule.created, projection_rule.archived\n  - added invariant helper validators and inv_* error code emission\n  - batch/simulate validators now preserve per-event index context for PolicyViolation\n  - added regression tests for bypass scenarios (malformed retraction/correction/rule payloads)\n\nTests and exact commands\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nResidual risks / non-goals\n- No historical replay/backfill remediation for already persisted malformed events in this issue.\n- No dynamic security-profile switching in runtime; ct3.7 remains responsible for rollout/UX dashboard.\n\nFollow-up issues\n- kura-training-ct3.7 (security profile rollout + UX guardrail dashboard)\n- kura-training-pdc.19 (next chain dependency now unblocked)\n\nRollback / disable path\n- Revert commit touching api/src/error.rs + api/src/routes/events.rs to restore pre-ct3.6 behavior.\n- If selective disable is needed, bypass validate_critical_invariants() call in validate_event while keeping generic validation intact.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:51.25517+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T14:04:24.756506+01:00","closed_at":"2026-02-12T14:04:24.756506+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-ct3.6","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:51.255935+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.6","depends_on_id":"kura-training-ct3.1","type":"blocks","created_at":"2026-02-11T20:59:51.749985+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ct3.7","title":"Security-Profile Rollout + UX Guardrail Dashboard","description":"Führe die Profile default/adaptive/strict kontrolliert aus und messe parallel Sicherheit und UX, um Überhärtung zu vermeiden.","design":"Rollout per Feature-Flags, Vergleichsmessungen und Dashboard für Security-Outcome vs UX-Kennzahlen.","acceptance_criteria":"1) Feature-Flags für Profile aktiv. 2) Dashboard mit Security- und UX-KPIs live. 3) Rollout-Entscheidungen datenbasiert dokumentiert. 4) Default-Profil bleibt für normale Nutzer friction-arm.","notes":"compact-safe completion notes\n\nexecution anchor\n- docs/design/038-ct3-security-baseline-execution-plan.md\n\nimplemented artifacts\n- migrations/20260227000003_security_profile_rollout.sql\n  - added rollout feature-flag config table (`security_profile_rollout`)\n  - added per-user profile override table (`security_profile_user_overrides`)\n  - added rollout decision record table (`security_profile_rollout_decisions`)\n  - extended `security_abuse_telemetry` with `profile` for profile-level KPI slicing\n- api/src/security_profile.rs\n  - shared profile model (`default|adaptive|strict`)\n  - rollout config loader\n  - deterministic bucket-based profile resolver + override precedence\n- api/src/middleware/adaptive_abuse.rs\n  - profile-aware scoring thresholds/cooldown/delay tuning\n  - default profile configured as low-friction baseline\n  - profile/source/bucket headers emitted for observability\n  - telemetry now persists profile tag and captures all agent requests for dashboard quality\n- api/src/routes/security.rs\n  - rollout control endpoints:\n    - GET/POST /v1/admin/security/profiles/rollout\n  - override endpoints:\n    - POST/DELETE /v1/admin/security/profiles/overrides/{user_id}\n  - decision record endpoints:\n    - POST/GET /v1/admin/security/profiles/decisions\n  - guardrail dashboard endpoint:\n    - GET /v1/admin/security/guardrails/dashboard\n  - dashboard returns paired security+UX KPIs per profile (24h window)\n- api/src/main.rs\n  - OpenAPI registration for new profile/guardrail endpoints + schemas\n  - module registration for security profile utilities\n- docs/design/041-security-profile-rollout-and-guardrail-dashboard-v1.md\n  - rollout mechanics, KPI definitions, decision-record model, residual risks\n\nbehavior changes\n- security profile rollout is now feature-flag driven and staged.\n- profile selection order: explicit user override -\u003e deterministic rollout bucket -\u003e configured default profile.\n- adaptive middleware behavior is profile-tuned:\n  - `default`: high-threshold, low-friction behavior\n  - `adaptive`: balanced baseline shaping\n  - `strict`: aggressive abuse response\n- guardrail dashboard exposes security + UX metrics together, profile-by-profile.\n- rollout decisions are now data-backed artifacts with metrics + config snapshot.\n\ndone criteria mapping\n- feature flags + staged rollout mechanics: implemented (rollout table + bucket resolver + overrides)\n- dashboard with security+UX impact: implemented (`/v1/admin/security/guardrails/dashboard`)\n- rollout decisions data-based: implemented (`security_profile_rollout_decisions` + POST/GET endpoints)\n- default profile friction-arm for normal users: implemented via high-threshold default tuning + explicit test coverage\n\ntests (exact commands)\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n\nresidual risks / non-goals\n- guardrail dashboard is a nearline operational view, not long-horizon BI.\n- rollout uses deterministic hashing (simple and explainable) rather than adaptive policy learning.\n- deeper multi-region rollout propagation concerns can be addressed in future hardening.\n\nfollow-up issues\n- none required to satisfy current acceptance criteria; optional future hardening can target distributed rollout propagation and historical BI depth.\n\nrollback / disable path\n- set rollout to safe baseline:\n  - `default_profile=default`, `adaptive_rollout_percent=0`, `strict_rollout_percent=0`\n- delete user overrides to return to rollout baseline.\n- remove profile-aware middleware behavior by reverting `api/src/security_profile.rs` + adaptive middleware integration.\n- revert migration `20260227000003_security_profile_rollout.sql` if schema rollback is required.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T20:59:51.351139+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T19:53:15.580175+01:00","closed_at":"2026-02-12T19:53:15.580175+01:00","close_reason":"Implemented profile feature flags, staged rollout controls, security-vs-UX guardrail dashboard, and data-backed rollout decision records while keeping default profile low-friction.","dependencies":[{"issue_id":"kura-training-ct3.7","depends_on_id":"kura-training-ct3","type":"parent-child","created_at":"2026-02-11T20:59:51.351837+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.7","depends_on_id":"kura-training-ct3.2","type":"blocks","created_at":"2026-02-11T20:59:51.992072+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.7","depends_on_id":"kura-training-ct3.3","type":"blocks","created_at":"2026-02-11T20:59:52.069273+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.7","depends_on_id":"kura-training-ct3.4","type":"blocks","created_at":"2026-02-11T20:59:52.147092+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.7","depends_on_id":"kura-training-ct3.5","type":"blocks","created_at":"2026-02-11T20:59:52.222681+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ct3.7","depends_on_id":"kura-training-ct3.6","type":"blocks","created_at":"2026-02-11T20:59:52.30312+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ctv","title":"Runtime Model Identity Attestation V1 (No Manual Mapping)","description":"Replace static model identity env mapping with per-request runtime attestation from agent gateway, so operators do not maintain per-user or per-model mapping. Keep deterministic safe fallback when attestation missing/invalid.","design":"Implement signed model attestation in /v1/agent/write-with-proof and related agent endpoints. Source of truth becomes request-scoped attestation (runtime_model_identity + issued_at + nonce/request_id + signature) verified server-side. Persist attested model identity as telemetry/event metadata for automatic per-model quality scoring. Unknown/new models default to safe confirm_first policy; tier promotion/demotion is automated from observed quality metrics with hysteresis and min-sample gates. Preserve existing quality_health gating and reason-code explainability.","acceptance_criteria":"1) Runtime identity is request-scoped and verified cryptographically (no manual env map required for normal operation). 2) Missing/invalid attestation fails closed to safe policy with explicit reason codes. 3) Telemetry persists runtime model identity per request for automated per-model scoring. 4) Automated tiering includes min sample threshold + hysteresis to avoid oscillation. 5) Tests cover valid attestation, invalid signature, replay/stale attestation, and unknown model fallback behavior.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T21:18:51.615406+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T10:52:49.860459+01:00","closed_at":"2026-02-14T10:52:49.860459+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-ctv","depends_on_id":"kura-training-wvp","type":"blocks","created_at":"2026-02-13T21:19:21.558426+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ctv","depends_on_id":"kura-training-d8o","type":"blocks","created_at":"2026-02-13T21:20:16.034149+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ctv","depends_on_id":"kura-training-ohr","type":"blocks","created_at":"2026-02-13T21:20:26.227773+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ctv","depends_on_id":"kura-training-akn","type":"blocks","created_at":"2026-02-13T21:20:36.476085+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ctv","depends_on_id":"kura-training-gh0","type":"blocks","created_at":"2026-02-13T21:20:44.30747+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-cza","title":"Design Decision: training_plan dimension (prescriptive)","description":"Training plan is fundamentally different from existing dimensions: prescriptive (what SHOULD happen) vs descriptive (what DID happen). Needs own design doc. Key questions: Template vs concrete days? Load prescription (concrete kg vs RPE-based)? Plan lifecycle (active/archived/paused)? Adherence tracking (cross-dimension with training_timeline)? See Design Doc 002, Decision 9 for context.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T08:02:16.209951+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:07:39.769468+01:00","closed_at":"2026-02-09T08:07:39.769468+01:00","close_reason":"Implemented as part of Decision 9 — all 7 domain dimensions now have handlers"}
{"id":"kura-training-d8o","title":"[ctv.1] Agent API model attestation contract + verification","description":"Add request-scoped model attestation payload to agent write contract; verify signature/freshness/replay and resolve runtime model identity from attestation first.","acceptance_criteria":"1) /v1/agent/write-with-proof accepts model_attestation payload. 2) Signature+freshness verified server-side. 3) Missing/invalid attestation yields explicit reason codes and safe fallback.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T21:19:34.583242+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:41:15.833542+01:00","closed_at":"2026-02-13T21:41:15.833542+01:00","close_reason":"Closed"}
{"id":"kura-training-dd1","title":"Projection rule lifecycle API (validate/preview/apply/archive)","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T07:42:51.683247+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T08:09:40.452496+01:00","closed_at":"2026-02-11T08:09:40.452496+01:00","close_reason":"Implemented projection rule lifecycle API: validate, preview, apply (create/update), and archive endpoints with strict rule validation, event-sourced writes, preview stats, and OpenAPI schema coverage"}
{"id":"kura-training-de9","title":"Data Integrity: API Response Warnings (Plausibilitäts-Checks)","description":"POST /v1/events und /v1/events/batch geben bei auffälligen Werten Warnings im Response zurück. Kein Reject, nur Signal.\n\nResponse-Erweiterung:\n{\n  id: '...',\n  warnings: [{field, message, severity: 'warning'}]\n}\n\nPlausibilitätsregeln sind dimension-spezifisch und könnten perspektivisch in system_config stehen (damit der Agent sie vorab kennt). Für den Anfang reichen hardcoded Regeln in der API.\n\nBeispiele:\n- weight_kg \u003e 300 bei set.logged → Warning\n- weight_kg \u003e 250 bei bodyweight.logged → Warning\n- calories \u003e 5000 bei meal.logged → Warning\n- Negative Werte bei Mengenfeldern → Warning\n\nWichtig: Das ist die schwächste Schicht (Prevention). Anomalie-Erkennung in den Handlern (Detection) ist wichtiger, weil sie auch Events erwischt, die einzeln plausibel sind aber im Kontext nicht (z.B. 1RM-Sprung von 100%). Deshalb P3, nicht P2.\n\nDesignfrage: Woher kommen die Regeln? Hardcoded? system_config? Per-User lernend? Für v1 reicht hardcoded.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:50.277755+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T16:22:04.83165+01:00","closed_at":"2026-02-09T16:22:04.83165+01:00","close_reason":"API plausibility warnings on event creation, 21 Rust unit tests, thresholds match Python handler anomaly detection","dependencies":[{"issue_id":"kura-training-de9","depends_on_id":"kura-training-57d","type":"blocks","created_at":"2026-02-09T15:42:02.813621+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-djr","title":"Timezone consistency rollout for non-timeline day/week projections","description":"Follow-up to pdc.3: body_composition, recovery, nutrition, exercise_progression and custom projections still derive day/week keys from raw timestamps. Align them to user timezone context or explicit UTC disclosure to avoid cross-dimension temporal drift.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:31:20.889348+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T22:31:19.69168+01:00","closed_at":"2026-02-11T22:31:19.69168+01:00","close_reason":"Rolled out timezone-first day/week semantics for body_composition, recovery, nutrition, exercise_progression, and custom field_tracking; added explicit UTC assumption disclosure and targeted integration/unit coverage."}
{"id":"kura-training-dqm","title":"Decision 13 Phase 1: Repair Proposal + Simulate Bridge","description":"Implement the next vertical slice from Decision 13: generate deterministic repair proposals from quality issues and validate every proposal via /v1/events/simulate before any apply path is allowed. This phase stays conservative: proposal + simulation + explainability first, no broad autonomous mutation.","design":"Reference: /Users/jz/Projekte/Life/kura-training/docs/design/013-self-healing-agentic-data-plane.md (Decision 13), sections 13.3, 13.4, 13.8 and Rollout Phase 1. Reuse existing simulation endpoint and append-only correction model. Keep all behavior inspectable, reversible, and policy-gated.","acceptance_criteria":"1) For at least INV-001 and INV-003 issue types, system creates structured repair proposals (event batches) with explicit rationale. 2) Each proposal is automatically evaluated through /v1/events/simulate and stores simulation result (warnings, projection impacts, notes). 3) Proposal artifacts distinguish states: proposed, simulated_safe, simulated_risky, rejected. 4) No proposal is auto-applied in this issue unless explicitly marked Tier A + safe by policy checks. 5) Add tests for proposal generation and simulate-bridge behavior, including one negative case where proposal is flagged risky. 6) Update docs/comments with explicit Decision 13 references.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T16:24:17.860607+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T16:37:58.916421+01:00","closed_at":"2026-02-11T16:37:58.916421+01:00","close_reason":"Closed"}
{"id":"kura-training-dru","title":"Data Integrity: Anomalie-Erkennung in Dimension-Handlern","description":"Jeder Dimension-Handler bekommt Anomalie-Erkennung in seiner Projection-Berechnung. Anomalien landen in data_quality.anomalies der Projection.\n\nWarum: Fehler werden passieren — LLMs machen Interpretationsfehler. Der Agent muss beim nächsten Projection-Read sehen, dass etwas verdächtig ist, und kann den User fragen.\n\nPro Handler:\n- exercise_progression: 1RM-Sprünge \u003e X%, unrealistische Gewichte pro Übung\n- body_composition: Gewichtsschwankungen \u003e 5kg/Tag, Messwerte außerhalb physiologischer Grenzen\n- nutrition: Tageskalorienwerte \u003e 10.000 oder \u003c 200, Makro-Summen vs Kalorien-Diskrepanz\n- recovery: Schlafdauer \u003e 24h oder \u003c 0, Energie-Level außerhalb Skala\n\nFormat in Projection:\ndata_quality.anomalies: [{event_id, field, value, expected_range, message}]\n\nWichtig: Anomalien sind WARNINGS, keine Fehler. Der Handler verarbeitet das Event trotzdem. Der Agent entscheidet, ob er korrigiert.\n\nDesignprinzip: 'Actionable, not descriptive' — jede Anomalie enthält genug Info damit der Agent handeln kann (event_id zum Retracten, field + value für die Korrektur-Konversation mit dem User).","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:32.783605+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T15:57:49.562915+01:00","closed_at":"2026-02-09T15:57:49.562915+01:00","close_reason":"Anomaly detection in 4 dimension handlers (exercise_progression, body_composition, nutrition, recovery). data_quality.anomalies in every projection. 23 new tests (233 unit + 9 integration). Code review: no issues. training_timeline, training_plan, user_profile don't need anomaly detection (aggregates/config).","dependencies":[{"issue_id":"kura-training-dru","depends_on_id":"kura-training-57d","type":"blocks","created_at":"2026-02-09T15:42:02.604622+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-dxl","title":"Decision 13 Phase 2: Agent write receipts + read-after-write guard","description":"Implement Roadmap 011 Workstream F4 and Decision 13.5 protocol hardening: require durable write receipts (event ids + idempotency keys), enforce read-after-write projection verification before any user-facing saved/tracked claim, and add explicit deferred/uncertainty markers when write proof is incomplete.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T16:38:36.398059+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T16:51:49.841629+01:00","closed_at":"2026-02-11T16:51:49.841629+01:00","close_reason":"Closed"}
{"id":"kura-training-dz8","title":"API Skeleton: axum + sqlx + utoipa, Health-Endpoint, Error-Struktur, Request-IDs, Tracing","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:03.330477+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-07T21:53:13.183937+01:00","closed_at":"2026-02-07T21:53:13.183937+01:00","close_reason":"Closed"}
{"id":"kura-training-f0l","title":"Passwort-Reset Flow","description":"## Warum\nOhne Passwort-Reset ist jedes vergessene Passwort ein manueller Support-Fall.\nFür eine seriöse Anwendung Pflicht.\n\n## Was\n### Frontend\n- \"Passwort vergessen?\" Link auf Login-Seite (existiert bereits als toter Link)\n- /forgot-password Seite: Email-Eingabe → \"Falls ein Account existiert, senden wir eine Email\"\n  (Info-Leakage-Schutz: immer gleiche Antwort)\n- /reset-password?token=xxx Seite: Neues Passwort + Bestätigung eingeben\n\n### Backend (NEU)\n- POST /v1/auth/forgot-password: Generiert Reset-Token, speichert in DB, sendet Email via Resend\n- POST /v1/auth/reset-password: Validiert Token, setzt neues Passwort\n- Reset-Token: 1 Stunde gültig, einmalig verwendbar, kura_rst_ Prefix\n- Email: Deutsch, mit Reset-Link zum Frontend\n\n### Datenbank\n- Neue Tabelle oder Spalte für password_reset_tokens (token_hash, user_id, expires_at, used_at)\n\n## Abhängigkeit\n- Blocked by: Browser Auth (kura-training-3kh) — Login muss funktionieren bevor Reset Sinn macht\n- Braucht: RESEND_API_KEY konfiguriert (existiert bereits für Invite-Emails)\n\n## Akzeptanzkriterien\n- User kann \"Passwort vergessen\" klicken, Email eingeben, Link bekommen\n- Reset-Link führt zu Formular, neues Passwort setzen funktioniert\n- Token ist nach 1h oder Verwendung ungültig\n- Keine Info-Leakage (gleiche Antwort ob Account existiert oder nicht)","status":"open","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:36:11.689633+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:36:11.689633+01:00","dependencies":[{"issue_id":"kura-training-f0l","depends_on_id":"kura-training-3kh","type":"blocks","created_at":"2026-02-13T14:36:19.735609+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-faz","title":"Projection freshness SLA metadata in API responses","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T07:42:51.528706+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T08:02:06.34401+01:00","closed_at":"2026-02-11T08:02:06.34401+01:00","close_reason":"Added ProjectionMeta freshness SLA metadata (age_seconds + fresh/warming/stale status) across projection and agent context responses with core classification tests"}
{"id":"kura-training-gh0","title":"[ctv.3] Automatic model tiering from observed quality","description":"Compute per-model quality score from observed metrics and automatically promote/demote model tiers with min-sample and hysteresis guards.","acceptance_criteria":"1) Worker computes per-model reliability status. 2) Tier decision deterministic with min samples+hysteresis. 3) Unknown/new model defaults to safe confirm_first until evidence sufficient.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T21:19:54.725946+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:41:32.839547+01:00","closed_at":"2026-02-13T21:41:32.839547+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-gh0","depends_on_id":"kura-training-akn","type":"blocks","created_at":"2026-02-13T21:21:02.735412+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-goy","title":"Onboarding interview design (agent-side)","description":"Design the onboarding interview flow: agent conducts adaptive interview with new user, produces standard events (preference.set, exercise.alias_created, goal.set, profile.updated). Inspired by Anthropic Interviewer. Interview is agent-side, not Kura-side — Kura receives the resulting events.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:17.788435+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T20:48:06.472316+01:00","closed_at":"2026-02-08T20:48:06.472316+01:00","close_reason":"Implemented Decision 8: interview guide in system layer, context_seeds, coverage computation, profile.updated + injury.reported events, bootstrap response, 126 tests passing","dependencies":[{"issue_id":"kura-training-goy","depends_on_id":"kura-training-nv2","type":"blocks","created_at":"2026-02-08T13:39:32.511804+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-he1","title":"Enforce HTTPS and add HSTS","description":"Redirect HTTP to HTTPS, add Strict-Transport-Security header. Production security requirement.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T11:00:02.097685+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T11:16:10.404403+01:00","closed_at":"2026-02-08T11:16:10.404403+01:00","close_reason":"Closed"}
{"id":"kura-training-hj7","title":"Shell-Sonderzeichen in Übungsnamen absichern","description":"Übungsnamen mit \u0026 (z.B. 'Clean \u0026 Push Press') brechen curl-Calls im Shell. Agent musste auf Temp-Files ausweichen. Betrifft CLI und jede Shell-basierte Agent-Integration. Lösung: CLI muss Escaping korrekt handhaben, API-Docs sollten auf JSON-File-Input hinweisen. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":3,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:43:02.05986+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:43:41.29831+01:00","closed_at":"2026-02-10T07:43:41.29831+01:00","close_reason":"Note im CLI-Code (cli/src/main.rs) hinterlassen bei --data Argument. Fix kommt wenn CLI Event-Create richtig ausgebaut wird (--data-file / stdin)."}
{"id":"kura-training-hwo","title":"Derivative-Enriched Projections: Werte mit eingebauter Dynamik","description":"## Ursprung\n\nAus einem Vortrag über ein mathematisches Framework mit diesen Eigenschaften:\n- Basic type ist Winkel (periodisch), mit variabler Auflösung und Dimensionen\n- Winkel sind nicht statisch, sondern dynamisch (enthalten Info über ihre eigene Veränderung im nächsten Schritt, 1-3 Ableitungen)\n- Kurze, periodische Propagationen (wenige Schichten)\n- Niedrige Auflösung von Werten und Gradienten\n\n## Was das für Kura ausgelöst hat\n\n### Kernproblem heute\nProjections sind **Zustandsfotos**. Eine 1RM ist eine Zahl, ein Wochenvolumen ist eine Zahl. Der Agent muss Trends *selbst rekonstruieren*, indem er Zeitreihen vergleicht. Und ob ein Trend an Fahrt gewinnt oder verliert (Beschleunigung), muss er aus Trends ableiten. Das ist viel kognitive Arbeit für den Agenten — und fehleranfällig.\n\n### Idee: Werte tragen ihre eigenen Ableitungen\nStatt:\n```json\n{\"bench_press_1rm\": 100.0}\n```\nKönnte ein Wert seine Dynamik mitbringen:\n```json\n{\n  \"bench_press_1rm\": {\n    \"value\": 100.0,\n    \"velocity\": 2.5,\n    \"acceleration\": -0.5\n  }\n}\n```\nEin einziger Lesevorgang sagt dem Agenten: \"Du bist bei 100kg, wirst stärker (+2.5kg/Woche), aber die Zuwächse flachen ab (-0.5kg/Woche²).\"\n\n### Drei konkrete Designprinzipien\n\n**1. Derivative-enriched projections**\nJeder quantitative Wert in einer Projection trägt Richtung und Momentum. Der Agent liest nicht \"Zahl + Zeitreihe\", sondern \"Zustand + Dynamik\". Erweiterung des Projection-Formats, kein neues System.\n\n**2. Phase statt Trend**\nStatt \"1RM steigt\" modellieren wir \"User ist in Phase X eines Zyklus\". Training ist fundamental zyklisch:\n- Wochenrhythmus (welche Tage, Lastverteilung)\n- Mesozyklus (Akkumulation → Intensivierung → Deload → Peak)\n- Supercompensation (Belastung → Ermüdung → Erholung → Überkompensation)\n- Schlaf, Ernährung haben Wochenmuster\n\nWinkel/periodische Werte sind die natürliche Darstellung für zyklische Phänomene. Jemand in der Deload-Woche sieht nach \"Regression\" aus wenn man nur linear schaut — Phase-Modellierung erkennt das als normal.\n\n**3. Low resolution, high meaning**\nDer Agent braucht keine Präzision. Er braucht:\n- ↑↑ (steigt beschleunigt)\n- ↑→ (steigt, flacht ab)\n- →↓ (stagniert, kippt)\nDas ist fast die \"angle with low resolution\"-Idee: wenige diskrete Zustände, aber dynamisch.\n\n## Wo das hingehört\n\nNatürlicher Ort ist die **Bayesian-Schicht (kqf)**. Die Bayesian Engine berechnet nicht nur Schätzwerte, sondern Schätzwerte *mit ihren Ableitungen*. Die Projections werden dadurch von \"Fakten, aus denen der Agent Dynamik ableiten muss\" zu \"Fakten MIT Dynamik\".\n\nAuch ohne Bayesian könnte man einfache Derivative-Enrichment auf bestehende Projections anwenden (lineare Regression über letzte N Wochen → velocity, Änderung der velocity → acceleration). Aber die Bayesian-Schicht macht es richtig (Unsicherheitsquantifizierung, nicht-lineare Trends, zyklische Modelle).\n\n## Was wir bewusst NICHT übernehmen\n\n\"Short periodic propagations (few layers at a time)\" auf die Worker-Pipeline zu mappen wäre erzwungen. Projections recomputen vollständig, nicht inkrementell. Vielleicht relevant bei massiver Skalierung, aber nicht jetzt.\n\n## Bezug zu bestehender Architektur\n\n- Passt zu agent_behavior: Agent bekommt reichere Daten → kann autonomere Entscheidungen treffen\n- Passt zu projection_schemas: output_schema erweitern um derivative-enriched Typen\n- Passt zu data_quality: velocity/acceleration mit Konfidenz → Agent weiß, wie verlässlich die Dynamik-Info ist\n- Decision 10 Phase 4 (Cross-Pollination): Derivative-Enrichment könnte ein Cross-Dimension Pattern sein (gleiche Logik für 1RM, Gewicht, Schlafqualität)","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T20:27:08.940161+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T13:07:14.99276+01:00","closed_at":"2026-02-11T13:07:14.99276+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-hwo","depends_on_id":"kura-training-kqf","type":"blocks","created_at":"2026-02-10T20:27:12.598247+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-ipu","title":"Configure CORS properly","description":"Configure CORS with explicit allowed origins instead of permissive defaults. Production security requirement.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T11:00:02.970538+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T11:16:10.414816+01:00","closed_at":"2026-02-08T11:16:10.414816+01:00","close_reason":"Closed"}
{"id":"kura-training-k71","title":"Data Integrity: Retraction-Support in Handlern (Full Replay)","description":"Handler müssen event.retracted verarbeiten können. Wenn ein retracted Event den eigenen Typ betrifft, wird die Projection per Full Replay neu berechnet.\n\nWarum Full Replay statt inkrementeller Subtraktion:\n- Korrekt bei jeder Aggregation (keine Rückwärts-Rechnung nötig)\n- Korrekturen sind selten → Performance unkritisch\n- Handler-Logik bleibt sauber (eine Berechnung, nicht zwei Pfade)\n- Bayesian Stats brauchen später sowieso Full Replay\n\nImplementierung pro Handler:\n1. Subscription auf event.retracted\n2. Prüfen ob retracted_event_id einen Event betrifft, der diesen Handler betrifft (event_type check)\n3. Alle Events des Users für eigene Event-Typen laden, retracted Events rausfiltern\n4. Projection komplett neu berechnen\n5. UPSERT wie gewohnt\n\nEdge Cases die durchdacht werden müssen:\n- exercise_progression hat Keys pro exercise_id — welche Keys sind betroffen?\n- Alias-Events retracten: Was passiert mit konsolidierten Projections?\n- Retraction eines Events das schon retracted wurde (idempotent ignorieren)\n- Performance bei Usern mit vielen Events (Pagination? Limit?)\n\nDas ist das komplexeste Ticket. Sorgfalt vor Geschwindigkeit.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:41.493674+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T16:14:01.10177+01:00","closed_at":"2026-02-09T16:14:01.10177+01:00","close_reason":"Full Replay retraction support in all 7 handlers + router + 18 integration tests","dependencies":[{"issue_id":"kura-training-k71","depends_on_id":"kura-training-57d","type":"blocks","created_at":"2026-02-09T15:42:02.675694+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-k71","depends_on_id":"kura-training-dru","type":"blocks","created_at":"2026-02-09T15:42:02.744699+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-kk0","title":"Decision 13 Phase 3/F5: Autonomous Tier-A repair apply path","description":"Implement policy-gated Tier-A auto-apply in quality_health: auto-apply only tier=A + simulated_safe + no warnings + no unknown impacts + deterministic source, emit quality.fix.applied/rejected and quality.issue.closed artifacts, rerun invariants for verification, and add tests for positive/negative/idempotency recurrence guard.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T16:59:22.678583+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T17:10:42.146516+01:00","closed_at":"2026-02-11T17:10:42.146516+01:00","close_reason":"Closed"}
{"id":"kura-training-kqf","title":"Inference Dimensions: Bayesian strength estimates, fatigue-readiness scores","description":"When PyMC/Stan engine arrives, computed values like Bayesian Strength Estimates or Fatigue-Readiness Scores could become their own dimension type. Not raw data, not agent composition — statistical inference. This is Decision 6 (Three Layers of Intelligence) materialized as projections. Prerequisite: PyMC/Stan integration.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T08:13:51.040943+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T09:05:24.007736+01:00","closed_at":"2026-02-11T09:05:24.007736+01:00","close_reason":"Closed"}
{"id":"kura-training-lsg","title":"set.logged conventions: exercise_id, weight_kg, richer fields","description":"Update set.logged conventions: units in field names (weight_kg), exercise + exercise_id duality, optional fields (rpe, set_type, tempo, duration_seconds, distance_meters). Update exercise_progression handler to prefer exercise_id. Document conventions in design doc.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:08.076267+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T14:11:06.233911+01:00","closed_at":"2026-02-08T14:11:06.233911+01:00","close_reason":"Conventions documented in design doc 002, exercise_progression updated (exercise_id priority, weight_kg, rpe/set_type, input validation), validation philosophy decided (free-form, no API validation), unit tests added (15 passing), whitespace bug fixed","dependencies":[{"issue_id":"kura-training-lsg","depends_on_id":"kura-training-nv2","type":"blocks","created_at":"2026-02-08T13:39:32.361961+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-lsu","title":"MCP Server (eigenes Projekt)","description":"Separate MCP server project. Thin client over REST API, speaks MCP protocol. Tool discovery, typed schemas, persistent connection. For Claude Desktop (local) and Claude.ai (hosted). Independent from CLI.","notes":"## Agent-Native Design Considerations (aus Artikel-Review)\n\n### Completion Signals\nMCP-Tools brauchen explizite Completion-Signale, nicht nur Daten-Rückgabe. Pattern: {status: 'success'|'error'|'complete', data: {...}} — damit der Client weiß, ob eine Multi-Step-Aufgabe noch läuft oder fertig ist. REST-API nutzt HTTP-Statuscodes (reicht), MCP braucht eigene Semantik.\n\n### Context Injection / System Prompt Design\nsystem_config + user_profile/me als Agent Entry Point (Decision 7) muss im MCP Server sauber exponiert werden. Der MCP Server sollte dem Client ermöglichen, system_config als Context zu injizieren — z.B. als MCP Resource, die der Client beim Session-Start liest und in den System-Prompt einbettet.\n\n### Partial Completion Tracking\nWenn MCP-Tools intern mehrere API-Calls machen (z.B. 'logge mein komplettes Training' = mehrere set.logged Events), braucht der Client Zwischenfeedback. MCP progress notifications nutzen, nicht stumm arbeiten.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:22.793928+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T08:48:21.231893+01:00","closed_at":"2026-02-13T08:48:21.231893+01:00","close_reason":"Implemented MCP hardening + runtime decoupling for dedicated kura-mcp package: explicit completion envelopes, capability-status diagnostics, and reusable token/auth utility in mcp crate. Verified via quality gates and workspace tests.","dependencies":[{"issue_id":"kura-training-lsu","depends_on_id":"kura-training-wid","type":"blocks","created_at":"2026-02-09T13:46:43.313485+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":1,"issue_id":"kura-training-lsu","author":"jonzim-cmd","text":"Reprioritized for ChatGPT App Integration readiness. Existing MCP baseline is implemented; remaining scope is hardening + decoupling into a dedicated MCP project/runtime and production-grade operator visibility for external tester validation.","created_at":"2026-02-13T07:36:37Z"}]}
{"id":"kura-training-m3k","title":"Agent-Behavior Detailausbau: Szenarien, Beispiele, User-Overrides","description":"Follow-up zu 2kb. Grundgerüst (vision + operational) steht. Noch offen: konkrete Szenarien mit Beispielen (wie der 3-Tage-Plan-Fehler), User-Override-Mechanismus in user_profile (z.B. scope=proactive), Integration mit interview_guide (Kommunikationsstil erfragen).","notes":"Session handoff 2026-02-13: Reliability UX + onboarding primer are done (m3k.1/m3k.2). Remaining work is now split into m3k.3 (scenario library) and m3k.4 (user overrides), intentionally dependent on wvp self-model/policy outputs to keep UX aligned with runtime constraints.","status":"open","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T07:25:51.179251+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:55:34.818774+01:00"}
{"id":"kura-training-m3k.1","title":"Reliability UX Protocol: saved vs inferred vs unresolved","description":"Standardize agent response behavior so users can distinguish persisted facts from inferences and open questions. Problem: current conversational confirmations can overstate certainty (e.g., saying logged while values are inferred or conflicting). Outcome: transparent reliability UX with explicit state labels and targeted follow-up prompts.","design":"Introduce response contract after logging: Saved (with receipt basis), Inferred (with confidence + provenance), Unresolved (asks one clarification). Enforce wording constraints in agent behavior policy/examples and add transcript-level tests for claim inflation. Ensure this integrates with write-with-proof artifacts and session audit results.","acceptance_criteria":"1) Response state contract documented with examples and anti-patterns. 2) Agent templates/policies updated to avoid certainty inflation. 3) Transcript tests verify correct labeling for saved/inferred/unresolved cases. 4) Clarification prompts are concise and conflict-focused. 5) User override hooks remain compatible.","notes":"Implemented artifacts\n- docs/design/032-reliability-ux-protocol-saved-inferred-unresolved.md (state contract, anti-patterns, concise clarification policy)\n- api/src/routes/agent.rs:\n  - added `reliability_ux` response contract to `AgentWriteWithProofResponse`\n  - added `AgentReliabilityUx` + `AgentReliabilityInferredFact` schema types\n  - added deterministic state derivation `saved|inferred|unresolved`\n  - added inferred fact collection from `evidence.claim.logged` and inferred repair provenance\n  - tightened clarification prompt wording to conflict-focused concise templates\n  - added regression tests for saved/inferred/unresolved labeling behavior\n- workers/src/kura_workers/system_config.py:\n  - added `agent_behavior.operational.reliability_ux_protocol` with state contract, anti-patterns, clarification style, and override-hook compatibility\n- workers/tests/test_system_config.py:\n  - added assertions for reliability_ux protocol states and override-hook compatibility\n\nTests and exact commands\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nResidual risks / non-goals\n- `assistant_phrase` is currently generated server-side as canonical baseline; no locale-specific phrasing layer yet.\n- V1 inferred-fact extraction focuses on evidence/repair provenance already present in write-with-proof flow; no separate narrative summarizer added.\n\nFollow-up issues\n- kura-training-2zc.2 (cluster reliability failures and state mismatches across users)\n- kura-training-2zc.5 (calibration/drift for inferred-fact confidence over time)\n\nRollback / disable path\n- Remove `reliability_ux` from `AgentWriteWithProofResponse` and bypass `build_reliability_ux(...)` call.\n- Revert `reliability_ux_protocol` section in system_config if policy rollout needs to pause.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T13:37:33.894493+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T15:10:14.319707+01:00","closed_at":"2026-02-12T15:10:14.319707+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-m3k.1","depends_on_id":"kura-training-pdc.5","type":"blocks","created_at":"2026-02-12T13:37:33.897178+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.1","depends_on_id":"kura-training-pdc.20","type":"blocks","created_at":"2026-02-12T13:37:33.897973+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.1","depends_on_id":"kura-training-m3k","type":"parent-child","created_at":"2026-02-12T13:40:06.219198+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-m3k.2","title":"Onboarding Collaboration Primer + Logging Guidance","description":"Add a concise onboarding primer that explains what Kura is, how collaboration works, and how users should communicate/log data for best coaching reliability.","design":"Extend interview_guide and system conventions with a short collaboration contract: context-first communication, correction loop, asking for review, and concrete logging examples. Keep it non-blocking but always available in onboarding guidance.","acceptance_criteria":"1) Interview guide includes collaboration primer and communication tips. 2) Logging guidance includes concrete examples for good set/session reporting. 3) Existing guide structure tests continue to pass and new tests assert primer presence.","notes":"Extended interview_guide with collaboration_primer, communication_tips, and logging_guidance sections to explain what Kura is, how to collaborate, and how to log better session/set data. Added guide tests for primer presence and structure.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:22:15.26046+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:31:58.047479+01:00","closed_at":"2026-02-13T09:31:58.047479+01:00","close_reason":"Implemented and tested","dependencies":[{"issue_id":"kura-training-m3k.2","depends_on_id":"kura-training-m3k","type":"parent-child","created_at":"2026-02-13T09:22:15.261679+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.2","depends_on_id":"kura-training-m3k.1","type":"blocks","created_at":"2026-02-13T09:22:56.256991+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-m3k.3","title":"Scenario Library V1: Model-Tier-Aware Agent Behavior Examples","description":"Create concrete scenario playbooks that show how agent behavior should differ by confidence, model tier, and user preference while preserving reliability UX semantics.","design":"Add executable scenario catalog (happy path, ambiguity, correction, contradiction, low-confidence, overload). Each scenario includes expected event writes, clarification strategy, and Saved/Inferred/Unresolved wording.","acceptance_criteria":"1) Scenario set covers onboarding, logging, correction, and planning transitions. 2) Each scenario specifies expected machine outputs and user-visible phrasing. 3) Regression tests or fixtures validate conformance.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:51.728608+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T07:49:18.759378+01:00","closed_at":"2026-02-14T07:49:18.759378+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-m3k.3","depends_on_id":"kura-training-m3k","type":"parent-child","created_at":"2026-02-13T09:53:51.72978+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.3","depends_on_id":"kura-training-m3k.2","type":"blocks","created_at":"2026-02-13T09:54:38.567897+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.3","depends_on_id":"kura-training-wvp.1","type":"blocks","created_at":"2026-02-13T09:54:43.785227+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":3,"issue_id":"kura-training-m3k.3","author":"jonzim-cmd","text":"Transcript 2026-02-13 regression scenario to include in Scenario Library: (a) session.completed was first guessed (enjoyment/quality) then corrected by user, (b) smith-machine comparability confusion for BSS, (c) pending read-after-write verification while receipts exist. Scenario should assert expected machine outputs and wording: Saved vs Inferred vs Unresolved, one-conflict clarification question, and explicit no-definitive-saved when claim_guard is pending.","created_at":"2026-02-13T11:42:14Z"},{"id":5,"issue_id":"kura-training-m3k.3","author":"jonzim-cmd","text":"Implemented Scenario Library V1 end-to-end. Added operational.scenario_library_v1 and operational.user_override_controls_v1 contracts in workers/src/kura_workers/system_config.py, plus executable architecture specs in tests/architecture/test_61_scenario_library_contract.py and tests/architecture/test_62_user_override_controls_contract.py. Added API runtime conformance tests for onboarding/logging, planning override confirm-first, inferred-with-provenance correction, contradiction unresolved, pending read-after-write unresolved, and overload single-conflict question in api/src/routes/agent.rs. Verified through full quality gates: ruff check, workers unit tests, workers integration tests, cargo test --workspace, and tests/architecture.","created_at":"2026-02-14T06:49:10Z"}]}
{"id":"kura-training-m3k.4","title":"User Override Controls V1: Autonomy Scope + Interaction Style","description":"Implement explicit user override controls to tune autonomy scope and interaction style without breaking safety floors.","design":"Add user_profile preference keys for autonomy scope (strict/moderate/proactive), verbosity, and confirmation strictness. Runtime policy reads overrides but never bypasses global hard invariants.","acceptance_criteria":"1) Overrides persist in profile/preferences and are visible in context. 2) Runtime policy respects overrides within safety floor bounds. 3) Tests cover override precedence and fallback defaults.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:56.949399+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T07:49:21.879064+01:00","closed_at":"2026-02-14T07:49:21.879064+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-m3k.4","depends_on_id":"kura-training-m3k","type":"parent-child","created_at":"2026-02-13T09:53:56.950359+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.4","depends_on_id":"kura-training-m3k.3","type":"blocks","created_at":"2026-02-13T09:54:49.008174+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-m3k.4","depends_on_id":"kura-training-wvp.3","type":"blocks","created_at":"2026-02-13T09:54:54.210452+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":6,"issue_id":"kura-training-m3k.4","author":"jonzim-cmd","text":"Implemented User Override Controls V1 across worker contracts + API runtime policy. Added preference keys autonomy_scope, verbosity, confirmation_strictness to event conventions/interview guide and profile coverage logic (workers/src/kura_workers/event_conventions.py, interview_guide.py, handlers/user_profile.py). Extended AgentAutonomyPolicy + write verification to apply user overrides with safety-floor clamping and confirm-first gating precedence, including concise/default phrasing behavior (api/src/routes/agent.rs, api/src/routes/agent/write_verification.rs, api/src/routes/agent/policy.rs). Added override precedence and fallback tests in api/src/routes/agent.rs and worker consistency tests in workers/tests/*. Verified with full gates: ruff, workers unit/integration, cargo workspace tests, architecture tests.","created_at":"2026-02-14T06:49:15Z"}]}
{"id":"kura-training-nv2","title":"Preference \u0026 Alias event types + user_profile projection","description":"Per-user alias system (exercise.alias_created, preference.set, goal.set events) and user_profile projection that answers 'what does Kura know about this user?' Foundation for agent context across sessions.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:02.247548+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T13:49:49.315141+01:00","closed_at":"2026-02-08T13:49:49.315141+01:00","close_reason":"Implemented and integration-tested"}
{"id":"kura-training-nwn","title":"CLI Skeleton: kura health, kura event create, kura event list","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:07.108039+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T07:35:58.288559+01:00","closed_at":"2026-02-08T07:35:58.288559+01:00","close_reason":"CLI with kura health, kura event create, kura event list. JSON-only, structured errors, auto-idempotency keys."}
{"id":"kura-training-odw","title":"Account-Löschung (DSGVO Art. 17)","description":"DSGVO Art. 17 + Art. 9 (Gesundheitsdaten): User muss eigene Daten komplett löschen können. Admin ebenfalls. Sonst niemand. Hard DELETE auf events, projections, background_jobs, api_keys, users. Privilegierte DB-Rolle nötig (app_user hat kein DELETE auf events). Endpoints: DELETE /v1/account (self), DELETE /v1/admin/users/{id} (admin).","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T18:06:46.336955+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T18:15:17.951414+01:00","closed_at":"2026-02-09T18:15:17.951414+01:00","close_reason":"Implemented: DELETE /v1/account (self) + DELETE /v1/admin/users/{id} (admin). SECURITY DEFINER function for hard delete."}
{"id":"kura-training-ohr","title":"[ctv.4] End-to-end tests for attestation and auto-tiering","description":"Add API and worker tests for valid/invalid/stale/replayed attestations and automatic tier transitions/fallback behavior.","acceptance_criteria":"1) Rust tests cover attestation verification edge cases. 2) Python worker tests cover auto-tiering thresholds and hysteresis. 3) Full quality gates pass.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T21:20:06.046382+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:41:40.190559+01:00","closed_at":"2026-02-13T21:41:40.190559+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-ohr","depends_on_id":"kura-training-d8o","type":"blocks","created_at":"2026-02-13T21:21:10.88362+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-ohr","depends_on_id":"kura-training-gh0","type":"blocks","created_at":"2026-02-13T21:21:18.531031+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc","title":"Decision 13 Domain Gap Closure: Onboarding and coaching reliability","description":"Close domain-specific reliability gaps observed in field tests after core self-healing platform steps. Problem: platform guardrails reduce chaos, but domain-level holes still degrade UX and recommendation quality. Goal: implement concrete domain controls for onboarding completeness, phase discipline, temporal correctness, intensity semantics, and save guarantees.","design":"Reference: docs/design/013-self-healing-agentic-data-plane.md. This epic captures user-facing domain gaps discovered during live testing and expected to recur across users in different forms. Each child issue must include: root cause, failure mode, mitigation, and measurable acceptance tests.","acceptance_criteria":"1) Child issues created for onboarding baseline profile, onboarding phase transitions, timezone-first flow, RIR first-class modeling, and save-handshake enforcement. 2) Each child includes explicit problem statement and testable outcomes. 3) Work sequencing defined so dependencies are clear.","notes":"Closed remaining domain reliability gaps via pdc.22-pdc.25: global legacy-path invariant enforcement, intensity ingress contract, observation lifecycle governance, and locale-aware ingestion baseline. Quality gates executed: ruff check workers/src/ workers/tests/, full workers pytest (unit + integration), cargo test --workspace.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:02:00.911494+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:33:17.6871+01:00","closed_at":"2026-02-13T09:33:17.6871+01:00","close_reason":"All child issues implemented and validated"}
{"id":"kura-training-pdc.1","title":"Onboarding V2: Baseline Profile Completeness (explicit known/unknown/deferred)","description":"Close missing baseline profile fields during onboarding. Problem: age/body baseline is often mentioned but not captured structurally, causing downstream recommendation errors and silent omissions in summary. Implement explicit baseline slots with tri-state semantics: known, unknown, deferred.","design":"Reference Decision 13 INV-006. Add onboarding coverage area and persistence conventions for age/date_of_birth, bodyweight baseline, and optional sex/body-composition context where relevant. Ensure summaries include deferred markers instead of dropping fields.","acceptance_criteria":"1) Onboarding coverage tracks baseline profile completeness explicitly. 2) Fields can be stored as value or deferred marker. 3) User summary reflects known + deferred baseline items. 4) Data model/docs updated with conventions. 5) Tests cover mention-captured, mention-deferred, and omitted-but-flagged scenarios.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:03:31.76997+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T21:27:04.332247+01:00","closed_at":"2026-02-11T21:27:04.332247+01:00","close_reason":"Implemented INV-006 baseline tri-state in onboarding coverage/user_profile, updated conventions/docs, and added mention-captured/deferred/missing tests.","dependencies":[{"issue_id":"kura-training-pdc.1","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T17:03:31.771018+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.10","title":"Field Correction Primitive: patch-style correction event","description":"Current repair workflow relies on retract-and-relog for small field fixes, which is noisy and increases event volume. Introduce a minimal correction primitive to update specific fields while preserving immutable history and full audit trail.","design":"Add a correction event convention (for example set.corrected) referencing target_event_id and changed_fields only. Keep original event immutable, apply correction overlay in projections, and support idempotency key to avoid duplicate corrections. Retraction remains available for semantic invalidation; field-level correction is default for additive/fixup edits.","acceptance_criteria":"1) New correction event convention documented with target_event_id, changed_fields, reason, provenance, and idempotency_key.\n2) Projection logic resolves effective values using latest valid correction chain.\n3) Retract-and-relog is no longer required for pure field additions like rest_seconds.\n4) Duplicate correction submissions are idempotent.\n5) Tests cover additive correction, overwrite correction, and chain resolution.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:45:05.157004+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:27:49.137167+01:00","closed_at":"2026-02-11T19:27:49.137167+01:00","close_reason":"Implemented set.corrected convention, correction-chain overlays in projections, and additive/overwrite/chain tests with idempotency-key convention checks.","dependencies":[{"issue_id":"kura-training-pdc.10","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T18:45:05.157874+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.10","depends_on_id":"kura-training-pdc.9","type":"blocks","created_at":"2026-02-11T18:45:05.158979+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.11","title":"Automatic Session Audit Gate: mention-field mismatch detection","description":"Mentioned values are still sometimes omitted unless manually prompted. Add an automatic post-session audit gate that detects mention-present/field-missing mismatches and proposes or applies safe repairs based on confidence policy.","design":"Run a deterministic audit after session logging and before final save confirmation. Compare extracted mentions against persisted structured fields per exercise/set scope. If confidence is high and policy allows, apply auto-correction; otherwise ask one focused clarification question. Emit telemetry for detected mismatch, repair action, and unresolved mismatches.","acceptance_criteria":"1) Session-end audit runs automatically and checks mention-field consistency for core mention-bound fields.\n2) High-confidence mismatches are auto-repaired according to policy; uncertain cases ask one concise user question.\n3) Audit result is included in save receipt (clean|repaired|needs_clarification).\n4) Telemetry events emitted for mismatch_detected, mismatch_repaired, mismatch_unresolved.\n5) Tests cover clean session, auto-repair session, and clarification-required session.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:45:05.277728+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:37:19.711986+01:00","closed_at":"2026-02-11T19:37:19.711986+01:00","close_reason":"Implemented automatic session mention-field audit with policy-gated auto-repair via set.corrected, clarification fallback, save receipt audit status, and mismatch telemetry/events with tests.","dependencies":[{"issue_id":"kura-training-pdc.11","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T18:45:05.278549+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.11","depends_on_id":"kura-training-pdc.7","type":"blocks","created_at":"2026-02-11T18:45:05.279318+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.11","depends_on_id":"kura-training-2zc.1","type":"blocks","created_at":"2026-02-11T18:45:05.279888+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.11","depends_on_id":"kura-training-pdc.9","type":"blocks","created_at":"2026-02-11T18:45:05.280419+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.12","title":"Repair UX V1: progressive disclosure receipts and undo","description":"Technical repair output with raw commands and IDs can overwhelm normal users. Add a user-facing repair UX contract with plain-language summaries by default and technical details only on demand.","design":"Default response format: what changed, what stayed the same, why. Provide expandable technical details (event IDs, diffs, command trace) only when requested. Include explicit undo action for last repair batch and keep machine-readable receipt for support/debugging. Align with save-handshake state model.","acceptance_criteria":"1) Default repair feedback is plain-language and concise.\n2) Technical detail block is optional and not shown by default.\n3) Every repair returns a receipt with changed_fields_count, unchanged_metrics, and status.\n4) Undo for last repair batch is available and tested.\n5) UX integration tests verify both normal-user and power-user views.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:45:05.399898+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:41:01.269736+01:00","closed_at":"2026-02-11T19:41:01.269736+01:00","close_reason":"Added plain-language repair feedback by default, optional technical details on request, receipt contract (status/changed_fields_count/unchanged_metrics), and undo event templates with coverage tests for normal and power-user views.","dependencies":[{"issue_id":"kura-training-pdc.12","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T18:45:05.401295+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.12","depends_on_id":"kura-training-pdc.5","type":"blocks","created_at":"2026-02-11T18:45:05.402327+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.12","depends_on_id":"kura-training-pdc.11","type":"blocks","created_at":"2026-02-11T18:45:05.403183+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.13","title":"Agent Capability Manifest API: protocol negotiation without prompt edits","description":"BYOA clients should discover contract changes automatically instead of requiring manual system-prompt updates. Add a machine-readable capability manifest endpoint so agents, CLI, and MCP can self-calibrate to preferred Kura contracts.","design":"Add `GET /v1/agent/capabilities` returning protocol_version, preferred_read_endpoint, preferred_write_endpoint, required_verification_contract, supported_fallbacks, min_cli_version, min_mcp_version, and upgrade_policy metadata. Include stable schema versioning and explicit backward-compat flags so clients can negotiate behavior safely.","acceptance_criteria":"1) New endpoint `/v1/agent/capabilities` documented in OpenAPI and returns stable versioned schema.\n2) Response includes preferred endpoints (`/v1/agent/context`, `/v1/agent/write-with-proof`) plus fallback/compat metadata.\n3) Contract includes minimum client version hints for CLI/MCP.\n4) Backward compatibility policy is explicit (supported, deprecated, removed timelines/flags).\n5) Tests cover schema stability and negotiation fields.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T19:22:16.598524+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T20:14:25.183258+01:00","closed_at":"2026-02-11T20:14:25.183258+01:00","close_reason":"Added /v1/agent/capabilities endpoint with versioned schema, fallback metadata, upgrade policy, and API tests.","dependencies":[{"issue_id":"kura-training-pdc.13","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T19:22:16.599355+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.14","title":"Legacy Contract Upgrade Signals: machine-readable deprecation guidance","description":"When agents continue calling legacy endpoints, Kura should provide actionable upgrade signals automatically. This avoids hidden drift and removes reliance on manual prompt tuning.","design":"Add machine-readable upgrade notices for legacy access paths (e.g., direct events/projections flows when higher-level agent contract is available). Provide warning payload/headers with recommended endpoint migration, reason, and urgency level. Emit telemetry for legacy usage to monitor rollout quality.","acceptance_criteria":"1) Legacy contract usage produces machine-readable upgrade signal with recommended replacement endpoint/flow.\n2) Signals include reason, policy phase (supported|deprecated), and action hint.\n3) Telemetry event emitted for legacy usage and client metadata when available.\n4) Rate-limited to avoid response spam while remaining visible.\n5) Tests cover signal emission, suppression policy, and payload format.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T19:22:16.724451+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T20:14:25.25997+01:00","closed_at":"2026-02-11T20:14:25.25997+01:00","close_reason":"Added machine-readable legacy upgrade headers with rate-limited emission and telemetry logging for events/projections paths, plus middleware tests.","dependencies":[{"issue_id":"kura-training-pdc.14","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T19:22:16.725587+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.14","depends_on_id":"kura-training-pdc.13","type":"blocks","created_at":"2026-02-11T19:22:16.726649+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.15","title":"CLI Protocol Parity: write-with-proof command + compatibility doctor","description":"CLI must expose the same high-level agent contract as the API so users do not need custom prompt surgery. Add first-class write-with-proof command(s) and protocol compatibility checks.","design":"Introduce dedicated CLI command for `/v1/agent/write-with-proof` (with receipts + read-after-write targets) and ensure `kura context` maps to `/v1/agent/context`. Extend `kura doctor` to check `/v1/agent/capabilities`, detect version/contract mismatches, and output actionable remediation.","acceptance_criteria":"1) CLI has dedicated command path for write-with-proof (not only generic `kura api`).\n2) Command supports input events, read-after-write targets, timeout, and structured output parsing.\n3) `kura doctor` checks server capability manifest and warns on incompatible/legacy client usage.\n4) Help/docs updated with contract-first examples.\n5) Tests cover request serialization, doctor mismatch detection, and backward-compatible fallback behavior.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T19:22:16.846812+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T20:14:25.356676+01:00","closed_at":"2026-02-11T20:14:25.356676+01:00","close_reason":"Added dedicated CLI write-with-proof command and doctor capability/version checks with request serialization/version tests.","dependencies":[{"issue_id":"kura-training-pdc.15","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T19:22:16.848632+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.15","depends_on_id":"kura-training-pdc.13","type":"blocks","created_at":"2026-02-11T19:22:16.849654+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.15","depends_on_id":"kura-training-pdc.14","type":"blocks","created_at":"2026-02-11T20:03:41.721938+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.16","title":"MCP Auto-Calibration: capability-driven tool routing to agent contract","description":"MCP-connected agents should not need handcrafted prompt updates after backend contract changes. MCP integration must auto-detect Kura capabilities and route reads/writes through preferred agent endpoints.","design":"At MCP startup, fetch capability manifest and configure tools toward `/v1/agent/context` and `/v1/agent/write-with-proof` when available. Expose a lightweight health/capability status output for operators. On mismatch, emit concise upgrade notice and safe fallback behavior.","acceptance_criteria":"1) MCP startup performs capability negotiation against Kura.\n2) Tool routing prefers agent contract endpoints when supported.\n3) On unsupported contract, MCP falls back deterministically and surfaces concise operator notice.\n4) Capability status is observable (logs/diagnostic tool output).\n5) Integration tests cover supported, legacy fallback, and mismatch scenarios.","notes":"Deferred flag removed. MCP baseline now exists in-repo; this issue now tracks startup auto-calibration hardening: fetch /v1/agent/capabilities on boot, route to preferred endpoints, emit deterministic fallback + operator-visible compatibility status.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T19:22:16.970682+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T08:48:26.431853+01:00","closed_at":"2026-02-13T08:48:26.431853+01:00","close_reason":"Implemented startup capability negotiation against /v1/agent/capabilities with preferred endpoint routing, deterministic legacy fallback on unsupported/mismatch states, operator-visible negotiation status, and regression tests for preferred/fallback/mismatch paths.","dependencies":[{"issue_id":"kura-training-pdc.16","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T19:22:16.971527+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.16","depends_on_id":"kura-training-pdc.13","type":"blocks","created_at":"2026-02-11T19:22:16.972365+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.16","depends_on_id":"kura-training-pdc.15","type":"blocks","created_at":"2026-02-11T19:22:16.972962+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.16","depends_on_id":"kura-training-lsu","type":"blocks","created_at":"2026-02-13T08:36:21.543289+01:00","created_by":"jonzim-cmd"}],"comments":[{"id":2,"issue_id":"kura-training-pdc.16","author":"jonzim-cmd","text":"Undeferred and reprioritized because ChatGPT App integration requires robust MCP behavior under contract evolution. Implement startup capability negotiation + automatic endpoint routing + deterministic fallback/health signaling.","created_at":"2026-02-13T07:36:42Z"}]}
{"id":"kura-training-pdc.17","title":"Workflow Gate E2E Coverage for write-with-proof","description":"Add DB-backed API integration tests for onboarding workflow gate flows in /v1/agent/write-with-proof, including blocked drift, explicit close, explicit override, and legacy auto-close compatibility path.","acceptance_criteria":"1) Tests verify blocked response payload + docs_hint for drift before close. 2) Tests verify explicit close allows planning and emits workflow_gate transition onboarding_closed. 3) Tests verify explicit override allows planning and emits transition override. 4) Legacy planning history path auto-writes workflow.onboarding.closed and returns compatibility warning.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:49:36.2833+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T22:15:51.958643+01:00","closed_at":"2026-02-11T22:15:51.958643+01:00","close_reason":"4 DB-backed E2E integration tests added and passing: drift detection, explicit close, explicit override, legacy planning path","dependencies":[{"issue_id":"kura-training-pdc.17","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T21:49:36.284539+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.18","title":"Visualization Resolve Endpoint E2E Integration Coverage","description":"Add DB-backed API integration tests for /v1/agent/visualization/resolve covering source binding against real projections, policy-triggered visualize/skipped paths, telemetry emission, and deterministic fallback responses.","acceptance_criteria":"1) Integration test verifies visualize trigger with resolvable projection refs returns resolved_sources and optional rich output. 2) Invalid source reference/json_path returns validation error with docs_hint. 3) allow_rich_rendering=false returns ASCII fallback with equivalent meaning and telemetry includes viz_fallback_used. 4) Policy skip path emits viz_skipped telemetry.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T22:09:05.196434+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T22:34:49.154222+01:00","closed_at":"2026-02-11T22:34:49.154222+01:00","close_reason":"Added DB-backed E2E integration coverage for /v1/agent/visualization/resolve: visualize+resolved sources, invalid json_path validation docs_hint, deterministic ASCII fallback with viz_fallback_used telemetry, and policy-skip viz_skipped telemetry.","dependencies":[{"issue_id":"kura-training-pdc.18","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T22:09:05.197903+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.19","title":"Evidence Layer V1: Utterance-\u003eClaim-\u003eEvent lineage","description":"Introduce a first-class evidence layer so agent writes remain reconstructable under open-world user input. Problem: important facts currently live in free text and can drift when summarized. Outcome: each persisted training fact can be traced to raw utterance evidence and confidence metadata.","design":"Create deterministic claim objects from raw utterances with fields: claim_type, value, unit, scope(session/exercise/set), confidence, provenance(source_text_span, parser_version). Store lineage links from claim to emitted events and corrections. Do not replace event store; augment it with evidence metadata and query surfaces for audits. Keep repairs reversible via set.corrected/event.retracted.","acceptance_criteria":"1) Claim schema and storage path documented and implemented. 2) Each auto-extracted write includes lineage to source utterance span. 3) API/worker can explain why a value exists (raw text + parser/provenance). 4) Integration tests cover deterministic replay from transcript snippets. 5) No regression in existing write-with-proof flow.","notes":"Implemented artifacts\n- docs/design/029-evidence-layer-v1-utterance-claim-event-lineage.md (claim schema, storage path, replay and explain surface)\n- api/src/routes/agent.rs:\n  - Added deterministic mention-\u003eclaim extraction with source_text_span + parser_version\n  - Added additive sidecar writes: `evidence.claim.logged` in `write_with_proof`\n  - Added explain endpoint: `GET /v1/agent/evidence/event/{event_id}`\n  - Added deterministic replay tests for transcript snippets and endpoint e2e test\n- api/src/main.rs: OpenAPI path/schema registration for evidence endpoint/response\n- workers/src/kura_workers/event_conventions.py: added `evidence.claim.logged` contract\n- workers/src/kura_workers/system_config.py: added `evidence_layer_v1` conventions section\n- workers/tests/test_system_config.py + workers/tests/test_interview_guide.py: updated/added convention coverage\n\nTests and exact commands\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nResidual risks / non-goals\n- V1 parser currently covers mention-bound set-context claims (rest_seconds, rir, tempo, set_type); broader claim families are intentionally deferred.\n- Evidence writes are additive sidecar writes; no backfill for historical events without lineage in this issue.\n\nFollow-up issues\n- kura-training-pdc.20 (cross-event coherence + scale guards)\n- kura-training-pdc.21 (open observation contract extension)\n- kura-training-2zc.5 (calibration/drift on new claim stream)\n\nRollback / disable path\n- Remove/disable sidecar `evidence.claim.logged` emission in `write_with_proof`.\n- Keep endpoint route disabled/removed if needed; primary write-with-proof flow remains functional.\n- Revert commit touching agent route/main + convention docs/tests to restore pre-evidence behavior.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T13:37:18.207254+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T14:14:52.995743+01:00","closed_at":"2026-02-12T14:14:52.995743+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-pdc.19","depends_on_id":"kura-training-pdc.11","type":"blocks","created_at":"2026-02-12T13:37:18.209864+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.19","depends_on_id":"kura-training-pdc.8","type":"blocks","created_at":"2026-02-12T13:37:18.210588+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.19","depends_on_id":"kura-training-ct3.6","type":"blocks","created_at":"2026-02-12T13:37:18.211302+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.19","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-12T13:39:50.591036+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.2","title":"Onboarding State Machine: No Coaching Drift before Phase Close","description":"Enforce hard onboarding phase transitions. Problem: agent naturally drifts into planning/coaching before onboarding closure, creating incomplete profiles and inconsistent persistence. Implement explicit state gating between onboarding and planning modes.","design":"Introduce conversation workflow state with transition conditions and override behavior. Planning/coaching actions require onboarding_closed or explicit user override event. Emit workflow violation signals for learning loop when drift attempts occur.","acceptance_criteria":"1) State machine prevents planning payload generation before onboarding phase close unless explicit override exists. 2) Transition events are auditable. 3) User-visible messaging handles phase switch clearly. 4) Tests cover drift attempt, valid close, and explicit override path.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:03:52.582636+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T21:49:17.647902+01:00","closed_at":"2026-02-11T21:49:17.647902+01:00","close_reason":"Implemented onboarding phase gate (INV-004) with auditable close/override transitions, legacy-safe auto-close compatibility, workflow telemetry, and tests for drift/close/override.","dependencies":[{"issue_id":"kura-training-pdc.2","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T17:03:52.583657+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.2","depends_on_id":"kura-training-pdc.1","type":"blocks","created_at":"2026-02-11T17:05:52.293622+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.20","title":"Session Audit V2: Cross-event coherence + scale guards","description":"Extend session audit beyond mention-bound set fields to session-level coherence checks. Problem: transcript-level inconsistencies (scale drift, contradictory summaries, inferred numbers without evidence) still pass. Outcome: automatic consistency validation and safe correction/clarification for session.completed and session summaries.","design":"Add post-write audit pass that evaluates: (a) scale consistency (1..5 vs 1..10), (b) contradiction checks between structured fields and narrative, (c) unsupported inferred values. Auto-repair only on high-confidence deterministic transforms; otherwise emit clarification question and mark unresolved mismatch. Expose machine-readable audit results in write-with-proof response.","acceptance_criteria":"1) Deterministic guards for enjoyment/quality/exertion scales implemented. 2) Contradiction detection between narrative and structured session feedback implemented. 3) Auto-repair path emits correction events with provenance; uncertain cases emit clarification prompts. 4) E2E tests cover clean, repaired, and needs_clarification states. 5) Telemetry includes mismatch classes for learning loop.","notes":"Implemented artifacts\n- docs/design/030-session-audit-v2-cross-event-coherence-and-scale-guards.md (scope, mismatch classes, repair/clarification split)\n- api/src/routes/agent.rs:\n  - Extended session audit with session.completed coherence checks:\n    - deterministic scale guards (1..10 -\u003e 1..5 normalization for enjoyment/perceived_quality)\n    - narrative vs structured contradiction detection\n    - unsupported inferred value detection (missing evidence id)\n  - Added `session_audit.mismatch_classes` to write-with-proof response and telemetry payloads\n  - Added deterministic auto-repair for high-confidence session feedback scale normalization via event.retracted + replacement session.completed with repair_provenance\n  - Clarification path for unresolved contradictions/out-of-bounds/unsupported inferred values\n  - Updated undo template to use retracted_event_id contract\n  - Added tests for clean, repaired, needs_clarification states for session feedback checks\n\nTests and exact commands\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 ruff check workers/src/ workers/tests/\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- set -a \u0026\u0026 source .env \u0026\u0026 set +a \u0026\u0026 cargo test --workspace\n\nResidual risks / non-goals\n- Narrative contradiction heuristics are rule-based/token-based in V2; no semantic model scoring yet.\n- Auto-repair currently covers deterministic scale normalization only; contradiction cases remain clarification-first.\n\nFollow-up issues\n- kura-training-pdc.21 (open observation contract for additional non-schema session signals)\n- kura-training-m3k.1 (reliability UX surfacing mismatch classes and saved/inferred/unresolved semantics)\n- kura-training-2zc.5 (calibration/drift over mismatch classes + contradiction heuristics)\n\nRollback / disable path\n- Disable session.completed scale normalization branch inside session audit while retaining mention-bound set-field checks.\n- Revert commit touching session-audit logic/docs to restore prior Audit V1 behavior.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T13:37:23.437991+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T14:24:46.557806+01:00","closed_at":"2026-02-12T14:24:46.557806+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-pdc.20","depends_on_id":"kura-training-pdc.11","type":"blocks","created_at":"2026-02-12T13:37:23.440834+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.20","depends_on_id":"kura-training-pdc.8","type":"blocks","created_at":"2026-02-12T13:37:23.441615+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.20","depends_on_id":"kura-training-pdc.19","type":"blocks","created_at":"2026-02-12T13:37:23.442364+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.20","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-12T13:39:55.793401+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.21","title":"Open Observation Contract V1 for non-schema session signals","description":"Add an open-world observation contract for valuable session facts that do not fit fixed event schemas. Problem: insights like motivation pre-session, technical cues, and jump baseline are currently preserved only as opaque text. Outcome: structured but extensible observations with confidence and context, without exploding event types.","design":"Define observation payload: dimension, value, unit(optional), scale(optional), context_text, tags, confidence, provenance, scope(session/exercise). Support high-confidence dimensions first: motivation_pre, discomfort_signal, jump_baseline. Keep contract extensible through dimension registry + validation tiers (known, provisional, unknown).","acceptance_criteria":"1) Observation contract and validation tiers documented. 2) At least three dimensions implemented with tests (motivation_pre, discomfort_signal, jump_baseline). 3) Observations are queryable in projections without custom per-dimension schema work. 4) Unknown dimensions remain storable with safe defaults and quality flags. 5) No loss of raw context text/provenance.","notes":"Implemented artifacts:\n- workers/src/kura_workers/handlers/open_observations.py (open-world observation projection with known/provisional/unknown tiers)\n- workers/src/kura_workers/handlers/__init__.py (handler registration)\n- workers/src/kura_workers/event_conventions.py (observation.logged contract)\n- workers/src/kura_workers/system_config.py (open_observation_v1 conventions)\n- api/src/routes/events.rs (simulation target mapping: open_observations/\u003cdimension\u003e)\n- workers/tests/test_open_observations.py (unit tests)\n- workers/tests/test_integration.py (integration tests for known/unknown/retraction)\n- workers/tests/test_interview_guide.py + workers/tests/test_system_config.py (contract/system assertions)\n- docs/design/031-open-observation-contract-v1.md\n\nTests + exact commands:\n- ruff check workers/src/ workers/tests/\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n- cargo test --workspace\n\nResidual risks / non-goals:\n- No automated dimension-promotion workflow in this issue (handled by learning-loop chain).\n- Unknown dimensions are stored safely but not yet auto-ranked for promotion.\n\nFollow-up issues:\n- kura-training-2zc.6 (unknown-dimension mining + proposal loop)\n- kura-training-2zc.3 (promotion policy bridge)\n\nRollback / disable path:\n- Stop emitting observation.logged events at writer level.\n- Remove open_observations registration from workers/src/kura_workers/handlers/__init__.py to disable projection updates while keeping immutable events.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T13:37:28.667296+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T14:34:52.074925+01:00","closed_at":"2026-02-12T14:34:52.074925+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-pdc.21","depends_on_id":"kura-training-pdc.19","type":"blocks","created_at":"2026-02-12T13:37:28.670131+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.21","depends_on_id":"kura-training-pdc.20","type":"blocks","created_at":"2026-02-12T13:37:28.670914+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.21","depends_on_id":"kura-training-pdc.7","type":"blocks","created_at":"2026-02-12T13:37:28.671701+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.21","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-12T13:40:00.99337+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.22","title":"Global Invariant Enforcement Parity on Legacy Event Writes","description":"Enforce Decision 13 core invariants on /v1/events and /v1/events/batch so legacy paths cannot bypass onboarding/timezone/save-contract safety.","design":"Apply server-side gate checks before insert for legacy endpoints: (1) block planning/coaching writes before onboarding close unless explicit override/close transition is present in the same batch, (2) require timezone preference before timeline-affecting writes unless event carries explicit timezone context, (3) protect INV-007 by routing plan writes to write-with-proof semantics (hard fail with docs_hint on legacy path).","acceptance_criteria":"1) POST /v1/events and /v1/events/batch reject planning/coaching events when onboarding not closed (unless explicit close/override in same request). 2) Legacy plan writes return machine-readable policy violation with migration hint to /v1/agent/write-with-proof. 3) Timeline-affecting writes without timezone preference fail with actionable docs_hint. 4) Tests cover allowed/blocked cases for single + batch.","notes":"Implemented global legacy-path enforcement in api/src/routes/events.rs: onboarding phase gate + plan-write contract gate + timezone requirement gate before /v1/events and /v1/events/batch writes. Added evaluate_legacy_domain_invariants(), fetch_user_profile_projection_data(), and regression tests for blocked/allowed flows.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:22:04.821666+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:31:26.815177+01:00","closed_at":"2026-02-13T09:31:26.815177+01:00","close_reason":"Implemented and tested","dependencies":[{"issue_id":"kura-training-pdc.22","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-13T09:22:04.823232+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.23","title":"Intensity Semantics V1: RIR/RPE Ingress Contract and Consistency Guards","description":"Define and enforce a deterministic intensity contract at write ingress for set.logged and training plan payloads.","design":"Add hard validation for numeric type + range (RPE 1..10, RIR 0..10) and deterministic consistency guard when both values are present. Keep consistency mismatch as warning for now; reject malformed/out-of-range payloads with invariant-specific policy codes.","acceptance_criteria":"1) Non-numeric or out-of-range RIR/RPE fails with machine-readable policy violation. 2) RIR+RPE contradiction emits warning metadata. 3) Event conventions/docs explicitly define precedence and inference semantics. 4) Unit tests cover pass/fail/warn cases.","notes":"Implemented deterministic intensity ingress contract: RPE/RIR type+range validation for set.logged and training_plan.* payloads, locale-decimal parsing (comma/dot), and consistency warning in plausibility checks. Updated event conventions and added unit tests.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:22:10.03943+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:31:42.440428+01:00","closed_at":"2026-02-13T09:31:42.440428+01:00","close_reason":"Implemented and tested","dependencies":[{"issue_id":"kura-training-pdc.23","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-13T09:22:10.040327+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.23","depends_on_id":"kura-training-pdc.22","type":"blocks","created_at":"2026-02-13T09:22:40.631234+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.24","title":"Observation Lifecycle Governance V1: unknown-\u003eprovisional-\u003eknown","description":"Make open-observation lifecycle promotion explicit and machine-readable with deterministic thresholds.","design":"Add lifecycle policy metadata to open_observation conventions + projection summaries: promotion status, confidence/support thresholds, and guardrails for auto-promotion eligibility. No automatic schema mutation in V1.","acceptance_criteria":"1) Projection summary exposes lifecycle status and promotion readiness fields. 2) System conventions declare thresholds/criteria and non-goals. 3) Tests cover lifecycle status calculation for known/provisional/unknown dimensions.","notes":"Added observation lifecycle governance in open_observations projection: lifecycle status + promotion readiness summary (support/confidence thresholds). Added lifecycle policy contract in system_config conventions and test coverage for known/unknown/provisional statuses.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:22:20.479119+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:32:13.672355+01:00","closed_at":"2026-02-13T09:32:13.672355+01:00","close_reason":"Implemented and tested","dependencies":[{"issue_id":"kura-training-pdc.24","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-13T09:22:20.479977+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.24","depends_on_id":"kura-training-pdc.21","type":"blocks","created_at":"2026-02-13T09:22:51.044778+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.25","title":"Locale-Aware Ingestion Baseline V1","description":"Prepare multilingual robustness by declaring locale/terminology ingestion contracts for number/unit/date parsing and confidence fallback.","design":"Introduce system-level ingestion locale contract: explicit locale hints, decimal/date normalization rules, and terminology mapping expectations with uncertainty discipline. Implement low-risk parser normalization for decimal comma in intensity fields.","acceptance_criteria":"1) System conventions expose locale ingestion contract + examples. 2) Ingress normalization accepts decimal-comma intensity values safely. 3) Tests cover locale-format normalization and fallback behavior.","notes":"Implemented locale-aware ingestion baseline: ingestion_locale_v1 conventions in system_config and decimal-comma normalization for intensity fields at API ingress. Added tests for locale normalization behavior and convention presence.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:22:25.700053+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:32:29.316108+01:00","closed_at":"2026-02-13T09:32:29.316108+01:00","close_reason":"Implemented and tested","dependencies":[{"issue_id":"kura-training-pdc.25","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-13T09:22:25.701298+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.25","depends_on_id":"kura-training-pdc.23","type":"blocks","created_at":"2026-02-13T09:22:45.840555+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.3","title":"Timezone-First Temporal Safety Flow","description":"Make timezone explicit before user-facing date math. Problem: schedule windows and week/day statements are error-prone without user timezone and lead to immediate trust loss. Add mandatory/default timezone handling path with clear assumption disclosure.","design":"Reference Decision 13 INV-003. Persist timezone preference early (or ask once with durable memory). All timeline/scheduling outputs must compute in user timezone; fallback assumptions must be explicit and logged as quality signal.","acceptance_criteria":"1) Timezone is captured or explicitly assumed before schedule/date claims. 2) Scheduling/timeline computations use user timezone consistently. 3) Missing-timezone quality issue drops after capture. 4) Tests cover DST boundary and mismatch regression case.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:04:08.36716+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T21:30:52.0575+01:00","closed_at":"2026-02-11T21:30:52.0575+01:00","close_reason":"Implemented timezone-first day/week grouping in training_timeline with explicit UTC fallback disclosure, updated onboarding/conventions, and added DST + mismatch regression tests.","dependencies":[{"issue_id":"kura-training-pdc.3","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T17:04:08.3687+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.4","title":"RIR as First-Class Data in Events and Plans","description":"Model Reps-In-Reserve explicitly instead of only narrative guidance. Problem: intensity prescriptions are inconsistent and hard to analyze when RIR is only implicit or text-based. Add structured RIR fields to set logging and planning conventions/projections.","design":"Extend event conventions and handlers to accept/store RIR consistently (and map with existing RPE where needed). Ensure training plans can prescribe target RIR and downstream analytics can query adherence.","acceptance_criteria":"1) set logging supports structured RIR field. 2) planning conventions support target RIR prescriptions. 3) projections expose RIR where relevant without breaking backward compatibility. 4) migration/backfill strategy documented. 5) tests cover parse, persistence, and projection output.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:04:27.87112+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:11:25.97273+01:00","closed_at":"2026-02-11T19:11:25.97273+01:00","close_reason":"Implemented RIR as first-class data in conventions and projections with backward-compatible normalization and documented backfill strategy.","dependencies":[{"issue_id":"kura-training-pdc.4","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T17:04:27.872345+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.4","depends_on_id":"kura-training-pdc.1","type":"blocks","created_at":"2026-02-11T17:06:02.567325+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.5","title":"Save Handshake Enforcement (write receipt + read-after-write)","description":"Enforce verifiable persistence before agent claims data/plan is saved. Problem: users currently need to ask manually whether a plan was persisted, creating trust risk and potential data loss. Add mandatory save handshake protocol.","design":"Reference Decision 13 INV-002 and INV-007. Agent must obtain event write receipt and projection read-back confirmation before success claim. Failures must return explicit pending/failed state and emit quality signals.","acceptance_criteria":"1) 'Saved' response is blocked unless receipt + read-back pass. 2) Protocol states visible: pending, saved_verified, failed. 3) quality signal emitted on claim mismatch attempts. 4) tests cover happy path, write success/read fail, and idempotent retry path.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:04:48.190089+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:08:38.406116+01:00","closed_at":"2026-02-11T19:08:38.406116+01:00","close_reason":"Enforced save handshake states (saved_verified|pending|failed), added idempotent retry receipt recovery, and extended handshake telemetry/quality signals with tests.","dependencies":[{"issue_id":"kura-training-pdc.5","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T17:04:48.191429+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.6","title":"Intent-aware Visualization Policy + Data-bound Specs","description":"Enable visualizations only when they improve clarity (not by default). Problem: purely textual explanations can hide misunderstandings in timeline/progression/planning topics, but always-on visualization creates noise. Goal: add policy-driven, data-bound visualization support with safe fallbacks.","design":"Add visualization decision policy based on user intent, complexity, and preference. Require a structured visualization_spec before rendering (chart/table/timeline/ascii/mermaid), bound to projection data and timezone context. Enforce explicit uncertainty labels when data quality is low. Include deterministic fallback path (ASCII/text) when rich rendering is unavailable.","acceptance_criteria":"1) Policy decides visualize vs no-visualize using explicit triggers (trend/compare/plan-vs-actual/multi-week scheduling) and supports user preference override. 2) Agent emits structured visualization_spec with declared data sources and purpose before rendering. 3) Renderer rejects specs without resolvable projection references. 4) Fallback output exists (ASCII or plain structured summary) with equivalent meaning. 5) Telemetry events added: viz_shown, viz_skipped, viz_source_bound, viz_fallback_used, viz_confusion_signal. 6) Tests cover positive trigger, negative trigger, invalid spec rejection, and fallback behavior.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T17:10:42.101286+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T22:09:09.235388+01:00","closed_at":"2026-02-11T22:09:09.235388+01:00","close_reason":"Implemented intent-aware visualization policy with structured visualization_spec validation, strict projection source binding, deterministic ASCII fallback, viz telemetry signals, and unit/contract tests.","dependencies":[{"issue_id":"kura-training-pdc.6","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T17:10:42.102275+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.6","depends_on_id":"kura-training-pdc.3","type":"blocks","created_at":"2026-02-11T17:12:16.009893+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.6","depends_on_id":"kura-training-2zc.1","type":"blocks","created_at":"2026-02-11T17:12:26.285834+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.7","title":"Training Core Fields V1: rest_seconds + modality-aware set context","description":"Ensure core training fields are captured from day 1 across relevant modalities. Field test showed that rest time was explicitly mentioned but not logged because it was not treated as baseline schema guidance, causing avoidable data loss and user correction loops. Goal: define and enforce a core field profile for set logging (including rest_seconds) with mention-to-field capture rules.","design":"Reference Decision 13 domain gap closure. Introduce modality-aware core field matrix (e.g., strength/oly/hypertrophy) with default fields such as reps, load/time/distance, RPE/RIR, rest_seconds, set_type/warmup-context where applicable. Add extraction rules so explicit user mentions (e.g., 'Pause 90 sec') are mapped proactively. Surface missing-core-field hints via quality checks instead of relying on ad-hoc agent memory.","acceptance_criteria":"1) Define a modality-aware core-field registry with field classes: required, optional, and mention-bound.\n2) `rest_seconds` is optional by default, but becomes mandatory to persist when the user explicitly mentions a pause/rest value.\n3) Session-default rule is enforced: a mentioned set-context value (e.g., rest, effort, tempo) applies to subsequent relevant sets in the same exercise until overridden.\n4) Mention→field extraction is deterministic (synonyms/units covered) and does not require an extra user reminder.\n5) Agent must not fabricate optional values; absent mention keeps the field unset/null.\n6) Quality/invariant checks flag mention-present/field-missing cases and provide remediation hints.\n7) Tests cover mention→field mapping, session-default propagation, and `rest_seconds` regression.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:28:10.188947+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:16:28.157933+01:00","closed_at":"2026-02-11T19:16:28.157933+01:00","close_reason":"Added modality-aware core-field registry, deterministic mention→field extraction, session-default propagation for mention-bound context, and quality invariant detection for mention-field mismatches.","dependencies":[{"issue_id":"kura-training-pdc.7","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T18:28:10.189956+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.7","depends_on_id":"kura-training-pdc.4","type":"blocks","created_at":"2026-02-11T18:28:41.295961+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.8","title":"Session Feedback Standardization: session.completed convention + projection","description":"Standardize post-session subjective feedback as first-class data instead of orphaned event types. Field test showed 'training felt good/fun' was logged as session.completed but remained orphaned, limiting longitudinal analysis and recommendation quality. Goal: define a canonical session feedback event convention and projection support.","design":"Add documented event convention for session completion/feedback with fields for enjoyment, perceived quality, perceived exertion summary, pain/discomfort signal, and free-text context. Implement a projection that aggregates these signals over time and exposes coach-relevant patterns (e.g., enjoyment trend, load-to-enjoyment alignment). Keep flexible text while ensuring baseline structured fields.","acceptance_criteria":"1) session feedback event type is documented in event conventions (no orphan status in normal flow). 2) Handler/projection surfaces session feedback trends over time. 3) Agent can reference this projection for planning adaptations. 4) Existing orphaned session.completed events can be mapped/handled without data loss where feasible. 5) Tests cover ingestion, projection output, and trend aggregation.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:28:27.408323+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:49:17.894205+01:00","closed_at":"2026-02-11T19:49:17.894205+01:00","close_reason":"Added session.completed convention + session_feedback projection (trend and load alignment), API context/simulation integration, legacy payload normalization, and ingestion/output/trend tests.","dependencies":[{"issue_id":"kura-training-pdc.8","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T18:28:27.409243+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.8","depends_on_id":"kura-training-pdc.7","type":"blocks","created_at":"2026-02-11T18:28:51.583428+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pdc.9","title":"Repair Provenance Contract: source confidence and scope","description":"Repairs currently flatten certainty into final values and hide whether fields were explicit, inferred, or estimated. This reduces auditability and can silently overstate data quality. Add a repair provenance contract so every corrected field keeps origin and confidence metadata.","design":"Introduce structured repair metadata for corrected events/fields: source_type (explicit|inferred|estimated|user_confirmed), confidence (0..1 or band), repair_reason, and applies_scope (single_set|exercise_session|session). Ensure projection surfaces both effective value and provenance state for downstream policy and UI decisions.","acceptance_criteria":"1) Event conventions define provenance fields for repaired values.\n2) Any repair operation persists provenance metadata per corrected field or correction bundle.\n3) Projections expose provenance in machine-readable form without breaking old consumers.\n4) Quality checks can filter high-confidence vs low-confidence repairs.\n5) Tests cover explicit, inferred, and user-confirmed repair paths.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T18:45:05.03608+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T19:20:48.708949+01:00","closed_at":"2026-02-11T19:20:48.708949+01:00","close_reason":"Implemented repair provenance contract (source_type/confidence/scope/reason), exposed provenance in repair proposals/events, and added confidence-based repair filtering with tests.","dependencies":[{"issue_id":"kura-training-pdc.9","depends_on_id":"kura-training-pdc","type":"parent-child","created_at":"2026-02-11T18:45:05.0371+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-pdc.9","depends_on_id":"kura-training-pdc.7","type":"blocks","created_at":"2026-02-11T18:45:05.037971+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-pef","title":"Onboarding: Kommunikationsstil und Erfahrungslevel als Profilfelder","description":"context_seeds in Decision 8 sehen Felder wie communication_style, experience_level, language vor, aber sie existieren noch nicht konkret. profile.updated muss diese Felder verstehen. Agent soll Stil anpassen können basierend auf Nutzerpräferenz. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:36:14.139981+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:30:01.851196+01:00","closed_at":"2026-02-10T07:30:01.851196+01:00","close_reason":"communication_style als Freitext-Feld in profile.updated + coverage_area communication_preferences im interview_guide. Sprache nicht nötig (ergibt sich aus Kontext)."}
{"id":"kura-training-pl5","title":"Convention: empty projections vs early return","description":"Handlers return early when no events exist, so dimensions never appear in manifest for new users. Need convention: should handlers create empty projections with zero/null values so the agent can discover that the dimension exists but has no data? Affects training_timeline and exercise_progression.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-08T15:18:34.984294+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:17:21.712622+01:00","closed_at":"2026-02-09T08:17:21.712622+01:00","close_reason":"Convention established: no empty projections. System layer declares existence (dimension_meta), user layer shows 'no_data'. Already implemented in _build_user_dimensions()."}
{"id":"kura-training-prz","title":"Web: Request Access Seite + Early Access Messaging","description":"## Was\n/request-access Seite im Web-Frontend. Ersetzt \"Konto erstellen\" als primären CTA.\n\n## Seite: /request-access\n- Route: web/src/app/[locale]/(inner)/request-access/\n- i18n: de + en (ja optional)\n\n### Inhalt\n- Headline: \"Early Access\" / \"Früher Zugang\"\n- Subtext (klar und ehrlich):\n  \"Kura ist in aktiver Entwicklung. Als Early-Access-Nutzer bekommst du kostenlosen, vollständigen Zugang — und hilfst dabei, das System besser zu machen. Deine Trainingsdaten fließen anonymisiert in die Verbesserung der Algorithmen ein.\"\n- Formular:\n  - Email (required)\n  - Name (optional)\n  - \"Was trainierst du?\" / \"What do you train?\" (optional, textarea)\n  - Submit: \"Zugang anfragen\" / \"Request Access\"\n- Erfolgs-State: \"Wir melden uns bei dir.\" / \"We'll be in touch.\"\n\n### Tonalität\n- Ehrlich, nicht Marketing-speak\n- Klar machen: kostenlos, vollständig, man hilft mit\n- Nicht: \"exklusiv\", \"limitiert\", künstliche Verknappung\n\n## Landing Page Anpassung\n- CTA Button: \"Request Access\" statt \"Konto erstellen\"\n- Signup-Links in Header/Footer → /request-access\n- /signup bleibt erreichbar (für Invite-Links), ist aber nicht direkt verlinkt\n\n## Design\n- Gleiche Ästhetik wie Auth-Seiten (butter yellow auf schwarz)\n- auth.module.css Patterns wiederverwenden\n- Einfach, focused, kein Overdesign","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:45:44.986664+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:12:55.802355+01:00","closed_at":"2026-02-13T13:12:55.802355+01:00","close_reason":"Request Access page created, landing/header/start CTAs updated, i18n de+en","dependencies":[{"issue_id":"kura-training-prz","depends_on_id":"kura-training-87v","type":"blocks","created_at":"2026-02-13T12:47:05.984336+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-prz","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:47.437584+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc","title":"Privacy-by-Default Auth v1: Identitaet entkoppeln, Daten nutzbar halten","description":"Kura verarbeitet sensible Trainings- und Gesundheitsdaten. Aktuell sind Konto-Identitaet und Fachdaten nur teilweise entkoppelt: users enthaelt email/password_hash, Auth-Flows sind email+password + PKCE loopback, es gibt keine provider identities fuer Google/Apple, keinen Device-Code-Flow fuer CLI/MCP und keinen kontrollierten Break-Glass Re-Identifikationspfad. Ziel: Plain Trainingsdaten fuer Modellverbesserung behalten, Personenbezug im Alltag minimieren.","design":"Ausgangslage im Code: migrations/20260209000001_auth_tables.sql, api/src/routes/auth.rs, api/src/auth.rs, cli/src/commands/auth.rs, migrations/20260207000001_create_events.sql, migrations/20260225000001_provider_connections.sql. Umsetzung in 6 Teilpaketen: (1) Identity-Datenmodell entkoppeln, (2) Auth API refactor auf identities, (3) Device Authorization Flow, (4) OIDC Google/Apple, (5) Break-Glass + Audit, (6) pseudonymisierte Analytics/Debug-Pfade. Sicherheitsprinzip: pseudonymized-by-default, re-identification nur kontrolliert und auditiert.","acceptance_criteria":"1) Child-Tasks mit klaren Dependencies sind angelegt. 2) Jede Aufgabe hat Why/How und konkrete Einstiegspunkte. 3) Zielbild deckt Email+Apple+Google sowie Code-basierte Auth fuer CLI/MCP ab. 4) Personenbezug ist standardmaessig von Trainingsdaten getrennt.","notes":"COMPACTION-SAFE BRIEF\nGoal: Privacy-by-default Auth/Identity ohne Verlust der trainingsbezogenen Datenqualität.\n\nInvarianten (muessen immer gelten):\n1) Events/Projections bleiben primär datenorientiert (keine Namens-/Email-Abhaengigkeit).\n2) Identitaetsmapping ist separiert und kontrolliert.\n3) Re-Identifikation ist Ausnahmefluss mit Audit.\n\nNicht-Ziele:\n- Kein Data-Obfuscation-Produkt, kein Entfernen wertvoller Trainingssignale.\n- Keine breite UI-Neuimplementierung; API/CLI zuerst.\n\nEmpfohlene Umsetzungsreihenfolge:\nqlc.1 -\u003e qlc.2 -\u003e (qlc.3 + qlc.4) -\u003e qlc.5 -\u003e qlc.6\n\nKritische Touchpoints:\nmigrations/20260209000001_auth_tables.sql, api/src/routes/auth.rs, api/src/auth.rs, cli/src/commands/auth.rs, cli/src/util.rs, api/src/routes/events.rs, api/src/routes/projections.rs\n\nAbbruchkriterien:\n- Wenn auth token issuance oder RLS scope regressions auftreten, sofort stoppen und zuerst qlc.2 stabilisieren.\n- Keine stillen schema changes ohne migration/test/backfill-plan.\n\nDefinition of Done (Programm-Ebene):\n- Email+Google+Apple login flows funktionieren und sind sicher verknuepft.\n- CLI/MCP koennen via Device Code authentifizieren.\n- Standard-Debug/Analytics bleibt pseudonymisiert; re-identification nur via audited break-glass.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:51:34.312746+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:23:23.812142+01:00","closed_at":"2026-02-12T21:23:23.812142+01:00","close_reason":"Completed Privacy-by-Default Auth v1 program end-to-end (schema split, identity-based auth, device flow, OIDC google/apple linking, break-glass audit path, pseudonymous debug surfaces). Validation: cargo test --workspace, ruff check, workers unit tests, workers integration tests all green."}
{"id":"kura-training-qlc.1","title":"Schema v1: user_identities, analysis_subjects und support_access_audit","description":"Baue das Datenmodell fuer Identity-Entkopplung und privacy-by-default Debugging. Problem heute: users traegt Identitaet direkt, es gibt kein dediziertes Identity-Register, keine stabile pseudonyme Analyse-ID und keinen Audit-Container fuer kontrollierte Re-Identifikation.","design":"Migrationen fuer: user_identities (user_id, provider, provider_subject, email_norm, email_verified_at, created_at, updated_at, constraints auf provider+subject), analysis_subjects (user_id, analysis_subject_id, rotation_version), support_access_audit (actor, target_user_id, reason, ticket_id, requested_mode, ttl, created_at). Backfill fuer bestehenden email/password Bestand aus users -\u003e provider=email_password. Keine PII-Erweiterung in events/projections.","acceptance_criteria":"1) Tabellen + Constraints + Grants + Indizes sind implementiert. 2) Backfill-Migration laeuft idempotent auf bestehender DB. 3) events/projections bleiben frei von Name/Email-Feldern. 4) Tests decken uniqueness, collision und backfill korrekt ab.","notes":"COMPACTION-SAFE EXECUTION NOTES\nPrimary objective: Introduce identity and pseudonym mapping tables without breaking existing auth/event flows.\n\nSchema scope (required):\n- user_identities(user_id, provider, provider_subject, email_norm, email_verified_at, created_at, updated_at)\n- analysis_subjects(user_id, analysis_subject_id, rotation_version, timestamps)\n- support_access_audit(actor, target_user_id, reason, ticket_id, requested_mode, ttl/expires_at, created_at, immutable)\n\nBackfill rules:\n- Existing users -\u003e user_identities provider=email_password, provider_subject=normalized email\n- Existing users -\u003e analysis_subjects deterministic/stable generated id\n\nMust not break:\n- users table compatibility for current code path\n- event/projection schemas and RLS policies\n\nVerification:\n- migration up on existing DB\n- unique constraints and duplicates tested\n- backfill idempotent rerun tested\n\nCommon pitfall:\n- adding constraints before backfill causes migration failure; backfill first, then tighten.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:51:50.995588+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:22:52.609457+01:00","closed_at":"2026-02-12T21:22:52.609457+01:00","close_reason":"Implemented identity/privacy schema foundation: added migrations 20260228000001_identity_privacy_foundation.sql and 20260228000002_oauth_device_codes.sql; created user_identities, analysis_subjects, support_access_audit, oauth_device_codes with indexes/grants and idempotent backfill for existing users.","dependencies":[{"issue_id":"kura-training-qlc.1","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T20:51:50.996602+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc.2","title":"Auth API Refactor: Email-Login ueber user_identities + sichere Linking-Regeln","description":"Stelle Register/Authorize auf identity-basierte Aufloesung um. Problem heute: Login bindet direkt an users.email. Das verhindert sauberes Multi-Provider-Linking und erschwert datenschutzfreundliche Trennung von Konto und Identitaet.","design":"api/src/routes/auth.rs refactoren: register erzeugt user + user_identities(provider=email_password). authorize_submit sucht Identitaet ueber provider/email_norm und validiert password_hash am zugeordneten user. Token-Issuance/Scopes in api/src/auth.rs bleiben kompatibel. Fuehre maschinenlesbare Fehler fuer identity collision, inactive account und linking conflict ein.","acceptance_criteria":"1) /v1/auth/register und /v1/auth/authorize funktionieren ueber user_identities. 2) Bestehende CLI- und OAuth-Code-Flow Funktionalitaet bleibt kompatibel. 3) Kollisionen/Conflict-Faelle geben strukturierte API-Errors zurueck. 4) DB- und Handler-Tests decken success + edge cases ab.","notes":"COMPACTION-SAFE EXECUTION NOTES\nPrimary objective: Move register/authorize lookup to user_identities while keeping token issuance compatible.\n\nImplementation contract:\n- register: create user + insert email_password identity atomically\n- authorize_submit: resolve via user_identities(email_norm, provider=email_password), then verify password hash\n- return machine-readable collisions/errors for identity conflicts\n\nMust preserve:\n- existing token format prefixes kura_at_/kura_rt_\n- existing scope enforcement in api/src/auth.rs\n- CLI login compatibility\n\nPitfalls:\n- dual source of truth between users.email and user_identities.email_norm\n- missing transaction around user + identity insert\n\nVerification:\n- register duplicate email conflict\n- authorize invalid email/password\n- authorize success + token exchange remains functional.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:52:05.946281+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:22:57.82299+01:00","closed_at":"2026-02-12T21:22:57.82299+01:00","close_reason":"Refactored auth to identity-based resolution: api/src/routes/auth.rs register now writes users+user_identities atomically and authorize resolves via user_identities(email_norm). Updated cli/src/commands/admin.rs create-user to also create email_password identity.","dependencies":[{"issue_id":"kura-training-qlc.2","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T20:52:05.947325+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.2","depends_on_id":"kura-training-qlc.1","type":"blocks","created_at":"2026-02-12T20:53:16.531717+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc.3","title":"OAuth Device Authorization Flow fuer CLI/MCP (user_code in Web-UI)","description":"Implementiere den Code-basierten Login fuer Umgebungen ohne Browser-Callback. Problem heute: cli/src/commands/auth.rs nutzt nur Loopback-Callback. Fuer MCP/headless Nutzung wird ein Device-Flow mit user_code benoetigt.","design":"Fuege Endpunkte fuer Device Flow hinzu (device authorize, device verify, device token polling) inkl. DB-Tabelle fuer device codes, Expiry, Polling-Interval, approved/denied Status und one-time use. CLI erweitert um den Modus kura login --device (zeigt verification_uri + user_code, pollt token endpoint). Web-UI Verification Screen in /auth Bereich zum Eingeben und Bestaetigen des Codes.","acceptance_criteria":"1) End-to-end Device Flow funktioniert fuer CLI und MCP-Token-Beschaffung. 2) Codes sind kurzlebig, rate-limited, brute-force-resistent. 3) Polling liefert RFC-konforme Pending/SlowDown/Denied/Expired Antworten. 4) Integrationstests decken Happy Path + expiry + deny + replay ab.","notes":"CLOSED IMPLEMENTATION DETAILS\n- API: /v1/auth/device/authorize, /v1/auth/device/verify (GET/POST), /v1/auth/device/token in api/src/routes/auth.rs\n- Schema: oauth_device_codes table in migration 20260228000002_oauth_device_codes.sql\n- CLI: new device flow path via `kura login --device` in cli/src/commands/auth.rs and cli/src/main.rs\n- Behavior: browser code entry + polling + pending/slow_down/expired/denied handling.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:52:18.814648+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:23:38.146805+01:00","closed_at":"2026-02-12T21:23:03.021607+01:00","close_reason":"Implemented OAuth device flow end-to-end: API routes /v1/auth/device/authorize, /v1/auth/device/verify (GET/POST), /v1/auth/device/token; CLI supports  polling flow in cli/src/commands/auth.rs and flag wiring in cli/src/main.rs.","dependencies":[{"issue_id":"kura-training-qlc.3","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T20:52:18.815498+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.3","depends_on_id":"kura-training-qlc.2","type":"blocks","created_at":"2026-02-12T20:53:21.734094+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc.4","title":"OIDC Login und Linking fuer Google + Apple (subject-basiert)","description":"Ergaenze federierte Anmeldung fuer Google und Apple mit sicherem Account-Linking. Problem heute: es gibt nur email/password Login, kein provider-subject Mapping und keine robuste Collision-Policy fuer bestehende Konten.","design":"Implementiere OIDC Code-Flow fuer Google/Apple inkl. Discovery/JWKS Validation serverseitig. Speichere provider_subject (sub claim) in user_identities; nutze email nur als UX-Hinweis, nicht als primaeren Schluessel. Definiere klare Linking-Regeln: verified-email Pflicht fuer Auto-Linking, sonst explizite Nutzerbestaetigung; niemals Blind-Linking nur auf unverified email.","acceptance_criteria":"1) Google und Apple Login funktionieren Ende-zu-Ende mit sicherer Token-Verifikation. 2) Neue und bestehende Konten werden korrekt erstellt/verknuepft. 3) Collision/Takeover-Faelle sind fail-closed und auditierbar. 4) Tests decken valid/invalid token, key rotation, link conflicts ab.","notes":"COMPACTION-SAFE EXECUTION NOTES\nPrimary objective: Implement secure Google/Apple sign-in linked by provider subject (sub), not by mutable email.\n\nRequired behavior:\n- verify OIDC token integrity and claims (iss/aud/exp + signature or equivalent trusted verification path)\n- identity key = (provider, provider_subject)\n- email used for UX and optional linking only when verified\n\nLinking policy:\n- if provider+subject exists -\u003e login existing user\n- if not exists and verified email maps exactly one user -\u003e link identity to that user\n- otherwise create account or fail-closed on ambiguity\n\nPitfalls:\n- account takeover via unverified email linking\n- accepting tokens with wrong audience or issuer\n\nVerification:\n- valid/invalid tokens\n- existing account linking\n- ambiguity conflict path with structured error.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:52:34.415752+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:23:08.21744+01:00","closed_at":"2026-02-12T21:23:08.21744+01:00","close_reason":"Implemented OIDC Google/Apple login+linking endpoint /v1/auth/oidc/{provider}/login with JWT verification via provider JWKS, issuer/audience checks, provider_subject linking in user_identities, and conflict-safe linking behavior. Added oauth web client seed migration 20260228000003_oauth_web_client.sql.","dependencies":[{"issue_id":"kura-training-qlc.4","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T20:52:34.416722+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.4","depends_on_id":"kura-training-qlc.1","type":"blocks","created_at":"2026-02-12T20:53:26.933442+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.4","depends_on_id":"kura-training-qlc.2","type":"blocks","created_at":"2026-02-12T20:53:32.129536+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc.5","title":"Break-Glass Re-Identifikation: Pflichtgrund, Ticket und unveraenderbares Audit","description":"Ermoegliche gezielte Rueckverfolgung user_id -\u003e PII nur fuer Incident/Support und nur kontrolliert. Problem heute: Es gibt keinen dedizierten Prozess, der notwendige Ausnahmezugriffe begruendet, begrenzt und revisionssicher protokolliert.","design":"Implementiere eingeschraenkten Admin-Support-Path (Endpoint oder CLI-Command) mit verpflichtenden Feldern reason, ticket_id, access_scope, expires_at. Jeder Zugriff schreibt einen immutable support_access_audit Eintrag. Standard-Debug- und Analysepfade bleiben pseudonymisiert und geben keine Email/Namen zurueck. Optional: feature flag fuer dual-control/approval in spaeteren Ausbaustufen.","acceptance_criteria":"1) Ohne reason/ticket kein Re-Identifikationszugriff. 2) Jeder Zugriff wird manipulationssicher auditiert. 3) Rueckgabe ist minimal (nur benoetigte PII). 4) Runbook fuer Incident/Support dokumentiert und testbar.","notes":"COMPACTION-SAFE EXECUTION NOTES\nPrimary objective: Controlled exceptional re-identification path (user_id -\u003e PII) with immutable auditing.\n\nRequired contract:\n- request must include reason + ticket_id + scope + expiry\n- every call writes immutable support_access_audit row\n- default operational endpoints remain pseudonymized\n\nSecurity model:\n- minimal data return\n- deny when required metadata missing\n- explicit admin capability check\n\nPitfalls:\n- hidden backdoor endpoints returning email directly\n- mutable/deletable audit rows\n\nVerification:\n- request rejected without reason/ticket\n- successful flow leaves audit trail\n- returned payload is minimal and scoped.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:52:47.686119+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:23:13.415432+01:00","closed_at":"2026-02-12T21:23:13.415432+01:00","close_reason":"Implemented audited break-glass re-identification: POST /v1/admin/support/reidentify in api/src/routes/account.rs with admin check, required reason/ticket/mode validation, immutable support_access_audit insert, and minimal identity response payload.","dependencies":[{"issue_id":"kura-training-qlc.5","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T20:52:47.687333+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.5","depends_on_id":"kura-training-qlc.1","type":"blocks","created_at":"2026-02-12T20:53:37.331252+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc.6","title":"Pseudonymisierte Lern- und Debug-Views fuer Systemverbesserung","description":"Sorge dafuer, dass Modellverbesserung und Debugging ohne Namensbezug funktionieren. Problem heute: Es gibt keine explizite analytics_subject_id Schicht, dadurch ist privacy-by-default fuer Lern-Workflows nicht sauber erzwungen.","design":"Fuehre analysis_subject_id als stabile pseudonyme Referenz ein (mapping zu user_id im separaten Bereich). Passe Analytics/Support-Queries und relevante Projektionen so an, dass standardmaessig nur analysis_subject_id ausgegeben wird. Definiere Redaction-Regeln fuer Freitextfelder in Debug-Exports.","acceptance_criteria":"1) Standard-Analysepfade funktionieren ohne direkte PII. 2) Trainingsdaten bleiben inhaltlich voll nutzbar (kein Informationsverlust fuer Modellverbesserung). 3) Exporte/Views enthalten keine Email/Namen. 4) Dokumentierte Query-Patterns fuer pseudonymisierte Auswertung vorhanden.","notes":"COMPACTION-SAFE EXECUTION NOTES\nPrimary objective: Keep learning/debug value while removing default person-linkability.\n\nRequired behavior:\n- standard analytics/debug outputs use analysis_subject_id\n- no plain email/name in default query/export paths\n- preserve raw training signal fidelity (no loss in reps/weight/timestamps etc.)\n\nImplementation hints:\n- add helper/mapping layer user_id -\u003e analysis_subject_id\n- update selected read endpoints or dedicated debug endpoints to emit pseudonymous subject\n- redact high-risk free-text fields in debug export mode\n\nPitfalls:\n- accidental exposure via nested JSON or legacy endpoints\n- unstable pseudonym ids breaking longitudinal analysis\n\nVerification:\n- before/after output diff: signal preserved, PII removed\n- deterministic/stable subject mapping across sessions.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T20:53:00.657812+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:23:18.614069+01:00","closed_at":"2026-02-12T21:23:18.614069+01:00","close_reason":"Implemented pseudonymized analysis/debug surfaces: added api/src/privacy.rs helper for stable analysis_subject_id, exposed GET /v1/account/analysis-subject, and added x-kura-analysis-subject header to events/projections read responses for default pseudonymous debugging.","dependencies":[{"issue_id":"kura-training-qlc.6","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T20:53:00.658656+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.6","depends_on_id":"kura-training-qlc.1","type":"blocks","created_at":"2026-02-12T20:53:42.527609+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.6","depends_on_id":"kura-training-qlc.5","type":"blocks","created_at":"2026-02-12T20:53:47.722285+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-qlc.7","title":"Privacy/Auth v1 Hardening: OIDC re-login, device deny, deletion safety","description":"Harte Kanten in Privacy/Auth v1 schließen: OIDC-Re-Login ohne email-claim (Apple), echter Device-deny-Pfad, stabile analysis_subject-Erzeugung bei neuen Accounts, und DB-Deletion-Haertung fuer oauth_device_codes/support_access_audit.","design":"Gezielte Hardening-Aenderungen in API/CLI/Migrationen ohne Breaking Changes: oidc_login fail-closed fuer first-linking ohne verified email; bestehende provider-subject Links funktionieren auch ohne erneuten email-claim. Device verify erlaubt approve/deny mit poll-seitigem access_denied. Neue Migration entfernt support_access_audit FK-Cascade, setzt oauth_device_codes approved_user FK auf ON DELETE SET NULL und aktualisiert delete_user_account().","acceptance_criteria":"1) Existing OIDC subject links funktionieren ohne email claim; first-time linking verlangt verified email. 2) Device flow erzeugt realen denied-Status und CLI bekommt access_denied. 3) Neue Accounts erhalten analysis_subject deterministisch via insert-on-conflict path. 4) Account deletion blockiert nicht wegen oauth_device_codes; support_access_audit bleibt append-only ueber user deletion hinweg. 5) Alle verpflichtenden Quality-Gates gruen.","notes":"COMPACTION-SAFE NOTES\n\nZiel\n- Privacy-by-default Auth Identity v1 auf production-grade Robustheit haerten, ohne Verlust von Trainingssignal-Qualitaet.\n\nInvarianten\n- Identity-Key bleibt provider+subject; kein unsicheres Linking ueber unverified email.\n- Token und Scope Mechanik bleibt kompatibel zu bestehenden CLI/API Flows.\n- Break-glass Audit Historie bleibt append-only und ueberlebt Account-Loeschungen.\n\nNon-Goals\n- Kein kompletter Login Signup UI-Neubau.\n- Keine Aenderung am Event oder Projection Datenmodell fuer Trainingsinhalte.\n\nKonkrete Touchpoints\n- migrations/20260228000004_identity_privacy_hardening.sql\n- api/src/routes/auth.rs\n- api/src/privacy.rs\n- cli/src/commands/admin.rs\n\nTypische Pitfalls\n- Apple Re-Login kann ohne email claim kommen; bestehender subject-link darf nicht fehlschlagen.\n- Device denied nur im CLI zu behandeln reicht nicht; API muss status denied wirklich setzen.\n- FK Cascade auf Audit Tabellen kann Historie implizit loeschen.\n\nVerifikationsschritte\n- cargo fmt --all\n- cargo test --workspace\n- ruff check workers/src/ workers/tests/\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q\n\nReihenfolge Abhaengigkeiten\n- Migration Hardening zuerst, dann API Hardening OIDC Device, dann analysis_subject on-create Pfade, danach komplette Quality Gates.\n- Depends on kura-training-qlc.1 kura-training-qlc.3 kura-training-qlc.4 kura-training-qlc.5\n\nCOMPLETION NOTES\n\nGeaenderte Dateien\n- api/src/privacy.rs\n- api/src/routes/auth.rs\n- cli/src/commands/admin.rs\n- migrations/20260228000004_identity_privacy_hardening.sql\n\nTests und Ergebnisse\n- cargo fmt --all -\u003e OK\n- cargo test --workspace -\u003e OK (171 api + 19 cli + 10 core tests passed)\n- ruff check workers/src/ workers/tests/ -\u003e OK\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py -\u003e OK (570 passed)\n- PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/test_integration.py -q -\u003e OK (80 passed)\n\nErgebnis\n- OIDC subject-linked accounts koennen ohne erneuten email claim einloggen; first-linking bleibt fail-closed auf verified email.\n- Device verify unterstuetzt approve und deny, und token polling liefert access_denied bei denied status.\n- Analysis subject IDs werden bei Register Admin-Create und OIDC-Login via insert-on-conflict abgesichert.\n- Account deletion wird nicht von oauth_device_codes blockiert; support_access_audit bleibt ohne FK-Cascade erhalten.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-12T21:47:42.016537+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T21:48:47.767976+01:00","closed_at":"2026-02-12T21:48:47.767976+01:00","close_reason":"Implemented hardening pass for OIDC re-login, device deny flow, analysis_subject on-create, and deletion/audit schema safety; all required quality gates passed.","dependencies":[{"issue_id":"kura-training-qlc.7","depends_on_id":"kura-training-qlc","type":"parent-child","created_at":"2026-02-12T21:47:42.017829+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.7","depends_on_id":"kura-training-qlc.1","type":"blocks","created_at":"2026-02-12T21:47:42.018767+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.7","depends_on_id":"kura-training-qlc.3","type":"blocks","created_at":"2026-02-12T21:47:42.019461+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.7","depends_on_id":"kura-training-qlc.4","type":"blocks","created_at":"2026-02-12T21:47:42.020062+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-qlc.7","depends_on_id":"kura-training-qlc.5","type":"blocks","created_at":"2026-02-12T21:47:42.020663+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-r7z","title":"Model Eval Harness: Replay, Calibration, und Shadow-Mode für Inference","description":"Create an evaluation harness for semantic resolution and Bayesian projections with offline replay, interval calibration metrics, error taxonomy, and shadow-mode rollout checks before enabling autonomous behavior changes.","notes":"Required for high-confidence innovation velocity without regressions.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T08:36:55.196745+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T12:43:51.514049+01:00","closed_at":"2026-02-11T12:43:51.514049+01:00","close_reason":"Implemented replay harness (projection_history + event_store), semantic + calibration metrics, inference telemetry taxonomy, shadow-mode rollout checks, and persistent eval run/artifact versioning with tests.","labels":["mlops","quality","testing"]}
{"id":"kura-training-rod","title":"Plan-vs-Ist Vergleich ermöglichen","description":"Agent muss wissen: Welches Training steht als nächstes an? Was wurde diese Woche schon gemacht? Aktuell muss er Plan + training_timeline manuell abgleichen. Mögliche Lösungen: (1) training_timeline bekommt sessions_this_week Feld mit Plan-Matching, (2) Agent-seitige Komposition aus Plan + Timeline (dann braucht es den Snapshot-Endpoint). Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:58.427759+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:41:04.547731+01:00","closed_at":"2026-02-10T07:41:04.547731+01:00","close_reason":"By design gelöst: Snapshot-Endpoint + recent_sessions mit Top-Sets + training_plan geben dem Agent alle Daten für Plan-vs-Ist. Agent-seitige Komposition ist hier die bessere Architektur als Cross-Dimension-Coupling.","dependencies":[{"issue_id":"kura-training-rod","depends_on_id":"kura-training-7an","type":"blocks","created_at":"2026-02-09T21:43:06.797537+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-s9z","title":"Rate Limiting on auth endpoints","description":"Add rate limiting to /v1/auth/register, /v1/auth/authorize, and /v1/auth/token to prevent brute-force attacks. Production security requirement.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T11:00:00.753215+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T11:16:10.39203+01:00","closed_at":"2026-02-08T11:16:10.39203+01:00","close_reason":"Closed"}
{"id":"kura-training-siq","title":"Antifragile Reliability V1: Root-Cause Defenses against User/Model Variance","description":"Address reliability as a systems problem (not case-by-case patching). Goal: make Kura robust under 1000 users x 1000 communication styles via executable contracts, adversarial testing, and runtime degradation strategies.","design":"Use proven software engineering patterns together: (1) property-based/fuzz testing for conversation-\u003eevent contracts, (2) schema capability gates + fail-fast/fail-soft runtime controls, (3) typed certainty state machine (confirmed/inferred/unresolved) enforced by server contracts, (4) semantic comparability model for load/equipment context, (5) incident-\u003etest auto-promotion to continuously harden unknown unknowns.","acceptance_criteria":"1) Reliability strategy documented as executable architecture work-items, not prose only. 2) Core failure classes (certainty inflation, semantic comparability drift, projection/schema mismatch, pending-verification ambiguity) each have implementation tracks with measurable outcomes. 3) Rollout order and dependency graph defined. 4) At least one transcript-derived scenario is mapped into regression assets. 5) Work remains compatible with wvp/m3k roadmap and does not bypass existing safety invariants.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:41:01.071917+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T07:21:48.058267+01:00","closed_at":"2026-02-14T07:21:48.058267+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-siq","depends_on_id":"kura-training-2zc","type":"blocks","created_at":"2026-02-13T12:41:01.073445+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq","depends_on_id":"kura-training-wvp.3","type":"blocks","created_at":"2026-02-13T12:41:01.074483+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1","title":"Adversarial Conversation Fuzzing Harness for Agent Write Contracts","description":"Build a generator-driven test harness that produces diverse user utterances, ambiguity, contradictions, locale variants, and correction patterns, then validates conversation-to-event behavior against invariants.","design":"Adopt property-based testing and metamorphic testing principles. Generate multilingual and noisy utterance variants, execute write-with-proof flows, and assert invariant properties (no false saved claim, bounded clarification count, deterministic correction behavior, no silent certainty escalation). Store failing seeds as permanent regression fixtures.","acceptance_criteria":"1) Harness generates randomized scenarios with reproducible seeds. 2) Core invariants are codified as machine assertions. 3) CI runs deterministic seed sets and fails on invariant violations. 4) Failing seeds auto-export into scenario fixtures for m3k.3. 5) Coverage report includes ambiguity, contradiction, and correction classes.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:41:32.598862+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:11:52.090922+01:00","closed_at":"2026-02-13T14:11:52.090922+01:00","close_reason":"All 6 sub-tasks complete. 80 fuzzing tests across 3 layers.","dependencies":[{"issue_id":"kura-training-siq.1","depends_on_id":"kura-training-siq","type":"parent-child","created_at":"2026-02-13T12:41:32.599715+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1","depends_on_id":"kura-training-m3k.3","type":"blocks","created_at":"2026-02-13T12:41:32.600859+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1","depends_on_id":"kura-training-veh","type":"blocks","created_at":"2026-02-13T12:41:32.601736+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1.1","title":"Foundation: contracts, strategies, assertions, conftest, deps","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:57:58.990625+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:02:52.68907+01:00","closed_at":"2026-02-13T14:02:52.68907+01:00","close_reason":"Foundation: contracts.py, strategies.py, assertions.py, conftest.py, hypothesis+httpx deps","dependencies":[{"issue_id":"kura-training-siq.1.1","depends_on_id":"kura-training-siq.1","type":"parent-child","created_at":"2026-02-13T13:57:58.991848+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1.2","title":"Layer 1 Core Invariants: set, retraction, correction, rules","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:58:04.2575+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:06:19.705881+01:00","closed_at":"2026-02-13T14:06:19.705881+01:00","close_reason":"31 property tests: set, retraction, correction, rules, plausibility","dependencies":[{"issue_id":"kura-training-siq.1.2","depends_on_id":"kura-training-siq.1","type":"parent-child","created_at":"2026-02-13T13:58:04.258897+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.2","depends_on_id":"kura-training-siq.1.1","type":"blocks","created_at":"2026-02-13T13:58:35.613467+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1.3","title":"Layer 1 Advanced Invariants: certainty, workflow, cross-field","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:58:09.522177+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:06:24.884832+01:00","closed_at":"2026-02-13T14:06:24.884832+01:00","close_reason":"9 property tests: certainty matrix, workflow gate, timezone, RPE+RIR, similarity, free-form","dependencies":[{"issue_id":"kura-training-siq.1.3","depends_on_id":"kura-training-siq.1","type":"parent-child","created_at":"2026-02-13T13:58:09.524277+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.3","depends_on_id":"kura-training-siq.1.1","type":"blocks","created_at":"2026-02-13T13:58:40.792066+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1.4","title":"Layer 2 LLM Adversarial: scenarios, generator, runner","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:58:14.764744+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:10:38.512331+01:00","closed_at":"2026-02-13T14:10:38.512331+01:00","close_reason":"21 built-in scenarios + LLM generator + runner, category tests","dependencies":[{"issue_id":"kura-training-siq.1.4","depends_on_id":"kura-training-siq.1","type":"parent-child","created_at":"2026-02-13T13:58:14.765675+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.4","depends_on_id":"kura-training-siq.1.2","type":"blocks","created_at":"2026-02-13T13:58:45.985876+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1.5","title":"Layer 3 Transcript Pipeline: fixtures, replay, promotion","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:58:20.000697+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:10:43.675573+01:00","closed_at":"2026-02-13T14:10:43.675573+01:00","close_reason":"13 fixture tests + replay pipeline + promotion mechanism","dependencies":[{"issue_id":"kura-training-siq.1.5","depends_on_id":"kura-training-siq.1","type":"parent-child","created_at":"2026-02-13T13:58:20.001776+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.5","depends_on_id":"kura-training-siq.1.1","type":"blocks","created_at":"2026-02-13T13:58:51.170852+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.1.6","title":"CI Integration + Documentation","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:58:25.249234+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T14:11:32.955649+01:00","closed_at":"2026-02-13T14:11:32.955649+01:00","close_reason":"pytest markers, run-fuzzing.sh script, CI-ready","dependencies":[{"issue_id":"kura-training-siq.1.6","depends_on_id":"kura-training-siq.1","type":"parent-child","created_at":"2026-02-13T13:58:25.250651+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.6","depends_on_id":"kura-training-siq.1.2","type":"blocks","created_at":"2026-02-13T13:58:56.358007+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.6","depends_on_id":"kura-training-siq.1.3","type":"blocks","created_at":"2026-02-13T13:59:01.536439+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.6","depends_on_id":"kura-training-siq.1.4","type":"blocks","created_at":"2026-02-13T13:59:06.732621+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.1.6","depends_on_id":"kura-training-siq.1.5","type":"blocks","created_at":"2026-02-13T13:59:11.953662+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.2","title":"Certainty State Machine Contract V1 (confirmed/inferred/unresolved)","description":"Enforce certainty as a typed state machine across ingestion, write-with-proof response, and projection consumers so subjective fields cannot be presented as confirmed without explicit evidence.","design":"Introduce contract-level certainty states with allowed transitions and required evidence metadata per transition. Make inferred subjective values fail-closed unless backed by explicit provenance and evidence references. Add server-side rejection paths and machine-readable reason codes for invalid transitions.","acceptance_criteria":"1) Certainty states and transitions are specified and enforced server-side. 2) session.completed subjective fields cannot be persisted as confirmed without explicit user-confirmed provenance. 3) Invalid certainty transitions return machine-readable policy errors. 4) Regression tests cover guessed-feedback and contradiction cases. 5) Reliability UX output is generated from state machine outputs, not ad-hoc phrasing.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:41:37.827525+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:14:23.94324+01:00","closed_at":"2026-02-13T13:14:23.94324+01:00","close_reason":"Implemented in d126707","dependencies":[{"issue_id":"kura-training-siq.2","depends_on_id":"kura-training-siq","type":"parent-child","created_at":"2026-02-13T12:41:37.829228+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.2","depends_on_id":"kura-training-wvp.1","type":"blocks","created_at":"2026-02-13T12:41:37.830484+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.2","depends_on_id":"kura-training-wvp.3","type":"blocks","created_at":"2026-02-13T12:41:37.831391+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.3","title":"Schema Capability Gate + Migration Parity Guardrails","description":"Prevent projection/runtime failures caused by partial schema rollout (for example missing external_import_jobs) by introducing schema capability checks and deployment parity gates.","design":"At startup and in health endpoints, validate required table/index capabilities per enabled handler. Add deployment preflight that blocks rollout when migration version and runtime handler requirements diverge. Define fail behavior per criticality: fail-fast for core handlers, explicit degrade mode with telemetry for optional capabilities.","acceptance_criteria":"1) Worker/API expose schema capability report with machine-readable missing requirements. 2) Deployment preflight blocks mismatch between required and applied migrations. 3) Dead-job flood from missing schema dependencies is prevented. 4) quality_health and training_timeline behavior is deterministic under missing optional tables. 5) Runbook documents recovery and replay path.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:41:43.038284+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:14:23.945228+01:00","closed_at":"2026-02-13T13:14:23.945228+01:00","close_reason":"Implemented in d126707","dependencies":[{"issue_id":"kura-training-siq.3","depends_on_id":"kura-training-siq","type":"parent-child","created_at":"2026-02-13T12:41:43.039161+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.3","depends_on_id":"kura-training-4sv","type":"blocks","created_at":"2026-02-13T12:41:43.040263+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.4","title":"Load Context Contract V1: Equipment and Comparability Semantics","description":"Model load comparability explicitly so machine-based and free-weight sets are not silently merged into the same progression stream.","design":"Add structured load context dimensions (implements_type, movement_constraint, equipment_profile, location_class, comparability_group). Define comparability rules and confidence semantics for aggregation boundaries. Expose machine-readable reason codes when comparisons are down-scoped or blocked.","acceptance_criteria":"1) set logging contract includes structured load context with conservative defaults. 2) exercise progression aggregation honors comparability boundaries. 3) System emits explicit uncertainty when cross-context comparison is weak or invalid. 4) Tests cover smith vs barbell and cross-location machine variance. 5) UX guidance prompts minimal extra user burden while preserving data integrity.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:41:48.266478+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:14:23.946425+01:00","closed_at":"2026-02-13T13:14:23.946425+01:00","close_reason":"Implemented in d126707","dependencies":[{"issue_id":"kura-training-siq.4","depends_on_id":"kura-training-siq","type":"parent-child","created_at":"2026-02-13T12:41:48.26735+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.4","depends_on_id":"kura-training-m3k.3","type":"blocks","created_at":"2026-02-13T12:41:48.268721+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.5","title":"exercise_progression Re-key on set.corrected exercise_id Changes","description":"Fix projection key consistency when set.corrected changes exercise_id. Current behavior can keep corrected sets under the old projection key, which defeats semantic separation and pollutes progression trends.","design":"When correction modifies exercise identity, recompute and reconcile both source and target canonical keys. Ensure projection key equals effective post-correction exercise_id. Add migration-safe backfill path for already polluted projections and deterministic conflict handling.","acceptance_criteria":"1) Corrected exercise_id causes data to move to the correct projection key. 2) Old key projection is cleaned or recomputed consistently. 3) No duplicate counting across old/new keys. 4) Regression tests cover multi-set corrections in one session. 5) Existing unaffected projections remain unchanged.","status":"closed","priority":1,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:41:53.489991+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:14:23.947492+01:00","closed_at":"2026-02-13T13:14:23.947492+01:00","close_reason":"Implemented in d126707","dependencies":[{"issue_id":"kura-training-siq.5","depends_on_id":"kura-training-siq","type":"parent-child","created_at":"2026-02-13T12:41:53.490802+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.5","depends_on_id":"kura-training-siq.4","type":"blocks","created_at":"2026-02-13T12:41:53.492051+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-siq.6","title":"Proof-in-Production V1: Stakeholder-Entscheidungsartefakte aus Eval/Gates","description":"Warum:\nMaschinenlesbare Eval-Reports existieren, aber es fehlt ein konsistentes Stakeholder-Artefakt („proof in production“), das Rollout-Entscheidungen transparent macht.\n\nScope:\n- Aus Shadow-Eval, Reliability- und Gate-Daten ein standardisiertes Entscheidungsartefakt erzeugen.\n- Artefakt in maschinenlesbarer Form und stakeholder-lesbarer Kurzform bereitstellen.\n- Klare Pflichtsektionen: Entscheidung, Risiken, fehlende Daten, nächste Schutzmaßnahmen.\n\nWas muss gelten:\n- Report lässt sich automatisiert erzeugen und diffen.\n- Rollout-Entscheidung ist anhand klarer Felder auditierbar.\n\nNicht-Ziele:\n- Kein neues Dashboard-Frontend in diesem Task.\n\nImplementierungsanker:\n- workers/src/kura_workers/eval_harness.py\n- docs/reports/\n- scripts/ (Report-Entry)\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst Report-Schema und Generator-Entrypoint lesen, danach mit Sample-Daten einen vollständigen Report bauen und gegen Erwartungen prüfen.\n","design":"Build for agents + humans + stakeholders: gleiche Datenbasis, unterschiedliche Darstellungen.","acceptance_criteria":"1) Standardisiertes Entscheidungsartefakt wird automatisiert erzeugt (maschinenlesbar + stakeholder-lesbare Kurzform). 2) Artefakt enthält mindestens: Gate-Status, Hauptgründe, fehlende Daten, empfohlene nächste Schritte. 3) Generator ist testbar und reproduzierbar.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:12:50.315661+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T06:33:33.657987+01:00","closed_at":"2026-02-14T06:33:33.657987+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-siq.6","depends_on_id":"kura-training-siq","type":"parent-child","created_at":"2026-02-13T20:12:50.316687+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-siq.6","depends_on_id":"kura-training-wvp.4","type":"blocks","created_at":"2026-02-13T20:12:55.518873+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-sn6","title":"Email: Invite-Benachrichtigung bei Approval","description":"## Was\nAutomatische Email an User wenn Access Request approved wird. Vom ersten Tag an funktionsfähig.\n\n## Technologie\nResend (resend.com) — einfachste Integration, gute Free Tier (100 emails/day), Rust SDK verfügbar.\nAlternative: Postmark oder direkt SMTP.\n\n## Trigger\nBei POST /v1/admin/access-requests/{id}/approve:\n- Nach Token-Generierung → Email an Request-Email senden\n- Async (nicht blockierend für die API-Response)\n\n## Email-Inhalt\nSubject DE: \"Dein Zugang zu Kura\"\nSubject EN: \"Your access to Kura\"\n\nBody (schlicht, persönlich, kein Marketing):\n---\nHallo {name},\n\ndu hast Zugang zu Kura.\n\nErstelle dein Konto hier: {invite_url}\n\nDer Link ist 7 Tage gültig.\n\nKura ist in aktiver Entwicklung. Als Early-Access-Nutzer hilfst du dabei,\ndas System besser zu machen. Deine Trainingsdaten fließen anonymisiert\nin die Verbesserung der Algorithmen ein.\n\nFragen? Antworte einfach auf diese Email.\n\n— Kura\n---\n\n## Config\n- RESEND_API_KEY (oder SMTP_HOST + SMTP_USER + SMTP_PASS als Fallback)\n- EMAIL_FROM: \"Kura \u003ckura@domain.tld\u003e\"\n- FRONTEND_URL: für invite_url Konstruktion\n\n## Fehlerbehandlung\n- Email-Versand schlägt fehl → loggen, aber Approval NICHT rückgängig machen\n- Admin sieht in Response ob Email erfolgreich war\n- Response: { \"status\": \"approved\", \"invite_token\": \"...\", \"email_sent\": true|false }\n\n## Kein Overdesign\n- Plain text Email, kein HTML-Template\n- Kein Tracking, keine Pixel\n- Reply-to auf eine echte Adresse","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:46:18.539887+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:03:48.62917+01:00","closed_at":"2026-02-13T13:03:48.62917+01:00","close_reason":"Resend email on approval, plain text, async","dependencies":[{"issue_id":"kura-training-sn6","depends_on_id":"kura-training-0yc","type":"blocks","created_at":"2026-02-13T12:47:16.340324+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-sn6","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:57.773217+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-svc","title":"Extend eval harness to causal_inference","description":"Add causal_inference support to offline evaluation pipeline: extend projection type allow-lists in workers/src/kura_workers/eval_harness.py and workers/src/kura_workers/eval_cli.py, add causal artifact persistence support in migrations (inference_eval_artifacts projection_type check), and define causal calibration/quality metrics with thresholds for shadow-mode gating.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T14:42:55.196987+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T15:11:01.594114+01:00","closed_at":"2026-02-11T15:11:01.594114+01:00","close_reason":"Closed","labels":["causal","mlops","testing"]}
{"id":"kura-training-syn","title":"Semantic Resolve API Endpoint","description":"Add dedicated semantic resolution endpoint(s) so agents can submit free-text terms and receive ranked canonical candidates (exercise/food) with confidence bands and provenance. Use semantic_memory + embeddings backend.","notes":"Foundation exists; API contract missing.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T09:04:52.382559+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T09:31:10.425371+01:00","closed_at":"2026-02-11T09:31:10.425371+01:00","close_reason":"Semantic Resolve endpoint mit Tests und Doku umgesetzt","labels":["agent-interface","api","semantic"]}
{"id":"kura-training-tct","title":"Projection-Output-Schemas in system_config","description":"Handler deklarieren ihre Projection-Output-Felder in dimension_meta (output_schema). build_system_config() sammelt sie ein und liefert sie über GET /v1/system/config aus. Damit weiß der Agent sofort welche Felder eine Projection hat, ohne raten zu müssen. Beispiel: exercise_progression hat estimated_1rm, total_sets, weekly_history[].estimated_1rm, etc.","notes":"Entstanden aus Agent-Walkthrough (2026-02-10): Agent konnte Projection-Daten nicht lesen weil Feldnamen unbekannt (estimated_1rm vs personal_records.best_estimated_1rm.value). Jeder Handler hat bereits dimension_meta in handlers/*.py. Erweitern um output_schema dict. build_system_config() in system_config.py sammelt es ein. Dann in GET /v1/system/config sichtbar. Kein API-Change nötig, nur Worker-seitig.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T19:47:37.322685+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T20:16:13.947751+01:00","closed_at":"2026-02-10T20:16:13.947751+01:00","close_reason":"Closed"}
{"id":"kura-training-tm5","title":"External Connector Readiness: Garmin/Strava/TrainingPeaks","description":"Bereite Kura backend-seitig so vor, dass externe Trainingsdatenquellen (zuerst Datei-Import, später API-Connectors) sauber, nützlich und ohne Datenchaos integriert werden können. Fokus: canonical data model, source-aware ingestion, idempotente Verarbeitung, verlässliche Projektionen.","design":"Launch-Strategie: Phase 1 file-based import (FIT/TCX/GPX) + provider-agnostic backend contract. Phase 2 offizielle API-Connector (Strava/Garmin/TrainingPeaks) auf denselben Ingestion-Kern. Alle provider-spezifischen Unterschiede werden in Mappern gekapselt, nicht in Core-Projektionen.","acceptance_criteria":"1) Epic enthält vollständige Task-Kette von Datenmodell bis Rollout. 2) Backend kann externe Daten source-aware und idempotent verarbeiten. 3) Provider-spezifische Implementierungen können später ohne Core-Bruch ergänzt werden. 4) Qualitätssignale und Invarianten verhindern stilles Datenchaos.","notes":"Session handoff 2026-02-13: Connector-readiness child chain is complete. Operational production cutover dependencies are tracked in kura-training-4sv. Keep this epic closed once rollout-hardening validates deployment environment.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:10.628877+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T09:56:33.851588+01:00","closed_at":"2026-02-13T09:56:33.851588+01:00","close_reason":"Connector-readiness chain complete; rollout execution tracked in kura-training-4sv"}
{"id":"kura-training-tm5.1","title":"Canonical External Activity Contract v1","description":"Definiere ein provider-unabhängiges Canonical Contract für externe Trainingsaktivitäten inkl. Pflicht-/Optional-Feldern, Source-Metadaten und Provenance.","design":"Contract mit stabilen Feldern für session/set/workout + source layer (provider, provider_user_id, external_activity_id, external_event_version, ingestion_method).","acceptance_criteria":"1) Contract v1 dokumentiert und versioniert. 2) Pflicht-/Optional-Felder klar. 3) Provenance-Felder vorhanden. 4) Tests für Contract-Validierung implementiert.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:10.748901+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:11:24.960146+01:00","closed_at":"2026-02-12T08:11:24.960146+01:00","close_reason":"Implemented canonical external activity contract v1 with required/optional source/session/set/workout/provenance fields, design doc, and validation tests.","dependencies":[{"issue_id":"kura-training-tm5.1","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:10.749781+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.2","title":"Provider Adapter Interface + Ingestion Envelope","description":"Baue ein einheitliches Adapter-Interface, über das Garmin/Strava/TrainingPeaks später andocken können, ohne Core-Logik zu duplizieren.","design":"Adapter liefern normalisierte Envelope-Events (raw payload refs + canonical draft + mapping metadata + validation report).","acceptance_criteria":"1) Adapter-Interface stabil definiert. 2) Envelope-Format implementiert. 3) Dummy-Adapter-Tests vorhanden. 4) Core-Ingestion ist provider-agnostic.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:10.867477+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:16:32.250654+01:00","closed_at":"2026-02-12T08:16:32.250654+01:00","close_reason":"Implemented stable provider adapter interface, ingestion envelope v1, dummy adapters, validation-report handling, and provider-agnostic ingestion preparation with tests.","dependencies":[{"issue_id":"kura-training-tm5.2","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:10.868353+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.2","depends_on_id":"kura-training-tm5.1","type":"blocks","created_at":"2026-02-11T21:56:11.798505+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.3","title":"Source Identity, Idempotency und Dedup Engine","description":"Verhindere doppelte oder widersprüchliche Imports durch source-aware Identity und idempotente Write-Pfade.","design":"Composite identity keys, replay-safe ingestion, duplicate policy (exact duplicate, partial overlap, update version).","acceptance_criteria":"1) Idempotency-Key-Strategie implementiert. 2) Duplicate-Erkennung mit klaren Outcomes. 3) Update-vs-new Regeln definiert. 4) Regressionstests für Mehrfachimporte vorhanden.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:10.987878+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:14:17.376847+01:00","closed_at":"2026-02-12T08:14:17.376847+01:00","close_reason":"Implemented source identity keying, replay-safe external idempotency keys, duplicate policy outcomes (exact/partial/update/stale/conflict), plus regression tests for repeated imports.","dependencies":[{"issue_id":"kura-training-tm5.3","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:10.988848+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.4","title":"Temporal Normalization: Timezone, Device Drift, Session Boundaries","description":"Normalisiere externe Zeitdaten robust, damit Sessions/Trends korrekt bleiben (Zeitzonenwechsel, Uhrdrift, Tagesgrenzen).","design":"Canonical timestamp policy + timezone fallback + boundary rules für overnight/long sessions.","acceptance_criteria":"1) Zeit-Normalisierungsregeln dokumentiert. 2) Device-/Provider-Zeitkonflikte behandelt. 3) Session-Boundary-Tests vorhanden. 4) Keine Datumsdrift in Projektionen.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:11.105277+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T07:51:51.734622+01:00","closed_at":"2026-02-12T07:51:51.734622+01:00","close_reason":"Implemented canonical temporal normalization (timezone fallback, drift/conflict handling, overnight/long-session fallback boundaries), integrated into timezone-based projections, added design doc + unit/integration coverage.","dependencies":[{"issue_id":"kura-training-tm5.4","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:11.106251+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.5","title":"Garmin/Strava/TrainingPeaks Field Mapping Matrix","description":"Erstelle eine gepflegte Mapping-Matrix je Provider auf das Canonical Contract, inklusive Verlust-/Unsicherheitskennzeichnung.","design":"Mapping-Tabelle pro Feld: source path, transform, unit conversion, confidence/provenance, unsupported behavior.","acceptance_criteria":"1) Mapping-Matrix für Garmin/Strava/TrainingPeaks v1 vorhanden. 2) Unit-Konvertierungen definiert. 3) Unsupported-Felder explizit markiert. 4) Mapping-Tests mit Beispielpayloads implementiert.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:11.221081+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:18:53.985713+01:00","closed_at":"2026-02-12T08:18:53.985713+01:00","close_reason":"Added v1 provider mapping matrices for Garmin/Strava/TrainingPeaks with explicit unit conversions, unsupported field handling, provenance wiring, and example payload tests.","dependencies":[{"issue_id":"kura-training-tm5.5","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:11.221959+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.5","depends_on_id":"kura-training-tm5.1","type":"blocks","created_at":"2026-02-11T21:56:11.890439+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.6","title":"Import Pipeline V1 (FIT/TCX/GPX) mit Async Jobs","description":"Implementiere file-based Import als Launch-fähigen Einstieg, der denselben Core wie spätere API-Connector nutzt.","design":"Upload -\u003e parse -\u003e map -\u003e validate -\u003e write-with-proof -\u003e projection refresh; mit retry/backoff und Job-Receipts.","acceptance_criteria":"1) FIT/TCX/GPX Import-End-to-End läuft. 2) Job-Status/Receipts verfügbar. 3) Fehlertypen klar klassifiziert. 4) Idempotenter Re-Import möglich.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:11.337655+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:27:25.532056+01:00","closed_at":"2026-02-12T08:27:25.532056+01:00","close_reason":"Implemented FIT/TCX/GPX async import pipeline with external_import job table, queue/status API endpoints, parser/mapping/validation/dedup/write flow, classified errors, receipts, and idempotent re-import handling.","dependencies":[{"issue_id":"kura-training-tm5.6","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:11.338713+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.6","depends_on_id":"kura-training-tm5.2","type":"blocks","created_at":"2026-02-11T21:56:12.079072+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.6","depends_on_id":"kura-training-tm5.3","type":"blocks","created_at":"2026-02-11T21:56:12.267779+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.6","depends_on_id":"kura-training-tm5.4","type":"blocks","created_at":"2026-02-11T21:56:12.45961+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.7","title":"Projection Integration + Quality Signals für External Data","description":"Sorge dafür, dass externe Daten nützlich in bestehende Kura-Projektionen einfließen und Qualitätsprobleme sichtbar werden.","design":"Projection hooks + quality signals (missing core fields, unit mismatch, temporal uncertainty, dedup actions).","acceptance_criteria":"1) Externe Daten erscheinen konsistent in Kernprojektionen. 2) Qualitäts-Signale werden emittiert. 3) Unsichere Felder werden nicht stillschweigend als sicher behandelt. 4) Tests für Misch-Szenarien (manuell + extern) vorhanden.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:11.458323+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:35:22.439005+01:00","closed_at":"2026-02-12T08:35:22.439005+01:00","close_reason":"Integrated external.activity_imported into training_timeline core projection and added external quality signals (unsupported/low-confidence/temporal/dedup) in training_timeline + quality_health, including mixed manual+external tests.","dependencies":[{"issue_id":"kura-training-tm5.7","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:11.45969+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.7","depends_on_id":"kura-training-tm5.1","type":"blocks","created_at":"2026-02-11T21:56:11.983868+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.7","depends_on_id":"kura-training-tm5.3","type":"blocks","created_at":"2026-02-11T21:56:12.364054+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.7","depends_on_id":"kura-training-tm5.4","type":"blocks","created_at":"2026-02-11T21:56:12.556674+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.7","depends_on_id":"kura-training-tm5.5","type":"blocks","created_at":"2026-02-11T21:56:12.649863+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.8","title":"Provider OAuth/Connection Domain Model (Post-Launch Ready)","description":"Lege Domain-Modell für Account-Linking, Token-Lifecycle, Scopes und Revoke vor, damit offizielle Provider-Connectors später schnell integrierbar sind.","design":"ProviderConnection aggregate: auth state, scopes, token metadata, sync cursors, consent timestamps, revocation handling.","acceptance_criteria":"1) ProviderConnection Modell + API contract definiert. 2) Scope/Consent/Revocation-Fälle modelliert. 3) Security-Audit-Felder vorhanden. 4) Integration mit Adapter-Pipeline vorbereitet.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:11.575161+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:39:51.062286+01:00","closed_at":"2026-02-12T08:39:51.062286+01:00","close_reason":"Added provider_connections domain model + migration, provider connection API contract (list/upsert/revoke), scope/consent/revocation modeling, security/audit metadata fields, and adapter-context integration contract.","dependencies":[{"issue_id":"kura-training-tm5.8","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:11.576055+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.8","depends_on_id":"kura-training-tm5.2","type":"blocks","created_at":"2026-02-11T21:56:12.171589+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-tm5.9","title":"Rollout Plan: Launch-Import -\u003e Post-Launch Connectors","description":"Definiere den kontrollierten Rolloutpfad inkl. Feature Flags, Migrationsstrategie und Success-Metriken für externe Datenquellen.","design":"Stufen: internal alpha, user opt-in import, connector beta, GA. Jede Stufe mit Go/No-Go Kriterien.","acceptance_criteria":"1) Rollout-Stufen dokumentiert. 2) Feature-Flag-Plan vorhanden. 3) KPI-Set für Datenqualität/UX definiert. 4) Rückfallstrategie bei Connector-Problemen klar.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T21:56:11.70537+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-12T08:39:55.795732+01:00","closed_at":"2026-02-12T08:39:55.795732+01:00","close_reason":"Documented staged rollout plan from launch file-import to connector beta/GA with feature flags, KPI gates, migration path, and fallback strategy.","dependencies":[{"issue_id":"kura-training-tm5.9","depends_on_id":"kura-training-tm5","type":"parent-child","created_at":"2026-02-11T21:56:11.706365+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.9","depends_on_id":"kura-training-tm5.6","type":"blocks","created_at":"2026-02-11T21:56:12.776041+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.9","depends_on_id":"kura-training-tm5.7","type":"blocks","created_at":"2026-02-11T21:56:12.87962+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-tm5.9","depends_on_id":"kura-training-tm5.8","type":"blocks","created_at":"2026-02-11T21:56:12.969897+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-u1h","title":"Footer + Legal-Pflichtseiten (Impressum, Datenschutz, Nutzungsbedingungen)","description":"## Warum\nDeutsche Anbieterkennzeichnungspflicht (TMG §5) + DSGVO-Pflichtinformationen.\nOhne Impressum und Datenschutzerklärung ist die Seite rechtlich angreifbar.\n\n## Was\n### Footer-Komponente\n- Auf allen Seiten sichtbar (im Layout einbinden)\n- Links: Impressum | Datenschutz | Nutzungsbedingungen\n- Copyright-Zeile\n- Dezent, passend zum Kura-Design\n\n### Impressum (/impressum)\n- Platzhalter-Seite mit Struktur:\n  - Angaben gemäß §5 TMG\n  - Name, Adresse, Kontakt\n  - Verantwortlich für den Inhalt\n  - TODO-Hinweis: \"Inhalte werden ergänzt\"\n\n### Datenschutzerklärung (/datenschutz)\n- Platzhalter-Seite mit Struktur:\n  - Verantwortlicher\n  - Erhobene Daten (Events, Projections, Account-Daten)\n  - Zweck der Verarbeitung\n  - Rechte der betroffenen Person (Auskunft, Löschung, Export)\n  - TODO-Hinweis: \"Vollständige Datenschutzerklärung wird ergänzt\"\n\n### Nutzungsbedingungen (/nutzungsbedingungen)\n- Platzhalter-Seite mit Struktur:\n  - Early Access Bedingungen\n  - Zustimmung zur anonymisierten Datenanalyse als Teilnahmevoraussetzung\n  - Haftungsausschluss (Beta-Software)\n  - TODO-Hinweis: \"Vollständige Nutzungsbedingungen werden ergänzt\"\n\n## Abhängigkeit\n- KEINE — kann parallel zu allem anderen gebaut werden\n\n## Akzeptanzkriterien\n- Footer auf allen Seiten sichtbar\n- Alle drei Seiten erreichbar und mit sinnvoller Platzhalter-Struktur\n- i18n: Mindestens Deutsch, Englisch als Fallback","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T14:35:53.282376+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T15:00:58.442378+01:00","closed_at":"2026-02-13T15:00:58.442378+01:00","close_reason":"Footer component with legal links on all pages. Impressum, Datenschutz, Nutzungsbedingungen pages with placeholder structure. All 3 languages (en/de/ja)."}
{"id":"kura-training-v2e","title":"Web: Signup invite gate + consent checkbox","description":"## Was\nSignup-Seite um Invite-Token-Validierung und Consent-Checkbox erweitern.\n\n## Logik\n- /signup?invite=TOKEN → Token aus URL lesen, im Signup-Request mitsenden\n- /signup ohne Token → Redirect zu /request-access (wenn SIGNUP_GATE=invite)\n- Token-Validierung passiert serverseitig (API gibt Fehler zurück)\n\n## Consent Checkbox\n- Unter dem Signup-Formular, vor dem Submit-Button\n- Text: \"Ich stimme zu, dass meine anonymisierten Trainingsdaten zur Verbesserung von Kura verwendet werden.\"\n- EN: \"I agree that my anonymized training data may be used to improve Kura.\"\n- Required: muss angehakt sein für Submit\n- Wird als consent_anonymized_learning: true im Register-Request mitgesendet\n\n## Fehlerbehandlung\n- invite_required → Redirect zu /request-access\n- invite_invalid → Meldung: \"Dieser Einladungslink ist ungültig oder abgelaufen.\"\n- invite_email_mismatch → Meldung: \"Dieser Link ist für eine andere E-Mail-Adresse.\"\n- consent_required → Checkbox highlighten\n\n## Hinweise\n- Invite-Token wird als hidden field oder im State gehalten, nicht im Formular angezeigt\n- Social Login (OAuth) muss Token auch mitsenden können (als state param oder Cookie)","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:46:01.244207+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:14:20.09621+01:00","closed_at":"2026-02-13T13:14:20.09621+01:00","close_reason":"Signup page: invite token redirect, consent checkbox, error handling, i18n de+en","dependencies":[{"issue_id":"kura-training-v2e","depends_on_id":"kura-training-zv3","type":"blocks","created_at":"2026-02-13T12:47:11.173069+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v2e","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:52.602291+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-v56","title":"Agent-first User Language Guard (fail-open, 1 rewrite, hidden developer raw mode)","description":"## Warum\nKura ist agent-first: Die maschinenlesbare Sprache (Event-Typen, Invariants, interne Contracts) muss vollständig erhalten bleiben, damit Agents präzise und leistungsfähig arbeiten können. Gleichzeitig sollen Endnutzer im Chat möglichst keine interne API-Sprache sehen. Eine rein manuelle Vocabulary-Allowlist skaliert nicht mit wachsender Anwendung und erzeugt doppelte Pflege. Deshalb brauchen wir einen robusten, fail-open Sprach-Guard, der den Agent nicht beschneidet.\n\n## Wie\nWir führen eine serverseitige Audience-Policy ein: `user_safe` als Default und `developer_raw` nur für privilegierte Developer-Clients. Im `user_safe`-Pfad bleibt die Agent-Antwort autoritativ, aber ein Leak-Detector prüft auf Maschinenmuster; bei Treffer gibt es genau einen Rewrite-Versuch in Alltagssprache. Danach wird immer ausgeliefert (fail-open), damit der Agent nie stumm wird. Die Leakerkennung soll weitgehend aus bestehenden Contract-Quellen gespeist werden, um doppelte Listenpflege zu vermeiden.\n\n## Ergebnisbild\n- Endnutzer sehen überwiegend Alltagssprache.\n- Agent-Contract und technische Präzision bleiben vollständig erhalten.\n- Kein Hard-Block bei verbleibenden Leaks.\n- Developer können Rohausgaben gezielt für Tests aktivieren, Endnutzer nicht.\n\n## Akzeptanzkriterien\n- `user_safe` ist Default für normale User-Clients.\n- `developer_raw` ist nur serverseitig per Scope + Allowlist aktivierbar.\n- `user_safe` nutzt Leak-Check + max. 1 Rewrite + fail-open Auslieferung.\n- Metriken und Tests decken Leak-Rate, Rewrite-Rate und Fallback-Pfade ab.\n","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:47:02.388804+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:04:05.242721+01:00","closed_at":"2026-02-13T21:04:05.242721+01:00","close_reason":"Closed"}
{"id":"kura-training-v56.1","title":"Audience-Control-Plane: user_safe default + hidden developer_raw authorization","description":"## Warum\nOhne harte Audience-Steuerung landet interne Sprache unkontrolliert im User-Chat. Der Agent soll nicht eingeschränkt werden, aber der Ausgabekanal für Endnutzer braucht klare Defaults und Rechteprüfung.\n\n## Wie\n- Serverseitige Audience-Resolution einführen: `user_safe` (default) und `developer_raw`.\n- `developer_raw` nur erlauben, wenn beide Bedingungen erfüllt sind:\n  - privilegierter Scope (z. B. `agent:debug`)\n  - serverseitige Client-Allowlist (z. B. via `client_id` Mapping)\n- Chat-Textkommandos dürfen den Modus nicht umschalten.\n- Entscheidungspfad als klaren Utility-Entry-Point kapseln, damit spätere Features zentral andocken.\n\n## Akzeptanzkriterien\n- Normale User-Clients landen immer in `user_safe`.\n- Nicht-privilegierte Clients können `developer_raw` nicht aktivieren.\n- Umschaltung ist nur serverseitig kontrolliert und auditierbar.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:47:39.216776+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:03:08.401812+01:00","closed_at":"2026-02-13T21:03:08.401812+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-v56.1","depends_on_id":"kura-training-v56","type":"parent-child","created_at":"2026-02-13T20:47:39.218185+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-v56.2","title":"Leak-Detector aus bestehenden Contracts ableiten (ohne zweite Vokabelliste)","description":"## Warum\nManuelle Doppelpflege von Maschinenbegriffen und User-Vokabular skaliert schlecht. Wir brauchen automatische Erkennung aus bestehenden Contracts, nicht aus einer zweiten Handliste.\n\n## Wie\n- Leak-Detector implementieren, der Maschinenmuster erkennt (z. B. `event.type`-Formen, `INV-###`, `inv_*`, endpoint-/command-artige Tokens).\n- Erkennungsquellen so weit wie möglich aus bestehenden Contract-Quellen speisen (Event-Conventions, bekannte Invariant-Formate, technische Namenskonventionen).\n- Detector liefert strukturierte Funde (Typ, Treffer, Position), damit Rewrite gezielt instruierbar ist.\n- Detector ist rein diagnostisch und blockiert nichts selbst.\n\n## Akzeptanzkriterien\n- Detector erkennt die bekannten Leak-Muster zuverlässig in repräsentativen Beispieltexten.\n- Neue Contracts können ohne zweite manuelle Vokabelliste in die Erkennung einfließen.\n- Detector-Output ist für Telemetrie und Rewrite-Prompting nutzbar.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:47:44.446806+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:03:33.694941+01:00","closed_at":"2026-02-13T21:03:33.694941+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-v56.2","depends_on_id":"kura-training-v56","type":"parent-child","created_at":"2026-02-13T20:47:44.447747+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.2","depends_on_id":"kura-training-v56.1","type":"blocks","created_at":"2026-02-13T20:48:05.364851+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-v56.3","title":"User-safe Pipeline: Leak-Check + genau 1 Rewrite + fail-open Auslieferung","description":"## Warum\nDer Agent soll weiter frei schreiben können, aber Leaks im Endnutzerkanal sollen minimiert werden. Gleichzeitig darf der Agent nie stumm werden.\n\n## Wie\n- `user_safe`-Pipeline:\n  1. Agent-Antwort erzeugen.\n  2. Leak-Check.\n  3. Bei Leak: genau ein Rewrite-Aufruf mit Instruktion „gleicher Inhalt, gleiche Persönlichkeit, ohne erkannte Maschinenbegriffe“.\n  4. Ergebnis direkt ausliefern (`fail-open`).\n- Rewrite mit kurzem Latenzbudget (Timeout), bei Fehler/Timeout Originalantwort senden.\n- Kein zweiter Rewrite und kein Hard-Block.\n\n## Akzeptanzkriterien\n- Ohne Leaks entsteht kein Zusatzaufruf.\n- Bei Leaks erfolgt maximal ein Rewrite.\n- Bei Rewrite-Fehler oder verbleibenden Leaks wird trotzdem sinnvoll ausgeliefert.\n- Persönlichkeitsstil bleibt erkennbar agentisch.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:47:49.687041+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:03:49.63752+01:00","closed_at":"2026-02-13T21:03:49.63752+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-v56.3","depends_on_id":"kura-training-v56","type":"parent-child","created_at":"2026-02-13T20:47:49.68853+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.3","depends_on_id":"kura-training-v56.1","type":"blocks","created_at":"2026-02-13T20:48:10.558097+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.3","depends_on_id":"kura-training-v56.2","type":"blocks","created_at":"2026-02-13T20:48:15.768498+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-v56.4","title":"Developer-Raw-Diagnostikpfad mit Audit und ohne User-Discoverability","description":"## Warum\nFür Debugging, QA und Prompt-Arbeit brauchen Developer Zugriff auf technische Begriffe. Endnutzer dürfen diesen Schalter nicht entdecken oder steuern.\n\n## Wie\n- `developer_raw`-Pfad implementieren, der Leak-Guard/Rewrite bewusst umgeht.\n- Zugriff nur über serverseitige AuthZ (Scope + Client-Allowlist), nicht über Chat-Befehle.\n- Jede Nutzung als Security/Debug-Ereignis telemetrieren (wer, wann, welcher Client).\n- UI/Agent-Prompts für Endnutzer enthalten keinen Hinweis auf diesen Modus.\n\n## Akzeptanzkriterien\n- Developer können reproduzierbar Rohbegriffe sehen.\n- Normale User können den Modus weder auslösen noch entdecken.\n- Audit-Trail für jede `developer_raw`-Ausführung vorhanden.\n","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:47:54.928563+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:03:54.84131+01:00","closed_at":"2026-02-13T21:03:54.84131+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-v56.4","depends_on_id":"kura-training-v56","type":"parent-child","created_at":"2026-02-13T20:47:54.929512+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.4","depends_on_id":"kura-training-v56.1","type":"blocks","created_at":"2026-02-13T20:48:20.970411+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-v56.5","title":"Executable Specs, Telemetrie und Rollout-Guardrails für Sprach-Guard","description":"## Warum\nOhne messbare Qualität und CI-Schutz droht Regression: entweder zu viele Leaks oder zu aggressive Umschreibungen, die Inhalt verlieren.\n\n## Wie\n- Tests:\n  - Architektur-/Contract-Tests für Audience-Policy und fail-open Verhalten.\n  - Pipeline-Tests für \"Leak erkannt -\u003e 1 Rewrite -\u003e Auslieferung\".\n  - Negative Tests: Rewrite-Timeout/Fehler liefert weiterhin Antwort.\n- Telemetrie:\n  - `leak_detected_total`\n  - `rewrite_applied_total`\n  - `rewrite_failed_or_timeout_total`\n  - `leak_passed_through_total`\n  - `developer_raw_uses_total`\n- Rollout:\n  - Start mit Monitoring, dann schrittweise Aktivierung, Grenzwerte/Alerts dokumentieren.\n\n## Akzeptanzkriterien\n- CI schützt Kerninvarianten (`agent-first`, `fail-open`, max. 1 Rewrite).\n- Dashboards/Logs zeigen Leak- und Rewrite-Qualität nachvollziehbar.\n- Rollout- und Rückfallplan ist dokumentiert.\n","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:48:00.159717+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T21:04:00.040357+01:00","closed_at":"2026-02-13T21:04:00.040357+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-v56.5","depends_on_id":"kura-training-v56","type":"parent-child","created_at":"2026-02-13T20:48:00.160898+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.5","depends_on_id":"kura-training-v56.2","type":"blocks","created_at":"2026-02-13T20:48:26.16992+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.5","depends_on_id":"kura-training-v56.3","type":"blocks","created_at":"2026-02-13T20:48:31.367694+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-v56.5","depends_on_id":"kura-training-v56.4","type":"blocks","created_at":"2026-02-13T20:48:36.568243+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-vcf","title":"Save-Echo als tier-unabhängige Always-On Policy extrahieren","description":"## Entscheidungszusammenfassung (Warum)\n\nSave-Echo (Werte nach dem Write sichtbar spiegeln) ist eine Datenintegritaets-Kontrolle und darf nicht von der Autonomie-Stufe abhaengen. Der aktuelle Zustand koppelt indirekt Integritaets-Nachweis und Intent-Handshake, obwohl das zwei verschiedene Problemklassen sind: \"darf ich schreiben\" vs. \"was wurde geschrieben\". Dadurch entsteht in `moderate`/`advanced` ein stilles Drift-Risiko bei plausiblen Fehluebersetzungen. Diese Aufgabe trennt die Konzepte sauber: Intent-Handshake bleibt Tier-abhhaengig, Save-Echo wird Always-On. Die Implementierung muss rueckwaertskompatibel sein und ohne UI-Annahme funktionieren.\n\n## Problem im Ist-Zustand (Code-Referenz)\n\n- Tier-Politik kennt aktuell nur `high_impact_write_policy` und `intent_handshake_required`, aber keine explizite Save-Echo-Pflicht:\n  - `workers/src/kura_workers/system_config.py` (`model_tier_registry_v1`, Zeilenbereich ~296-351)\n  - `api/src/routes/agent/policy.rs` (`model_tier_policy_from_name`, Zeilenbereich ~681-708)\n- Intent-Handshake ist nur strict+high-impact verpflichtend (korrekt), aber Save-Echo wird nicht als separater, tier-unabhaengiger Contract modelliert:\n  - `api/src/routes/agent.rs` (Zeilenbereich ~3321-3461)\n- `quality.save_claim.checked` setzt `mismatch_detected` derzeit nur aus `allow_saved_claim` ab (Proof-Ebene), nicht aus Echo-Vollstaendigkeit:\n  - `api/src/routes/agent/write_verification.rs` (Zeilenbereich ~864-929)\n\n## Zielzustand (Invarianten)\n\n1. Save-Echo ist **immer verpflichtend**, unabhaengig von `strict|moderate|advanced`.\n2. Intent-Handshake bleibt **unveraendert**: nur `strict` + `high_impact_write`.\n3. Save-Echo ist **natuerlich formuliert** (kein technischer Dump), muss aber die geschriebenen Nutzwerte spiegeln.\n4. Bei Batch-Writes ist ein kompakter Sammel-Echo erlaubt, solange alle geschriebenen Werte abgedeckt sind.\n5. Fehlende Event-ID darf nie als \"kein Echo\" klassifiziert werden (wird in `kura-training-znc` gewichtet, nicht hier).\n\n## Implementierungs-Scope (Wie)\n\n### A) Contract/Policy trennen\n\n- `workers/src/kura_workers/system_config.py`\n  - `agent_behavior.operational` um `save_echo_policy_v1` erweitern (schema-pinned):\n    - `always_on: true`\n    - `tier_independent: true`\n    - `required_after_claim_status: [\"saved_verified\"]`\n    - `message_style: \"natural_compact\"`\n    - `batch_mode: \"compact_summary_allowed\"`\n  - `model_tier_registry_v1.rules` klarstellen:\n    - Tier steuert Autonomie/Confirmation, **nicht** Save-Echo-Pflicht.\n\n### B) Runtime-Verhalten explizit machen\n\n- `api/src/routes/agent/write_verification.rs`\n  - Save-Echo-Contract als eigene Bewertungsstufe einfuehren (nicht von `intent_handshake` ableiten).\n  - Payload von `quality.save_claim.checked` um Echo-Metadaten erweitern (zunaechst nur Praesenz/Vollstaendigkeit, detaillierte Severity folgt in `kura-training-znc`).\n- `api/src/routes/agent.rs`\n  - Sicherstellen, dass user-facing Antwortfelder bei `claim_status=saved_verified` ein Echo enthalten (einzeln oder Batch-Zusammenfassung).\n\n### C) Telemetrie vorbereiten (ohne Severity-Reweighting vorwegzunehmen)\n\n- `quality.save_claim.checked` Datenmodell mindestens um folgende Felder erweitern:\n  - `save_echo_required: true`\n  - `save_echo_present: bool`\n  - `save_echo_completeness: \"complete\"|\"partial\"|\"missing\"`\n- Rueckwaertskompatibilitaet:\n  - Fehlende neue Felder in Alt-Events duerfen keine Crashes verursachen.\n  - Default-Fallback fuer Alt-Events ist explizit zu dokumentieren und zu testen.\n\n## Architecture-Spec-Tests (Pflicht laut AGENTS.md)\n\nNeue/angepasste Tests in `tests/architecture/` (keine neue Design-Doc):\n\n1. `tests/architecture/test_11_save_echo_policy_contract.py`\n   - Contract aus `system_config` pruefen:\n     - `save_echo_policy_v1.always_on == True`\n     - `save_echo_policy_v1.tier_independent == True`\n   - Runtime-Referenztests via `assert_kura_api_test_passes(...)`:\n     - `routes::agent::tests::save_echo_contract_enforced_in_advanced_tier`\n     - `routes::agent::tests::save_echo_contract_enforced_in_moderate_tier`\n\n2. `tests/architecture/test_60_agent_contract_coverage_matrix.py`\n   - Matrix um Contract-Key `save_echo_policy` erweitern (schema_pin + positive + negative).\n\n3. Rust-Tests in `api/src/routes/agent.rs` (oder naheliegende Route-Module)\n   - Intent-Handshake-Verpflichtung bleibt strict-only.\n   - Save-Echo bleibt in allen Tiers aktiv.\n\n## Nicht-Ziele\n\n- Keine finale Severity-Gewichtung in dieser Aufgabe (separat `kura-training-znc`).\n- Keine UI-Einfuehrung.\n- Keine Migration alter Events im Nachhinein.\n\n## Akzeptanzkriterien\n\n- Save-Echo als eigener, tier-unabhaengiger Contract ist in System-Config und Runtime vorhanden.\n- Strict-only Intent-Handshake-Verhalten bleibt unveraendert und explizit getestet.\n- Architecture-Spec-Tests in `tests/architecture/` sind hinzugefuegt/angepasst und gruene Referenz.\n- Alt-Events ohne neue Echo-Felder werden robust verarbeitet.\n- Natuerliche Echo-Formulierungen sind moeglich, aber Werteabdeckung ist verpflichtend.\n\n## Hinweise fuer KI-Umsetzung mit wenig Kontext (compaction-resistent)\n\n- Diese Aufgabe darf nicht \"heuristisch\" ueber Prompt-Stil geloest werden; es ist ein **Contract-Problem**.\n- Wenn bei Implementierung ein Trade-off noetig ist, gilt Prioritaet: Integritaets-Nachweis \u003e Formulierungskomfort.\n- Bei Unsicherheit ueber Feldnamen zuerst vorhandene Payloads in `quality.save_claim.checked` erweitern statt neue Event-Typen einzufuehren.\n","status":"open","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T11:29:31.658256+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:45:41.078214+01:00"}
{"id":"kura-training-veh","title":"Executable Specs: Architektur-Invarianten als CI-Tests","description":"Design Docs (Decision 7, 10, 13) enthalten architektonische Zusagen, die heute nur als Prosa existieren. Diese in ausführbare Tests übersetzen, die in CI laufen.\n\nBeispiele:\n- Jeder Handler deklariert dimension_meta + output_schema (Decision 7)\n- Alle Handler reichen unknown fields durch (Decision 10 Phase 1)\n- system_config listet alle registrierten Dimensionen\n- Jeder API-Error hat error + field + docs_hint\n- Event Conventions (21 Typen) matchen tatsächliche Handler-Subscriptions\n- Invarianten INV-001 bis INV-009 aus Self-Healing Doc (013)\n\nZiel: Agents und Menschen können Code ändern, ohne stille architektonische Regression. CI fängt ab, was Code Review übersieht.\n\nInspiration: Ramin Hasani (Liquid AI) — 'Turn every tech spec into code. CI fails if invariant violated.'","notes":"Compaction-safe execution order: veh.1 -\u003e veh.2 -\u003e amg.1 -\u003e amg.2 -\u003e wvp.5 -\u003e wvp.6 -\u003e wvp.4 -\u003e siq.6 -\u003e 5ur.1. Architekturvorgaben aus AGENTS.md strikt anwenden: neue Zusagen als ausführbare Specs in tests/architecture, keine neuen docs/design-Entscheidungsdokumente.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-12T15:34:25.905532+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T07:33:11.768785+01:00","closed_at":"2026-02-14T07:33:11.768785+01:00","close_reason":"Closed"}
{"id":"kura-training-veh.1","title":"Executable Specs V2.1: Marker-Checks auf Verhaltens-Contracts umstellen","description":"Warum:\nDie aktuellen Architektur-Specs in tests/architecture sichern zentrale Agent-Contracts teils nur über String-Marker ab. Das schützt nicht zuverlässig gegen Laufzeit-Regressionen.\n\nScope:\n- Marker-basierte Specs für Intent Handshake, Trace Digest, Memory Tier, Post-Task Reflection auf Verhaltens- und Strukturtests anheben.\n- Positive + negative Fälle pro Contract ergänzen.\n- Assertions so formulieren, dass sie auf API-Verhalten/Contract-Struktur prüfen, nicht auf Quelltext-Substring-Matches.\n\nWas muss gelten (Executable Specs, AGENTS.md-konform):\n- Invarianten werden in tests/architecture und/oder bestehenden Runtime-Tests in Code gegossen.\n- Keine neuen Design-Dokumente unter docs/design für diese Entscheidung.\n\nNicht-Ziele:\n- Keine Produktlogik-Änderung an Policy-Verhalten.\n- Kein Rewrite von agent.rs in diesem Task.\n\nImplementierungsanker:\n- tests/architecture/test_10_intent_handshake_contract.py\n- tests/architecture/test_20_trace_digest_contract.py\n- tests/architecture/test_40_memory_tier_contract.py\n- tests/architecture/test_50_post_task_reflection_contract.py\n- api/src/routes/agent.rs (nur falls für testbare Grenzflächen nötig)\n\nHandoff (compaction-safe):\nBeim Wiederaufsetzen zuerst tests/architecture und die oben genannten Contract-Bereiche in api/src/routes/agent.rs lesen. Dann nur Tests auf Verhaltensassertions umbauen und alle Quality Gates laufen lassen.\n","design":"AGENTS.md beachten: Warum in Bead, Was-muss-gelten als ausführbare Tests in tests/architecture; keine neuen docs/design-Artefakte.","acceptance_criteria":"1) Für Handshake/Trace/Memory/Reflection gibt es keine reinen Quelltext-Substring-Checks als primäre Absicherung mehr. 2) Pro Contract existiert mindestens ein positiver und ein negativer Testfall. 3) scripts/run-architecture-tests.sh, PYTHONPATH=workers/src uv run --project workers python -m pytest workers/tests/ -q --ignore=workers/tests/test_integration.py und cargo test --workspace sind grün.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:11:52.925713+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T20:38:10.327212+01:00","closed_at":"2026-02-13T20:38:10.327212+01:00","close_reason":"Implemented executable behavior contracts for intent handshake, trace digest, memory tier, and post-task reflection; replaced marker-only architecture checks with Rust contract tests; full quality gates green.","dependencies":[{"issue_id":"kura-training-veh.1","depends_on_id":"kura-training-veh","type":"parent-child","created_at":"2026-02-13T20:11:52.92711+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-veh.2","title":"Executable Specs V2.2: Coverage-Matrix und Gate-Bindung","description":"Warum:\nNach der Umstellung auf Verhaltens-Contracts braucht es eine dauerhafte Abdeckungsklammer, damit neue Agent-Contract-Flächen nicht ungetestet bleiben.\n\nScope:\n- Coverage-Matrix als ausführbare Prüfung ergänzen: welche Agent-Contracts architekturell verpflichtend sind.\n- Architektur-Spec-Gate so verankern, dass es in den normalen Worker-/Repo-Qualitätslauf integriert bleibt.\n- Sicherstellen, dass neue Contract-Versionen nicht still eingeführt werden können ohne Spec-Update.\n\nWas muss gelten (Executable Specs, AGENTS.md-konform):\n- Der Testkorpus schlägt fehl, wenn ein verpflichtender Contract entfernt oder ohne Spec-Anpassung geändert wird.\n- Keine neuen Prosa-Designentscheidungen; Invarianten als Tests.\n\nNicht-Ziele:\n- Kein Performance-Benchmarking.\n- Keine Produkt-UI-Änderungen.\n\nImplementierungsanker:\n- workers/tests/test_architecture_specs.py\n- scripts/run-architecture-tests.sh\n- tests/architecture/*\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst workers/tests/test_architecture_specs.py öffnen und prüfen, welche Contract-Flächen bereits durchgesetzt sind; danach fehlende Coverage als Test ergänzen.\n","design":"AGENTS.md Workflow: neue Architekturzusagen ausschließlich als ausführbare Specs, keine neuen Design-Docs.","acceptance_criteria":"1) Architektur-Specs prüfen verpflichtende Contract-Flächen explizit (nicht implizit über Dateitext). 2) Das bestehende Gate bleibt im regulären Testlauf verankert und failt bei Contract-Drift. 3) Voller Gate-Lauf ist grün.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:11:58.158843+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T23:20:15.585023+01:00","closed_at":"2026-02-13T23:20:15.585023+01:00","close_reason":"Added explicit agent contract coverage matrix with schema-pin/positive/negative runtime checks, wired through architecture spec suite, and kept full quality gates green.","dependencies":[{"issue_id":"kura-training-veh.2","depends_on_id":"kura-training-veh","type":"parent-child","created_at":"2026-02-13T20:11:58.159821+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-veh.2","depends_on_id":"kura-training-veh.1","type":"blocks","created_at":"2026-02-13T20:12:03.356509+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-w9p","title":"training_timeline: Top-Sets pro Übung pro Tag in recent_days","description":"recent_days in training_timeline zeigt aktuell nur Übungsliste + Aggregate (total_sets, total_volume). Für einen schnellen Tagesüberblick fehlen die konkreten Top-Sets (schwerster Satz, bester 1RM) pro Übung. Mit dieser Anreicherung reicht EIN API-Call für 'Was hab ich heute gemacht?' statt 1+N Calls. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:54.492323+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:36:29.088661+01:00","closed_at":"2026-02-10T07:36:29.088661+01:00","close_reason":"Top-sets per exercise in recent_days + recent_sessions. epley_1rm moved to shared utils. Best estimated 1RM wins per exercise per day/session.","dependencies":[{"issue_id":"kura-training-w9p","depends_on_id":"kura-training-alk","type":"blocks","created_at":"2026-02-09T21:43:06.717554+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wid","title":"E2E Validation via CLI vor MCP Server","description":"Manueller E2E Happy Path durch den CLI gegen laufende Instanz. User anlegen, Events posten (alle Event-Types), Projections lesen, Daten validieren. Lücken fixen bevor MCP Server gebaut wird.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T13:46:39.098108+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T14:12:54.632062+01:00","closed_at":"2026-02-09T14:12:54.632062+01:00","close_reason":"E2E validation complete. All 7 dimensions validated, 3 discoverability gaps found and fixed (projection_key, 18 event_conventions, bed_time naming)."}
{"id":"kura-training-wke","title":"Deployment: RESEND_API_KEY + KURA_BASE_URL konfigurieren","description":"Für den Email-Versand bei Access-Request-Approval müssen zwei Environment-Variablen auf dem VPS gesetzt werden:\n\n- RESEND_API_KEY: API-Key von Resend (resend.com) für transaktionale Emails\n- KURA_BASE_URL: Öffentliche URL der Web-App (für Signup-Links in Invite-Emails, z.B. https://kura.training)\n\nOhne RESEND_API_KEY funktioniert alles außer automatischem Email-Versand — Token wird dann im CLI-Output angezeigt und kann manuell weitergegeben werden.\n\nIn docker/.env.production eintragen und compose neu starten.","notes":"Blocked until launch infra exists: (1) public web URL/domain is decided and live, (2) Resend is provisioned with production API key and sender setup, (3) env naming for invite links is aligned (currently code reads FRONTEND_URL while ticket mentions KURA_BASE_URL).","status":"blocked","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T13:52:28.83822+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:38:17.756716+01:00"}
{"id":"kura-training-wvp","title":"Model-Aware Agent Runtime V1: Self-Model, Capability Tiers, and Adaptive Autonomy","description":"Bridge completed Continuous Learning Loop outputs into runtime behavior so agents with different model quality operate safely and transparently. Problem: model quality variance can cause inconsistent reliability if runtime autonomy is static. Goal: model-aware, calibration-aware autonomy that keeps UX trustworthy across agent implementations.","design":"Combine 2zc learning signals (calibration, clustering, shadow-eval) with runtime policy. Introduce explicit self-model contract, model-tier registry, and policy gates that adjust write autonomy and confirmation requirements by model quality + calibration status. Keep behavior explainable via machine-readable reason codes.","acceptance_criteria":"1) Runtime resolves model capability tier for each agent execution path. 2) High-risk writes are gated by model tier + calibration status. 3) Agent surfaces transparent policy reason codes when autonomy is reduced. 4) Shadow-eval includes model-tier matrix before policy promotion. 5) Documentation and tests define deterministic fallback behavior when model identity is unknown.","notes":"Session handoff 2026-02-13: This epic operationalizes model-quality variance in runtime policy. WHY: different agent/model quality must not yield unsafe behavior divergence. HOW: execute in order wvp.1 -\u003e wvp.2 -\u003e wvp.3 -\u003e wvp.4, then wire m3k.3/m3k.4 UX scenarios and overrides on top. Safety rule: global hard invariants stay non-bypassable; overrides only tune behavior above safety floor. Execution artifact for context recovery: docs/design/042-model-aware-agent-runtime-v1-execution-plan.md. Child chain IDs: wvp.1 =\u003e kura-training-wvp.1.3 + kura-training-wvp.1.2 -\u003e kura-training-wvp.1.1; wvp.2 =\u003e kura-training-wvp.2.1 -\u003e kura-training-wvp.2.2 -\u003e kura-training-wvp.2.3; wvp.3 =\u003e kura-training-wvp.3.2 -\u003e kura-training-wvp.3.1 -\u003e kura-training-wvp.3.3.","status":"closed","priority":1,"issue_type":"epic","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:09.00809+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T07:21:48.064213+01:00","closed_at":"2026-02-14T07:21:48.064213+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp","depends_on_id":"kura-training-2zc","type":"blocks","created_at":"2026-02-13T09:54:02.150752+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp","depends_on_id":"kura-training-pdc","type":"blocks","created_at":"2026-02-13T09:54:07.358602+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.1","title":"Self-Model Contract V1 in Agent Context","description":"Expose a machine-readable agent self-model in /v1/agent/context and capabilities resources so agents know their runtime contract, constraints, and available repair paths.","design":"Add self_model payload: model_identity, capability_tier, known_limitations, preferred_contracts, fallback_behavior, docs pointers. Keep deny-by-default for unknown fields and include schema_version for compatibility.","acceptance_criteria":"1) Agent context returns self_model block with stable schema version. 2) Unknown/legacy clients receive conservative defaults. 3) Tests validate redaction and schema stability.","notes":"Execution source-of-truth: docs/design/042-model-aware-agent-runtime-v1-execution-plan.md. Implement child chain in order: (kura-training-wvp.1.3 + kura-training-wvp.1.2) -\u003e kura-training-wvp.1.1. Safety invariant: unknown/malformed identity must never elevate autonomy and must map to conservative fallback.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:14.236568+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.689337+01:00","closed_at":"2026-02-13T18:25:19.689337+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.1","depends_on_id":"kura-training-wvp","type":"parent-child","created_at":"2026-02-13T09:53:14.237889+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.1.1","title":"[wvp.1c] Self-model contract tests","description":"Add API tests for self_model schema stability, redaction compatibility, and conservative defaults for unknown/legacy resolution.","acceptance_criteria":"1) tests fail on schema drift. 2) redaction contract remains intact. 3) unknown/legacy path remains conservative.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:02:53.695224+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.678767+01:00","closed_at":"2026-02-13T18:25:19.678767+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.1.1","depends_on_id":"kura-training-wvp.1","type":"parent-child","created_at":"2026-02-13T18:03:51.435439+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.1.1","depends_on_id":"kura-training-wvp.1.3","type":"blocks","created_at":"2026-02-13T18:04:18.861113+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.1.1","depends_on_id":"kura-training-wvp.1.2","type":"blocks","created_at":"2026-02-13T18:04:24.072369+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.1.2","title":"[wvp.1b] Trusted model identity resolver","description":"Implement server-side model identity resolution from trusted runtime sources (client_id mapping, runtime default, unknown fallback).","acceptance_criteria":"1) deterministic resolution order implemented. 2) unknown/malformed identity falls back to strict-safe path. 3) no client-supplied privilege elevation.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:02:53.695337+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.677322+01:00","closed_at":"2026-02-13T18:25:19.677322+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.1.2","depends_on_id":"kura-training-wvp.1","type":"parent-child","created_at":"2026-02-13T18:02:53.697602+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.1.3","title":"[wvp.1a] Self-model schema in context + capabilities","description":"Add self_model contract block to /v1/agent/context and /v1/agent/capabilities with explicit schema_version and deny-by-default fallback metadata.","acceptance_criteria":"1) self_model exists in both endpoints. 2) schema_version is explicit and stable. 3) fallback behavior is conservative.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:02:53.714568+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.675428+01:00","closed_at":"2026-02-13T18:25:19.675428+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.1.3","depends_on_id":"kura-training-wvp.1","type":"parent-child","created_at":"2026-02-13T18:03:56.652371+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.2","title":"Model Tier Registry + Policy Mapping","description":"Define deterministic mapping from runtime model identity to capability tier and policy constraints.","design":"Implement registry with explicit tiers (strict, moderate, advanced), required confidence floors, and allowed action scopes. Integrate with autonomy policy extraction so write behavior is deterministic per tier.","acceptance_criteria":"1) Model identity resolves to a tier or conservative fallback. 2) Tier policy is machine-readable in system conventions. 3) Tests cover known, unknown, and malformed identity inputs.","notes":"Execution source-of-truth: docs/design/042-model-aware-agent-runtime-v1-execution-plan.md. Implement child chain in order: kura-training-wvp.2.1 -\u003e kura-training-wvp.2.2 -\u003e kura-training-wvp.2.3. Safety invariant: model_identity -\u003e tier mapping is deterministic; unknown/malformed identities resolve to strict fallback.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:19.465337+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.690587+01:00","closed_at":"2026-02-13T18:25:19.690587+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.2","depends_on_id":"kura-training-wvp","type":"parent-child","created_at":"2026-02-13T09:53:19.466257+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.2","depends_on_id":"kura-training-2zc.5","type":"blocks","created_at":"2026-02-13T09:54:12.553224+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.2","depends_on_id":"kura-training-wvp.1","type":"blocks","created_at":"2026-02-13T09:56:28.620514+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.2.1","title":"[wvp.2a] Model tier registry contract surface","description":"Expose machine-readable model_tier_registry_v1 policy contract in system conventions and ensure agent-facing visibility through redaction allowlist rules.","acceptance_criteria":"1) registry contract exists in conventions. 2) tier policy is machine-readable. 3) agent-facing redaction behavior is explicit.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:02:53.707065+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.680268+01:00","closed_at":"2026-02-13T18:25:19.680268+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.2.1","depends_on_id":"kura-training-wvp.2","type":"parent-child","created_at":"2026-02-13T18:02:53.707853+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.2.1","depends_on_id":"kura-training-wvp.1.3","type":"blocks","created_at":"2026-02-13T18:04:29.287159+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.2.2","title":"[wvp.2b] Deterministic tier resolver + policy mapping","description":"Implement deterministic mapping model_identity -\u003e capability_tier (strict/moderate/advanced) and map tier to confidence floors and allowed action scopes.","acceptance_criteria":"1) known identities resolve deterministically. 2) unknown/malformed resolve to strict fallback. 3) tier policy output is consumable by runtime gates.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:02:53.714794+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.681942+01:00","closed_at":"2026-02-13T18:25:19.681942+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.2.2","depends_on_id":"kura-training-wvp.2","type":"parent-child","created_at":"2026-02-13T18:02:53.716279+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.2.2","depends_on_id":"kura-training-wvp.1.2","type":"blocks","created_at":"2026-02-13T18:04:34.502752+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.2.2","depends_on_id":"kura-training-wvp.2.1","type":"blocks","created_at":"2026-02-13T18:04:39.710724+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.2.3","title":"[wvp.2c] Tier mapping tests (known/unknown/malformed)","description":"Add unit/integration tests for known model identities, unknown identities, malformed identities, and deterministic conservative fallback behavior.","acceptance_criteria":"1) known/unknown/malformed paths covered. 2) fallback is strict and deterministic. 3) tests assert machine-readable policy outputs.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:03:06.758285+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.683741+01:00","closed_at":"2026-02-13T18:25:19.683741+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.2.3","depends_on_id":"kura-training-wvp.2","type":"parent-child","created_at":"2026-02-13T18:03:06.759487+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.2.3","depends_on_id":"kura-training-wvp.2.2","type":"blocks","created_at":"2026-02-13T18:04:44.923508+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.3","title":"Adaptive Autonomy Gate: Model Tier x Calibration","description":"Gate high-impact actions using combined model tier and extraction calibration status.","design":"Extend claim/save/workflow gates to include model-tier policy and calibration status. Low-tier or degraded-calibration paths force confirm-first or block unsafe actions with explicit reason codes.","acceptance_criteria":"1) High-impact writes respect combined gate decisions. 2) Responses include deterministic reason codes. 3) Tests cover strict/moderate/advanced tiers with healthy/monitor/degraded calibration states.","notes":"Execution source-of-truth: docs/design/042-model-aware-agent-runtime-v1-execution-plan.md. Implement child chain in order: kura-training-wvp.3.2 -\u003e kura-training-wvp.3.1 -\u003e kura-training-wvp.3.3. Safety invariant: high-impact writes must follow gate decision allow|confirm_first|block with deterministic reason_codes.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:24.692843+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.691782+01:00","closed_at":"2026-02-13T18:25:19.691782+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.3","depends_on_id":"kura-training-wvp","type":"parent-child","created_at":"2026-02-13T09:53:24.6941+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.3","depends_on_id":"kura-training-wvp.1","type":"blocks","created_at":"2026-02-13T09:54:17.737498+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.3","depends_on_id":"kura-training-wvp.2","type":"blocks","created_at":"2026-02-13T09:54:22.9569+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.3.1","title":"[wvp.3b] Reason-code contract + payload wiring","description":"Add stable machine-readable reason_codes for autonomy reductions/blocks and include them in API response and quality signal event payloads.","acceptance_criteria":"1) stable reason_code catalog implemented. 2) confirm/block decisions always emit reason_codes. 3) response + event payloads are updated.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:03:22.552828+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.686474+01:00","closed_at":"2026-02-13T18:25:19.686474+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.3.1","depends_on_id":"kura-training-wvp.3","type":"parent-child","created_at":"2026-02-13T18:03:22.553682+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.3.1","depends_on_id":"kura-training-wvp.3.2","type":"blocks","created_at":"2026-02-13T18:04:55.346156+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.3.2","title":"[wvp.3a] Adaptive autonomy decision engine (tier x calibration)","description":"Implement deterministic gate decision from model tier, calibration status, integrity status, and action class (allow|confirm_first|block).","acceptance_criteria":"1) decision matrix implemented deterministically. 2) conservative behavior on ambiguity/errors. 3) high-impact writes follow gate decision.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:03:22.559083+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.685143+01:00","closed_at":"2026-02-13T18:25:19.685143+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.3.2","depends_on_id":"kura-training-wvp.3","type":"parent-child","created_at":"2026-02-13T18:03:22.560651+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.3.2","depends_on_id":"kura-training-wvp.2.2","type":"blocks","created_at":"2026-02-13T18:04:50.13818+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.3.3","title":"[wvp.3c] Gate matrix tests + integration scenarios","description":"Add tests for strict/moderate/advanced tiers across healthy/monitor/degraded statuses, including high-impact write behavior and deterministic reason codes.","acceptance_criteria":"1) full tier x status matrix covered. 2) high-impact block/confirm behavior asserted. 3) reason_codes determinism tested.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T18:03:22.558828+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T18:25:19.687892+01:00","closed_at":"2026-02-13T18:25:19.687892+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.3.3","depends_on_id":"kura-training-wvp.3","type":"parent-child","created_at":"2026-02-13T18:04:01.86878+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.3.3","depends_on_id":"kura-training-wvp.3.1","type":"blocks","created_at":"2026-02-13T18:05:00.55575+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.3.3","depends_on_id":"kura-training-wvp.2.3","type":"blocks","created_at":"2026-02-13T18:05:05.762793+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.4","title":"Shadow Eval Matrix by Model Tier","description":"Extend shadow evaluation to compare policy behavior across model tiers before rollout.","design":"Add per-tier replay matrix and release criteria deltas (quality, clarification rate, blocked unsafe attempts). Promotion requires no regression for protected metrics on weakest supported tier.","acceptance_criteria":"1) Shadow report includes tier-stratified metrics and pass/fail. 2) Release gate blocks rollout on weakest-tier regressions. 3) Sample report documented.","notes":"Sequenced after runtime modularization/decoupling for safer tier-matrix rollout. Dependency chain: wvp.5 -\u003e wvp.6 -\u003e wvp.4. Keep release-gate output machine-readable for siq.6 stakeholder proof artifacts.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T09:53:29.920157+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T06:28:44.288187+01:00","closed_at":"2026-02-14T06:28:44.288187+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.4","depends_on_id":"kura-training-wvp","type":"parent-child","created_at":"2026-02-13T09:53:29.921242+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.4","depends_on_id":"kura-training-wvp.3","type":"blocks","created_at":"2026-02-13T09:54:28.158903+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.4","depends_on_id":"kura-training-2zc.4","type":"blocks","created_at":"2026-02-13T09:54:33.361117+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.4","depends_on_id":"kura-training-wvp.6","type":"blocks","created_at":"2026-02-13T20:13:21.594471+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.5","title":"Agent Runtime Modularisierung V1: agent.rs in Domänenmodule ohne Verhaltensdrift","description":"Warum:\napi/src/routes/agent.rs ist ein zentraler Hotspot mit sehr hoher Größe und hoher Änderungsdichte. Das erhöht Review-Risiko und erschwert sichere Agent-gestützte Änderungen.\n\nScope:\n- Inkrementeller Refactor in Domänenmodule ohne Verhaltensänderung.\n- Klare Grenzflächen für Contracts, Policy, Write/Verify, Context, Visualization, Audit.\n- Tests mitziehen/neu ordnen, damit Ownership pro Modul klar bleibt.\n\nWas muss gelten:\n- Verhalten bleibt stabil (keine API-Contract-Regression).\n- Alle bestehenden Tests und Gates bleiben grün.\n- Modulgrenzen sind so gesetzt, dass Folgearbeit (z.B. wvp.4) gezielt auf Teilbereiche zugreifen kann.\n\nNicht-Ziele:\n- Keine neue Produktfunktion in diesem Task.\n- Kein „Big Bang“-Rewrite.\n\nImplementierungsanker:\n- api/src/routes/agent.rs\n- api/src/routes/agent/* (neue Module)\n- zugehörige Rust-Tests\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst Modul-Schnittstellen und Migrationsschritte (Commit-für-Commit) nachvollziehen. Refactor nur in kleinen, verifizierten Schritten mit vollem Gate-Lauf nach jedem Schritt.\n","design":"Refactor-first, behavior-preserving. Ziel ist niedrigere Änderungsrisiken bei gleicher Semantik.","acceptance_criteria":"1) Zentrale Verantwortungen sind in separaten Modulen organisiert; agent.rs dient primär als dünner Routing-/Orchestrierungs-Layer. 2) API-Contracts bleiben kompatibel (bestehende Tests grün). 3) Voller Qualitätslauf (ruff, worker tests, integration tests, cargo test) ist grün.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:12:29.446131+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T06:15:26.243144+01:00","closed_at":"2026-02-14T06:15:26.243144+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.5","depends_on_id":"kura-training-wvp","type":"parent-child","created_at":"2026-02-13T20:12:29.447477+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.5","depends_on_id":"kura-training-amg.2","type":"blocks","created_at":"2026-02-13T20:12:34.644978+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wvp.6","title":"MCP/CLI Entkopplung V1: Shared Runtime statt Path-Include","description":"Warum:\nDer MCP-Runtime-Entry bindet aktuell CLI-Code per Pfad-Include ein. Das erhöht Kopplung und erschwert unabhängige Evolution von CLI und MCP.\n\nScope:\n- Shared Runtime/Contract-Schicht extrahieren (z.B. gemeinsames Crate/Modul), die von CLI und MCP genutzt wird.\n- mcp/src/lib.rs auf sauberen Import umstellen; path-include entfernen.\n- Kompatibilität der MCP-Tools und CLI-Verhalten sicherstellen.\n\nWas muss gelten:\n- Keine direkte Pfad-Include-Kopplung mehr zwischen mcp und cli.\n- Gemeinsame Funktionalität ist explizit versionierbar und testbar.\n\nNicht-Ziele:\n- Keine Änderung an externen API-Semantiken.\n- Keine UI-Arbeit.\n\nImplementierungsanker:\n- mcp/src/lib.rs\n- cli/src/commands/mcp.rs\n- ggf. neues shared crate/modul\n\nHandoff (compaction-safe):\nNach Kontextverlust zuerst Dependency-Graph (Cargo.toml) und neue shared Schicht lesen; danach Importpfade und MCP-Tests prüfen.\n","design":"Vision-konform: CLI und MCP als getrennte Interfaces mit minimierter technischer Kopplung.","acceptance_criteria":"1) mcp/src/lib.rs nutzt kein #[path = \"../../cli/...\"] mehr. 2) CLI- und MCP-Tests bleiben grün. 3) Gemeinsame Runtime/Contract-Schicht ist explizit und wartbar.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-13T20:12:39.882825+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T06:18:57.196329+01:00","closed_at":"2026-02-14T06:18:57.196329+01:00","close_reason":"Closed","dependencies":[{"issue_id":"kura-training-wvp.6","depends_on_id":"kura-training-wvp","type":"parent-child","created_at":"2026-02-13T20:12:39.883696+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-wvp.6","depends_on_id":"kura-training-wvp.5","type":"blocks","created_at":"2026-02-13T20:12:45.085236+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-y0t","title":"Nightly Refit Scheduler Hardening","description":"Replace bootstrap-based recurring inference scheduling with a dedicated durable scheduler mechanism (single-flight, dedup, recovery after failed run). Add explicit telemetry for next_run_at and missed-run catch-up behavior.","notes":"Follow-up from semantic/bayesian foundation implementation.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-11T09:04:52.382683+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T11:21:38.334534+01:00","closed_at":"2026-02-11T11:21:38.334534+01:00","close_reason":"Durable Nightly Scheduler mit single-flight, dedup, failed-run recovery und Telemetrie (next_run_at/missed_runs) implementiert; lokal mit DB-Integrationstests verifiziert","labels":["bayesian","scheduler","workers"]}
{"id":"kura-training-yep","title":"Observability: Access Pattern Logging Middleware","description":"Strukturiertes Access-Log auf API-Ebene. Erfasst Agent-Zugriffsmuster unabhängig davon, ob CLI oder MCP Server der Client ist.\n\nLogged wird:\n(timestamp, user_id, method, endpoint, projection_type, key, status_code, batch_size, response_time_ms)\n\nKeine User-Daten, nur Zugriffsmuster.\n\nDaraus lesen wir:\n- Welche Projections zusammen gelesen werden (→ Kandidaten für Graduation zu Domain-Tools)\n- Welche Event-Sequenzen häufig sind (→ Batch-Optimierungen)\n- Ob Batch oder Einzel überwiegt\n- Welche Endpoints nie genutzt werden (→ tote API-Fläche)\n- Response-Zeiten pro Endpoint (→ Performance-Monitoring)\n\nImplementierung: axum Middleware/Layer, eigene Tabelle (api_access_log), kein RLS nötig (Infra-Daten, nicht User-Daten).\n\nMuss VOR dem ersten echten Agent-Einsatz stehen — sonst fehlen die Daten von Anfang an.\n\nUnabhängig von den Data Integrity Tickets — kann parallel gebaut werden.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:58.20729+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T16:47:55.092723+01:00","closed_at":"2026-02-09T16:47:55.092723+01:00","close_reason":"Auth refactored to Tower Layer (InjectAuthLayer), AccessLogLayer captures all /v1/* access patterns, api_access_log table with analytics indexes. 26 Rust + 233 Python tests passing."}
{"id":"kura-training-yi1","title":"Decision 13 Phase 0: Self-Healing Instrumentation","description":"Implement the first production slice from docs/design/013-self-healing-agentic-data-plane.md (Phase 0). Add read-only invariant evaluation over events/projections and a quality_health/overview projection so system quality becomes measurable before autonomous repair.","design":"Reference: docs/design/013-self-healing-agentic-data-plane.md (Decision 13), sections Decision 13.2, 13.3, 13.4, Rollout Phase 0. Keep append-only and non-mutating behavior; no auto-fixes in this phase.","acceptance_criteria":"1) Invariant evaluator runs in read-only mode and emits typed issues without mutating canonical events. 2) New projection quality_health/overview is computed and queryable. 3) Projection includes score/status/open-issue counts by severity and top issue summaries. 4) At least one integration-style test proves issue detection from real event data. 5) Documentation/comments reference Decision 13 explicitly.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-11T16:13:13.624513+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-11T16:17:33.185633+01:00","closed_at":"2026-02-11T16:17:33.185633+01:00","close_reason":"Implemented Decision 13 Phase 0 slice: read-only invariant evaluator (INV-001/003/005/006), new quality_health/overview projection with score/status/issue summaries, unit tests, and integration-style quality health test (DB-backed)."}
{"id":"kura-training-zhr","title":"Split system layer: system_config table + endpoint","description":"Extract deployment-static system layer from user_profile monolith into separate system_config table and API endpoint. system_config written at worker startup, user_profile slimmed to user+agenda only.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T14:45:26.846565+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T14:51:28.948653+01:00","closed_at":"2026-02-09T14:51:28.948653+01:00","close_reason":"Implemented: system_config table + GET /v1/system/config endpoint. user_profile slimmed to {user, agenda}. 204 Python tests passing, Rust compiles clean."}
{"id":"kura-training-znc","title":"Mismatch-Severity nach Datenintegritäts-Risiko gewichten","description":"## Entscheidungszusammenfassung (Warum)\n\nDie aktuelle Mismatch-Metrik ist binaer und vermischt unterschiedliche Risiken zu einem einzigen Zaehler. Damit kann ein rein protokollarischer Mangel (z. B. Event-ID im Echo fehlt) dieselbe Degradierung ausloesen wie ein echter Integritaets-Bruch (Echo fehlt komplett). Das fuehrt zu False Positives in Auto-Tiering und verschlechtert UX ohne realen Sicherheitsgewinn. Diese Aufgabe fuehrt eine risikobasierte Gewichtung (`critical/warning/info`) ein, ohne Alt-Daten zu brechen. Ergebnis: Tiering und Lernsignale spiegeln Datenmull-Risiko statt Format-Pedanterie.\n\n## Harte Vorbedingung\n\n- Abhaengig von `kura-training-vcf` (Save-Echo Always-On).\n- Erst nach expliziter Save-Echo-Policy macht die Severity-Gewichtung semantisch konsistent Sinn.\n\n## Problem im Ist-Zustand (Code-Referenz)\n\n- Worker berechnet Mismatch aktuell binaer:\n  - `workers/src/kura_workers/handlers/quality_health.py` (`_compute_save_claim_slo`, Zeilenbereich ~1242-1280)\n- Auto-Tiering SQL zaehlt binaer `mismatch_detected`:\n  - `api/src/routes/agent/policy.rs` (`resolve_auto_tier_policy`, SQL im Zeilenbereich ~783-810)\n- Learning-Clustering kennt nur statisches Signalgewicht ohne differenzierte Save-Mismatch-Severity:\n  - `workers/src/kura_workers/issue_clustering.py` (`_SEVERITY_WEIGHT_BY_SIGNAL`, Zeilenbereich ~27-41)\n- API schreibt aktuell `mismatch_detected = !allow_saved_claim` (Proof-Mismatch), nicht Echo-Detail-Risiko:\n  - `api/src/routes/agent/write_verification.rs` (Zeilenbereich ~872-883)\n\n## Zielzustand (Invarianten)\n\n1. Save-Mismatch wird in `critical|warning|info|none` klassifiziert.\n2. Auto-Tiering nutzt **gewichtete** Mismatch-Last statt roher Count-Bits.\n3. Alt-Events ohne Severity-Felder bleiben verarbeitbar (deterministischer Fallback).\n4. Proof-Mismatch (`allow_saved_claim=false`) und Echo-Mismatch bleiben unterscheidbar, aber aggregierbar.\n5. Metriken liefern Breakdowns pro Severity fuer Auditierbarkeit.\n\n## Datenvertrag (verbindlich)\n\n`quality.save_claim.checked.data` wird erweitert um:\n\n- `mismatch_severity`: `\"critical\"|\"warning\"|\"info\"|\"none\"`\n- `mismatch_weight`: `1.0|0.5|0.1|0.0`\n- `mismatch_domain`: `\"save_echo\"|\"proof_verification\"|\"protocol\"`\n- `mismatch_reason_codes`: `string[]`\n\nKompatibilitaetsregeln fuer Alt-Events (wenn Felder fehlen):\n\n- Wenn `mismatch_detected=true` -\u003e Fallback `critical` + Gewicht `1.0`\n- Wenn `mismatch_detected=false` -\u003e Fallback `none` + Gewicht `0.0`\n\nHinweis: Diese Fallback-Regel ist hart zu testen; keine impliziten Defaults in mehreren Modulen verstreuen.\n\n## Implementierungs-Scope (Wie)\n\n### A) API: Severity erzeugen und persistieren\n\n- `api/src/routes/agent/write_verification.rs`\n  - Klassifikationsfunktion einfuehren, die aus Echo-/Proof-Check eine Severity ableitet.\n  - `build_save_claim_checked_event(...)` erweitert Payload um `mismatch_severity`, `mismatch_weight`, `mismatch_domain`, `mismatch_reason_codes`.\n  - `learning.signal.logged` Attribute fuer `save_claim_mismatch_attempt` um gleiche Kernfelder erweitern.\n\n### B) Worker: gewichtete Integrity-SLOs\n\n- `workers/src/kura_workers/handlers/quality_health.py`\n  - `_compute_save_claim_slo(...)` auf gewichtete Summen erweitern.\n  - Neue Ausgabe-Felder:\n    - `weighted_mismatch_sum`\n    - `weighted_mismatch_rate_pct`\n    - `severity_breakdown` (`critical/warning/info/none`)\n  - Legacy-Output nur wenn noetig beibehalten; konsumierende Pfade klar auf weighted umstellen.\n\n### C) Auto-Tiering SQL auf gewichtete Mismatch-Last\n\n- `api/src/routes/agent/policy.rs`\n  - SQL in `resolve_auto_tier_policy(...)` von binaerem `SUM(CASE mismatch_detected ...)` auf gewichtete Summe umstellen:\n    - Primar: `mismatch_weight`\n    - Fallback: binaere Ableitung wie oben\n  - Prozentberechnung bleibt `weighted_sum / sample_count * 100`.\n  - Schwellenwerte dokumentieren und bei Bedarf minimal nachziehen (keine stillen Aenderungen).\n\n### D) Cross-user Clustering\n\n- `workers/src/kura_workers/issue_clustering.py`\n  - Save-Mismatch-Severity aus Signal-Attributen einlesen und in Severity-Faktor einfliessen lassen.\n  - Falls Attribut fehlt: bestehendes Verhalten als Fallback.\n\n## Architecture-Spec-Tests (Pflicht laut AGENTS.md)\n\nNeue/angepasste Tests in `tests/architecture/`:\n\n1. `tests/architecture/test_12_save_claim_mismatch_severity_contract.py`\n   - Runtime-Kontrakte via `assert_kura_api_test_passes(...)`:\n     - `routes::agent::tests::save_claim_mismatch_severity_contract_critical_when_echo_missing`\n     - `routes::agent::tests::save_claim_mismatch_severity_contract_info_when_only_protocol_detail_missing`\n     - `routes::agent::tests::save_claim_mismatch_severity_contract_backcompat_defaults_for_legacy_payload`\n\n2. `tests/architecture/test_60_agent_contract_coverage_matrix.py`\n   - Contract-Key fuer `save_claim_mismatch_severity` aufnehmen.\n\n3. Worker-Architektur-Absicherung (pythonseitig, deterministic)\n   - Test auf gewichtete SLO-Berechnung inkl. Alt-Event-Fallback.\n\n## Nicht-Ziele\n\n- Keine Aenderung am strict-only Intent-Handshake.\n- Keine neue UI.\n- Keine manuelle Datenmigration historischer Events.\n\n## Akzeptanzkriterien\n\n- `quality.save_claim.checked` schreibt Severity + Weight + Domain + Reason-Codes.\n- Auto-Tiering verwendet gewichtete Mismatch-Last mit dokumentiertem Legacy-Fallback.\n- `quality_health` liefert Severity-Breakdown und gewichtete Rate.\n- Clustering priorisiert Save-Mismatch-Faelle nach Severity statt pauschal 1.0.\n- Alle neuen Architecture-Spec-Tests sind gruen.\n\n## Hinweise fuer KI-Umsetzung mit wenig Kontext (compaction-resistent)\n\n- Niemals `mismatch_detected` umdeuten, ohne Fallback explizit zu codieren und zu testen.\n- Bei Konflikt zwischen Datenreinheit und Rueckwaertskompatibilitaet: kompatibel ausrollen, dann Konsumenten schrittweise umstellen.\n- Gewichtung ist ein **Policy-Contract**, kein stilles Refactoring; Schwellen und Formel muessen im Code erkennbar bleiben.\n","status":"open","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-14T11:29:49.436705+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-14T11:46:15.054969+01:00","dependencies":[{"issue_id":"kura-training-znc","depends_on_id":"kura-training-vcf","type":"blocks","created_at":"2026-02-14T11:29:55.142577+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-zv3","title":"API: Signup invite gate (SIGNUP_GATE config)","description":"## Was\nRegistration-Endpoint um Invite-Token-Validierung erweitern. Config-Switch für Gate-Modus.\n\n## Config\n- Env-Variable: SIGNUP_GATE=invite|open|payment (default: open)\n- Bei invite: Registration erfordert gültiges invite_token\n- Bei open: keine Prüfung (aktuelles Verhalten)\n- Bei payment: Platzhalter, gibt 403 mit Hinweis zurück (für später)\n\n## Änderungen an POST /v1/auth/register\n- Neues optionales Feld: invite_token\n- Wenn SIGNUP_GATE=invite:\n  - invite_token required, sonst 403 { error: \"invite_required\", message: \"...\", docs_hint: \"Request access at /request-access\" }\n  - Token validieren: existiert, nicht abgelaufen, nicht benutzt, Email-Match wenn gebunden\n  - Bei Erfolg: used_at=now(), used_by=new_user_id setzen\n- Neues Feld: consent_anonymized_learning (bool, required wenn SIGNUP_GATE=invite)\n  - Muss true sein für Registrierung im invite-Modus\n  - Wird am User gespeichert\n\n## Fehler\n- 403 invite_required: kein Token bei SIGNUP_GATE=invite\n- 403 invite_invalid: Token ungültig, abgelaufen, oder bereits benutzt\n- 403 invite_email_mismatch: Token an andere Email gebunden\n- 400 consent_required: consent_anonymized_learning fehlt oder false\n\n## Hinweise\n- Abwärtskompatibel: SIGNUP_GATE=open → alles wie bisher\n- invite_token Feld wird einfach ignoriert bei open-Modus","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-13T12:45:12.223285+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-13T13:03:43.459357+01:00","closed_at":"2026-02-13T13:03:43.459357+01:00","close_reason":"SIGNUP_GATE config + invite validation in register","dependencies":[{"issue_id":"kura-training-zv3","depends_on_id":"kura-training-33v","type":"blocks","created_at":"2026-02-13T12:46:55.533685+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-zv3","depends_on_id":"kura-training-az0","type":"blocks","created_at":"2026-02-13T12:47:37.11362+01:00","created_by":"jonzim-cmd"}]}
