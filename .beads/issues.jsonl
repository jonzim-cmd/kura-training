{"id":"kura-training-0hf","title":"Write Path: POST /v1/events + POST /v1/events/batch mit Idempotency","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:05.490369+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T07:26:40.287064+01:00","closed_at":"2026-02-08T07:26:40.287064+01:00","close_reason":"Closed"}
{"id":"kura-training-2kb","title":"Agent-Verhaltens-Conventions in system_config","description":"Neue Sektion in system_config für Agent-Verhalten (nicht Daten-Conventions): Bei Mehrdeutigkeit nachfragen statt annehmen, nicht mehr erstellen als explizit gewünscht, Follow-up-Fragen bei fehlenden Daten. System-Defaults in system_config, User-Overrides in user_profile. Quasi eine soul.md als Datenstruktur. Entdeckt im Kura-Playtest 2026-02-09 (über-eifriger Agent hat 3-Tage-Plan statt nur Tag A erstellt).","notes":"Grundgerüst implementiert: vision (Bach-Prinzipien) + operational (scope levels, rules). Follow-up: konkrete Szenarien, Beispiele, User-Override-Mechanismus in user_profile.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:50.376579+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:25:44.812262+01:00","closed_at":"2026-02-10T07:25:44.812262+01:00","close_reason":"Grundgerüst implementiert. Detailausbau als Follow-up."}
{"id":"kura-training-3ii","title":"Read Path: GET /v1/events mit Cursor-Pagination","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:06.26606+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T07:33:04.862031+01:00","closed_at":"2026-02-08T07:33:04.862031+01:00","close_reason":"GET /v1/events with cursor pagination, filtering (event_type, since, until), RLS enforcement. Tested and working."}
{"id":"kura-training-3n4","title":"exercise_progression alias fragmentation","description":"exercise_progression queries events by exercise_key, but does not resolve aliases. If user logs 'Kniebeuge' then creates alias Kniebeuge-\u003ebarbell_back_squat, the progression for barbell_back_squat misses the old Kniebeuge events. Data is fragmented until agent consistently uses exercise_id. Options: (a) resolve aliases at query time, (b) re-index on alias creation, (c) document as known limitation.","status":"closed","priority":2,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-08T15:18:42.59717+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:17:19.575344+01:00","closed_at":"2026-02-09T08:17:19.575344+01:00","close_reason":"Alias-aware handlers implemented: exercise_progression resolves through aliases and DELETEs stale projections, training_timeline resolves exercise keys through aliases. Plus conventions in system layer to prevent fragmentation at source."}
{"id":"kura-training-4u6","title":"Semantic Layer: pgvector + pre-trained embeddings","description":"Exercise and food resolution via embedding similarity. Pre-trained sentence transformer, pgvector for storage/query. Cross-language matching (Kniebeuge ~ barbell back squat). Background worker computes embeddings on new exercises. Enhances but doesn't replace per-user alias system.","status":"open","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:27.62076+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T13:39:27.62076+01:00"}
{"id":"kura-training-57d","title":"Data Integrity: Event Conventions für Korrekturen","description":"Event Conventions für event.retracted und Null-Semantik in profile.updated definieren und in event_conventions.py aufnehmen.\n\nevent.retracted: Universelles Retraction-Pattern — ein Event-Typ für alle Korrekturen. Felder: retracted_event_id (required), reason (optional). Retraction ist bewusst getrennt von Correction, weil es handler-agnostisch funktioniert.\n\nprofile.updated Null-Semantik: Explizit dokumentieren, dass null-Werte 'Feld entfernen' bedeuten. Ist implizit schon so, muss aber in den Conventions stehen damit der Agent es weiß.\n\nDesignentscheidung: Nur event.retracted, KEIN *.corrected Pattern. Retraction + neues Event ist sauberer als Delta-Corrections, weil: (a) kein Handler typ-spezifische Correction-Logik braucht, (b) idempotent, (c) auditierbar. Correction wäre Overengineering.\n\nLiefert: Erweiterte event_conventions in system_config, die der Agent beim Session-Start liest.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:23.33533+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T15:49:56.795669+01:00","closed_at":"2026-02-09T15:49:56.795669+01:00","close_reason":"event.retracted convention + profile.updated null_semantics + data_correction convention in system_config. 6 new tests (210 total). No handler changes — those are dru + k71."}
{"id":"kura-training-6kf","title":"Design: Adaptives Projektionssystem (Attribute Passthrough, Raw Events, Deklarative Handler)","description":"Drei Ansätze für adaptives System statt starre Handler: (1) Attribute Passthrough — unbekannte Felder in Projektionen durchreichen statt wegwerfen, (2) Raw-Events-Projektion — letzte N Events pro User als Sicherheitsnetz, (3) Deklarative Handler — Handler-Verhalten als Config statt Code. Vor Implementierung: Vor-/Nachteile analysieren, weitere Optionen explorieren. Liquid-AI-Analogie: System reagiert auf User-Daten statt Blaupause. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:39.990394+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T22:11:01.693541+01:00","closed_at":"2026-02-09T22:11:01.693541+01:00","close_reason":"Phase 1 (Graceful Degradation) implemented. Phases 2-4 tracked separately."}
{"id":"kura-training-7an","title":"GET /v1/projections Snapshot-Endpoint (alle Dimensionen in einem Call)","description":"Neuer Endpoint der ALLE Projektionen eines Users in einem Call zurückgibt. Aktuell braucht der Agent pro Dimension einen separaten Call — bei 7+ Dimensionen zu mühsam. Ein einzelner Snapshot löst 80% der Kompositions-Probleme. Leicht zu implementieren, hoher Impact. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:42.869178+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:04:00.586791+01:00","closed_at":"2026-02-10T07:04:00.586791+01:00","close_reason":"GET /v1/projections implemented, tested, 20 projections in one call"}
{"id":"kura-training-7cy","title":"session_summary projection","description":"Projection that answers 'what did I do this week/today?' Grouped by day, shows exercises, volume, set counts. Uses session_id from metadata to group sets into sessions.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:12.873326+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:07:45.333995+01:00","closed_at":"2026-02-09T08:07:45.333995+01:00","close_reason":"session_summary killed — violates Decision 5 (Dimensions, not Answers). Data already available via training_timeline + exercise_progression composition.","dependencies":[{"issue_id":"kura-training-7cy","depends_on_id":"kura-training-nv2","type":"blocks","created_at":"2026-02-08T13:39:32.433452+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-880","title":"Docker Compose: PostgreSQL mit pgvector, RLS, DB-Rollen, Immutability-Constraints","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:01.964022+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-07T21:53:13.110532+01:00","closed_at":"2026-02-07T21:53:13.110532+01:00","close_reason":"Closed"}
{"id":"kura-training-9bz","title":"Projektstruktur + Rust Cargo Workspace anlegen (api, cli, core crates)","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:00.619292+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-07T21:53:09.542159+01:00","closed_at":"2026-02-07T21:53:09.542159+01:00","close_reason":"Closed"}
{"id":"kura-training-alk","title":"session_id Konzept für set.logged Events","description":"Optionales session_id Feld in set.logged Events. Agent generiert eine ID pro Trainingseinheit, hängt sie an jeden Set. training_timeline gruppiert nach session_id statt nur Datum. Ermöglicht mehrere Sessions pro Tag. Rückwärtskompatibel: alte Events ohne session_id fallen auf Tages-Gruppierung zurück. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:46.371672+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:17:12.665462+01:00","closed_at":"2026-02-10T07:17:12.665462+01:00","close_reason":"session_id implemented: event conventions, training_timeline session grouping, exercise_progression session counting, datagen generation. Full backward compatibility."}
{"id":"kura-training-aok","title":"Agenda-Severity-Eskalation bei ignorierten Issues","description":"Agenda-Items eskalieren in der Priorität wenn sie über Zeit ignoriert werden. Mechanik: Item trackt seit wann es existiert und wie viele Daten betroffen sind. Eskalationsstufen z.B.: info (neu) → low (\u003e1 Woche oder \u003e20 Events) → medium (\u003e2 Wochen oder \u003e50 Events) → high (\u003e4 Wochen oder \u003e100 Events). Verhindert stille Datenkorruption über Wochen. Beispiel: 'unresolved exercises' mit 3 Sets bleibt info. Mit 300 Sets nach 4 Wochen wird es high. Zwingt den Agent hinzuschauen.","notes":"Entstanden aus Agent-Walkthrough (2026-02-10): Sorge dass stille Datenkorruption sich über Wochen aufbaut wenn Agent Agenda-Items ignoriert. Aktuell: alle observed_patterns und orphaned_event_types sind priority=info, egal wie alt oder wie viele Daten betroffen. Umsetzung in handlers/user_profile.py in _build_agenda(). Braucht: Tracking von 'first_seen' pro Agenda-Item (z.B. aus Projection-Daten oder Event-Timestamps). Eskalationslogik: Anzahl betroffener Events + Alter des Issues → höhere Priorität.","status":"open","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T19:47:41.887837+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T19:48:37.709411+01:00","dependencies":[{"issue_id":"kura-training-aok","depends_on_id":"kura-training-tct","type":"blocks","created_at":"2026-02-10T19:48:42.43705+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-b3z","title":"Account-Löschung: Passwort-Bestätigung + 30-Tage Grace Period","description":"Zwei Hardening-Maßnahmen für Production: (1) DELETE /v1/account erfordert Passwort-Re-Entry im Request Body als Bestätigung. (2) Soft-Delete mit 30-Tage Grace Period — User wird sofort deaktiviert (is_active=false), Daten werden erst nach 30 Tagen endgültig gelöscht. Innerhalb der Frist kann der Account reaktiviert werden. Braucht: Cron-Job oder Worker-Task für verzögerte Hard-Deletes.","status":"open","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T18:17:09.084009+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T18:17:09.084009+01:00","dependencies":[{"issue_id":"kura-training-b3z","depends_on_id":"kura-training-lsu","type":"blocks","created_at":"2026-02-09T18:17:13.107188+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-b4z","title":"Event-Schema Migration: events Tabelle, Idempotency, Immutability auf DB-Level","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:04.537372+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-07T21:53:13.25639+01:00","closed_at":"2026-02-07T21:53:13.25639+01:00","close_reason":"Closed"}
{"id":"kura-training-bdn","title":"Enrich manifest metadata per dimension","description":"Manifest currently only has last_updated and optional exercises list. Design doc 002 specifies coverage (date range from/to), freshness, and dimension-specific summaries (weeks_tracked, last_training). Decide: enrich manifest from projections table metadata? Or read and summarize each projection's data?","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T15:18:38.721601+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T16:14:02.592905+01:00","closed_at":"2026-02-08T16:14:02.592905+01:00","close_reason":"Decision 7 implemented: manifest_contribution functions, dimension coverage with freshness/status, summary extraction per dimension"}
{"id":"kura-training-csy","title":"Exercise-ID Similarity Warnings bei POST /v1/events","description":"Wenn ein Event mit einer unbekannten exercise_id gepostet wird, soll die API ähnliche existierende exercise_ids als Warning zurückgeben. Erweitert das bestehende Plausibility Warnings System. Beispiel: POST mit exercise_id='lu_raise' → Warning: 'New exercise_id lu_raise. Similar existing: lateral_raise'. Verhindert stille Exercise-ID-Proliferation.","notes":"Entstanden aus Agent-Walkthrough (2026-02-10): Agent hat exercise_id='lu_raise' erstellt ohne zu wissen, dass 'lateral_raise' existiert. System akzeptiert alles ohne Feedback. Bestehende Plausibility Warnings: api/src/routes/events.rs (warn_unusual_values). Erweitern um exercise_id-Check gegen existierende IDs in der events-Tabelle. Ähnlichkeit z.B. über Levenshtein oder simple contains-Prüfung. Nur für exercise_id-Feld in set.logged und exercise.alias_created Events.","status":"open","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T19:47:34.648019+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T19:48:29.972678+01:00"}
{"id":"kura-training-cza","title":"Design Decision: training_plan dimension (prescriptive)","description":"Training plan is fundamentally different from existing dimensions: prescriptive (what SHOULD happen) vs descriptive (what DID happen). Needs own design doc. Key questions: Template vs concrete days? Load prescription (concrete kg vs RPE-based)? Plan lifecycle (active/archived/paused)? Adherence tracking (cross-dimension with training_timeline)? See Design Doc 002, Decision 9 for context.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T08:02:16.209951+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:07:39.769468+01:00","closed_at":"2026-02-09T08:07:39.769468+01:00","close_reason":"Implemented as part of Decision 9 — all 7 domain dimensions now have handlers"}
{"id":"kura-training-de9","title":"Data Integrity: API Response Warnings (Plausibilitäts-Checks)","description":"POST /v1/events und /v1/events/batch geben bei auffälligen Werten Warnings im Response zurück. Kein Reject, nur Signal.\n\nResponse-Erweiterung:\n{\n  id: '...',\n  warnings: [{field, message, severity: 'warning'}]\n}\n\nPlausibilitätsregeln sind dimension-spezifisch und könnten perspektivisch in system_config stehen (damit der Agent sie vorab kennt). Für den Anfang reichen hardcoded Regeln in der API.\n\nBeispiele:\n- weight_kg \u003e 300 bei set.logged → Warning\n- weight_kg \u003e 250 bei bodyweight.logged → Warning\n- calories \u003e 5000 bei meal.logged → Warning\n- Negative Werte bei Mengenfeldern → Warning\n\nWichtig: Das ist die schwächste Schicht (Prevention). Anomalie-Erkennung in den Handlern (Detection) ist wichtiger, weil sie auch Events erwischt, die einzeln plausibel sind aber im Kontext nicht (z.B. 1RM-Sprung von 100%). Deshalb P3, nicht P2.\n\nDesignfrage: Woher kommen die Regeln? Hardcoded? system_config? Per-User lernend? Für v1 reicht hardcoded.","status":"closed","priority":3,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:50.277755+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T16:22:04.83165+01:00","closed_at":"2026-02-09T16:22:04.83165+01:00","close_reason":"API plausibility warnings on event creation, 21 Rust unit tests, thresholds match Python handler anomaly detection","dependencies":[{"issue_id":"kura-training-de9","depends_on_id":"kura-training-57d","type":"blocks","created_at":"2026-02-09T15:42:02.813621+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-dru","title":"Data Integrity: Anomalie-Erkennung in Dimension-Handlern","description":"Jeder Dimension-Handler bekommt Anomalie-Erkennung in seiner Projection-Berechnung. Anomalien landen in data_quality.anomalies der Projection.\n\nWarum: Fehler werden passieren — LLMs machen Interpretationsfehler. Der Agent muss beim nächsten Projection-Read sehen, dass etwas verdächtig ist, und kann den User fragen.\n\nPro Handler:\n- exercise_progression: 1RM-Sprünge \u003e X%, unrealistische Gewichte pro Übung\n- body_composition: Gewichtsschwankungen \u003e 5kg/Tag, Messwerte außerhalb physiologischer Grenzen\n- nutrition: Tageskalorienwerte \u003e 10.000 oder \u003c 200, Makro-Summen vs Kalorien-Diskrepanz\n- recovery: Schlafdauer \u003e 24h oder \u003c 0, Energie-Level außerhalb Skala\n\nFormat in Projection:\ndata_quality.anomalies: [{event_id, field, value, expected_range, message}]\n\nWichtig: Anomalien sind WARNINGS, keine Fehler. Der Handler verarbeitet das Event trotzdem. Der Agent entscheidet, ob er korrigiert.\n\nDesignprinzip: 'Actionable, not descriptive' — jede Anomalie enthält genug Info damit der Agent handeln kann (event_id zum Retracten, field + value für die Korrektur-Konversation mit dem User).","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:32.783605+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T15:57:49.562915+01:00","closed_at":"2026-02-09T15:57:49.562915+01:00","close_reason":"Anomaly detection in 4 dimension handlers (exercise_progression, body_composition, nutrition, recovery). data_quality.anomalies in every projection. 23 new tests (233 unit + 9 integration). Code review: no issues. training_timeline, training_plan, user_profile don't need anomaly detection (aggregates/config).","dependencies":[{"issue_id":"kura-training-dru","depends_on_id":"kura-training-57d","type":"blocks","created_at":"2026-02-09T15:42:02.604622+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-dz8","title":"API Skeleton: axum + sqlx + utoipa, Health-Endpoint, Error-Struktur, Request-IDs, Tracing","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:03.330477+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-07T21:53:13.183937+01:00","closed_at":"2026-02-07T21:53:13.183937+01:00","close_reason":"Closed"}
{"id":"kura-training-goy","title":"Onboarding interview design (agent-side)","description":"Design the onboarding interview flow: agent conducts adaptive interview with new user, produces standard events (preference.set, exercise.alias_created, goal.set, profile.updated). Inspired by Anthropic Interviewer. Interview is agent-side, not Kura-side — Kura receives the resulting events.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:17.788435+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T20:48:06.472316+01:00","closed_at":"2026-02-08T20:48:06.472316+01:00","close_reason":"Implemented Decision 8: interview guide in system layer, context_seeds, coverage computation, profile.updated + injury.reported events, bootstrap response, 126 tests passing","dependencies":[{"issue_id":"kura-training-goy","depends_on_id":"kura-training-nv2","type":"blocks","created_at":"2026-02-08T13:39:32.511804+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-he1","title":"Enforce HTTPS and add HSTS","description":"Redirect HTTP to HTTPS, add Strict-Transport-Security header. Production security requirement.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T11:00:02.097685+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T11:16:10.404403+01:00","closed_at":"2026-02-08T11:16:10.404403+01:00","close_reason":"Closed"}
{"id":"kura-training-hj7","title":"Shell-Sonderzeichen in Übungsnamen absichern","description":"Übungsnamen mit \u0026 (z.B. 'Clean \u0026 Push Press') brechen curl-Calls im Shell. Agent musste auf Temp-Files ausweichen. Betrifft CLI und jede Shell-basierte Agent-Integration. Lösung: CLI muss Escaping korrekt handhaben, API-Docs sollten auf JSON-File-Input hinweisen. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":3,"issue_type":"bug","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:43:02.05986+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:43:41.29831+01:00","closed_at":"2026-02-10T07:43:41.29831+01:00","close_reason":"Note im CLI-Code (cli/src/main.rs) hinterlassen bei --data Argument. Fix kommt wenn CLI Event-Create richtig ausgebaut wird (--data-file / stdin)."}
{"id":"kura-training-ipu","title":"Configure CORS properly","description":"Configure CORS with explicit allowed origins instead of permissive defaults. Production security requirement.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T11:00:02.970538+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T11:16:10.414816+01:00","closed_at":"2026-02-08T11:16:10.414816+01:00","close_reason":"Closed"}
{"id":"kura-training-k71","title":"Data Integrity: Retraction-Support in Handlern (Full Replay)","description":"Handler müssen event.retracted verarbeiten können. Wenn ein retracted Event den eigenen Typ betrifft, wird die Projection per Full Replay neu berechnet.\n\nWarum Full Replay statt inkrementeller Subtraktion:\n- Korrekt bei jeder Aggregation (keine Rückwärts-Rechnung nötig)\n- Korrekturen sind selten → Performance unkritisch\n- Handler-Logik bleibt sauber (eine Berechnung, nicht zwei Pfade)\n- Bayesian Stats brauchen später sowieso Full Replay\n\nImplementierung pro Handler:\n1. Subscription auf event.retracted\n2. Prüfen ob retracted_event_id einen Event betrifft, der diesen Handler betrifft (event_type check)\n3. Alle Events des Users für eigene Event-Typen laden, retracted Events rausfiltern\n4. Projection komplett neu berechnen\n5. UPSERT wie gewohnt\n\nEdge Cases die durchdacht werden müssen:\n- exercise_progression hat Keys pro exercise_id — welche Keys sind betroffen?\n- Alias-Events retracten: Was passiert mit konsolidierten Projections?\n- Retraction eines Events das schon retracted wurde (idempotent ignorieren)\n- Performance bei Usern mit vielen Events (Pagination? Limit?)\n\nDas ist das komplexeste Ticket. Sorgfalt vor Geschwindigkeit.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:41.493674+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T16:14:01.10177+01:00","closed_at":"2026-02-09T16:14:01.10177+01:00","close_reason":"Full Replay retraction support in all 7 handlers + router + 18 integration tests","dependencies":[{"issue_id":"kura-training-k71","depends_on_id":"kura-training-57d","type":"blocks","created_at":"2026-02-09T15:42:02.675694+01:00","created_by":"jonzim-cmd"},{"issue_id":"kura-training-k71","depends_on_id":"kura-training-dru","type":"blocks","created_at":"2026-02-09T15:42:02.744699+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-kqf","title":"Inference Dimensions: Bayesian strength estimates, fatigue-readiness scores","description":"When PyMC/Stan engine arrives, computed values like Bayesian Strength Estimates or Fatigue-Readiness Scores could become their own dimension type. Not raw data, not agent composition — statistical inference. This is Decision 6 (Three Layers of Intelligence) materialized as projections. Prerequisite: PyMC/Stan integration.","status":"open","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T08:13:51.040943+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:13:51.040943+01:00"}
{"id":"kura-training-lsg","title":"set.logged conventions: exercise_id, weight_kg, richer fields","description":"Update set.logged conventions: units in field names (weight_kg), exercise + exercise_id duality, optional fields (rpe, set_type, tempo, duration_seconds, distance_meters). Update exercise_progression handler to prefer exercise_id. Document conventions in design doc.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:08.076267+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T14:11:06.233911+01:00","closed_at":"2026-02-08T14:11:06.233911+01:00","close_reason":"Conventions documented in design doc 002, exercise_progression updated (exercise_id priority, weight_kg, rpe/set_type, input validation), validation philosophy decided (free-form, no API validation), unit tests added (15 passing), whitespace bug fixed","dependencies":[{"issue_id":"kura-training-lsg","depends_on_id":"kura-training-nv2","type":"blocks","created_at":"2026-02-08T13:39:32.361961+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-lsu","title":"MCP Server (eigenes Projekt)","description":"Separate MCP server project. Thin client over REST API, speaks MCP protocol. Tool discovery, typed schemas, persistent connection. For Claude Desktop (local) and Claude.ai (hosted). Independent from CLI.","notes":"## Agent-Native Design Considerations (aus Artikel-Review)\n\n### Completion Signals\nMCP-Tools brauchen explizite Completion-Signale, nicht nur Daten-Rückgabe. Pattern: {status: 'success'|'error'|'complete', data: {...}} — damit der Client weiß, ob eine Multi-Step-Aufgabe noch läuft oder fertig ist. REST-API nutzt HTTP-Statuscodes (reicht), MCP braucht eigene Semantik.\n\n### Context Injection / System Prompt Design\nsystem_config + user_profile/me als Agent Entry Point (Decision 7) muss im MCP Server sauber exponiert werden. Der MCP Server sollte dem Client ermöglichen, system_config als Context zu injizieren — z.B. als MCP Resource, die der Client beim Session-Start liest und in den System-Prompt einbettet.\n\n### Partial Completion Tracking\nWenn MCP-Tools intern mehrere API-Calls machen (z.B. 'logge mein komplettes Training' = mehrere set.logged Events), braucht der Client Zwischenfeedback. MCP progress notifications nutzen, nicht stumm arbeiten.","status":"open","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:22.793928+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T15:25:06.885129+01:00","dependencies":[{"issue_id":"kura-training-lsu","depends_on_id":"kura-training-wid","type":"blocks","created_at":"2026-02-09T13:46:43.313485+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-m3k","title":"Agent-Behavior Detailausbau: Szenarien, Beispiele, User-Overrides","description":"Follow-up zu 2kb. Grundgerüst (vision + operational) steht. Noch offen: konkrete Szenarien mit Beispielen (wie der 3-Tage-Plan-Fehler), User-Override-Mechanismus in user_profile (z.B. scope=proactive), Integration mit interview_guide (Kommunikationsstil erfragen).","status":"open","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T07:25:51.179251+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:25:51.179251+01:00"}
{"id":"kura-training-nv2","title":"Preference \u0026 Alias event types + user_profile projection","description":"Per-user alias system (exercise.alias_created, preference.set, goal.set events) and user_profile projection that answers 'what does Kura know about this user?' Foundation for agent context across sessions.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T13:39:02.247548+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T13:49:49.315141+01:00","closed_at":"2026-02-08T13:49:49.315141+01:00","close_reason":"Implemented and integration-tested"}
{"id":"kura-training-nwn","title":"CLI Skeleton: kura health, kura event create, kura event list","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-07T21:40:07.108039+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T07:35:58.288559+01:00","closed_at":"2026-02-08T07:35:58.288559+01:00","close_reason":"CLI with kura health, kura event create, kura event list. JSON-only, structured errors, auto-idempotency keys."}
{"id":"kura-training-odw","title":"Account-Löschung (DSGVO Art. 17)","description":"DSGVO Art. 17 + Art. 9 (Gesundheitsdaten): User muss eigene Daten komplett löschen können. Admin ebenfalls. Sonst niemand. Hard DELETE auf events, projections, background_jobs, api_keys, users. Privilegierte DB-Rolle nötig (app_user hat kein DELETE auf events). Endpoints: DELETE /v1/account (self), DELETE /v1/admin/users/{id} (admin).","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T18:06:46.336955+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T18:15:17.951414+01:00","closed_at":"2026-02-09T18:15:17.951414+01:00","close_reason":"Implemented: DELETE /v1/account (self) + DELETE /v1/admin/users/{id} (admin). SECURITY DEFINER function for hard delete."}
{"id":"kura-training-pef","title":"Onboarding: Kommunikationsstil und Erfahrungslevel als Profilfelder","description":"context_seeds in Decision 8 sehen Felder wie communication_style, experience_level, language vor, aber sie existieren noch nicht konkret. profile.updated muss diese Felder verstehen. Agent soll Stil anpassen können basierend auf Nutzerpräferenz. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:36:14.139981+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:30:01.851196+01:00","closed_at":"2026-02-10T07:30:01.851196+01:00","close_reason":"communication_style als Freitext-Feld in profile.updated + coverage_area communication_preferences im interview_guide. Sprache nicht nötig (ergibt sich aus Kontext)."}
{"id":"kura-training-pl5","title":"Convention: empty projections vs early return","description":"Handlers return early when no events exist, so dimensions never appear in manifest for new users. Need convention: should handlers create empty projections with zero/null values so the agent can discover that the dimension exists but has no data? Affects training_timeline and exercise_progression.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-08T15:18:34.984294+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T08:17:21.712622+01:00","closed_at":"2026-02-09T08:17:21.712622+01:00","close_reason":"Convention established: no empty projections. System layer declares existence (dimension_meta), user layer shows 'no_data'. Already implemented in _build_user_dimensions()."}
{"id":"kura-training-rod","title":"Plan-vs-Ist Vergleich ermöglichen","description":"Agent muss wissen: Welches Training steht als nächstes an? Was wurde diese Woche schon gemacht? Aktuell muss er Plan + training_timeline manuell abgleichen. Mögliche Lösungen: (1) training_timeline bekommt sessions_this_week Feld mit Plan-Matching, (2) Agent-seitige Komposition aus Plan + Timeline (dann braucht es den Snapshot-Endpoint). Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:58.427759+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:41:04.547731+01:00","closed_at":"2026-02-10T07:41:04.547731+01:00","close_reason":"By design gelöst: Snapshot-Endpoint + recent_sessions mit Top-Sets + training_plan geben dem Agent alle Daten für Plan-vs-Ist. Agent-seitige Komposition ist hier die bessere Architektur als Cross-Dimension-Coupling.","dependencies":[{"issue_id":"kura-training-rod","depends_on_id":"kura-training-7an","type":"blocks","created_at":"2026-02-09T21:43:06.797537+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-s9z","title":"Rate Limiting on auth endpoints","description":"Add rate limiting to /v1/auth/register, /v1/auth/authorize, and /v1/auth/token to prevent brute-force attacks. Production security requirement.","status":"closed","priority":1,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-08T11:00:00.753215+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-08T11:16:10.39203+01:00","closed_at":"2026-02-08T11:16:10.39203+01:00","close_reason":"Closed"}
{"id":"kura-training-tct","title":"Projection-Output-Schemas in system_config","description":"Handler deklarieren ihre Projection-Output-Felder in dimension_meta (output_schema). build_system_config() sammelt sie ein und liefert sie über GET /v1/system/config aus. Damit weiß der Agent sofort welche Felder eine Projection hat, ohne raten zu müssen. Beispiel: exercise_progression hat estimated_1rm, total_sets, weekly_history[].estimated_1rm, etc.","notes":"Entstanden aus Agent-Walkthrough (2026-02-10): Agent konnte Projection-Daten nicht lesen weil Feldnamen unbekannt (estimated_1rm vs personal_records.best_estimated_1rm.value). Jeder Handler hat bereits dimension_meta in handlers/*.py. Erweitern um output_schema dict. build_system_config() in system_config.py sammelt es ein. Dann in GET /v1/system/config sichtbar. Kein API-Change nötig, nur Worker-seitig.","status":"open","priority":2,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-10T19:47:37.322685+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T19:48:33.132787+01:00"}
{"id":"kura-training-w9p","title":"training_timeline: Top-Sets pro Übung pro Tag in recent_days","description":"recent_days in training_timeline zeigt aktuell nur Übungsliste + Aggregate (total_sets, total_volume). Für einen schnellen Tagesüberblick fehlen die konkreten Top-Sets (schwerster Satz, bester 1RM) pro Übung. Mit dieser Anreicherung reicht EIN API-Call für 'Was hab ich heute gemacht?' statt 1+N Calls. Entdeckt im Kura-Playtest 2026-02-09.","status":"closed","priority":3,"issue_type":"feature","owner":"jonzim@posteo.de","created_at":"2026-02-09T21:42:54.492323+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-10T07:36:29.088661+01:00","closed_at":"2026-02-10T07:36:29.088661+01:00","close_reason":"Top-sets per exercise in recent_days + recent_sessions. epley_1rm moved to shared utils. Best estimated 1RM wins per exercise per day/session.","dependencies":[{"issue_id":"kura-training-w9p","depends_on_id":"kura-training-alk","type":"blocks","created_at":"2026-02-09T21:43:06.717554+01:00","created_by":"jonzim-cmd"}]}
{"id":"kura-training-wid","title":"E2E Validation via CLI vor MCP Server","description":"Manueller E2E Happy Path durch den CLI gegen laufende Instanz. User anlegen, Events posten (alle Event-Types), Projections lesen, Daten validieren. Lücken fixen bevor MCP Server gebaut wird.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T13:46:39.098108+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T14:12:54.632062+01:00","closed_at":"2026-02-09T14:12:54.632062+01:00","close_reason":"E2E validation complete. All 7 dimensions validated, 3 discoverability gaps found and fixed (projection_key, 18 event_conventions, bed_time naming)."}
{"id":"kura-training-yep","title":"Observability: Access Pattern Logging Middleware","description":"Strukturiertes Access-Log auf API-Ebene. Erfasst Agent-Zugriffsmuster unabhängig davon, ob CLI oder MCP Server der Client ist.\n\nLogged wird:\n(timestamp, user_id, method, endpoint, projection_type, key, status_code, batch_size, response_time_ms)\n\nKeine User-Daten, nur Zugriffsmuster.\n\nDaraus lesen wir:\n- Welche Projections zusammen gelesen werden (→ Kandidaten für Graduation zu Domain-Tools)\n- Welche Event-Sequenzen häufig sind (→ Batch-Optimierungen)\n- Ob Batch oder Einzel überwiegt\n- Welche Endpoints nie genutzt werden (→ tote API-Fläche)\n- Response-Zeiten pro Endpoint (→ Performance-Monitoring)\n\nImplementierung: axum Middleware/Layer, eigene Tabelle (api_access_log), kein RLS nötig (Infra-Daten, nicht User-Daten).\n\nMuss VOR dem ersten echten Agent-Einsatz stehen — sonst fehlen die Daten von Anfang an.\n\nUnabhängig von den Data Integrity Tickets — kann parallel gebaut werden.","status":"closed","priority":2,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T15:41:58.20729+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T16:47:55.092723+01:00","closed_at":"2026-02-09T16:47:55.092723+01:00","close_reason":"Auth refactored to Tower Layer (InjectAuthLayer), AccessLogLayer captures all /v1/* access patterns, api_access_log table with analytics indexes. 26 Rust + 233 Python tests passing."}
{"id":"kura-training-zhr","title":"Split system layer: system_config table + endpoint","description":"Extract deployment-static system layer from user_profile monolith into separate system_config table and API endpoint. system_config written at worker startup, user_profile slimmed to user+agenda only.","status":"closed","priority":1,"issue_type":"task","owner":"jonzim@posteo.de","created_at":"2026-02-09T14:45:26.846565+01:00","created_by":"jonzim-cmd","updated_at":"2026-02-09T14:51:28.948653+01:00","closed_at":"2026-02-09T14:51:28.948653+01:00","close_reason":"Implemented: system_config table + GET /v1/system/config endpoint. user_profile slimmed to {user, agenda}. 204 Python tests passing, Rust compiles clean."}
